var gN=Object.defineProperty;var ux=i=>{throw TypeError(i)};var mN=(i,t,e)=>t in i?gN(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var B=(i,t,e)=>mN(i,typeof t!="symbol"?t+"":t,e),Wb=(i,t,e)=>t.has(i)||ux("Cannot "+e);var o=(i,t,e)=>(Wb(i,t,"read from private field"),e?e.call(i):t.get(i)),A=(i,t,e)=>t.has(i)?ux("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),m=(i,t,e,s)=>(Wb(i,t,"write to private field"),s?s.call(i,e):t.set(i,e),e),x=(i,t,e)=>(Wb(i,t,"access private method"),e);var Fe=(i,t,e,s)=>({set _(n){m(i,t,n,e)},get _(){return o(i,t,s)}});function pN(i,t){for(var e=0;e<t.length;e++){const s=t[e];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in i)){const r=Object.getOwnPropertyDescriptor(s,n);r&&Object.defineProperty(i,n,r.get?r:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();function GE(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function yN(i){if(i.__esModule)return i;var t=i.default;if(typeof t=="function"){var e=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(i).forEach(function(s){var n=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(e,s,n.get?n:{enumerable:!0,get:function(){return i[s]}})}),e}var VE={exports:{}},Ab={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN=Symbol.for("react.transitional.element"),vN=Symbol.for("react.fragment");function XE(i,t,e){var s=null;if(e!==void 0&&(s=""+e),t.key!==void 0&&(s=""+t.key),"key"in t){e={};for(var n in t)n!=="key"&&(e[n]=t[n])}else e=t;return t=e.ref,{$$typeof:bN,type:i,key:s,ref:t!==void 0?t:null,props:e}}Ab.Fragment=vN;Ab.jsx=XE;Ab.jsxs=XE;VE.exports=Ab;var _=VE.exports,YE={exports:{}},lt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BA=Symbol.for("react.transitional.element"),wN=Symbol.for("react.portal"),_N=Symbol.for("react.fragment"),AN=Symbol.for("react.strict_mode"),SN=Symbol.for("react.profiler"),xN=Symbol.for("react.consumer"),EN=Symbol.for("react.context"),TN=Symbol.for("react.forward_ref"),CN=Symbol.for("react.suspense"),RN=Symbol.for("react.memo"),KE=Symbol.for("react.lazy"),ON=Symbol.for("react.activity"),hx=Symbol.iterator;function kN(i){return i===null||typeof i!="object"?null:(i=hx&&i[hx]||i["@@iterator"],typeof i=="function"?i:null)}var WE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QE=Object.assign,JE={};function Ud(i,t,e){this.props=i,this.context=t,this.refs=JE,this.updater=e||WE}Ud.prototype.isReactComponent={};Ud.prototype.setState=function(i,t){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,t,"setState")};Ud.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function ZE(){}ZE.prototype=Ud.prototype;function IA(i,t,e){this.props=i,this.context=t,this.refs=JE,this.updater=e||WE}var UA=IA.prototype=new ZE;UA.constructor=IA;QE(UA,Ud.prototype);UA.isPureReactComponent=!0;var dx=Array.isArray;function Zv(){}var ae={H:null,A:null,T:null,S:null},tT=Object.prototype.hasOwnProperty;function zA(i,t,e){var s=e.ref;return{$$typeof:BA,type:i,key:t,ref:s!==void 0?s:null,props:e}}function NN(i,t){return zA(i.type,t,i.props)}function FA(i){return typeof i=="object"&&i!==null&&i.$$typeof===BA}function MN(i){var t={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(e){return t[e]})}var fx=/\/+/g;function Qb(i,t){return typeof i=="object"&&i!==null&&i.key!=null?MN(""+i.key):t.toString(36)}function DN(i){switch(i.status){case"fulfilled":return i.value;case"rejected":throw i.reason;default:switch(typeof i.status=="string"?i.then(Zv,Zv):(i.status="pending",i.then(function(t){i.status==="pending"&&(i.status="fulfilled",i.value=t)},function(t){i.status==="pending"&&(i.status="rejected",i.reason=t)})),i.status){case"fulfilled":return i.value;case"rejected":throw i.reason}}throw i}function pu(i,t,e,s,n){var r=typeof i;(r==="undefined"||r==="boolean")&&(i=null);var a=!1;if(i===null)a=!0;else switch(r){case"bigint":case"string":case"number":a=!0;break;case"object":switch(i.$$typeof){case BA:case wN:a=!0;break;case KE:return a=i._init,pu(a(i._payload),t,e,s,n)}}if(a)return n=n(i),a=s===""?"."+Qb(i,0):s,dx(n)?(e="",a!=null&&(e=a.replace(fx,"$&/")+"/"),pu(n,t,e,"",function(u){return u})):n!=null&&(FA(n)&&(n=NN(n,e+(n.key==null||i&&i.key===n.key?"":(""+n.key).replace(fx,"$&/")+"/")+a)),t.push(n)),1;a=0;var l=s===""?".":s+":";if(dx(i))for(var c=0;c<i.length;c++)s=i[c],r=l+Qb(s,c),a+=pu(s,t,e,r,n);else if(c=kN(i),typeof c=="function")for(i=c.call(i),c=0;!(s=i.next()).done;)s=s.value,r=l+Qb(s,c++),a+=pu(s,t,e,r,n);else if(r==="object"){if(typeof i.then=="function")return pu(DN(i),t,e,s,n);throw t=String(i),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return a}function Dp(i,t,e){if(i==null)return i;var s=[],n=0;return pu(i,s,"","",function(r){return t.call(e,r,n++)}),s}function jN(i){if(i._status===-1){var t=i._result;t=t(),t.then(function(e){(i._status===0||i._status===-1)&&(i._status=1,i._result=e)},function(e){(i._status===0||i._status===-1)&&(i._status=2,i._result=e)}),i._status===-1&&(i._status=0,i._result=t)}if(i._status===1)return i._result.default;throw i._result}var gx=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},LN={map:Dp,forEach:function(i,t,e){Dp(i,function(){t.apply(this,arguments)},e)},count:function(i){var t=0;return Dp(i,function(){t++}),t},toArray:function(i){return Dp(i,function(t){return t})||[]},only:function(i){if(!FA(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};lt.Activity=ON;lt.Children=LN;lt.Component=Ud;lt.Fragment=_N;lt.Profiler=SN;lt.PureComponent=IA;lt.StrictMode=AN;lt.Suspense=CN;lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ae;lt.__COMPILER_RUNTIME={__proto__:null,c:function(i){return ae.H.useMemoCache(i)}};lt.cache=function(i){return function(){return i.apply(null,arguments)}};lt.cacheSignal=function(){return null};lt.cloneElement=function(i,t,e){if(i==null)throw Error("The argument must be a React element, but you passed "+i+".");var s=QE({},i.props),n=i.key;if(t!=null)for(r in t.key!==void 0&&(n=""+t.key),t)!tT.call(t,r)||r==="key"||r==="__self"||r==="__source"||r==="ref"&&t.ref===void 0||(s[r]=t[r]);var r=arguments.length-2;if(r===1)s.children=e;else if(1<r){for(var a=Array(r),l=0;l<r;l++)a[l]=arguments[l+2];s.children=a}return zA(i.type,n,s)};lt.createContext=function(i){return i={$$typeof:EN,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null},i.Provider=i,i.Consumer={$$typeof:xN,_context:i},i};lt.createElement=function(i,t,e){var s,n={},r=null;if(t!=null)for(s in t.key!==void 0&&(r=""+t.key),t)tT.call(t,s)&&s!=="key"&&s!=="__self"&&s!=="__source"&&(n[s]=t[s]);var a=arguments.length-2;if(a===1)n.children=e;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];n.children=l}if(i&&i.defaultProps)for(s in a=i.defaultProps,a)n[s]===void 0&&(n[s]=a[s]);return zA(i,r,n)};lt.createRef=function(){return{current:null}};lt.forwardRef=function(i){return{$$typeof:TN,render:i}};lt.isValidElement=FA;lt.lazy=function(i){return{$$typeof:KE,_payload:{_status:-1,_result:i},_init:jN}};lt.memo=function(i,t){return{$$typeof:RN,type:i,compare:t===void 0?null:t}};lt.startTransition=function(i){var t=ae.T,e={};ae.T=e;try{var s=i(),n=ae.S;n!==null&&n(e,s),typeof s=="object"&&s!==null&&typeof s.then=="function"&&s.then(Zv,gx)}catch(r){gx(r)}finally{t!==null&&e.types!==null&&(t.types=e.types),ae.T=t}};lt.unstable_useCacheRefresh=function(){return ae.H.useCacheRefresh()};lt.use=function(i){return ae.H.use(i)};lt.useActionState=function(i,t,e){return ae.H.useActionState(i,t,e)};lt.useCallback=function(i,t){return ae.H.useCallback(i,t)};lt.useContext=function(i){return ae.H.useContext(i)};lt.useDebugValue=function(){};lt.useDeferredValue=function(i,t){return ae.H.useDeferredValue(i,t)};lt.useEffect=function(i,t){return ae.H.useEffect(i,t)};lt.useEffectEvent=function(i){return ae.H.useEffectEvent(i)};lt.useId=function(){return ae.H.useId()};lt.useImperativeHandle=function(i,t,e){return ae.H.useImperativeHandle(i,t,e)};lt.useInsertionEffect=function(i,t){return ae.H.useInsertionEffect(i,t)};lt.useLayoutEffect=function(i,t){return ae.H.useLayoutEffect(i,t)};lt.useMemo=function(i,t){return ae.H.useMemo(i,t)};lt.useOptimistic=function(i,t){return ae.H.useOptimistic(i,t)};lt.useReducer=function(i,t,e){return ae.H.useReducer(i,t,e)};lt.useRef=function(i){return ae.H.useRef(i)};lt.useState=function(i){return ae.H.useState(i)};lt.useSyncExternalStore=function(i,t,e){return ae.H.useSyncExternalStore(i,t,e)};lt.useTransition=function(){return ae.H.useTransition()};lt.version="19.2.0";YE.exports=lt;var q=YE.exports;const PN=GE(q);var eT={exports:{}},Sb={},sT={exports:{}},iT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function t(N,L){var z=N.length;N.push(L);t:for(;0<z;){var tt=z-1>>>1,bt=N[tt];if(0<n(bt,L))N[tt]=L,N[z]=bt,z=tt;else break t}}function e(N){return N.length===0?null:N[0]}function s(N){if(N.length===0)return null;var L=N[0],z=N.pop();if(z!==L){N[0]=z;t:for(var tt=0,bt=N.length,ze=bt>>>1;tt<ze;){var gt=2*(tt+1)-1,vt=N[gt],Nt=gt+1,de=N[Nt];if(0>n(vt,z))Nt<bt&&0>n(de,vt)?(N[tt]=de,N[Nt]=z,tt=Nt):(N[tt]=vt,N[gt]=z,tt=gt);else if(Nt<bt&&0>n(de,z))N[tt]=de,N[Nt]=z,tt=Nt;else break t}}return L}function n(N,L){var z=N.sortIndex-L.sortIndex;return z!==0?z:N.id-L.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;i.unstable_now=function(){return r.now()}}else{var a=Date,l=a.now();i.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,g=!1,b=!1,v=!1,S=!1,p=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;function E(N){for(var L=e(u);L!==null;){if(L.callback===null)s(u);else if(L.startTime<=N)s(u),L.sortIndex=L.expirationTime,t(c,L);else break;L=e(u)}}function T(N){if(v=!1,E(N),!b)if(e(c)!==null)b=!0,C||(C=!0,I());else{var L=e(u);L!==null&&W(T,L.startTime-N)}}var C=!1,R=-1,O=5,k=-1;function D(){return S?!0:!(i.unstable_now()-k<O)}function P(){if(S=!1,C){var N=i.unstable_now();k=N;var L=!0;try{t:{b=!1,v&&(v=!1,w(R),R=-1),g=!0;var z=f;try{e:{for(E(N),d=e(c);d!==null&&!(d.expirationTime>N&&D());){var tt=d.callback;if(typeof tt=="function"){d.callback=null,f=d.priorityLevel;var bt=tt(d.expirationTime<=N);if(N=i.unstable_now(),typeof bt=="function"){d.callback=bt,E(N),L=!0;break e}d===e(c)&&s(c),E(N)}else s(c);d=e(c)}if(d!==null)L=!0;else{var ze=e(u);ze!==null&&W(T,ze.startTime-N),L=!1}}break t}finally{d=null,f=z,g=!1}L=void 0}}finally{L?I():C=!1}}}var I;if(typeof y=="function")I=function(){y(P)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,K=Z.port2;Z.port1.onmessage=P,I=function(){K.postMessage(null)}}else I=function(){p(P,0)};function W(N,L){R=p(function(){N(i.unstable_now())},L)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(N){N.callback=null},i.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<N?Math.floor(1e3/N):5},i.unstable_getCurrentPriorityLevel=function(){return f},i.unstable_next=function(N){switch(f){case 1:case 2:case 3:var L=3;break;default:L=f}var z=f;f=L;try{return N()}finally{f=z}},i.unstable_requestPaint=function(){S=!0},i.unstable_runWithPriority=function(N,L){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var z=f;f=N;try{return L()}finally{f=z}},i.unstable_scheduleCallback=function(N,L,z){var tt=i.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?tt+z:tt):z=tt,N){case 1:var bt=-1;break;case 2:bt=250;break;case 5:bt=1073741823;break;case 4:bt=1e4;break;default:bt=5e3}return bt=z+bt,N={id:h++,callback:L,priorityLevel:N,startTime:z,expirationTime:bt,sortIndex:-1},z>tt?(N.sortIndex=z,t(u,N),e(c)===null&&N===e(u)&&(v?(w(R),R=-1):v=!0,W(T,z-tt))):(N.sortIndex=bt,t(c,N),b||g||(b=!0,C||(C=!0,I()))),N},i.unstable_shouldYield=D,i.unstable_wrapCallback=function(N){var L=f;return function(){var z=f;f=L;try{return N.apply(this,arguments)}finally{f=z}}}})(iT);sT.exports=iT;var BN=sT.exports,nT={exports:{}},$s={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IN=q;function rT(i){var t="https://react.dev/errors/"+i;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var e=2;e<arguments.length;e++)t+="&args[]="+encodeURIComponent(arguments[e])}return"Minified React error #"+i+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function ja(){}var zs={d:{f:ja,r:function(){throw Error(rT(522))},D:ja,C:ja,L:ja,m:ja,X:ja,S:ja,M:ja},p:0,findDOMNode:null},UN=Symbol.for("react.portal");function zN(i,t,e){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:UN,key:s==null?null:""+s,children:i,containerInfo:t,implementation:e}}var Bf=IN.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function xb(i,t){if(i==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}$s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=zs;$s.createPortal=function(i,t){var e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(rT(299));return zN(i,t,null,e)};$s.flushSync=function(i){var t=Bf.T,e=zs.p;try{if(Bf.T=null,zs.p=2,i)return i()}finally{Bf.T=t,zs.p=e,zs.d.f()}};$s.preconnect=function(i,t){typeof i=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,zs.d.C(i,t))};$s.prefetchDNS=function(i){typeof i=="string"&&zs.d.D(i)};$s.preinit=function(i,t){if(typeof i=="string"&&t&&typeof t.as=="string"){var e=t.as,s=xb(e,t.crossOrigin),n=typeof t.integrity=="string"?t.integrity:void 0,r=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;e==="style"?zs.d.S(i,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:s,integrity:n,fetchPriority:r}):e==="script"&&zs.d.X(i,{crossOrigin:s,integrity:n,fetchPriority:r,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};$s.preinitModule=function(i,t){if(typeof i=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var e=xb(t.as,t.crossOrigin);zs.d.M(i,{crossOrigin:e,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&zs.d.M(i)};$s.preload=function(i,t){if(typeof i=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var e=t.as,s=xb(e,t.crossOrigin);zs.d.L(i,e,{crossOrigin:s,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};$s.preloadModule=function(i,t){if(typeof i=="string")if(t){var e=xb(t.as,t.crossOrigin);zs.d.m(i,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:e,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else zs.d.m(i)};$s.requestFormReset=function(i){zs.d.r(i)};$s.unstable_batchedUpdates=function(i,t){return i(t)};$s.useFormState=function(i,t,e){return Bf.H.useFormState(i,t,e)};$s.useFormStatus=function(){return Bf.H.useHostTransitionStatus()};$s.version="19.2.0";function aT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aT)}catch(i){console.error(i)}}aT(),nT.exports=$s;var FN=nT.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ke=BN,oT=q,HN=FN;function M(i){var t="https://react.dev/errors/"+i;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var e=2;e<arguments.length;e++)t+="&args[]="+encodeURIComponent(arguments[e])}return"Minified React error #"+i+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function lT(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function hp(i){var t=i,e=i;if(i.alternate)for(;t.return;)t=t.return;else{i=t;do t=i,t.flags&4098&&(e=t.return),i=t.return;while(i)}return t.tag===3?e:null}function cT(i){if(i.tag===13){var t=i.memoizedState;if(t===null&&(i=i.alternate,i!==null&&(t=i.memoizedState)),t!==null)return t.dehydrated}return null}function uT(i){if(i.tag===31){var t=i.memoizedState;if(t===null&&(i=i.alternate,i!==null&&(t=i.memoizedState)),t!==null)return t.dehydrated}return null}function mx(i){if(hp(i)!==i)throw Error(M(188))}function $N(i){var t=i.alternate;if(!t){if(t=hp(i),t===null)throw Error(M(188));return t!==i?null:i}for(var e=i,s=t;;){var n=e.return;if(n===null)break;var r=n.alternate;if(r===null){if(s=n.return,s!==null){e=s;continue}break}if(n.child===r.child){for(r=n.child;r;){if(r===e)return mx(n),i;if(r===s)return mx(n),t;r=r.sibling}throw Error(M(188))}if(e.return!==s.return)e=n,s=r;else{for(var a=!1,l=n.child;l;){if(l===e){a=!0,e=n,s=r;break}if(l===s){a=!0,s=n,e=r;break}l=l.sibling}if(!a){for(l=r.child;l;){if(l===e){a=!0,e=r,s=n;break}if(l===s){a=!0,s=r,e=n;break}l=l.sibling}if(!a)throw Error(M(189))}}if(e.alternate!==s)throw Error(M(190))}if(e.tag!==3)throw Error(M(188));return e.stateNode.current===e?i:t}function hT(i){var t=i.tag;if(t===5||t===26||t===27||t===6)return i;for(i=i.child;i!==null;){if(t=hT(i),t!==null)return t;i=i.sibling}return null}var oe=Object.assign,qN=Symbol.for("react.element"),jp=Symbol.for("react.transitional.element"),uf=Symbol.for("react.portal"),Ou=Symbol.for("react.fragment"),dT=Symbol.for("react.strict_mode"),tw=Symbol.for("react.profiler"),fT=Symbol.for("react.consumer"),ya=Symbol.for("react.context"),HA=Symbol.for("react.forward_ref"),ew=Symbol.for("react.suspense"),sw=Symbol.for("react.suspense_list"),$A=Symbol.for("react.memo"),Ba=Symbol.for("react.lazy"),iw=Symbol.for("react.activity"),GN=Symbol.for("react.memo_cache_sentinel"),px=Symbol.iterator;function Qd(i){return i===null||typeof i!="object"?null:(i=px&&i[px]||i["@@iterator"],typeof i=="function"?i:null)}var VN=Symbol.for("react.client.reference");function nw(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===VN?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Ou:return"Fragment";case tw:return"Profiler";case dT:return"StrictMode";case ew:return"Suspense";case sw:return"SuspenseList";case iw:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case uf:return"Portal";case ya:return i.displayName||"Context";case fT:return(i._context.displayName||"Context")+".Consumer";case HA:var t=i.render;return i=i.displayName,i||(i=t.displayName||t.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case $A:return t=i.displayName||null,t!==null?t:nw(i.type)||"Memo";case Ba:t=i._payload,i=i._init;try{return nw(i(t))}catch{}}return null}var hf=Array.isArray,st=oT.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,kt=HN.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,zc={pending:!1,data:null,method:null,action:null},rw=[],ku=-1;function _r(i){return{current:i}}function as(i){0>ku||(i.current=rw[ku],rw[ku]=null,ku--)}function se(i,t){ku++,rw[ku]=i.current,i.current=t}var yr=_r(null),tg=_r(null),Ho=_r(null),c0=_r(null);function u0(i,t){switch(se(Ho,t),se(tg,i),se(yr,null),t.nodeType){case 9:case 11:i=(i=t.documentElement)&&(i=i.namespaceURI)?A1(i):0;break;default:if(i=t.tagName,t=t.namespaceURI)t=A1(t),i=D2(t,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}as(yr),se(yr,i)}function Cd(){as(yr),as(tg),as(Ho)}function aw(i){i.memoizedState!==null&&se(c0,i);var t=yr.current,e=D2(t,i.type);t!==e&&(se(tg,i),se(yr,e))}function h0(i){tg.current===i&&(as(yr),as(tg)),c0.current===i&&(as(c0),hg._currentValue=zc)}var Jb,yx;function hl(i){if(Jb===void 0)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);Jb=t&&t[1]||"",yx=-1<e.stack.indexOf(`
    at`)?" (<anonymous>)":-1<e.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Jb+i+yx}var Zb=!1;function tv(i,t){if(!i||Zb)return"";Zb=!0;var e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var d=function(){throw Error()};if(Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(g){var f=g}Reflect.construct(i,[],d)}else{try{d.call()}catch(g){f=g}i.call(d.prototype)}}else{try{throw Error()}catch(g){f=g}(d=i())&&typeof d.catch=="function"&&d.catch(function(){})}}catch(g){if(g&&f&&typeof g.stack=="string")return[g.stack,f.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=s.DetermineComponentFrameRoot(),a=r[0],l=r[1];if(a&&l){var c=a.split(`
`),u=l.split(`
`);for(n=s=0;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;for(;n<u.length&&!u[n].includes("DetermineComponentFrameRoot");)n++;if(s===c.length||n===u.length)for(s=c.length-1,n=u.length-1;1<=s&&0<=n&&c[s]!==u[n];)n--;for(;1<=s&&0<=n;s--,n--)if(c[s]!==u[n]){if(s!==1||n!==1)do if(s--,n--,0>n||c[s]!==u[n]){var h=`
`+c[s].replace(" at new "," at ");return i.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",i.displayName)),h}while(1<=s&&0<=n);break}}}finally{Zb=!1,Error.prepareStackTrace=e}return(e=i?i.displayName||i.name:"")?hl(e):""}function XN(i,t){switch(i.tag){case 26:case 27:case 5:return hl(i.type);case 16:return hl("Lazy");case 13:return i.child!==t&&t!==null?hl("Suspense Fallback"):hl("Suspense");case 19:return hl("SuspenseList");case 0:case 15:return tv(i.type,!1);case 11:return tv(i.type.render,!1);case 1:return tv(i.type,!0);case 31:return hl("Activity");default:return""}}function bx(i){try{var t="",e=null;do t+=XN(i,e),e=i,i=i.return;while(i);return t}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}var ow=Object.prototype.hasOwnProperty,qA=Ke.unstable_scheduleCallback,ev=Ke.unstable_cancelCallback,YN=Ke.unstable_shouldYield,KN=Ke.unstable_requestPaint,Pi=Ke.unstable_now,WN=Ke.unstable_getCurrentPriorityLevel,gT=Ke.unstable_ImmediatePriority,mT=Ke.unstable_UserBlockingPriority,d0=Ke.unstable_NormalPriority,QN=Ke.unstable_LowPriority,pT=Ke.unstable_IdlePriority,JN=Ke.log,ZN=Ke.unstable_setDisableYieldValue,dp=null,Bi=null;function Bo(i){if(typeof JN=="function"&&ZN(i),Bi&&typeof Bi.setStrictMode=="function")try{Bi.setStrictMode(dp,i)}catch{}}var Ii=Math.clz32?Math.clz32:sM,tM=Math.log,eM=Math.LN2;function sM(i){return i>>>=0,i===0?32:31-(tM(i)/eM|0)|0}var Lp=256,Pp=262144,Bp=4194304;function dl(i){var t=i&42;if(t!==0)return t;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Eb(i,t,e){var s=i.pendingLanes;if(s===0)return 0;var n=0,r=i.suspendedLanes,a=i.pingedLanes;i=i.warmLanes;var l=s&134217727;return l!==0?(s=l&~r,s!==0?n=dl(s):(a&=l,a!==0?n=dl(a):e||(e=l&~i,e!==0&&(n=dl(e))))):(l=s&~r,l!==0?n=dl(l):a!==0?n=dl(a):e||(e=s&~i,e!==0&&(n=dl(e)))),n===0?0:t!==0&&t!==n&&!(t&r)&&(r=n&-n,e=t&-t,r>=e||r===32&&(e&4194048)!==0)?t:n}function fp(i,t){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&t)===0}function iM(i,t){switch(i){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yT(){var i=Bp;return Bp<<=1,!(Bp&62914560)&&(Bp=4194304),i}function sv(i){for(var t=[],e=0;31>e;e++)t.push(i);return t}function gp(i,t){i.pendingLanes|=t,t!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function nM(i,t,e,s,n,r){var a=i.pendingLanes;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=e,i.entangledLanes&=e,i.errorRecoveryDisabledLanes&=e,i.shellSuspendCounter=0;var l=i.entanglements,c=i.expirationTimes,u=i.hiddenUpdates;for(e=a&~e;0<e;){var h=31-Ii(e),d=1<<h;l[h]=0,c[h]=-1;var f=u[h];if(f!==null)for(u[h]=null,h=0;h<f.length;h++){var g=f[h];g!==null&&(g.lane&=-536870913)}e&=~d}s!==0&&bT(i,s,0),r!==0&&n===0&&i.tag!==0&&(i.suspendedLanes|=r&~(a&~t))}function bT(i,t,e){i.pendingLanes|=t,i.suspendedLanes&=~t;var s=31-Ii(t);i.entangledLanes|=t,i.entanglements[s]=i.entanglements[s]|1073741824|e&261930}function vT(i,t){var e=i.entangledLanes|=t;for(i=i.entanglements;e;){var s=31-Ii(e),n=1<<s;n&t|i[s]&t&&(i[s]|=t),e&=~n}}function wT(i,t){var e=t&-t;return e=e&42?1:GA(e),e&(i.suspendedLanes|t)?0:e}function GA(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function VA(i){return i&=-i,2<i?8<i?i&134217727?32:268435456:8:2}function _T(){var i=kt.p;return i!==0?i:(i=window.event,i===void 0?32:q2(i.type))}function vx(i,t){var e=kt.p;try{return kt.p=i,t()}finally{kt.p=e}}var nl=Math.random().toString(36).slice(2),ps="__reactFiber$"+nl,ai="__reactProps$"+nl,zd="__reactContainer$"+nl,lw="__reactEvents$"+nl,rM="__reactListeners$"+nl,aM="__reactHandles$"+nl,wx="__reactResources$"+nl,mp="__reactMarker$"+nl;function XA(i){delete i[ps],delete i[ai],delete i[lw],delete i[rM],delete i[aM]}function Nu(i){var t=i[ps];if(t)return t;for(var e=i.parentNode;e;){if(t=e[zd]||e[ps]){if(e=t.alternate,t.child!==null||e!==null&&e.child!==null)for(i=C1(i);i!==null;){if(e=i[ps])return e;i=C1(i)}return t}i=e,e=i.parentNode}return null}function Fd(i){if(i=i[ps]||i[zd]){var t=i.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return i}return null}function df(i){var t=i.tag;if(t===5||t===26||t===27||t===6)return i.stateNode;throw Error(M(33))}function Xu(i){var t=i[wx];return t||(t=i[wx]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function rs(i){i[mp]=!0}var AT=new Set,ST={};function Zc(i,t){Rd(i,t),Rd(i+"Capture",t)}function Rd(i,t){for(ST[i]=t,i=0;i<t.length;i++)AT.add(t[i])}var oM=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_x={},Ax={};function lM(i){return ow.call(Ax,i)?!0:ow.call(_x,i)?!1:oM.test(i)?Ax[i]=!0:(_x[i]=!0,!1)}function fy(i,t,e){if(lM(t))if(e===null)i.removeAttribute(t);else{switch(typeof e){case"undefined":case"function":case"symbol":i.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){i.removeAttribute(t);return}}i.setAttribute(t,""+e)}}function Ip(i,t,e){if(e===null)i.removeAttribute(t);else{switch(typeof e){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(t);return}i.setAttribute(t,""+e)}}function Sr(i,t,e,s){if(s===null)i.removeAttribute(e);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(e);return}i.setAttributeNS(t,e,""+s)}}function on(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function xT(i){var t=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function cM(i,t,e){var s=Object.getOwnPropertyDescriptor(i.constructor.prototype,t);if(!i.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var n=s.get,r=s.set;return Object.defineProperty(i,t,{configurable:!0,get:function(){return n.call(this)},set:function(a){e=""+a,r.call(this,a)}}),Object.defineProperty(i,t,{enumerable:s.enumerable}),{getValue:function(){return e},setValue:function(a){e=""+a},stopTracking:function(){i._valueTracker=null,delete i[t]}}}}function cw(i){if(!i._valueTracker){var t=xT(i)?"checked":"value";i._valueTracker=cM(i,t,""+i[t])}}function ET(i){if(!i)return!1;var t=i._valueTracker;if(!t)return!0;var e=t.getValue(),s="";return i&&(s=xT(i)?i.checked?"true":"false":i.value),i=s,i!==e?(t.setValue(i),!0):!1}function f0(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var uM=/[\n"\\]/g;function un(i){return i.replace(uM,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function uw(i,t,e,s,n,r,a,l){i.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?i.type=a:i.removeAttribute("type"),t!=null?a==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+on(t)):i.value!==""+on(t)&&(i.value=""+on(t)):a!=="submit"&&a!=="reset"||i.removeAttribute("value"),t!=null?hw(i,a,on(t)):e!=null?hw(i,a,on(e)):s!=null&&i.removeAttribute("value"),n==null&&r!=null&&(i.defaultChecked=!!r),n!=null&&(i.checked=n&&typeof n!="function"&&typeof n!="symbol"),l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"?i.name=""+on(l):i.removeAttribute("name")}function TT(i,t,e,s,n,r,a,l){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(i.type=r),t!=null||e!=null){if(!(r!=="submit"&&r!=="reset"||t!=null)){cw(i);return}e=e!=null?""+on(e):"",t=t!=null?""+on(t):e,l||t===i.value||(i.value=t),i.defaultValue=t}s=s??n,s=typeof s!="function"&&typeof s!="symbol"&&!!s,i.checked=l?i.checked:!!s,i.defaultChecked=!!s,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(i.name=a),cw(i)}function hw(i,t,e){t==="number"&&f0(i.ownerDocument)===i||i.defaultValue===""+e||(i.defaultValue=""+e)}function Yu(i,t,e,s){if(i=i.options,t){t={};for(var n=0;n<e.length;n++)t["$"+e[n]]=!0;for(e=0;e<i.length;e++)n=t.hasOwnProperty("$"+i[e].value),i[e].selected!==n&&(i[e].selected=n),n&&s&&(i[e].defaultSelected=!0)}else{for(e=""+on(e),t=null,n=0;n<i.length;n++){if(i[n].value===e){i[n].selected=!0,s&&(i[n].defaultSelected=!0);return}t!==null||i[n].disabled||(t=i[n])}t!==null&&(t.selected=!0)}}function CT(i,t,e){if(t!=null&&(t=""+on(t),t!==i.value&&(i.value=t),e==null)){i.defaultValue!==t&&(i.defaultValue=t);return}i.defaultValue=e!=null?""+on(e):""}function RT(i,t,e,s){if(t==null){if(s!=null){if(e!=null)throw Error(M(92));if(hf(s)){if(1<s.length)throw Error(M(93));s=s[0]}e=s}e==null&&(e=""),t=e}e=on(t),i.defaultValue=e,s=i.textContent,s===e&&s!==""&&s!==null&&(i.value=s),cw(i)}function Od(i,t){if(t){var e=i.firstChild;if(e&&e===i.lastChild&&e.nodeType===3){e.nodeValue=t;return}}i.textContent=t}var hM=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Sx(i,t,e){var s=t.indexOf("--")===0;e==null||typeof e=="boolean"||e===""?s?i.setProperty(t,""):t==="float"?i.cssFloat="":i[t]="":s?i.setProperty(t,e):typeof e!="number"||e===0||hM.has(t)?t==="float"?i.cssFloat=e:i[t]=(""+e).trim():i[t]=e+"px"}function OT(i,t,e){if(t!=null&&typeof t!="object")throw Error(M(62));if(i=i.style,e!=null){for(var s in e)!e.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="");for(var n in t)s=t[n],t.hasOwnProperty(n)&&e[n]!==s&&Sx(i,n,s)}else for(var r in t)t.hasOwnProperty(r)&&Sx(i,r,t[r])}function YA(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dM=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),fM=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function gy(i){return fM.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ba(){}var dw=null;function KA(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Mu=null,Ku=null;function xx(i){var t=Fd(i);if(t&&(i=t.stateNode)){var e=i[ai]||null;t:switch(i=t.stateNode,t.type){case"input":if(uw(i,e.value,e.defaultValue,e.defaultValue,e.checked,e.defaultChecked,e.type,e.name),t=e.name,e.type==="radio"&&t!=null){for(e=i;e.parentNode;)e=e.parentNode;for(e=e.querySelectorAll('input[name="'+un(""+t)+'"][type="radio"]'),t=0;t<e.length;t++){var s=e[t];if(s!==i&&s.form===i.form){var n=s[ai]||null;if(!n)throw Error(M(90));uw(s,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(t=0;t<e.length;t++)s=e[t],s.form===i.form&&ET(s)}break t;case"textarea":CT(i,e.value,e.defaultValue);break t;case"select":t=e.value,t!=null&&Yu(i,!!e.multiple,t,!1)}}}var iv=!1;function kT(i,t,e){if(iv)return i(t,e);iv=!0;try{var s=i(t);return s}finally{if(iv=!1,(Mu!==null||Ku!==null)&&(Bb(),Mu&&(t=Mu,i=Ku,Ku=Mu=null,xx(t),i)))for(t=0;t<i.length;t++)xx(i[t])}}function eg(i,t){var e=i.stateNode;if(e===null)return null;var s=e[ai]||null;if(s===null)return null;e=s[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(i=i.type,s=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!s;break t;default:i=!1}if(i)return null;if(e&&typeof e!="function")throw Error(M(231,t,typeof e));return e}var Ta=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fw=!1;if(Ta)try{var Jd={};Object.defineProperty(Jd,"passive",{get:function(){fw=!0}}),window.addEventListener("test",Jd,Jd),window.removeEventListener("test",Jd,Jd)}catch{fw=!1}var Io=null,WA=null,my=null;function NT(){if(my)return my;var i,t=WA,e=t.length,s,n="value"in Io?Io.value:Io.textContent,r=n.length;for(i=0;i<e&&t[i]===n[i];i++);var a=e-i;for(s=1;s<=a&&t[e-s]===n[r-s];s++);return my=n.slice(i,1<s?1-s:void 0)}function py(i){var t=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&t===13&&(i=13)):i=t,i===10&&(i=13),32<=i||i===13?i:0}function Up(){return!0}function Ex(){return!1}function oi(i){function t(e,s,n,r,a){this._reactName=e,this._targetInst=n,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var l in i)i.hasOwnProperty(l)&&(e=i[l],this[l]=e?e(r):r[l]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Up:Ex,this.isPropagationStopped=Ex,this}return oe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():typeof e.returnValue!="unknown"&&(e.returnValue=!1),this.isDefaultPrevented=Up)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():typeof e.cancelBubble!="unknown"&&(e.cancelBubble=!0),this.isPropagationStopped=Up)},persist:function(){},isPersistent:Up}),t}var tu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tb=oi(tu),pp=oe({},tu,{view:0,detail:0}),gM=oi(pp),nv,rv,Zd,Cb=oe({},pp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:QA,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Zd&&(Zd&&i.type==="mousemove"?(nv=i.screenX-Zd.screenX,rv=i.screenY-Zd.screenY):rv=nv=0,Zd=i),nv)},movementY:function(i){return"movementY"in i?i.movementY:rv}}),Tx=oi(Cb),mM=oe({},Cb,{dataTransfer:0}),pM=oi(mM),yM=oe({},pp,{relatedTarget:0}),av=oi(yM),bM=oe({},tu,{animationName:0,elapsedTime:0,pseudoElement:0}),vM=oi(bM),wM=oe({},tu,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),_M=oi(wM),AM=oe({},tu,{data:0}),Cx=oi(AM),SM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TM(i){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(i):(i=EM[i])?!!t[i]:!1}function QA(){return TM}var CM=oe({},pp,{key:function(i){if(i.key){var t=SM[i.key]||i.key;if(t!=="Unidentified")return t}return i.type==="keypress"?(i=py(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?xM[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:QA,charCode:function(i){return i.type==="keypress"?py(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?py(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),RM=oi(CM),OM=oe({},Cb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rx=oi(OM),kM=oe({},pp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:QA}),NM=oi(kM),MM=oe({},tu,{propertyName:0,elapsedTime:0,pseudoElement:0}),DM=oi(MM),jM=oe({},Cb,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),LM=oi(jM),PM=oe({},tu,{newState:0,oldState:0}),BM=oi(PM),IM=[9,13,27,32],JA=Ta&&"CompositionEvent"in window,If=null;Ta&&"documentMode"in document&&(If=document.documentMode);var UM=Ta&&"TextEvent"in window&&!If,MT=Ta&&(!JA||If&&8<If&&11>=If),Ox=" ",kx=!1;function DT(i,t){switch(i){case"keyup":return IM.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jT(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Du=!1;function zM(i,t){switch(i){case"compositionend":return jT(t);case"keypress":return t.which!==32?null:(kx=!0,Ox);case"textInput":return i=t.data,i===Ox&&kx?null:i;default:return null}}function FM(i,t){if(Du)return i==="compositionend"||!JA&&DT(i,t)?(i=NT(),my=WA=Io=null,Du=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return MT&&t.locale!=="ko"?null:t.data;default:return null}}var HM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nx(i){var t=i&&i.nodeName&&i.nodeName.toLowerCase();return t==="input"?!!HM[i.type]:t==="textarea"}function LT(i,t,e,s){Mu?Ku?Ku.push(s):Ku=[s]:Mu=s,t=N0(t,"onChange"),0<t.length&&(e=new Tb("onChange","change",null,e,s),i.push({event:e,listeners:t}))}var Uf=null,sg=null;function $M(i){k2(i,0)}function Rb(i){var t=df(i);if(ET(t))return i}function Mx(i,t){if(i==="change")return t}var PT=!1;if(Ta){var ov;if(Ta){var lv="oninput"in document;if(!lv){var Dx=document.createElement("div");Dx.setAttribute("oninput","return;"),lv=typeof Dx.oninput=="function"}ov=lv}else ov=!1;PT=ov&&(!document.documentMode||9<document.documentMode)}function jx(){Uf&&(Uf.detachEvent("onpropertychange",BT),sg=Uf=null)}function BT(i){if(i.propertyName==="value"&&Rb(sg)){var t=[];LT(t,sg,i,KA(i)),kT($M,t)}}function qM(i,t,e){i==="focusin"?(jx(),Uf=t,sg=e,Uf.attachEvent("onpropertychange",BT)):i==="focusout"&&jx()}function GM(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Rb(sg)}function VM(i,t){if(i==="click")return Rb(t)}function XM(i,t){if(i==="input"||i==="change")return Rb(t)}function YM(i,t){return i===t&&(i!==0||1/i===1/t)||i!==i&&t!==t}var Fi=typeof Object.is=="function"?Object.is:YM;function ig(i,t){if(Fi(i,t))return!0;if(typeof i!="object"||i===null||typeof t!="object"||t===null)return!1;var e=Object.keys(i),s=Object.keys(t);if(e.length!==s.length)return!1;for(s=0;s<e.length;s++){var n=e[s];if(!ow.call(t,n)||!Fi(i[n],t[n]))return!1}return!0}function Lx(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Px(i,t){var e=Lx(i);i=0;for(var s;e;){if(e.nodeType===3){if(s=i+e.textContent.length,i<=t&&s>=t)return{node:e,offset:t-i};i=s}t:{for(;e;){if(e.nextSibling){e=e.nextSibling;break t}e=e.parentNode}e=void 0}e=Lx(e)}}function IT(i,t){return i&&t?i===t?!0:i&&i.nodeType===3?!1:t&&t.nodeType===3?IT(i,t.parentNode):"contains"in i?i.contains(t):i.compareDocumentPosition?!!(i.compareDocumentPosition(t)&16):!1:!1}function UT(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var t=f0(i.document);t instanceof i.HTMLIFrameElement;){try{var e=typeof t.contentWindow.location.href=="string"}catch{e=!1}if(e)i=t.contentWindow;else break;t=f0(i.document)}return t}function ZA(i){var t=i&&i.nodeName&&i.nodeName.toLowerCase();return t&&(t==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||t==="textarea"||i.contentEditable==="true")}var KM=Ta&&"documentMode"in document&&11>=document.documentMode,ju=null,gw=null,zf=null,mw=!1;function Bx(i,t,e){var s=e.window===e?e.document:e.nodeType===9?e:e.ownerDocument;mw||ju==null||ju!==f0(s)||(s=ju,"selectionStart"in s&&ZA(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),zf&&ig(zf,s)||(zf=s,s=N0(gw,"onSelect"),0<s.length&&(t=new Tb("onSelect","select",null,t,e),i.push({event:t,listeners:s}),t.target=ju)))}function ll(i,t){var e={};return e[i.toLowerCase()]=t.toLowerCase(),e["Webkit"+i]="webkit"+t,e["Moz"+i]="moz"+t,e}var Lu={animationend:ll("Animation","AnimationEnd"),animationiteration:ll("Animation","AnimationIteration"),animationstart:ll("Animation","AnimationStart"),transitionrun:ll("Transition","TransitionRun"),transitionstart:ll("Transition","TransitionStart"),transitioncancel:ll("Transition","TransitionCancel"),transitionend:ll("Transition","TransitionEnd")},cv={},zT={};Ta&&(zT=document.createElement("div").style,"AnimationEvent"in window||(delete Lu.animationend.animation,delete Lu.animationiteration.animation,delete Lu.animationstart.animation),"TransitionEvent"in window||delete Lu.transitionend.transition);function eu(i){if(cv[i])return cv[i];if(!Lu[i])return i;var t=Lu[i],e;for(e in t)if(t.hasOwnProperty(e)&&e in zT)return cv[i]=t[e];return i}var FT=eu("animationend"),HT=eu("animationiteration"),$T=eu("animationstart"),WM=eu("transitionrun"),QM=eu("transitionstart"),JM=eu("transitioncancel"),qT=eu("transitionend"),GT=new Map,pw="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pw.push("scrollEnd");function Fn(i,t){GT.set(i,t),Zc(t,[i])}var g0=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},an=[],Pu=0,tS=0;function Ob(){for(var i=Pu,t=tS=Pu=0;t<i;){var e=an[t];an[t++]=null;var s=an[t];an[t++]=null;var n=an[t];an[t++]=null;var r=an[t];if(an[t++]=null,s!==null&&n!==null){var a=s.pending;a===null?n.next=n:(n.next=a.next,a.next=n),s.pending=n}r!==0&&VT(e,n,r)}}function kb(i,t,e,s){an[Pu++]=i,an[Pu++]=t,an[Pu++]=e,an[Pu++]=s,tS|=s,i.lanes|=s,i=i.alternate,i!==null&&(i.lanes|=s)}function eS(i,t,e,s){return kb(i,t,e,s),m0(i)}function su(i,t){return kb(i,null,null,t),m0(i)}function VT(i,t,e){i.lanes|=e;var s=i.alternate;s!==null&&(s.lanes|=e);for(var n=!1,r=i.return;r!==null;)r.childLanes|=e,s=r.alternate,s!==null&&(s.childLanes|=e),r.tag===22&&(i=r.stateNode,i===null||i._visibility&1||(n=!0)),i=r,r=r.return;return i.tag===3?(r=i.stateNode,n&&t!==null&&(n=31-Ii(e),i=r.hiddenUpdates,s=i[n],s===null?i[n]=[t]:s.push(t),t.lane=e|536870912),r):null}function m0(i){if(50<Kf)throw Kf=0,Bw=null,Error(M(185));for(var t=i.return;t!==null;)i=t,t=i.return;return i.tag===3?i.stateNode:null}var Bu={};function ZM(i,t,e,s){this.tag=i,this.key=e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mi(i,t,e,s){return new ZM(i,t,e,s)}function sS(i){return i=i.prototype,!(!i||!i.isReactComponent)}function wa(i,t){var e=i.alternate;return e===null?(e=Mi(i.tag,t,i.key,i.mode),e.elementType=i.elementType,e.type=i.type,e.stateNode=i.stateNode,e.alternate=i,i.alternate=e):(e.pendingProps=t,e.type=i.type,e.flags=0,e.subtreeFlags=0,e.deletions=null),e.flags=i.flags&65011712,e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,t=i.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},e.sibling=i.sibling,e.index=i.index,e.ref=i.ref,e.refCleanup=i.refCleanup,e}function XT(i,t){i.flags&=65011714;var e=i.alternate;return e===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,i.type=e.type,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),i}function yy(i,t,e,s,n,r){var a=0;if(s=i,typeof i=="function")sS(i)&&(a=1);else if(typeof i=="string")a=nj(i,e,yr.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case iw:return i=Mi(31,e,t,n),i.elementType=iw,i.lanes=r,i;case Ou:return Fc(e.children,n,r,t);case dT:a=8,n|=24;break;case tw:return i=Mi(12,e,t,n|2),i.elementType=tw,i.lanes=r,i;case ew:return i=Mi(13,e,t,n),i.elementType=ew,i.lanes=r,i;case sw:return i=Mi(19,e,t,n),i.elementType=sw,i.lanes=r,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ya:a=10;break t;case fT:a=9;break t;case HA:a=11;break t;case $A:a=14;break t;case Ba:a=16,s=null;break t}a=29,e=Error(M(130,i===null?"null":typeof i,"")),s=null}return t=Mi(a,e,t,n),t.elementType=i,t.type=s,t.lanes=r,t}function Fc(i,t,e,s){return i=Mi(7,i,s,t),i.lanes=e,i}function uv(i,t,e){return i=Mi(6,i,null,t),i.lanes=e,i}function YT(i){var t=Mi(18,null,null,0);return t.stateNode=i,t}function hv(i,t,e){return t=Mi(4,i.children!==null?i.children:[],i.key,t),t.lanes=e,t.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},t}var Ix=new WeakMap;function hn(i,t){if(typeof i=="object"&&i!==null){var e=Ix.get(i);return e!==void 0?e:(t={value:i,source:t,stack:bx(t)},Ix.set(i,t),t)}return{value:i,source:t,stack:bx(t)}}var Iu=[],Uu=0,p0=null,ng=0,ln=[],cn=0,Qo=null,gr=1,mr="";function jr(i,t){Iu[Uu++]=ng,Iu[Uu++]=p0,p0=i,ng=t}function KT(i,t,e){ln[cn++]=gr,ln[cn++]=mr,ln[cn++]=Qo,Qo=i;var s=gr;i=mr;var n=32-Ii(s)-1;s&=~(1<<n),e+=1;var r=32-Ii(t)+n;if(30<r){var a=n-n%5;r=(s&(1<<a)-1).toString(32),s>>=a,n-=a,gr=1<<32-Ii(t)+n|e<<n|s,mr=r+i}else gr=1<<r|e<<n|s,mr=i}function iS(i){i.return!==null&&(jr(i,1),KT(i,1,0))}function nS(i){for(;i===p0;)p0=Iu[--Uu],Iu[Uu]=null,ng=Iu[--Uu],Iu[Uu]=null;for(;i===Qo;)Qo=ln[--cn],ln[cn]=null,mr=ln[--cn],ln[cn]=null,gr=ln[--cn],ln[cn]=null}function WT(i,t){ln[cn++]=gr,ln[cn++]=mr,ln[cn++]=Qo,gr=t.id,mr=t.overflow,Qo=i}var ys=null,re=null,xt=!1,$o=null,dn=!1,yw=Error(M(519));function Jo(i){var t=Error(M(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw rg(hn(t,i)),yw}function Ux(i){var t=i.stateNode,e=i.type,s=i.memoizedProps;switch(t[ps]=i,t[ai]=s,e){case"dialog":pt("cancel",t),pt("close",t);break;case"iframe":case"object":case"embed":pt("load",t);break;case"video":case"audio":for(e=0;e<cg.length;e++)pt(cg[e],t);break;case"source":pt("error",t);break;case"img":case"image":case"link":pt("error",t),pt("load",t);break;case"details":pt("toggle",t);break;case"input":pt("invalid",t),TT(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0);break;case"select":pt("invalid",t);break;case"textarea":pt("invalid",t),RT(t,s.value,s.defaultValue,s.children)}e=s.children,typeof e!="string"&&typeof e!="number"&&typeof e!="bigint"||t.textContent===""+e||s.suppressHydrationWarning===!0||M2(t.textContent,e)?(s.popover!=null&&(pt("beforetoggle",t),pt("toggle",t)),s.onScroll!=null&&pt("scroll",t),s.onScrollEnd!=null&&pt("scrollend",t),s.onClick!=null&&(t.onclick=ba),t=!0):t=!1,t||Jo(i,!0)}function zx(i){for(ys=i.return;ys;)switch(ys.tag){case 5:case 31:case 13:dn=!1;return;case 27:case 3:dn=!0;return;default:ys=ys.return}}function lu(i){if(i!==ys)return!1;if(!xt)return zx(i),xt=!0,!1;var t=i.tag,e;if((e=t!==3&&t!==27)&&((e=t===5)&&(e=i.type,e=!(e!=="form"&&e!=="button")||Hw(i.type,i.memoizedProps)),e=!e),e&&re&&Jo(i),zx(i),t===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(M(317));re=T1(i)}else if(t===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(M(317));re=T1(i)}else t===27?(t=re,rl(i.type)?(i=Vw,Vw=null,re=i):re=t):re=ys?mn(i.stateNode.nextSibling):null;return!0}function Gc(){re=ys=null,xt=!1}function dv(){var i=$o;return i!==null&&(ii===null?ii=i:ii.push.apply(ii,i),$o=null),i}function rg(i){$o===null?$o=[i]:$o.push(i)}var bw=_r(null),iu=null,va=null;function Ua(i,t,e){se(bw,t._currentValue),t._currentValue=e}function _a(i){i._currentValue=bw.current,as(bw)}function vw(i,t,e){for(;i!==null;){var s=i.alternate;if((i.childLanes&t)!==t?(i.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),i===e)break;i=i.return}}function ww(i,t,e,s){var n=i.child;for(n!==null&&(n.return=i);n!==null;){var r=n.dependencies;if(r!==null){var a=n.child;r=r.firstContext;t:for(;r!==null;){var l=r;r=n;for(var c=0;c<t.length;c++)if(l.context===t[c]){r.lanes|=e,l=r.alternate,l!==null&&(l.lanes|=e),vw(r.return,e,i),s||(a=null);break t}r=l.next}}else if(n.tag===18){if(a=n.return,a===null)throw Error(M(341));a.lanes|=e,r=a.alternate,r!==null&&(r.lanes|=e),vw(a,e,i),a=null}else a=n.child;if(a!==null)a.return=n;else for(a=n;a!==null;){if(a===i){a=null;break}if(n=a.sibling,n!==null){n.return=a.return,a=n;break}a=a.return}n=a}}function Hd(i,t,e,s){i=null;for(var n=t,r=!1;n!==null;){if(!r){if(n.flags&524288)r=!0;else if(n.flags&262144)break}if(n.tag===10){var a=n.alternate;if(a===null)throw Error(M(387));if(a=a.memoizedProps,a!==null){var l=n.type;Fi(n.pendingProps.value,a.value)||(i!==null?i.push(l):i=[l])}}else if(n===c0.current){if(a=n.alternate,a===null)throw Error(M(387));a.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(i!==null?i.push(hg):i=[hg])}n=n.return}i!==null&&ww(t,i,e,s),t.flags|=262144}function y0(i){for(i=i.firstContext;i!==null;){if(!Fi(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Vc(i){iu=i,va=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function vs(i){return QT(iu,i)}function zp(i,t){return iu===null&&Vc(i),QT(i,t)}function QT(i,t){var e=t._currentValue;if(t={context:t,memoizedValue:e,next:null},va===null){if(i===null)throw Error(M(308));va=t,i.dependencies={lanes:0,firstContext:t},i.flags|=524288}else va=va.next=t;return e}var tD=typeof AbortController<"u"?AbortController:function(){var i=[],t=this.signal={aborted:!1,addEventListener:function(e,s){i.push(s)}};this.abort=function(){t.aborted=!0,i.forEach(function(e){return e()})}},eD=Ke.unstable_scheduleCallback,sD=Ke.unstable_NormalPriority,Be={$$typeof:ya,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function rS(){return{controller:new tD,data:new Map,refCount:0}}function yp(i){i.refCount--,i.refCount===0&&eD(sD,function(){i.controller.abort()})}var Ff=null,_w=0,kd=0,Wu=null;function iD(i,t){if(Ff===null){var e=Ff=[];_w=0,kd=kS(),Wu={status:"pending",value:void 0,then:function(s){e.push(s)}}}return _w++,t.then(Fx,Fx),t}function Fx(){if(--_w===0&&Ff!==null){Wu!==null&&(Wu.status="fulfilled");var i=Ff;Ff=null,kd=0,Wu=null;for(var t=0;t<i.length;t++)(0,i[t])()}}function nD(i,t){var e=[],s={status:"pending",value:null,reason:null,then:function(n){e.push(n)}};return i.then(function(){s.status="fulfilled",s.value=t;for(var n=0;n<e.length;n++)(0,e[n])(t)},function(n){for(s.status="rejected",s.reason=n,n=0;n<e.length;n++)(0,e[n])(void 0)}),s}var Hx=st.S;st.S=function(i,t){h2=Pi(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&iD(i,t),Hx!==null&&Hx(i,t)};var Hc=_r(null);function aS(){var i=Hc.current;return i!==null?i:Qt.pooledCache}function by(i,t){t===null?se(Hc,Hc.current):se(Hc,t.pool)}function JT(){var i=aS();return i===null?null:{parent:Be._currentValue,pool:i}}var $d=Error(M(460)),oS=Error(M(474)),Nb=Error(M(542)),b0={then:function(){}};function $x(i){return i=i.status,i==="fulfilled"||i==="rejected"}function ZT(i,t,e){switch(e=i[e],e===void 0?i.push(t):e!==t&&(t.then(ba,ba),t=e),t.status){case"fulfilled":return t.value;case"rejected":throw i=t.reason,Gx(i),i;default:if(typeof t.status=="string")t.then(ba,ba);else{if(i=Qt,i!==null&&100<i.shellSuspendCounter)throw Error(M(482));i=t,i.status="pending",i.then(function(s){if(t.status==="pending"){var n=t;n.status="fulfilled",n.value=s}},function(s){if(t.status==="pending"){var n=t;n.status="rejected",n.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw i=t.reason,Gx(i),i}throw $c=t,$d}}function fl(i){try{var t=i._init;return t(i._payload)}catch(e){throw e!==null&&typeof e=="object"&&typeof e.then=="function"?($c=e,$d):e}}var $c=null;function qx(){if($c===null)throw Error(M(459));var i=$c;return $c=null,i}function Gx(i){if(i===$d||i===Nb)throw Error(M(483))}var Qu=null,ag=0;function Fp(i){var t=ag;return ag+=1,Qu===null&&(Qu=[]),ZT(Qu,i,t)}function tf(i,t){t=t.props.ref,i.ref=t!==void 0?t:null}function Hp(i,t){throw t.$$typeof===qN?Error(M(525)):(i=Object.prototype.toString.call(t),Error(M(31,i==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":i)))}function tC(i){function t(p,w){if(i){var y=p.deletions;y===null?(p.deletions=[w],p.flags|=16):y.push(w)}}function e(p,w){if(!i)return null;for(;w!==null;)t(p,w),w=w.sibling;return null}function s(p){for(var w=new Map;p!==null;)p.key!==null?w.set(p.key,p):w.set(p.index,p),p=p.sibling;return w}function n(p,w){return p=wa(p,w),p.index=0,p.sibling=null,p}function r(p,w,y){return p.index=y,i?(y=p.alternate,y!==null?(y=y.index,y<w?(p.flags|=67108866,w):y):(p.flags|=67108866,w)):(p.flags|=1048576,w)}function a(p){return i&&p.alternate===null&&(p.flags|=67108866),p}function l(p,w,y,E){return w===null||w.tag!==6?(w=uv(y,p.mode,E),w.return=p,w):(w=n(w,y),w.return=p,w)}function c(p,w,y,E){var T=y.type;return T===Ou?h(p,w,y.props.children,E,y.key):w!==null&&(w.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ba&&fl(T)===w.type)?(w=n(w,y.props),tf(w,y),w.return=p,w):(w=yy(y.type,y.key,y.props,null,p.mode,E),tf(w,y),w.return=p,w)}function u(p,w,y,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=hv(y,p.mode,E),w.return=p,w):(w=n(w,y.children||[]),w.return=p,w)}function h(p,w,y,E,T){return w===null||w.tag!==7?(w=Fc(y,p.mode,E,T),w.return=p,w):(w=n(w,y),w.return=p,w)}function d(p,w,y){if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return w=uv(""+w,p.mode,y),w.return=p,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case jp:return y=yy(w.type,w.key,w.props,null,p.mode,y),tf(y,w),y.return=p,y;case uf:return w=hv(w,p.mode,y),w.return=p,w;case Ba:return w=fl(w),d(p,w,y)}if(hf(w)||Qd(w))return w=Fc(w,p.mode,y,null),w.return=p,w;if(typeof w.then=="function")return d(p,Fp(w),y);if(w.$$typeof===ya)return d(p,zp(p,w),y);Hp(p,w)}return null}function f(p,w,y,E){var T=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return T!==null?null:l(p,w,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case jp:return y.key===T?c(p,w,y,E):null;case uf:return y.key===T?u(p,w,y,E):null;case Ba:return y=fl(y),f(p,w,y,E)}if(hf(y)||Qd(y))return T!==null?null:h(p,w,y,E,null);if(typeof y.then=="function")return f(p,w,Fp(y),E);if(y.$$typeof===ya)return f(p,w,zp(p,y),E);Hp(p,y)}return null}function g(p,w,y,E,T){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return p=p.get(y)||null,l(w,p,""+E,T);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case jp:return p=p.get(E.key===null?y:E.key)||null,c(w,p,E,T);case uf:return p=p.get(E.key===null?y:E.key)||null,u(w,p,E,T);case Ba:return E=fl(E),g(p,w,y,E,T)}if(hf(E)||Qd(E))return p=p.get(y)||null,h(w,p,E,T,null);if(typeof E.then=="function")return g(p,w,y,Fp(E),T);if(E.$$typeof===ya)return g(p,w,y,zp(w,E),T);Hp(w,E)}return null}function b(p,w,y,E){for(var T=null,C=null,R=w,O=w=0,k=null;R!==null&&O<y.length;O++){R.index>O?(k=R,R=null):k=R.sibling;var D=f(p,R,y[O],E);if(D===null){R===null&&(R=k);break}i&&R&&D.alternate===null&&t(p,R),w=r(D,w,O),C===null?T=D:C.sibling=D,C=D,R=k}if(O===y.length)return e(p,R),xt&&jr(p,O),T;if(R===null){for(;O<y.length;O++)R=d(p,y[O],E),R!==null&&(w=r(R,w,O),C===null?T=R:C.sibling=R,C=R);return xt&&jr(p,O),T}for(R=s(R);O<y.length;O++)k=g(R,p,O,y[O],E),k!==null&&(i&&k.alternate!==null&&R.delete(k.key===null?O:k.key),w=r(k,w,O),C===null?T=k:C.sibling=k,C=k);return i&&R.forEach(function(P){return t(p,P)}),xt&&jr(p,O),T}function v(p,w,y,E){if(y==null)throw Error(M(151));for(var T=null,C=null,R=w,O=w=0,k=null,D=y.next();R!==null&&!D.done;O++,D=y.next()){R.index>O?(k=R,R=null):k=R.sibling;var P=f(p,R,D.value,E);if(P===null){R===null&&(R=k);break}i&&R&&P.alternate===null&&t(p,R),w=r(P,w,O),C===null?T=P:C.sibling=P,C=P,R=k}if(D.done)return e(p,R),xt&&jr(p,O),T;if(R===null){for(;!D.done;O++,D=y.next())D=d(p,D.value,E),D!==null&&(w=r(D,w,O),C===null?T=D:C.sibling=D,C=D);return xt&&jr(p,O),T}for(R=s(R);!D.done;O++,D=y.next())D=g(R,p,O,D.value,E),D!==null&&(i&&D.alternate!==null&&R.delete(D.key===null?O:D.key),w=r(D,w,O),C===null?T=D:C.sibling=D,C=D);return i&&R.forEach(function(I){return t(p,I)}),xt&&jr(p,O),T}function S(p,w,y,E){if(typeof y=="object"&&y!==null&&y.type===Ou&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case jp:t:{for(var T=y.key;w!==null;){if(w.key===T){if(T=y.type,T===Ou){if(w.tag===7){e(p,w.sibling),E=n(w,y.props.children),E.return=p,p=E;break t}}else if(w.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ba&&fl(T)===w.type){e(p,w.sibling),E=n(w,y.props),tf(E,y),E.return=p,p=E;break t}e(p,w);break}else t(p,w);w=w.sibling}y.type===Ou?(E=Fc(y.props.children,p.mode,E,y.key),E.return=p,p=E):(E=yy(y.type,y.key,y.props,null,p.mode,E),tf(E,y),E.return=p,p=E)}return a(p);case uf:t:{for(T=y.key;w!==null;){if(w.key===T)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){e(p,w.sibling),E=n(w,y.children||[]),E.return=p,p=E;break t}else{e(p,w);break}else t(p,w);w=w.sibling}E=hv(y,p.mode,E),E.return=p,p=E}return a(p);case Ba:return y=fl(y),S(p,w,y,E)}if(hf(y))return b(p,w,y,E);if(Qd(y)){if(T=Qd(y),typeof T!="function")throw Error(M(150));return y=T.call(y),v(p,w,y,E)}if(typeof y.then=="function")return S(p,w,Fp(y),E);if(y.$$typeof===ya)return S(p,w,zp(p,y),E);Hp(p,y)}return typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint"?(y=""+y,w!==null&&w.tag===6?(e(p,w.sibling),E=n(w,y),E.return=p,p=E):(e(p,w),E=uv(y,p.mode,E),E.return=p,p=E),a(p)):e(p,w)}return function(p,w,y,E){try{ag=0;var T=S(p,w,y,E);return Qu=null,T}catch(R){if(R===$d||R===Nb)throw R;var C=Mi(29,R,null,p.mode);return C.lanes=E,C.return=p,C}finally{}}}var Xc=tC(!0),eC=tC(!1),Ia=!1;function lS(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Aw(i,t){i=i.updateQueue,t.updateQueue===i&&(t.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function qo(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Go(i,t,e){var s=i.updateQueue;if(s===null)return null;if(s=s.shared,Ot&2){var n=s.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t,t=m0(i),VT(i,null,e),t}return kb(i,s,t,e),m0(i)}function Hf(i,t,e){if(t=t.updateQueue,t!==null&&(t=t.shared,(e&4194048)!==0)){var s=t.lanes;s&=i.pendingLanes,e|=s,t.lanes=e,vT(i,e)}}function fv(i,t){var e=i.updateQueue,s=i.alternate;if(s!==null&&(s=s.updateQueue,e===s)){var n=null,r=null;if(e=e.firstBaseUpdate,e!==null){do{var a={lane:e.lane,tag:e.tag,payload:e.payload,callback:null,next:null};r===null?n=r=a:r=r.next=a,e=e.next}while(e!==null);r===null?n=r=t:r=r.next=t}else n=r=t;e={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:s.shared,callbacks:s.callbacks},i.updateQueue=e;return}i=e.lastBaseUpdate,i===null?e.firstBaseUpdate=t:i.next=t,e.lastBaseUpdate=t}var Sw=!1;function $f(){if(Sw){var i=Wu;if(i!==null)throw i}}function qf(i,t,e,s){Sw=!1;var n=i.updateQueue;Ia=!1;var r=n.firstBaseUpdate,a=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var h=i.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==a&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(r!==null){var d=n.baseState;a=0,h=u=c=null,l=r;do{var f=l.lane&-536870913,g=f!==l.lane;if(g?(_t&f)===f:(s&f)===f){f!==0&&f===kd&&(Sw=!0),h!==null&&(h=h.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});t:{var b=i,v=l;f=t;var S=e;switch(v.tag){case 1:if(b=v.payload,typeof b=="function"){d=b.call(S,d,f);break t}d=b;break t;case 3:b.flags=b.flags&-65537|128;case 0:if(b=v.payload,f=typeof b=="function"?b.call(S,d,f):b,f==null)break t;d=oe({},d,f);break t;case 2:Ia=!0}}f=l.callback,f!==null&&(i.flags|=64,g&&(i.flags|=8192),g=n.callbacks,g===null?n.callbacks=[f]:g.push(f))}else g={lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=g,c=d):h=h.next=g,a|=f;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;g=l,l=g.next,g.next=null,n.lastBaseUpdate=g,n.shared.pending=null}}while(!0);h===null&&(c=d),n.baseState=c,n.firstBaseUpdate=u,n.lastBaseUpdate=h,r===null&&(n.shared.lanes=0),tl|=a,i.lanes=a,i.memoizedState=d}}function sC(i,t){if(typeof i!="function")throw Error(M(191,i));i.call(t)}function iC(i,t){var e=i.callbacks;if(e!==null)for(i.callbacks=null,i=0;i<e.length;i++)sC(e[i],t)}var Nd=_r(null),v0=_r(0);function Vx(i,t){i=ka,se(v0,i),se(Nd,t),ka=i|t.baseLanes}function xw(){se(v0,ka),se(Nd,Nd.current)}function cS(){ka=v0.current,as(Nd),as(v0)}var Hi=_r(null),gn=null;function za(i){var t=i.alternate;se(Re,Re.current&1),se(Hi,i),gn===null&&(t===null||Nd.current!==null||t.memoizedState!==null)&&(gn=i)}function Ew(i){se(Re,Re.current),se(Hi,i),gn===null&&(gn=i)}function nC(i){i.tag===22?(se(Re,Re.current),se(Hi,i),gn===null&&(gn=i)):Fa()}function Fa(){se(Re,Re.current),se(Hi,Hi.current)}function ki(i){as(Hi),gn===i&&(gn=null),as(Re)}var Re=_r(0);function w0(i){for(var t=i;t!==null;){if(t.tag===13){var e=t.memoizedState;if(e!==null&&(e=e.dehydrated,e===null||qw(e)||Gw(e)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break;for(;t.sibling===null;){if(t.return===null||t.return===i)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ca=0,ht=null,Gt=null,Le=null,_0=!1,Ju=!1,Yc=!1,A0=0,og=0,Zu=null,rD=0;function be(){throw Error(M(321))}function uS(i,t){if(t===null)return!1;for(var e=0;e<t.length&&e<i.length;e++)if(!Fi(i[e],t[e]))return!1;return!0}function hS(i,t,e,s,n,r){return Ca=r,ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,st.H=i===null||i.memoizedState===null?LC:AS,Yc=!1,r=e(s,n),Yc=!1,Ju&&(r=aC(t,e,s,n)),rC(i),r}function rC(i){st.H=lg;var t=Gt!==null&&Gt.next!==null;if(Ca=0,Le=Gt=ht=null,_0=!1,og=0,Zu=null,t)throw Error(M(300));i===null||Ie||(i=i.dependencies,i!==null&&y0(i)&&(Ie=!0))}function aC(i,t,e,s){ht=i;var n=0;do{if(Ju&&(Zu=null),og=0,Ju=!1,25<=n)throw Error(M(301));if(n+=1,Le=Gt=null,i.updateQueue!=null){var r=i.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}st.H=PC,r=t(e,s)}while(Ju);return r}function aD(){var i=st.H,t=i.useState()[0];return t=typeof t.then=="function"?bp(t):t,i=i.useState()[0],(Gt!==null?Gt.memoizedState:null)!==i&&(ht.flags|=1024),t}function dS(){var i=A0!==0;return A0=0,i}function fS(i,t,e){t.updateQueue=i.updateQueue,t.flags&=-2053,i.lanes&=~e}function gS(i){if(_0){for(i=i.memoizedState;i!==null;){var t=i.queue;t!==null&&(t.pending=null),i=i.next}_0=!1}Ca=0,Le=Gt=ht=null,Ju=!1,og=A0=0,Zu=null}function Ps(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Le===null?ht.memoizedState=Le=i:Le=Le.next=i,Le}function Oe(){if(Gt===null){var i=ht.alternate;i=i!==null?i.memoizedState:null}else i=Gt.next;var t=Le===null?ht.memoizedState:Le.next;if(t!==null)Le=t,Gt=i;else{if(i===null)throw ht.alternate===null?Error(M(467)):Error(M(310));Gt=i,i={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Le===null?ht.memoizedState=Le=i:Le=Le.next=i}return Le}function Mb(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bp(i){var t=og;return og+=1,Zu===null&&(Zu=[]),i=ZT(Zu,i,t),t=ht,(Le===null?t.memoizedState:Le.next)===null&&(t=t.alternate,st.H=t===null||t.memoizedState===null?LC:AS),i}function Db(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return bp(i);if(i.$$typeof===ya)return vs(i)}throw Error(M(438,String(i)))}function mS(i){var t=null,e=ht.updateQueue;if(e!==null&&(t=e.memoCache),t==null){var s=ht.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(n){return n.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),e===null&&(e=Mb(),ht.updateQueue=e),e.memoCache=t,e=t.data[t.index],e===void 0)for(e=t.data[t.index]=Array(i),s=0;s<i;s++)e[s]=GN;return t.index++,e}function Ra(i,t){return typeof t=="function"?t(i):t}function vy(i){var t=Oe();return pS(t,Gt,i)}function pS(i,t,e){var s=i.queue;if(s===null)throw Error(M(311));s.lastRenderedReducer=e;var n=i.baseQueue,r=s.pending;if(r!==null){if(n!==null){var a=n.next;n.next=r.next,r.next=a}t.baseQueue=n=r,s.pending=null}if(r=i.baseState,n===null)i.memoizedState=r;else{t=n.next;var l=a=null,c=null,u=t,h=!1;do{var d=u.lane&-536870913;if(d!==u.lane?(_t&d)===d:(Ca&d)===d){var f=u.revertLane;if(f===0)c!==null&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===kd&&(h=!0);else if((Ca&f)===f){u=u.next,f===kd&&(h=!0);continue}else d={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(l=c=d,a=r):c=c.next=d,ht.lanes|=f,tl|=f;d=u.action,Yc&&e(r,d),r=u.hasEagerState?u.eagerState:e(r,d)}else f={lane:d,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(l=c=f,a=r):c=c.next=f,ht.lanes|=d,tl|=d;u=u.next}while(u!==null&&u!==t);if(c===null?a=r:c.next=l,!Fi(r,i.memoizedState)&&(Ie=!0,h&&(e=Wu,e!==null)))throw e;i.memoizedState=r,i.baseState=a,i.baseQueue=c,s.lastRenderedState=r}return n===null&&(s.lanes=0),[i.memoizedState,s.dispatch]}function gv(i){var t=Oe(),e=t.queue;if(e===null)throw Error(M(311));e.lastRenderedReducer=i;var s=e.dispatch,n=e.pending,r=t.memoizedState;if(n!==null){e.pending=null;var a=n=n.next;do r=i(r,a.action),a=a.next;while(a!==n);Fi(r,t.memoizedState)||(Ie=!0),t.memoizedState=r,t.baseQueue===null&&(t.baseState=r),e.lastRenderedState=r}return[r,s]}function oC(i,t,e){var s=ht,n=Oe(),r=xt;if(r){if(e===void 0)throw Error(M(407));e=e()}else e=t();var a=!Fi((Gt||n).memoizedState,e);if(a&&(n.memoizedState=e,Ie=!0),n=n.queue,yS(uC.bind(null,s,n,i),[i]),n.getSnapshot!==t||a||Le!==null&&Le.memoizedState.tag&1){if(s.flags|=2048,Md(9,{destroy:void 0},cC.bind(null,s,n,e,t),null),Qt===null)throw Error(M(349));r||Ca&127||lC(s,t,e)}return e}function lC(i,t,e){i.flags|=16384,i={getSnapshot:t,value:e},t=ht.updateQueue,t===null?(t=Mb(),ht.updateQueue=t,t.stores=[i]):(e=t.stores,e===null?t.stores=[i]:e.push(i))}function cC(i,t,e,s){t.value=e,t.getSnapshot=s,hC(t)&&dC(i)}function uC(i,t,e){return e(function(){hC(t)&&dC(i)})}function hC(i){var t=i.getSnapshot;i=i.value;try{var e=t();return!Fi(i,e)}catch{return!0}}function dC(i){var t=su(i,2);t!==null&&ri(t,i,2)}function Tw(i){var t=Ps();if(typeof i=="function"){var e=i;if(i=e(),Yc){Bo(!0);try{e()}finally{Bo(!1)}}}return t.memoizedState=t.baseState=i,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ra,lastRenderedState:i},t}function fC(i,t,e,s){return i.baseState=e,pS(i,Gt,typeof s=="function"?s:Ra)}function oD(i,t,e,s,n){if(Lb(i))throw Error(M(485));if(i=t.action,i!==null){var r={payload:n,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){r.listeners.push(a)}};st.T!==null?e(!0):r.isTransition=!1,s(r),e=t.pending,e===null?(r.next=t.pending=r,gC(t,r)):(r.next=e.next,t.pending=e.next=r)}}function gC(i,t){var e=t.action,s=t.payload,n=i.state;if(t.isTransition){var r=st.T,a={};st.T=a;try{var l=e(n,s),c=st.S;c!==null&&c(a,l),Xx(i,t,l)}catch(u){Cw(i,t,u)}finally{r!==null&&a.types!==null&&(r.types=a.types),st.T=r}}else try{r=e(n,s),Xx(i,t,r)}catch(u){Cw(i,t,u)}}function Xx(i,t,e){e!==null&&typeof e=="object"&&typeof e.then=="function"?e.then(function(s){Yx(i,t,s)},function(s){return Cw(i,t,s)}):Yx(i,t,e)}function Yx(i,t,e){t.status="fulfilled",t.value=e,mC(t),i.state=e,t=i.pending,t!==null&&(e=t.next,e===t?i.pending=null:(e=e.next,t.next=e,gC(i,e)))}function Cw(i,t,e){var s=i.pending;if(i.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=e,mC(t),t=t.next;while(t!==s)}i.action=null}function mC(i){i=i.listeners;for(var t=0;t<i.length;t++)(0,i[t])()}function pC(i,t){return t}function Kx(i,t){if(xt){var e=Qt.formState;if(e!==null){t:{var s=ht;if(xt){if(re){e:{for(var n=re,r=dn;n.nodeType!==8;){if(!r){n=null;break e}if(n=mn(n.nextSibling),n===null){n=null;break e}}r=n.data,n=r==="F!"||r==="F"?n:null}if(n){re=mn(n.nextSibling),s=n.data==="F!";break t}}Jo(s)}s=!1}s&&(t=e[0])}}return e=Ps(),e.memoizedState=e.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pC,lastRenderedState:t},e.queue=s,e=MC.bind(null,ht,s),s.dispatch=e,s=Tw(!1),r=_S.bind(null,ht,!1,s.queue),s=Ps(),n={state:t,dispatch:null,action:i,pending:null},s.queue=n,e=oD.bind(null,ht,n,r,e),n.dispatch=e,s.memoizedState=i,[t,e,!1]}function Wx(i){var t=Oe();return yC(t,Gt,i)}function yC(i,t,e){if(t=pS(i,t,pC)[0],i=vy(Ra)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=bp(t)}catch(a){throw a===$d?Nb:a}else s=t;t=Oe();var n=t.queue,r=n.dispatch;return e!==t.memoizedState&&(ht.flags|=2048,Md(9,{destroy:void 0},lD.bind(null,n,e),null)),[s,r,i]}function lD(i,t){i.action=t}function Qx(i){var t=Oe(),e=Gt;if(e!==null)return yC(t,e,i);Oe(),t=t.memoizedState,e=Oe();var s=e.queue.dispatch;return e.memoizedState=i,[t,s,!1]}function Md(i,t,e,s){return i={tag:i,create:e,deps:s,inst:t,next:null},t=ht.updateQueue,t===null&&(t=Mb(),ht.updateQueue=t),e=t.lastEffect,e===null?t.lastEffect=i.next=i:(s=e.next,e.next=i,i.next=s,t.lastEffect=i),i}function bC(){return Oe().memoizedState}function wy(i,t,e,s){var n=Ps();ht.flags|=i,n.memoizedState=Md(1|t,{destroy:void 0},e,s===void 0?null:s)}function jb(i,t,e,s){var n=Oe();s=s===void 0?null:s;var r=n.memoizedState.inst;Gt!==null&&s!==null&&uS(s,Gt.memoizedState.deps)?n.memoizedState=Md(t,r,e,s):(ht.flags|=i,n.memoizedState=Md(1|t,r,e,s))}function Jx(i,t){wy(8390656,8,i,t)}function yS(i,t){jb(2048,8,i,t)}function cD(i){ht.flags|=4;var t=ht.updateQueue;if(t===null)t=Mb(),ht.updateQueue=t,t.events=[i];else{var e=t.events;e===null?t.events=[i]:e.push(i)}}function vC(i){var t=Oe().memoizedState;return cD({ref:t,nextImpl:i}),function(){if(Ot&2)throw Error(M(440));return t.impl.apply(void 0,arguments)}}function wC(i,t){return jb(4,2,i,t)}function _C(i,t){return jb(4,4,i,t)}function AC(i,t){if(typeof t=="function"){i=i();var e=t(i);return function(){typeof e=="function"?e():t(null)}}if(t!=null)return i=i(),t.current=i,function(){t.current=null}}function SC(i,t,e){e=e!=null?e.concat([i]):null,jb(4,4,AC.bind(null,t,i),e)}function bS(){}function xC(i,t){var e=Oe();t=t===void 0?null:t;var s=e.memoizedState;return t!==null&&uS(t,s[1])?s[0]:(e.memoizedState=[i,t],i)}function EC(i,t){var e=Oe();t=t===void 0?null:t;var s=e.memoizedState;if(t!==null&&uS(t,s[1]))return s[0];if(s=i(),Yc){Bo(!0);try{i()}finally{Bo(!1)}}return e.memoizedState=[s,t],s}function vS(i,t,e){return e===void 0||Ca&1073741824&&!(_t&261930)?i.memoizedState=t:(i.memoizedState=e,i=f2(),ht.lanes|=i,tl|=i,e)}function TC(i,t,e,s){return Fi(e,t)?e:Nd.current!==null?(i=vS(i,e,s),Fi(i,t)||(Ie=!0),i):!(Ca&42)||Ca&1073741824&&!(_t&261930)?(Ie=!0,i.memoizedState=e):(i=f2(),ht.lanes|=i,tl|=i,t)}function CC(i,t,e,s,n){var r=kt.p;kt.p=r!==0&&8>r?r:8;var a=st.T,l={};st.T=l,_S(i,!1,t,e);try{var c=n(),u=st.S;if(u!==null&&u(l,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=nD(c,s);Gf(i,t,h,Ui(i))}else Gf(i,t,s,Ui(i))}catch(d){Gf(i,t,{then:function(){},status:"rejected",reason:d},Ui())}finally{kt.p=r,a!==null&&l.types!==null&&(a.types=l.types),st.T=a}}function uD(){}function Rw(i,t,e,s){if(i.tag!==5)throw Error(M(476));var n=RC(i).queue;CC(i,n,t,zc,e===null?uD:function(){return OC(i),e(s)})}function RC(i){var t=i.memoizedState;if(t!==null)return t;t={memoizedState:zc,baseState:zc,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ra,lastRenderedState:zc},next:null};var e={};return t.next={memoizedState:e,baseState:e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ra,lastRenderedState:e},next:null},i.memoizedState=t,i=i.alternate,i!==null&&(i.memoizedState=t),t}function OC(i){var t=RC(i);t.next===null&&(t=i.alternate.memoizedState),Gf(i,t.next.queue,{},Ui())}function wS(){return vs(hg)}function kC(){return Oe().memoizedState}function NC(){return Oe().memoizedState}function hD(i){for(var t=i.return;t!==null;){switch(t.tag){case 24:case 3:var e=Ui();i=qo(e);var s=Go(t,i,e);s!==null&&(ri(s,t,e),Hf(s,t,e)),t={cache:rS()},i.payload=t;return}t=t.return}}function dD(i,t,e){var s=Ui();e={lane:s,revertLane:0,gesture:null,action:e,hasEagerState:!1,eagerState:null,next:null},Lb(i)?DC(t,e):(e=eS(i,t,e,s),e!==null&&(ri(e,i,s),jC(e,t,s)))}function MC(i,t,e){var s=Ui();Gf(i,t,e,s)}function Gf(i,t,e,s){var n={lane:s,revertLane:0,gesture:null,action:e,hasEagerState:!1,eagerState:null,next:null};if(Lb(i))DC(t,n);else{var r=i.alternate;if(i.lanes===0&&(r===null||r.lanes===0)&&(r=t.lastRenderedReducer,r!==null))try{var a=t.lastRenderedState,l=r(a,e);if(n.hasEagerState=!0,n.eagerState=l,Fi(l,a))return kb(i,t,n,0),Qt===null&&Ob(),!1}catch{}finally{}if(e=eS(i,t,n,s),e!==null)return ri(e,i,s),jC(e,t,s),!0}return!1}function _S(i,t,e,s){if(s={lane:2,revertLane:kS(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},Lb(i)){if(t)throw Error(M(479))}else t=eS(i,e,s,2),t!==null&&ri(t,i,2)}function Lb(i){var t=i.alternate;return i===ht||t!==null&&t===ht}function DC(i,t){Ju=_0=!0;var e=i.pending;e===null?t.next=t:(t.next=e.next,e.next=t),i.pending=t}function jC(i,t,e){if(e&4194048){var s=t.lanes;s&=i.pendingLanes,e|=s,t.lanes=e,vT(i,e)}}var lg={readContext:vs,use:Db,useCallback:be,useContext:be,useEffect:be,useImperativeHandle:be,useLayoutEffect:be,useInsertionEffect:be,useMemo:be,useReducer:be,useRef:be,useState:be,useDebugValue:be,useDeferredValue:be,useTransition:be,useSyncExternalStore:be,useId:be,useHostTransitionStatus:be,useFormState:be,useActionState:be,useOptimistic:be,useMemoCache:be,useCacheRefresh:be};lg.useEffectEvent=be;var LC={readContext:vs,use:Db,useCallback:function(i,t){return Ps().memoizedState=[i,t===void 0?null:t],i},useContext:vs,useEffect:Jx,useImperativeHandle:function(i,t,e){e=e!=null?e.concat([i]):null,wy(4194308,4,AC.bind(null,t,i),e)},useLayoutEffect:function(i,t){return wy(4194308,4,i,t)},useInsertionEffect:function(i,t){wy(4,2,i,t)},useMemo:function(i,t){var e=Ps();t=t===void 0?null:t;var s=i();if(Yc){Bo(!0);try{i()}finally{Bo(!1)}}return e.memoizedState=[s,t],s},useReducer:function(i,t,e){var s=Ps();if(e!==void 0){var n=e(t);if(Yc){Bo(!0);try{e(t)}finally{Bo(!1)}}}else n=t;return s.memoizedState=s.baseState=n,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:n},s.queue=i,i=i.dispatch=dD.bind(null,ht,i),[s.memoizedState,i]},useRef:function(i){var t=Ps();return i={current:i},t.memoizedState=i},useState:function(i){i=Tw(i);var t=i.queue,e=MC.bind(null,ht,t);return t.dispatch=e,[i.memoizedState,e]},useDebugValue:bS,useDeferredValue:function(i,t){var e=Ps();return vS(e,i,t)},useTransition:function(){var i=Tw(!1);return i=CC.bind(null,ht,i.queue,!0,!1),Ps().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,t,e){var s=ht,n=Ps();if(xt){if(e===void 0)throw Error(M(407));e=e()}else{if(e=t(),Qt===null)throw Error(M(349));_t&127||lC(s,t,e)}n.memoizedState=e;var r={value:e,getSnapshot:t};return n.queue=r,Jx(uC.bind(null,s,r,i),[i]),s.flags|=2048,Md(9,{destroy:void 0},cC.bind(null,s,r,e,t),null),e},useId:function(){var i=Ps(),t=Qt.identifierPrefix;if(xt){var e=mr,s=gr;e=(s&~(1<<32-Ii(s)-1)).toString(32)+e,t="_"+t+"R_"+e,e=A0++,0<e&&(t+="H"+e.toString(32)),t+="_"}else e=rD++,t="_"+t+"r_"+e.toString(32)+"_";return i.memoizedState=t},useHostTransitionStatus:wS,useFormState:Kx,useActionState:Kx,useOptimistic:function(i){var t=Ps();t.memoizedState=t.baseState=i;var e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=e,t=_S.bind(null,ht,!0,e),e.dispatch=t,[i,t]},useMemoCache:mS,useCacheRefresh:function(){return Ps().memoizedState=hD.bind(null,ht)},useEffectEvent:function(i){var t=Ps(),e={impl:i};return t.memoizedState=e,function(){if(Ot&2)throw Error(M(440));return e.impl.apply(void 0,arguments)}}},AS={readContext:vs,use:Db,useCallback:xC,useContext:vs,useEffect:yS,useImperativeHandle:SC,useInsertionEffect:wC,useLayoutEffect:_C,useMemo:EC,useReducer:vy,useRef:bC,useState:function(){return vy(Ra)},useDebugValue:bS,useDeferredValue:function(i,t){var e=Oe();return TC(e,Gt.memoizedState,i,t)},useTransition:function(){var i=vy(Ra)[0],t=Oe().memoizedState;return[typeof i=="boolean"?i:bp(i),t]},useSyncExternalStore:oC,useId:kC,useHostTransitionStatus:wS,useFormState:Wx,useActionState:Wx,useOptimistic:function(i,t){var e=Oe();return fC(e,Gt,i,t)},useMemoCache:mS,useCacheRefresh:NC};AS.useEffectEvent=vC;var PC={readContext:vs,use:Db,useCallback:xC,useContext:vs,useEffect:yS,useImperativeHandle:SC,useInsertionEffect:wC,useLayoutEffect:_C,useMemo:EC,useReducer:gv,useRef:bC,useState:function(){return gv(Ra)},useDebugValue:bS,useDeferredValue:function(i,t){var e=Oe();return Gt===null?vS(e,i,t):TC(e,Gt.memoizedState,i,t)},useTransition:function(){var i=gv(Ra)[0],t=Oe().memoizedState;return[typeof i=="boolean"?i:bp(i),t]},useSyncExternalStore:oC,useId:kC,useHostTransitionStatus:wS,useFormState:Qx,useActionState:Qx,useOptimistic:function(i,t){var e=Oe();return Gt!==null?fC(e,Gt,i,t):(e.baseState=i,[i,e.queue.dispatch])},useMemoCache:mS,useCacheRefresh:NC};PC.useEffectEvent=vC;function mv(i,t,e,s){t=i.memoizedState,e=e(s,t),e=e==null?t:oe({},t,e),i.memoizedState=e,i.lanes===0&&(i.updateQueue.baseState=e)}var Ow={enqueueSetState:function(i,t,e){i=i._reactInternals;var s=Ui(),n=qo(s);n.payload=t,e!=null&&(n.callback=e),t=Go(i,n,s),t!==null&&(ri(t,i,s),Hf(t,i,s))},enqueueReplaceState:function(i,t,e){i=i._reactInternals;var s=Ui(),n=qo(s);n.tag=1,n.payload=t,e!=null&&(n.callback=e),t=Go(i,n,s),t!==null&&(ri(t,i,s),Hf(t,i,s))},enqueueForceUpdate:function(i,t){i=i._reactInternals;var e=Ui(),s=qo(e);s.tag=2,t!=null&&(s.callback=t),t=Go(i,s,e),t!==null&&(ri(t,i,e),Hf(t,i,e))}};function Zx(i,t,e,s,n,r,a){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(s,r,a):t.prototype&&t.prototype.isPureReactComponent?!ig(e,s)||!ig(n,r):!0}function t1(i,t,e,s){i=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(e,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(e,s),t.state!==i&&Ow.enqueueReplaceState(t,t.state,null)}function Kc(i,t){var e=t;if("ref"in t){e={};for(var s in t)s!=="ref"&&(e[s]=t[s])}if(i=i.defaultProps){e===t&&(e=oe({},e));for(var n in i)e[n]===void 0&&(e[n]=i[n])}return e}function BC(i){g0(i)}function IC(i){console.error(i)}function UC(i){g0(i)}function S0(i,t){try{var e=i.onUncaughtError;e(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function e1(i,t,e){try{var s=i.onCaughtError;s(e.value,{componentStack:e.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function kw(i,t,e){return e=qo(e),e.tag=3,e.payload={element:null},e.callback=function(){S0(i,t)},e}function zC(i){return i=qo(i),i.tag=3,i}function FC(i,t,e,s){var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var r=s.value;i.payload=function(){return n(r)},i.callback=function(){e1(t,e,s)}}var a=e.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(i.callback=function(){e1(t,e,s),typeof n!="function"&&(Vo===null?Vo=new Set([this]):Vo.add(this));var l=s.stack;this.componentDidCatch(s.value,{componentStack:l!==null?l:""})})}function fD(i,t,e,s,n){if(e.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=e.alternate,t!==null&&Hd(t,e,n,!0),e=Hi.current,e!==null){switch(e.tag){case 31:case 13:return gn===null?R0():e.alternate===null&&Ee===0&&(Ee=3),e.flags&=-257,e.flags|=65536,e.lanes=n,s===b0?e.flags|=16384:(t=e.updateQueue,t===null?e.updateQueue=new Set([s]):t.add(s),Tv(i,s,n)),!1;case 22:return e.flags|=65536,s===b0?e.flags|=16384:(t=e.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},e.updateQueue=t):(e=t.retryQueue,e===null?t.retryQueue=new Set([s]):e.add(s)),Tv(i,s,n)),!1}throw Error(M(435,e.tag))}return Tv(i,s,n),R0(),!1}if(xt)return t=Hi.current,t!==null?(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=n,s!==yw&&(i=Error(M(422),{cause:s}),rg(hn(i,e)))):(s!==yw&&(t=Error(M(423),{cause:s}),rg(hn(t,e))),i=i.current.alternate,i.flags|=65536,n&=-n,i.lanes|=n,s=hn(s,e),n=kw(i.stateNode,s,n),fv(i,n),Ee!==4&&(Ee=2)),!1;var r=Error(M(520),{cause:s});if(r=hn(r,e),Yf===null?Yf=[r]:Yf.push(r),Ee!==4&&(Ee=2),t===null)return!0;s=hn(s,e),e=t;do{switch(e.tag){case 3:return e.flags|=65536,i=n&-n,e.lanes|=i,i=kw(e.stateNode,s,i),fv(e,i),!1;case 1:if(t=e.type,r=e.stateNode,(e.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(Vo===null||!Vo.has(r))))return e.flags|=65536,n&=-n,e.lanes|=n,n=zC(n),FC(n,i,e,s),fv(e,n),!1}e=e.return}while(e!==null);return!1}var SS=Error(M(461)),Ie=!1;function fs(i,t,e,s){t.child=i===null?eC(t,null,e,s):Xc(t,i.child,e,s)}function s1(i,t,e,s,n){e=e.render;var r=t.ref;if("ref"in s){var a={};for(var l in s)l!=="ref"&&(a[l]=s[l])}else a=s;return Vc(t),s=hS(i,t,e,a,r,n),l=dS(),i!==null&&!Ie?(fS(i,t,n),Oa(i,t,n)):(xt&&l&&iS(t),t.flags|=1,fs(i,t,s,n),t.child)}function i1(i,t,e,s,n){if(i===null){var r=e.type;return typeof r=="function"&&!sS(r)&&r.defaultProps===void 0&&e.compare===null?(t.tag=15,t.type=r,HC(i,t,r,s,n)):(i=yy(e.type,null,s,t,t.mode,n),i.ref=t.ref,i.return=t,t.child=i)}if(r=i.child,!xS(i,n)){var a=r.memoizedProps;if(e=e.compare,e=e!==null?e:ig,e(a,s)&&i.ref===t.ref)return Oa(i,t,n)}return t.flags|=1,i=wa(r,s),i.ref=t.ref,i.return=t,t.child=i}function HC(i,t,e,s,n){if(i!==null){var r=i.memoizedProps;if(ig(r,s)&&i.ref===t.ref)if(Ie=!1,t.pendingProps=s=r,xS(i,n))i.flags&131072&&(Ie=!0);else return t.lanes=i.lanes,Oa(i,t,n)}return Nw(i,t,e,s,n)}function $C(i,t,e,s){var n=s.children,r=i!==null?i.memoizedState:null;if(i===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.mode==="hidden"){if(t.flags&128){if(r=r!==null?r.baseLanes|e:e,i!==null){for(s=t.child=i.child,n=0;s!==null;)n=n|s.lanes|s.childLanes,s=s.sibling;s=n&~r}else s=0,t.child=null;return n1(i,t,r,e,s)}if(e&536870912)t.memoizedState={baseLanes:0,cachePool:null},i!==null&&by(t,r!==null?r.cachePool:null),r!==null?Vx(t,r):xw(),nC(t);else return s=t.lanes=536870912,n1(i,t,r!==null?r.baseLanes|e:e,e,s)}else r!==null?(by(t,r.cachePool),Vx(t,r),Fa(),t.memoizedState=null):(i!==null&&by(t,null),xw(),Fa());return fs(i,t,n,e),t.child}function ff(i,t){return i!==null&&i.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function n1(i,t,e,s,n){var r=aS();return r=r===null?null:{parent:Be._currentValue,pool:r},t.memoizedState={baseLanes:e,cachePool:r},i!==null&&by(t,null),xw(),nC(t),i!==null&&Hd(i,t,s,!0),t.childLanes=n,null}function _y(i,t){return t=x0({mode:t.mode,children:t.children},i.mode),t.ref=i.ref,i.child=t,t.return=i,t}function r1(i,t,e){return Xc(t,i.child,null,e),i=_y(t,t.pendingProps),i.flags|=2,ki(t),t.memoizedState=null,i}function gD(i,t,e){var s=t.pendingProps,n=(t.flags&128)!==0;if(t.flags&=-129,i===null){if(xt){if(s.mode==="hidden")return i=_y(t,s),t.lanes=536870912,ff(null,i);if(Ew(t),(i=re)?(i=L2(i,dn),i=i!==null&&i.data==="&"?i:null,i!==null&&(t.memoizedState={dehydrated:i,treeContext:Qo!==null?{id:gr,overflow:mr}:null,retryLane:536870912,hydrationErrors:null},e=YT(i),e.return=t,t.child=e,ys=t,re=null)):i=null,i===null)throw Jo(t);return t.lanes=536870912,null}return _y(t,s)}var r=i.memoizedState;if(r!==null){var a=r.dehydrated;if(Ew(t),n)if(t.flags&256)t.flags&=-257,t=r1(i,t,e);else if(t.memoizedState!==null)t.child=i.child,t.flags|=128,t=null;else throw Error(M(558));else if(Ie||Hd(i,t,e,!1),n=(e&i.childLanes)!==0,Ie||n){if(s=Qt,s!==null&&(a=wT(s,e),a!==0&&a!==r.retryLane))throw r.retryLane=a,su(i,a),ri(s,i,a),SS;R0(),t=r1(i,t,e)}else i=r.treeContext,re=mn(a.nextSibling),ys=t,xt=!0,$o=null,dn=!1,i!==null&&WT(t,i),t=_y(t,s),t.flags|=4096;return t}return i=wa(i.child,{mode:s.mode,children:s.children}),i.ref=t.ref,t.child=i,i.return=t,i}function Ay(i,t){var e=t.ref;if(e===null)i!==null&&i.ref!==null&&(t.flags|=4194816);else{if(typeof e!="function"&&typeof e!="object")throw Error(M(284));(i===null||i.ref!==e)&&(t.flags|=4194816)}}function Nw(i,t,e,s,n){return Vc(t),e=hS(i,t,e,s,void 0,n),s=dS(),i!==null&&!Ie?(fS(i,t,n),Oa(i,t,n)):(xt&&s&&iS(t),t.flags|=1,fs(i,t,e,n),t.child)}function a1(i,t,e,s,n,r){return Vc(t),t.updateQueue=null,e=aC(t,s,e,n),rC(i),s=dS(),i!==null&&!Ie?(fS(i,t,r),Oa(i,t,r)):(xt&&s&&iS(t),t.flags|=1,fs(i,t,e,r),t.child)}function o1(i,t,e,s,n){if(Vc(t),t.stateNode===null){var r=Bu,a=e.contextType;typeof a=="object"&&a!==null&&(r=vs(a)),r=new e(s,r),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Ow,t.stateNode=r,r._reactInternals=t,r=t.stateNode,r.props=s,r.state=t.memoizedState,r.refs={},lS(t),a=e.contextType,r.context=typeof a=="object"&&a!==null?vs(a):Bu,r.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(mv(t,e,a,s),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(a=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),a!==r.state&&Ow.enqueueReplaceState(r,r.state,null),qf(t,s,r,n),$f(),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(i===null){r=t.stateNode;var l=t.memoizedProps,c=Kc(e,l);r.props=c;var u=r.context,h=e.contextType;a=Bu,typeof h=="object"&&h!==null&&(a=vs(h));var d=e.getDerivedStateFromProps;h=typeof d=="function"||typeof r.getSnapshotBeforeUpdate=="function",l=t.pendingProps!==l,h||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(l||u!==a)&&t1(t,r,s,a),Ia=!1;var f=t.memoizedState;r.state=f,qf(t,s,r,n),$f(),u=t.memoizedState,l||f!==u||Ia?(typeof d=="function"&&(mv(t,e,d,s),u=t.memoizedState),(c=Ia||Zx(t,e,c,s,f,u,a))?(h||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(t.flags|=4194308)):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=u),r.props=s,r.state=u,r.context=a,s=c):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{r=t.stateNode,Aw(i,t),a=t.memoizedProps,h=Kc(e,a),r.props=h,d=t.pendingProps,f=r.context,u=e.contextType,c=Bu,typeof u=="object"&&u!==null&&(c=vs(u)),l=e.getDerivedStateFromProps,(u=typeof l=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==d||f!==c)&&t1(t,r,s,c),Ia=!1,f=t.memoizedState,r.state=f,qf(t,s,r,n),$f();var g=t.memoizedState;a!==d||f!==g||Ia||i!==null&&i.dependencies!==null&&y0(i.dependencies)?(typeof l=="function"&&(mv(t,e,l,s),g=t.memoizedState),(h=Ia||Zx(t,e,h,s,f,g,c)||i!==null&&i.dependencies!==null&&y0(i.dependencies))?(u||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(s,g,c),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(s,g,c)),typeof r.componentDidUpdate=="function"&&(t.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof r.componentDidUpdate!="function"||a===i.memoizedProps&&f===i.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&f===i.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=g),r.props=s,r.state=g,r.context=c,s=h):(typeof r.componentDidUpdate!="function"||a===i.memoizedProps&&f===i.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===i.memoizedProps&&f===i.memoizedState||(t.flags|=1024),s=!1)}return r=s,Ay(i,t),s=(t.flags&128)!==0,r||s?(r=t.stateNode,e=s&&typeof e.getDerivedStateFromError!="function"?null:r.render(),t.flags|=1,i!==null&&s?(t.child=Xc(t,i.child,null,n),t.child=Xc(t,null,e,n)):fs(i,t,e,n),t.memoizedState=r.state,i=t.child):i=Oa(i,t,n),i}function l1(i,t,e,s){return Gc(),t.flags|=256,fs(i,t,e,s),t.child}var pv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function yv(i){return{baseLanes:i,cachePool:JT()}}function bv(i,t,e){return i=i!==null?i.childLanes&~e:0,t&&(i|=Li),i}function qC(i,t,e){var s=t.pendingProps,n=!1,r=(t.flags&128)!==0,a;if((a=r)||(a=i!==null&&i.memoizedState===null?!1:(Re.current&2)!==0),a&&(n=!0,t.flags&=-129),a=(t.flags&32)!==0,t.flags&=-33,i===null){if(xt){if(n?za(t):Fa(),(i=re)?(i=L2(i,dn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(t.memoizedState={dehydrated:i,treeContext:Qo!==null?{id:gr,overflow:mr}:null,retryLane:536870912,hydrationErrors:null},e=YT(i),e.return=t,t.child=e,ys=t,re=null)):i=null,i===null)throw Jo(t);return Gw(i)?t.lanes=32:t.lanes=536870912,null}var l=s.children;return s=s.fallback,n?(Fa(),n=t.mode,l=x0({mode:"hidden",children:l},n),s=Fc(s,n,e,null),l.return=t,s.return=t,l.sibling=s,t.child=l,s=t.child,s.memoizedState=yv(e),s.childLanes=bv(i,a,e),t.memoizedState=pv,ff(null,s)):(za(t),Mw(t,l))}var c=i.memoizedState;if(c!==null&&(l=c.dehydrated,l!==null)){if(r)t.flags&256?(za(t),t.flags&=-257,t=vv(i,t,e)):t.memoizedState!==null?(Fa(),t.child=i.child,t.flags|=128,t=null):(Fa(),l=s.fallback,n=t.mode,s=x0({mode:"visible",children:s.children},n),l=Fc(l,n,e,null),l.flags|=2,s.return=t,l.return=t,s.sibling=l,t.child=s,Xc(t,i.child,null,e),s=t.child,s.memoizedState=yv(e),s.childLanes=bv(i,a,e),t.memoizedState=pv,t=ff(null,s));else if(za(t),Gw(l)){if(a=l.nextSibling&&l.nextSibling.dataset,a)var u=a.dgst;a=u,s=Error(M(419)),s.stack="",s.digest=a,rg({value:s,source:null,stack:null}),t=vv(i,t,e)}else if(Ie||Hd(i,t,e,!1),a=(e&i.childLanes)!==0,Ie||a){if(a=Qt,a!==null&&(s=wT(a,e),s!==0&&s!==c.retryLane))throw c.retryLane=s,su(i,s),ri(a,i,s),SS;qw(l)||R0(),t=vv(i,t,e)}else qw(l)?(t.flags|=192,t.child=i.child,t=null):(i=c.treeContext,re=mn(l.nextSibling),ys=t,xt=!0,$o=null,dn=!1,i!==null&&WT(t,i),t=Mw(t,s.children),t.flags|=4096);return t}return n?(Fa(),l=s.fallback,n=t.mode,c=i.child,u=c.sibling,s=wa(c,{mode:"hidden",children:s.children}),s.subtreeFlags=c.subtreeFlags&65011712,u!==null?l=wa(u,l):(l=Fc(l,n,e,null),l.flags|=2),l.return=t,s.return=t,s.sibling=l,t.child=s,ff(null,s),s=t.child,l=i.child.memoizedState,l===null?l=yv(e):(n=l.cachePool,n!==null?(c=Be._currentValue,n=n.parent!==c?{parent:c,pool:c}:n):n=JT(),l={baseLanes:l.baseLanes|e,cachePool:n}),s.memoizedState=l,s.childLanes=bv(i,a,e),t.memoizedState=pv,ff(i.child,s)):(za(t),e=i.child,i=e.sibling,e=wa(e,{mode:"visible",children:s.children}),e.return=t,e.sibling=null,i!==null&&(a=t.deletions,a===null?(t.deletions=[i],t.flags|=16):a.push(i)),t.child=e,t.memoizedState=null,e)}function Mw(i,t){return t=x0({mode:"visible",children:t},i.mode),t.return=i,i.child=t}function x0(i,t){return i=Mi(22,i,null,t),i.lanes=0,i}function vv(i,t,e){return Xc(t,i.child,null,e),i=Mw(t,t.pendingProps.children),i.flags|=2,t.memoizedState=null,i}function c1(i,t,e){i.lanes|=t;var s=i.alternate;s!==null&&(s.lanes|=t),vw(i.return,t,e)}function wv(i,t,e,s,n,r){var a=i.memoizedState;a===null?i.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:e,tailMode:n,treeForkCount:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=e,a.tailMode=n,a.treeForkCount=r)}function GC(i,t,e){var s=t.pendingProps,n=s.revealOrder,r=s.tail;s=s.children;var a=Re.current,l=(a&2)!==0;if(l?(a=a&1|2,t.flags|=128):a&=1,se(Re,a),fs(i,t,s,e),s=xt?ng:0,!l&&i!==null&&i.flags&128)t:for(i=t.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&c1(i,e,t);else if(i.tag===19)c1(i,e,t);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break t;for(;i.sibling===null;){if(i.return===null||i.return===t)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(n){case"forwards":for(e=t.child,n=null;e!==null;)i=e.alternate,i!==null&&w0(i)===null&&(n=e),e=e.sibling;e=n,e===null?(n=t.child,t.child=null):(n=e.sibling,e.sibling=null),wv(t,!1,n,e,r,s);break;case"backwards":case"unstable_legacy-backwards":for(e=null,n=t.child,t.child=null;n!==null;){if(i=n.alternate,i!==null&&w0(i)===null){t.child=n;break}i=n.sibling,n.sibling=e,e=n,n=i}wv(t,!0,e,null,r,s);break;case"together":wv(t,!1,null,null,void 0,s);break;default:t.memoizedState=null}return t.child}function Oa(i,t,e){if(i!==null&&(t.dependencies=i.dependencies),tl|=t.lanes,!(e&t.childLanes))if(i!==null){if(Hd(i,t,e,!1),(e&t.childLanes)===0)return null}else return null;if(i!==null&&t.child!==i.child)throw Error(M(153));if(t.child!==null){for(i=t.child,e=wa(i,i.pendingProps),t.child=e,e.return=t;i.sibling!==null;)i=i.sibling,e=e.sibling=wa(i,i.pendingProps),e.return=t;e.sibling=null}return t.child}function xS(i,t){return i.lanes&t?!0:(i=i.dependencies,!!(i!==null&&y0(i)))}function mD(i,t,e){switch(t.tag){case 3:u0(t,t.stateNode.containerInfo),Ua(t,Be,i.memoizedState.cache),Gc();break;case 27:case 5:aw(t);break;case 4:u0(t,t.stateNode.containerInfo);break;case 10:Ua(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Ew(t),null;break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(za(t),t.flags|=128,null):e&t.child.childLanes?qC(i,t,e):(za(t),i=Oa(i,t,e),i!==null?i.sibling:null);za(t);break;case 19:var n=(i.flags&128)!==0;if(s=(e&t.childLanes)!==0,s||(Hd(i,t,e,!1),s=(e&t.childLanes)!==0),n){if(s)return GC(i,t,e);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),se(Re,Re.current),s)break;return null;case 22:return t.lanes=0,$C(i,t,e,t.pendingProps);case 24:Ua(t,Be,i.memoizedState.cache)}return Oa(i,t,e)}function VC(i,t,e){if(i!==null)if(i.memoizedProps!==t.pendingProps)Ie=!0;else{if(!xS(i,e)&&!(t.flags&128))return Ie=!1,mD(i,t,e);Ie=!!(i.flags&131072)}else Ie=!1,xt&&t.flags&1048576&&KT(t,ng,t.index);switch(t.lanes=0,t.tag){case 16:t:{var s=t.pendingProps;if(i=fl(t.elementType),t.type=i,typeof i=="function")sS(i)?(s=Kc(i,s),t.tag=1,t=o1(null,t,i,s,e)):(t.tag=0,t=Nw(null,t,i,s,e));else{if(i!=null){var n=i.$$typeof;if(n===HA){t.tag=11,t=s1(null,t,i,s,e);break t}else if(n===$A){t.tag=14,t=i1(null,t,i,s,e);break t}}throw t=nw(i)||i,Error(M(306,t,""))}}return t;case 0:return Nw(i,t,t.type,t.pendingProps,e);case 1:return s=t.type,n=Kc(s,t.pendingProps),o1(i,t,s,n,e);case 3:t:{if(u0(t,t.stateNode.containerInfo),i===null)throw Error(M(387));s=t.pendingProps;var r=t.memoizedState;n=r.element,Aw(i,t),qf(t,s,null,e);var a=t.memoizedState;if(s=a.cache,Ua(t,Be,s),s!==r.cache&&ww(t,[Be],e,!0),$f(),s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=r,t.memoizedState=r,t.flags&256){t=l1(i,t,s,e);break t}else if(s!==n){n=hn(Error(M(424)),t),rg(n),t=l1(i,t,s,e);break t}else{switch(i=t.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(re=mn(i.firstChild),ys=t,xt=!0,$o=null,dn=!0,e=eC(t,null,s,e),t.child=e;e;)e.flags=e.flags&-3|4096,e=e.sibling}else{if(Gc(),s===n){t=Oa(i,t,e);break t}fs(i,t,s,e)}t=t.child}return t;case 26:return Ay(i,t),i===null?(e=O1(t.type,null,t.pendingProps,null))?t.memoizedState=e:xt||(e=t.type,i=t.pendingProps,s=M0(Ho.current).createElement(e),s[ps]=t,s[ai]=i,ws(s,e,i),rs(s),t.stateNode=s):t.memoizedState=O1(t.type,i.memoizedProps,t.pendingProps,i.memoizedState),null;case 27:return aw(t),i===null&&xt&&(s=t.stateNode=P2(t.type,t.pendingProps,Ho.current),ys=t,dn=!0,n=re,rl(t.type)?(Vw=n,re=mn(s.firstChild)):re=n),fs(i,t,t.pendingProps.children,e),Ay(i,t),i===null&&(t.flags|=4194304),t.child;case 5:return i===null&&xt&&((n=s=re)&&(s=GD(s,t.type,t.pendingProps,dn),s!==null?(t.stateNode=s,ys=t,re=mn(s.firstChild),dn=!1,n=!0):n=!1),n||Jo(t)),aw(t),n=t.type,r=t.pendingProps,a=i!==null?i.memoizedProps:null,s=r.children,Hw(n,r)?s=null:a!==null&&Hw(n,a)&&(t.flags|=32),t.memoizedState!==null&&(n=hS(i,t,aD,null,null,e),hg._currentValue=n),Ay(i,t),fs(i,t,s,e),t.child;case 6:return i===null&&xt&&((i=e=re)&&(e=VD(e,t.pendingProps,dn),e!==null?(t.stateNode=e,ys=t,re=null,i=!0):i=!1),i||Jo(t)),null;case 13:return qC(i,t,e);case 4:return u0(t,t.stateNode.containerInfo),s=t.pendingProps,i===null?t.child=Xc(t,null,s,e):fs(i,t,s,e),t.child;case 11:return s1(i,t,t.type,t.pendingProps,e);case 7:return fs(i,t,t.pendingProps,e),t.child;case 8:return fs(i,t,t.pendingProps.children,e),t.child;case 12:return fs(i,t,t.pendingProps.children,e),t.child;case 10:return s=t.pendingProps,Ua(t,t.type,s.value),fs(i,t,s.children,e),t.child;case 9:return n=t.type._context,s=t.pendingProps.children,Vc(t),n=vs(n),s=s(n),t.flags|=1,fs(i,t,s,e),t.child;case 14:return i1(i,t,t.type,t.pendingProps,e);case 15:return HC(i,t,t.type,t.pendingProps,e);case 19:return GC(i,t,e);case 31:return gD(i,t,e);case 22:return $C(i,t,e,t.pendingProps);case 24:return Vc(t),s=vs(Be),i===null?(n=aS(),n===null&&(n=Qt,r=rS(),n.pooledCache=r,r.refCount++,r!==null&&(n.pooledCacheLanes|=e),n=r),t.memoizedState={parent:s,cache:n},lS(t),Ua(t,Be,n)):(i.lanes&e&&(Aw(i,t),qf(t,null,null,e),$f()),n=i.memoizedState,r=t.memoizedState,n.parent!==s?(n={parent:s,cache:s},t.memoizedState=n,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=n),Ua(t,Be,s)):(s=r.cache,Ua(t,Be,s),s!==n.cache&&ww(t,[Be],e,!0))),fs(i,t,t.pendingProps.children,e),t.child;case 29:throw t.pendingProps}throw Error(M(156,t.tag))}function xr(i){i.flags|=4}function _v(i,t,e,s,n){if((t=(i.mode&32)!==0)&&(t=!1),t){if(i.flags|=16777216,(n&335544128)===n)if(i.stateNode.complete)i.flags|=8192;else if(p2())i.flags|=8192;else throw $c=b0,oS}else i.flags&=-16777217}function u1(i,t){if(t.type!=="stylesheet"||t.state.loading&4)i.flags&=-16777217;else if(i.flags|=16777216,!U2(t))if(p2())i.flags|=8192;else throw $c=b0,oS}function $p(i,t){t!==null&&(i.flags|=4),i.flags&16384&&(t=i.tag!==22?yT():536870912,i.lanes|=t,Dd|=t)}function ef(i,t){if(!xt)switch(i.tailMode){case"hidden":t=i.tail;for(var e=null;t!==null;)t.alternate!==null&&(e=t),t=t.sibling;e===null?i.tail=null:e.sibling=null;break;case"collapsed":e=i.tail;for(var s=null;e!==null;)e.alternate!==null&&(s=e),e=e.sibling;s===null?t||i.tail===null?i.tail=null:i.tail.sibling=null:s.sibling=null}}function ie(i){var t=i.alternate!==null&&i.alternate.child===i.child,e=0,s=0;if(t)for(var n=i.child;n!==null;)e|=n.lanes|n.childLanes,s|=n.subtreeFlags&65011712,s|=n.flags&65011712,n.return=i,n=n.sibling;else for(n=i.child;n!==null;)e|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=i,n=n.sibling;return i.subtreeFlags|=s,i.childLanes=e,t}function pD(i,t,e){var s=t.pendingProps;switch(nS(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ie(t),null;case 1:return ie(t),null;case 3:return e=t.stateNode,s=null,i!==null&&(s=i.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),_a(Be),Cd(),e.pendingContext&&(e.context=e.pendingContext,e.pendingContext=null),(i===null||i.child===null)&&(lu(t)?xr(t):i===null||i.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,dv())),ie(t),null;case 26:var n=t.type,r=t.memoizedState;return i===null?(xr(t),r!==null?(ie(t),u1(t,r)):(ie(t),_v(t,n,null,s,e))):r?r!==i.memoizedState?(xr(t),ie(t),u1(t,r)):(ie(t),t.flags&=-16777217):(i=i.memoizedProps,i!==s&&xr(t),ie(t),_v(t,n,i,s,e)),null;case 27:if(h0(t),e=Ho.current,n=t.type,i!==null&&t.stateNode!=null)i.memoizedProps!==s&&xr(t);else{if(!s){if(t.stateNode===null)throw Error(M(166));return ie(t),null}i=yr.current,lu(t)?Ux(t):(i=P2(n,s,e),t.stateNode=i,xr(t))}return ie(t),null;case 5:if(h0(t),n=t.type,i!==null&&t.stateNode!=null)i.memoizedProps!==s&&xr(t);else{if(!s){if(t.stateNode===null)throw Error(M(166));return ie(t),null}if(r=yr.current,lu(t))Ux(t);else{var a=M0(Ho.current);switch(r){case 1:r=a.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:r=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":r=a.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":r=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof s.is=="string"?a.createElement("select",{is:s.is}):a.createElement("select"),s.multiple?r.multiple=!0:s.size&&(r.size=s.size);break;default:r=typeof s.is=="string"?a.createElement(n,{is:s.is}):a.createElement(n)}}r[ps]=t,r[ai]=s;t:for(a=t.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break t;for(;a.sibling===null;){if(a.return===null||a.return===t)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=r;t:switch(ws(r,n,s),n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break t;case"img":s=!0;break t;default:s=!1}s&&xr(t)}}return ie(t),_v(t,t.type,i===null?null:i.memoizedProps,t.pendingProps,e),null;case 6:if(i&&t.stateNode!=null)i.memoizedProps!==s&&xr(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(M(166));if(i=Ho.current,lu(t)){if(i=t.stateNode,e=t.memoizedProps,s=null,n=ys,n!==null)switch(n.tag){case 27:case 5:s=n.memoizedProps}i[ps]=t,i=!!(i.nodeValue===e||s!==null&&s.suppressHydrationWarning===!0||M2(i.nodeValue,e)),i||Jo(t,!0)}else i=M0(i).createTextNode(s),i[ps]=t,t.stateNode=i}return ie(t),null;case 31:if(e=t.memoizedState,i===null||i.memoizedState!==null){if(s=lu(t),e!==null){if(i===null){if(!s)throw Error(M(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(M(557));i[ps]=t}else Gc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ie(t),i=!1}else e=dv(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=e),i=!0;if(!i)return t.flags&256?(ki(t),t):(ki(t),null);if(t.flags&128)throw Error(M(558))}return ie(t),null;case 13:if(s=t.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(n=lu(t),s!==null&&s.dehydrated!==null){if(i===null){if(!n)throw Error(M(318));if(n=t.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(M(317));n[ps]=t}else Gc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ie(t),n=!1}else n=dv(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=n),n=!0;if(!n)return t.flags&256?(ki(t),t):(ki(t),null)}return ki(t),t.flags&128?(t.lanes=e,t):(e=s!==null,i=i!==null&&i.memoizedState!==null,e&&(s=t.child,n=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(n=s.alternate.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==n&&(s.flags|=2048)),e!==i&&e&&(t.child.flags|=8192),$p(t,t.updateQueue),ie(t),null);case 4:return Cd(),i===null&&NS(t.stateNode.containerInfo),ie(t),null;case 10:return _a(t.type),ie(t),null;case 19:if(as(Re),s=t.memoizedState,s===null)return ie(t),null;if(n=(t.flags&128)!==0,r=s.rendering,r===null)if(n)ef(s,!1);else{if(Ee!==0||i!==null&&i.flags&128)for(i=t.child;i!==null;){if(r=w0(i),r!==null){for(t.flags|=128,ef(s,!1),i=r.updateQueue,t.updateQueue=i,$p(t,i),t.subtreeFlags=0,i=e,e=t.child;e!==null;)XT(e,i),e=e.sibling;return se(Re,Re.current&1|2),xt&&jr(t,s.treeForkCount),t.child}i=i.sibling}s.tail!==null&&Pi()>T0&&(t.flags|=128,n=!0,ef(s,!1),t.lanes=4194304)}else{if(!n)if(i=w0(r),i!==null){if(t.flags|=128,n=!0,i=i.updateQueue,t.updateQueue=i,$p(t,i),ef(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!xt)return ie(t),null}else 2*Pi()-s.renderingStartTime>T0&&e!==536870912&&(t.flags|=128,n=!0,ef(s,!1),t.lanes=4194304);s.isBackwards?(r.sibling=t.child,t.child=r):(i=s.last,i!==null?i.sibling=r:t.child=r,s.last=r)}return s.tail!==null?(i=s.tail,s.rendering=i,s.tail=i.sibling,s.renderingStartTime=Pi(),i.sibling=null,e=Re.current,se(Re,n?e&1|2:e&1),xt&&jr(t,s.treeForkCount),i):(ie(t),null);case 22:case 23:return ki(t),cS(),s=t.memoizedState!==null,i!==null?i.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?e&536870912&&!(t.flags&128)&&(ie(t),t.subtreeFlags&6&&(t.flags|=8192)):ie(t),e=t.updateQueue,e!==null&&$p(t,e.retryQueue),e=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(e=i.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==e&&(t.flags|=2048),i!==null&&as(Hc),null;case 24:return e=null,i!==null&&(e=i.memoizedState.cache),t.memoizedState.cache!==e&&(t.flags|=2048),_a(Be),ie(t),null;case 25:return null;case 30:return null}throw Error(M(156,t.tag))}function yD(i,t){switch(nS(t),t.tag){case 1:return i=t.flags,i&65536?(t.flags=i&-65537|128,t):null;case 3:return _a(Be),Cd(),i=t.flags,i&65536&&!(i&128)?(t.flags=i&-65537|128,t):null;case 26:case 27:case 5:return h0(t),null;case 31:if(t.memoizedState!==null){if(ki(t),t.alternate===null)throw Error(M(340));Gc()}return i=t.flags,i&65536?(t.flags=i&-65537|128,t):null;case 13:if(ki(t),i=t.memoizedState,i!==null&&i.dehydrated!==null){if(t.alternate===null)throw Error(M(340));Gc()}return i=t.flags,i&65536?(t.flags=i&-65537|128,t):null;case 19:return as(Re),null;case 4:return Cd(),null;case 10:return _a(t.type),null;case 22:case 23:return ki(t),cS(),i!==null&&as(Hc),i=t.flags,i&65536?(t.flags=i&-65537|128,t):null;case 24:return _a(Be),null;case 25:return null;default:return null}}function XC(i,t){switch(nS(t),t.tag){case 3:_a(Be),Cd();break;case 26:case 27:case 5:h0(t);break;case 4:Cd();break;case 31:t.memoizedState!==null&&ki(t);break;case 13:ki(t);break;case 19:as(Re);break;case 10:_a(t.type);break;case 22:case 23:ki(t),cS(),i!==null&&as(Hc);break;case 24:_a(Be)}}function vp(i,t){try{var e=t.updateQueue,s=e!==null?e.lastEffect:null;if(s!==null){var n=s.next;e=n;do{if((e.tag&i)===i){s=void 0;var r=e.create,a=e.inst;s=r(),a.destroy=s}e=e.next}while(e!==n)}}catch(l){Pt(t,t.return,l)}}function Zo(i,t,e){try{var s=t.updateQueue,n=s!==null?s.lastEffect:null;if(n!==null){var r=n.next;s=r;do{if((s.tag&i)===i){var a=s.inst,l=a.destroy;if(l!==void 0){a.destroy=void 0,n=t;var c=e,u=l;try{u()}catch(h){Pt(n,c,h)}}}s=s.next}while(s!==r)}}catch(h){Pt(t,t.return,h)}}function YC(i){var t=i.updateQueue;if(t!==null){var e=i.stateNode;try{iC(t,e)}catch(s){Pt(i,i.return,s)}}}function KC(i,t,e){e.props=Kc(i.type,i.memoizedProps),e.state=i.memoizedState;try{e.componentWillUnmount()}catch(s){Pt(i,t,s)}}function Vf(i,t){try{var e=i.ref;if(e!==null){switch(i.tag){case 26:case 27:case 5:var s=i.stateNode;break;case 30:s=i.stateNode;break;default:s=i.stateNode}typeof e=="function"?i.refCleanup=e(s):e.current=s}}catch(n){Pt(i,t,n)}}function pr(i,t){var e=i.ref,s=i.refCleanup;if(e!==null)if(typeof s=="function")try{s()}catch(n){Pt(i,t,n)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof e=="function")try{e(null)}catch(n){Pt(i,t,n)}else e.current=null}function WC(i){var t=i.type,e=i.memoizedProps,s=i.stateNode;try{t:switch(t){case"button":case"input":case"select":case"textarea":e.autoFocus&&s.focus();break t;case"img":e.src?s.src=e.src:e.srcSet&&(s.srcset=e.srcSet)}}catch(n){Pt(i,i.return,n)}}function Av(i,t,e){try{var s=i.stateNode;UD(s,i.type,e,t),s[ai]=t}catch(n){Pt(i,i.return,n)}}function QC(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&rl(i.type)||i.tag===4}function Sv(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||QC(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&rl(i.type)||i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Dw(i,t,e){var s=i.tag;if(s===5||s===6)i=i.stateNode,t?(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e).insertBefore(i,t):(t=e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,t.appendChild(i),e=e._reactRootContainer,e!=null||t.onclick!==null||(t.onclick=ba));else if(s!==4&&(s===27&&rl(i.type)&&(e=i.stateNode,t=null),i=i.child,i!==null))for(Dw(i,t,e),i=i.sibling;i!==null;)Dw(i,t,e),i=i.sibling}function E0(i,t,e){var s=i.tag;if(s===5||s===6)i=i.stateNode,t?e.insertBefore(i,t):e.appendChild(i);else if(s!==4&&(s===27&&rl(i.type)&&(e=i.stateNode),i=i.child,i!==null))for(E0(i,t,e),i=i.sibling;i!==null;)E0(i,t,e),i=i.sibling}function JC(i){var t=i.stateNode,e=i.memoizedProps;try{for(var s=i.type,n=t.attributes;n.length;)t.removeAttributeNode(n[0]);ws(t,s,e),t[ps]=i,t[ai]=e}catch(r){Pt(i,i.return,r)}}var ma=!1,Pe=!1,xv=!1,h1=typeof WeakSet=="function"?WeakSet:Set,ns=null;function bD(i,t){if(i=i.containerInfo,zw=P0,i=UT(i),ZA(i)){if("selectionStart"in i)var e={start:i.selectionStart,end:i.selectionEnd};else t:{e=(e=i.ownerDocument)&&e.defaultView||window;var s=e.getSelection&&e.getSelection();if(s&&s.rangeCount!==0){e=s.anchorNode;var n=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{e.nodeType,r.nodeType}catch{e=null;break t}var a=0,l=-1,c=-1,u=0,h=0,d=i,f=null;e:for(;;){for(var g;d!==e||n!==0&&d.nodeType!==3||(l=a+n),d!==r||s!==0&&d.nodeType!==3||(c=a+s),d.nodeType===3&&(a+=d.nodeValue.length),(g=d.firstChild)!==null;)f=d,d=g;for(;;){if(d===i)break e;if(f===e&&++u===n&&(l=a),f===r&&++h===s&&(c=a),(g=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=g}e=l===-1||c===-1?null:{start:l,end:c}}else e=null}e=e||{start:0,end:0}}else e=null;for(Fw={focusedElem:i,selectionRange:e},P0=!1,ns=t;ns!==null;)if(t=ns,i=t.child,(t.subtreeFlags&1028)!==0&&i!==null)i.return=t,ns=i;else for(;ns!==null;){switch(t=ns,r=t.alternate,i=t.flags,t.tag){case 0:if(i&4&&(i=t.updateQueue,i=i!==null?i.events:null,i!==null))for(e=0;e<i.length;e++)n=i[e],n.ref.impl=n.nextImpl;break;case 11:case 15:break;case 1:if(i&1024&&r!==null){i=void 0,e=t,n=r.memoizedProps,r=r.memoizedState,s=e.stateNode;try{var b=Kc(e.type,n);i=s.getSnapshotBeforeUpdate(b,r),s.__reactInternalSnapshotBeforeUpdate=i}catch(v){Pt(e,e.return,v)}}break;case 3:if(i&1024){if(i=t.stateNode.containerInfo,e=i.nodeType,e===9)$w(i);else if(e===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":$w(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(i&1024)throw Error(M(163))}if(i=t.sibling,i!==null){i.return=t.return,ns=i;break}ns=t.return}}function ZC(i,t,e){var s=e.flags;switch(e.tag){case 0:case 11:case 15:Tr(i,e),s&4&&vp(5,e);break;case 1:if(Tr(i,e),s&4)if(i=e.stateNode,t===null)try{i.componentDidMount()}catch(a){Pt(e,e.return,a)}else{var n=Kc(e.type,t.memoizedProps);t=t.memoizedState;try{i.componentDidUpdate(n,t,i.__reactInternalSnapshotBeforeUpdate)}catch(a){Pt(e,e.return,a)}}s&64&&YC(e),s&512&&Vf(e,e.return);break;case 3:if(Tr(i,e),s&64&&(i=e.updateQueue,i!==null)){if(t=null,e.child!==null)switch(e.child.tag){case 27:case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}try{iC(i,t)}catch(a){Pt(e,e.return,a)}}break;case 27:t===null&&s&4&&JC(e);case 26:case 5:Tr(i,e),t===null&&s&4&&WC(e),s&512&&Vf(e,e.return);break;case 12:Tr(i,e);break;case 31:Tr(i,e),s&4&&s2(i,e);break;case 13:Tr(i,e),s&4&&i2(i,e),s&64&&(i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(e=CD.bind(null,e),XD(i,e))));break;case 22:if(s=e.memoizedState!==null||ma,!s){t=t!==null&&t.memoizedState!==null||Pe,n=ma;var r=Pe;ma=s,(Pe=t)&&!r?Cr(i,e,(e.subtreeFlags&8772)!==0):Tr(i,e),ma=n,Pe=r}break;case 30:break;default:Tr(i,e)}}function t2(i){var t=i.alternate;t!==null&&(i.alternate=null,t2(t)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(t=i.stateNode,t!==null&&XA(t)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var he=null,si=!1;function Er(i,t,e){for(e=e.child;e!==null;)e2(i,t,e),e=e.sibling}function e2(i,t,e){if(Bi&&typeof Bi.onCommitFiberUnmount=="function")try{Bi.onCommitFiberUnmount(dp,e)}catch{}switch(e.tag){case 26:Pe||pr(e,t),Er(i,t,e),e.memoizedState?e.memoizedState.count--:e.stateNode&&(e=e.stateNode,e.parentNode.removeChild(e));break;case 27:Pe||pr(e,t);var s=he,n=si;rl(e.type)&&(he=e.stateNode,si=!1),Er(i,t,e),Wf(e.stateNode),he=s,si=n;break;case 5:Pe||pr(e,t);case 6:if(s=he,n=si,he=null,Er(i,t,e),he=s,si=n,he!==null)if(si)try{(he.nodeType===9?he.body:he.nodeName==="HTML"?he.ownerDocument.body:he).removeChild(e.stateNode)}catch(r){Pt(e,t,r)}else try{he.removeChild(e.stateNode)}catch(r){Pt(e,t,r)}break;case 18:he!==null&&(si?(i=he,x1(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,e.stateNode),Bd(i)):x1(he,e.stateNode));break;case 4:s=he,n=si,he=e.stateNode.containerInfo,si=!0,Er(i,t,e),he=s,si=n;break;case 0:case 11:case 14:case 15:Zo(2,e,t),Pe||Zo(4,e,t),Er(i,t,e);break;case 1:Pe||(pr(e,t),s=e.stateNode,typeof s.componentWillUnmount=="function"&&KC(e,t,s)),Er(i,t,e);break;case 21:Er(i,t,e);break;case 22:Pe=(s=Pe)||e.memoizedState!==null,Er(i,t,e),Pe=s;break;default:Er(i,t,e)}}function s2(i,t){if(t.memoizedState===null&&(i=t.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Bd(i)}catch(e){Pt(t,t.return,e)}}}function i2(i,t){if(t.memoizedState===null&&(i=t.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Bd(i)}catch(e){Pt(t,t.return,e)}}function vD(i){switch(i.tag){case 31:case 13:case 19:var t=i.stateNode;return t===null&&(t=i.stateNode=new h1),t;case 22:return i=i.stateNode,t=i._retryCache,t===null&&(t=i._retryCache=new h1),t;default:throw Error(M(435,i.tag))}}function qp(i,t){var e=vD(i);t.forEach(function(s){if(!e.has(s)){e.add(s);var n=RD.bind(null,i,s);s.then(n,n)}})}function Gs(i,t){var e=t.deletions;if(e!==null)for(var s=0;s<e.length;s++){var n=e[s],r=i,a=t,l=a;t:for(;l!==null;){switch(l.tag){case 27:if(rl(l.type)){he=l.stateNode,si=!1;break t}break;case 5:he=l.stateNode,si=!1;break t;case 3:case 4:he=l.stateNode.containerInfo,si=!0;break t}l=l.return}if(he===null)throw Error(M(160));e2(r,a,n),he=null,si=!1,r=n.alternate,r!==null&&(r.return=null),n.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)n2(t,i),t=t.sibling}var Bn=null;function n2(i,t){var e=i.alternate,s=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Gs(t,i),Vs(i),s&4&&(Zo(3,i,i.return),vp(3,i),Zo(5,i,i.return));break;case 1:Gs(t,i),Vs(i),s&512&&(Pe||e===null||pr(e,e.return)),s&64&&ma&&(i=i.updateQueue,i!==null&&(s=i.callbacks,s!==null&&(e=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=e===null?s:e.concat(s))));break;case 26:var n=Bn;if(Gs(t,i),Vs(i),s&512&&(Pe||e===null||pr(e,e.return)),s&4){var r=e!==null?e.memoizedState:null;if(s=i.memoizedState,e===null)if(s===null)if(i.stateNode===null){t:{s=i.type,e=i.memoizedProps,n=n.ownerDocument||n;e:switch(s){case"title":r=n.getElementsByTagName("title")[0],(!r||r[mp]||r[ps]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=n.createElement(s),n.head.insertBefore(r,n.querySelector("head > title"))),ws(r,s,e),r[ps]=i,rs(r),s=r;break t;case"link":var a=N1("link","href",n).get(s+(e.href||""));if(a){for(var l=0;l<a.length;l++)if(r=a[l],r.getAttribute("href")===(e.href==null||e.href===""?null:e.href)&&r.getAttribute("rel")===(e.rel==null?null:e.rel)&&r.getAttribute("title")===(e.title==null?null:e.title)&&r.getAttribute("crossorigin")===(e.crossOrigin==null?null:e.crossOrigin)){a.splice(l,1);break e}}r=n.createElement(s),ws(r,s,e),n.head.appendChild(r);break;case"meta":if(a=N1("meta","content",n).get(s+(e.content||""))){for(l=0;l<a.length;l++)if(r=a[l],r.getAttribute("content")===(e.content==null?null:""+e.content)&&r.getAttribute("name")===(e.name==null?null:e.name)&&r.getAttribute("property")===(e.property==null?null:e.property)&&r.getAttribute("http-equiv")===(e.httpEquiv==null?null:e.httpEquiv)&&r.getAttribute("charset")===(e.charSet==null?null:e.charSet)){a.splice(l,1);break e}}r=n.createElement(s),ws(r,s,e),n.head.appendChild(r);break;default:throw Error(M(468,s))}r[ps]=i,rs(r),s=r}i.stateNode=s}else M1(n,i.type,i.stateNode);else i.stateNode=k1(n,s,i.memoizedProps);else r!==s?(r===null?e.stateNode!==null&&(e=e.stateNode,e.parentNode.removeChild(e)):r.count--,s===null?M1(n,i.type,i.stateNode):k1(n,s,i.memoizedProps)):s===null&&i.stateNode!==null&&Av(i,i.memoizedProps,e.memoizedProps)}break;case 27:Gs(t,i),Vs(i),s&512&&(Pe||e===null||pr(e,e.return)),e!==null&&s&4&&Av(i,i.memoizedProps,e.memoizedProps);break;case 5:if(Gs(t,i),Vs(i),s&512&&(Pe||e===null||pr(e,e.return)),i.flags&32){n=i.stateNode;try{Od(n,"")}catch(b){Pt(i,i.return,b)}}s&4&&i.stateNode!=null&&(n=i.memoizedProps,Av(i,n,e!==null?e.memoizedProps:n)),s&1024&&(xv=!0);break;case 6:if(Gs(t,i),Vs(i),s&4){if(i.stateNode===null)throw Error(M(162));s=i.memoizedProps,e=i.stateNode;try{e.nodeValue=s}catch(b){Pt(i,i.return,b)}}break;case 3:if(Ey=null,n=Bn,Bn=D0(t.containerInfo),Gs(t,i),Bn=n,Vs(i),s&4&&e!==null&&e.memoizedState.isDehydrated)try{Bd(t.containerInfo)}catch(b){Pt(i,i.return,b)}xv&&(xv=!1,r2(i));break;case 4:s=Bn,Bn=D0(i.stateNode.containerInfo),Gs(t,i),Vs(i),Bn=s;break;case 12:Gs(t,i),Vs(i);break;case 31:Gs(t,i),Vs(i),s&4&&(s=i.updateQueue,s!==null&&(i.updateQueue=null,qp(i,s)));break;case 13:Gs(t,i),Vs(i),i.child.flags&8192&&i.memoizedState!==null!=(e!==null&&e.memoizedState!==null)&&(Pb=Pi()),s&4&&(s=i.updateQueue,s!==null&&(i.updateQueue=null,qp(i,s)));break;case 22:n=i.memoizedState!==null;var c=e!==null&&e.memoizedState!==null,u=ma,h=Pe;if(ma=u||n,Pe=h||c,Gs(t,i),Pe=h,ma=u,Vs(i),s&8192)t:for(t=i.stateNode,t._visibility=n?t._visibility&-2:t._visibility|1,n&&(e===null||c||ma||Pe||gl(i)),e=null,t=i;;){if(t.tag===5||t.tag===26){if(e===null){c=e=t;try{if(r=c.stateNode,n)a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var d=c.memoizedProps.style,f=d!=null&&d.hasOwnProperty("display")?d.display:null;l.style.display=f==null||typeof f=="boolean"?"":(""+f).trim()}}catch(b){Pt(c,c.return,b)}}}else if(t.tag===6){if(e===null){c=t;try{c.stateNode.nodeValue=n?"":c.memoizedProps}catch(b){Pt(c,c.return,b)}}}else if(t.tag===18){if(e===null){c=t;try{var g=c.stateNode;n?E1(g,!0):E1(c.stateNode,!1)}catch(b){Pt(c,c.return,b)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===i)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break t;for(;t.sibling===null;){if(t.return===null||t.return===i)break t;e===t&&(e=null),t=t.return}e===t&&(e=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=i.updateQueue,s!==null&&(e=s.retryQueue,e!==null&&(s.retryQueue=null,qp(i,e))));break;case 19:Gs(t,i),Vs(i),s&4&&(s=i.updateQueue,s!==null&&(i.updateQueue=null,qp(i,s)));break;case 30:break;case 21:break;default:Gs(t,i),Vs(i)}}function Vs(i){var t=i.flags;if(t&2){try{for(var e,s=i.return;s!==null;){if(QC(s)){e=s;break}s=s.return}if(e==null)throw Error(M(160));switch(e.tag){case 27:var n=e.stateNode,r=Sv(i);E0(i,r,n);break;case 5:var a=e.stateNode;e.flags&32&&(Od(a,""),e.flags&=-33);var l=Sv(i);E0(i,l,a);break;case 3:case 4:var c=e.stateNode.containerInfo,u=Sv(i);Dw(i,u,c);break;default:throw Error(M(161))}}catch(h){Pt(i,i.return,h)}i.flags&=-3}t&4096&&(i.flags&=-4097)}function r2(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var t=i;r2(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),i=i.sibling}}function Tr(i,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)ZC(i,t.alternate,t),t=t.sibling}function gl(i){for(i=i.child;i!==null;){var t=i;switch(t.tag){case 0:case 11:case 14:case 15:Zo(4,t,t.return),gl(t);break;case 1:pr(t,t.return);var e=t.stateNode;typeof e.componentWillUnmount=="function"&&KC(t,t.return,e),gl(t);break;case 27:Wf(t.stateNode);case 26:case 5:pr(t,t.return),gl(t);break;case 22:t.memoizedState===null&&gl(t);break;case 30:gl(t);break;default:gl(t)}i=i.sibling}}function Cr(i,t,e){for(e=e&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,n=i,r=t,a=r.flags;switch(r.tag){case 0:case 11:case 15:Cr(n,r,e),vp(4,r);break;case 1:if(Cr(n,r,e),s=r,n=s.stateNode,typeof n.componentDidMount=="function")try{n.componentDidMount()}catch(u){Pt(s,s.return,u)}if(s=r,n=s.updateQueue,n!==null){var l=s.stateNode;try{var c=n.shared.hiddenCallbacks;if(c!==null)for(n.shared.hiddenCallbacks=null,n=0;n<c.length;n++)sC(c[n],l)}catch(u){Pt(s,s.return,u)}}e&&a&64&&YC(r),Vf(r,r.return);break;case 27:JC(r);case 26:case 5:Cr(n,r,e),e&&s===null&&a&4&&WC(r),Vf(r,r.return);break;case 12:Cr(n,r,e);break;case 31:Cr(n,r,e),e&&a&4&&s2(n,r);break;case 13:Cr(n,r,e),e&&a&4&&i2(n,r);break;case 22:r.memoizedState===null&&Cr(n,r,e),Vf(r,r.return);break;case 30:break;default:Cr(n,r,e)}t=t.sibling}}function ES(i,t){var e=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(e=i.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==e&&(i!=null&&i.refCount++,e!=null&&yp(e))}function TS(i,t){i=null,t.alternate!==null&&(i=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==i&&(t.refCount++,i!=null&&yp(i))}function vn(i,t,e,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)a2(i,t,e,s),t=t.sibling}function a2(i,t,e,s){var n=t.flags;switch(t.tag){case 0:case 11:case 15:vn(i,t,e,s),n&2048&&vp(9,t);break;case 1:vn(i,t,e,s);break;case 3:vn(i,t,e,s),n&2048&&(i=null,t.alternate!==null&&(i=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==i&&(t.refCount++,i!=null&&yp(i)));break;case 12:if(n&2048){vn(i,t,e,s),i=t.stateNode;try{var r=t.memoizedProps,a=r.id,l=r.onPostCommit;typeof l=="function"&&l(a,t.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(c){Pt(t,t.return,c)}}else vn(i,t,e,s);break;case 31:vn(i,t,e,s);break;case 13:vn(i,t,e,s);break;case 23:break;case 22:r=t.stateNode,a=t.alternate,t.memoizedState!==null?r._visibility&2?vn(i,t,e,s):Xf(i,t):r._visibility&2?vn(i,t,e,s):(r._visibility|=2,yu(i,t,e,s,(t.subtreeFlags&10256)!==0||!1)),n&2048&&ES(a,t);break;case 24:vn(i,t,e,s),n&2048&&TS(t.alternate,t);break;default:vn(i,t,e,s)}}function yu(i,t,e,s,n){for(n=n&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var r=i,a=t,l=e,c=s,u=a.flags;switch(a.tag){case 0:case 11:case 15:yu(r,a,l,c,n),vp(8,a);break;case 23:break;case 22:var h=a.stateNode;a.memoizedState!==null?h._visibility&2?yu(r,a,l,c,n):Xf(r,a):(h._visibility|=2,yu(r,a,l,c,n)),n&&u&2048&&ES(a.alternate,a);break;case 24:yu(r,a,l,c,n),n&&u&2048&&TS(a.alternate,a);break;default:yu(r,a,l,c,n)}t=t.sibling}}function Xf(i,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var e=i,s=t,n=s.flags;switch(s.tag){case 22:Xf(e,s),n&2048&&ES(s.alternate,s);break;case 24:Xf(e,s),n&2048&&TS(s.alternate,s);break;default:Xf(e,s)}t=t.sibling}}var gf=8192;function cu(i,t,e){if(i.subtreeFlags&gf)for(i=i.child;i!==null;)o2(i,t,e),i=i.sibling}function o2(i,t,e){switch(i.tag){case 26:cu(i,t,e),i.flags&gf&&i.memoizedState!==null&&rj(e,Bn,i.memoizedState,i.memoizedProps);break;case 5:cu(i,t,e);break;case 3:case 4:var s=Bn;Bn=D0(i.stateNode.containerInfo),cu(i,t,e),Bn=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=gf,gf=16777216,cu(i,t,e),gf=s):cu(i,t,e));break;default:cu(i,t,e)}}function l2(i){var t=i.alternate;if(t!==null&&(i=t.child,i!==null)){t.child=null;do t=i.sibling,i.sibling=null,i=t;while(i!==null)}}function sf(i){var t=i.deletions;if(i.flags&16){if(t!==null)for(var e=0;e<t.length;e++){var s=t[e];ns=s,u2(s,i)}l2(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)c2(i),i=i.sibling}function c2(i){switch(i.tag){case 0:case 11:case 15:sf(i),i.flags&2048&&Zo(9,i,i.return);break;case 3:sf(i);break;case 12:sf(i);break;case 22:var t=i.stateNode;i.memoizedState!==null&&t._visibility&2&&(i.return===null||i.return.tag!==13)?(t._visibility&=-3,Sy(i)):sf(i);break;default:sf(i)}}function Sy(i){var t=i.deletions;if(i.flags&16){if(t!==null)for(var e=0;e<t.length;e++){var s=t[e];ns=s,u2(s,i)}l2(i)}for(i=i.child;i!==null;){switch(t=i,t.tag){case 0:case 11:case 15:Zo(8,t,t.return),Sy(t);break;case 22:e=t.stateNode,e._visibility&2&&(e._visibility&=-3,Sy(t));break;default:Sy(t)}i=i.sibling}}function u2(i,t){for(;ns!==null;){var e=ns;switch(e.tag){case 0:case 11:case 15:Zo(8,e,t);break;case 23:case 22:if(e.memoizedState!==null&&e.memoizedState.cachePool!==null){var s=e.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:yp(e.memoizedState.cache)}if(s=e.child,s!==null)s.return=e,ns=s;else t:for(e=i;ns!==null;){s=ns;var n=s.sibling,r=s.return;if(t2(s),s===e){ns=null;break t}if(n!==null){n.return=r,ns=n;break t}ns=r}}}var wD={getCacheForType:function(i){var t=vs(Be),e=t.data.get(i);return e===void 0&&(e=i(),t.data.set(i,e)),e},cacheSignal:function(){return vs(Be).controller.signal}},_D=typeof WeakMap=="function"?WeakMap:Map,Ot=0,Qt=null,yt=null,_t=0,Lt=0,Ri=null,Uo=!1,qd=!1,CS=!1,ka=0,Ee=0,tl=0,qc=0,RS=0,Li=0,Dd=0,Yf=null,ii=null,jw=!1,Pb=0,h2=0,T0=1/0,C0=null,Vo=null,Xe=0,Xo=null,jd=null,Aa=0,Lw=0,Pw=null,d2=null,Kf=0,Bw=null;function Ui(){return Ot&2&&_t!==0?_t&-_t:st.T!==null?kS():_T()}function f2(){if(Li===0)if(!(_t&536870912)||xt){var i=Pp;Pp<<=1,!(Pp&3932160)&&(Pp=262144),Li=i}else Li=536870912;return i=Hi.current,i!==null&&(i.flags|=32),Li}function ri(i,t,e){(i===Qt&&(Lt===2||Lt===9)||i.cancelPendingCommit!==null)&&(Ld(i,0),zo(i,_t,Li,!1)),gp(i,e),(!(Ot&2)||i!==Qt)&&(i===Qt&&(!(Ot&2)&&(qc|=e),Ee===4&&zo(i,_t,Li,!1)),Ar(i))}function g2(i,t,e){if(Ot&6)throw Error(M(327));var s=!e&&(t&127)===0&&(t&i.expiredLanes)===0||fp(i,t),n=s?xD(i,t):Ev(i,t,!0),r=s;do{if(n===0){qd&&!s&&zo(i,t,0,!1);break}else{if(e=i.current.alternate,r&&!AD(e)){n=Ev(i,t,!1),r=!1;continue}if(n===2){if(r=t,i.errorRecoveryDisabledLanes&r)var a=0;else a=i.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){t=a;t:{var l=i;n=Yf;var c=l.current.memoizedState.isDehydrated;if(c&&(Ld(l,a).flags|=256),a=Ev(l,a,!1),a!==2){if(CS&&!c){l.errorRecoveryDisabledLanes|=r,qc|=r,n=4;break t}r=ii,ii=n,r!==null&&(ii===null?ii=r:ii.push.apply(ii,r))}n=a}if(r=!1,n!==2)continue}}if(n===1){Ld(i,0),zo(i,t,0,!0);break}t:{switch(s=i,r=n,r){case 0:case 1:throw Error(M(345));case 4:if((t&4194048)!==t)break;case 6:zo(s,t,Li,!Uo);break t;case 2:ii=null;break;case 3:case 5:break;default:throw Error(M(329))}if((t&62914560)===t&&(n=Pb+300-Pi(),10<n)){if(zo(s,t,Li,!Uo),Eb(s,0,!0)!==0)break t;Aa=t,s.timeoutHandle=j2(d1.bind(null,s,e,ii,C0,jw,t,Li,qc,Dd,Uo,r,"Throttled",-0,0),n);break t}d1(s,e,ii,C0,jw,t,Li,qc,Dd,Uo,r,null,-0,0)}}break}while(!0);Ar(i)}function d1(i,t,e,s,n,r,a,l,c,u,h,d,f,g){if(i.timeoutHandle=-1,d=t.subtreeFlags,d&8192||(d&16785408)===16785408){d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ba},o2(t,r,d);var b=(r&62914560)===r?Pb-Pi():(r&4194048)===r?h2-Pi():0;if(b=aj(d,b),b!==null){Aa=r,i.cancelPendingCommit=b(g1.bind(null,i,t,r,e,s,n,a,l,c,h,d,null,f,g)),zo(i,r,a,!u);return}}g1(i,t,r,e,s,n,a,l,c)}function AD(i){for(var t=i;;){var e=t.tag;if((e===0||e===11||e===15)&&t.flags&16384&&(e=t.updateQueue,e!==null&&(e=e.stores,e!==null)))for(var s=0;s<e.length;s++){var n=e[s],r=n.getSnapshot;n=n.value;try{if(!Fi(r(),n))return!1}catch{return!1}}if(e=t.child,t.subtreeFlags&16384&&e!==null)e.return=t,t=e;else{if(t===i)break;for(;t.sibling===null;){if(t.return===null||t.return===i)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zo(i,t,e,s){t&=~RS,t&=~qc,i.suspendedLanes|=t,i.pingedLanes&=~t,s&&(i.warmLanes|=t),s=i.expirationTimes;for(var n=t;0<n;){var r=31-Ii(n),a=1<<r;s[r]=-1,n&=~a}e!==0&&bT(i,e,t)}function Bb(){return Ot&6?!0:(wp(0),!1)}function OS(){if(yt!==null){if(Lt===0)var i=yt.return;else i=yt,va=iu=null,gS(i),Qu=null,ag=0,i=yt;for(;i!==null;)XC(i.alternate,i),i=i.return;yt=null}}function Ld(i,t){var e=i.timeoutHandle;e!==-1&&(i.timeoutHandle=-1,HD(e)),e=i.cancelPendingCommit,e!==null&&(i.cancelPendingCommit=null,e()),Aa=0,OS(),Qt=i,yt=e=wa(i.current,null),_t=t,Lt=0,Ri=null,Uo=!1,qd=fp(i,t),CS=!1,Dd=Li=RS=qc=tl=Ee=0,ii=Yf=null,jw=!1,t&8&&(t|=t&32);var s=i.entangledLanes;if(s!==0)for(i=i.entanglements,s&=t;0<s;){var n=31-Ii(s),r=1<<n;t|=i[n],s&=~r}return ka=t,Ob(),e}function m2(i,t){ht=null,st.H=lg,t===$d||t===Nb?(t=qx(),Lt=3):t===oS?(t=qx(),Lt=4):Lt=t===SS?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ri=t,yt===null&&(Ee=1,S0(i,hn(t,i.current)))}function p2(){var i=Hi.current;return i===null?!0:(_t&4194048)===_t?gn===null:(_t&62914560)===_t||_t&536870912?i===gn:!1}function y2(){var i=st.H;return st.H=lg,i===null?lg:i}function b2(){var i=st.A;return st.A=wD,i}function R0(){Ee=4,Uo||(_t&4194048)!==_t&&Hi.current!==null||(qd=!0),!(tl&134217727)&&!(qc&134217727)||Qt===null||zo(Qt,_t,Li,!1)}function Ev(i,t,e){var s=Ot;Ot|=2;var n=y2(),r=b2();(Qt!==i||_t!==t)&&(C0=null,Ld(i,t)),t=!1;var a=Ee;t:do try{if(Lt!==0&&yt!==null){var l=yt,c=Ri;switch(Lt){case 8:OS(),a=6;break t;case 3:case 2:case 9:case 6:Hi.current===null&&(t=!0);var u=Lt;if(Lt=0,Ri=null,zu(i,l,c,u),e&&qd){a=0;break t}break;default:u=Lt,Lt=0,Ri=null,zu(i,l,c,u)}}SD(),a=Ee;break}catch(h){m2(i,h)}while(!0);return t&&i.shellSuspendCounter++,va=iu=null,Ot=s,st.H=n,st.A=r,yt===null&&(Qt=null,_t=0,Ob()),a}function SD(){for(;yt!==null;)v2(yt)}function xD(i,t){var e=Ot;Ot|=2;var s=y2(),n=b2();Qt!==i||_t!==t?(C0=null,T0=Pi()+500,Ld(i,t)):qd=fp(i,t);t:do try{if(Lt!==0&&yt!==null){t=yt;var r=Ri;e:switch(Lt){case 1:Lt=0,Ri=null,zu(i,t,r,1);break;case 2:case 9:if($x(r)){Lt=0,Ri=null,f1(t);break}t=function(){Lt!==2&&Lt!==9||Qt!==i||(Lt=7),Ar(i)},r.then(t,t);break t;case 3:Lt=7;break t;case 4:Lt=5;break t;case 7:$x(r)?(Lt=0,Ri=null,f1(t)):(Lt=0,Ri=null,zu(i,t,r,7));break;case 5:var a=null;switch(yt.tag){case 26:a=yt.memoizedState;case 5:case 27:var l=yt;if(a?U2(a):l.stateNode.complete){Lt=0,Ri=null;var c=l.sibling;if(c!==null)yt=c;else{var u=l.return;u!==null?(yt=u,Ib(u)):yt=null}break e}}Lt=0,Ri=null,zu(i,t,r,5);break;case 6:Lt=0,Ri=null,zu(i,t,r,6);break;case 8:OS(),Ee=6;break t;default:throw Error(M(462))}}ED();break}catch(h){m2(i,h)}while(!0);return va=iu=null,st.H=s,st.A=n,Ot=e,yt!==null?0:(Qt=null,_t=0,Ob(),Ee)}function ED(){for(;yt!==null&&!YN();)v2(yt)}function v2(i){var t=VC(i.alternate,i,ka);i.memoizedProps=i.pendingProps,t===null?Ib(i):yt=t}function f1(i){var t=i,e=t.alternate;switch(t.tag){case 15:case 0:t=a1(e,t,t.pendingProps,t.type,void 0,_t);break;case 11:t=a1(e,t,t.pendingProps,t.type.render,t.ref,_t);break;case 5:gS(t);default:XC(e,t),t=yt=XT(t,ka),t=VC(e,t,ka)}i.memoizedProps=i.pendingProps,t===null?Ib(i):yt=t}function zu(i,t,e,s){va=iu=null,gS(t),Qu=null,ag=0;var n=t.return;try{if(fD(i,n,t,e,_t)){Ee=1,S0(i,hn(e,i.current)),yt=null;return}}catch(r){if(n!==null)throw yt=n,r;Ee=1,S0(i,hn(e,i.current)),yt=null;return}t.flags&32768?(xt||s===1?i=!0:qd||_t&536870912?i=!1:(Uo=i=!0,(s===2||s===9||s===3||s===6)&&(s=Hi.current,s!==null&&s.tag===13&&(s.flags|=16384))),w2(t,i)):Ib(t)}function Ib(i){var t=i;do{if(t.flags&32768){w2(t,Uo);return}i=t.return;var e=pD(t.alternate,t,ka);if(e!==null){yt=e;return}if(t=t.sibling,t!==null){yt=t;return}yt=t=i}while(t!==null);Ee===0&&(Ee=5)}function w2(i,t){do{var e=yD(i.alternate,i);if(e!==null){e.flags&=32767,yt=e;return}if(e=i.return,e!==null&&(e.flags|=32768,e.subtreeFlags=0,e.deletions=null),!t&&(i=i.sibling,i!==null)){yt=i;return}yt=i=e}while(i!==null);Ee=6,yt=null}function g1(i,t,e,s,n,r,a,l,c){i.cancelPendingCommit=null;do Ub();while(Xe!==0);if(Ot&6)throw Error(M(327));if(t!==null){if(t===i.current)throw Error(M(177));if(r=t.lanes|t.childLanes,r|=tS,nM(i,e,r,a,l,c),i===Qt&&(yt=Qt=null,_t=0),jd=t,Xo=i,Aa=e,Lw=r,Pw=n,d2=s,t.subtreeFlags&10256||t.flags&10256?(i.callbackNode=null,i.callbackPriority=0,OD(d0,function(){return E2(),null})):(i.callbackNode=null,i.callbackPriority=0),s=(t.flags&13878)!==0,t.subtreeFlags&13878||s){s=st.T,st.T=null,n=kt.p,kt.p=2,a=Ot,Ot|=4;try{bD(i,t,e)}finally{Ot=a,kt.p=n,st.T=s}}Xe=1,_2(),A2(),S2()}}function _2(){if(Xe===1){Xe=0;var i=Xo,t=jd,e=(t.flags&13878)!==0;if(t.subtreeFlags&13878||e){e=st.T,st.T=null;var s=kt.p;kt.p=2;var n=Ot;Ot|=4;try{n2(t,i);var r=Fw,a=UT(i.containerInfo),l=r.focusedElem,c=r.selectionRange;if(a!==l&&l&&l.ownerDocument&&IT(l.ownerDocument.documentElement,l)){if(c!==null&&ZA(l)){var u=c.start,h=c.end;if(h===void 0&&(h=u),"selectionStart"in l)l.selectionStart=u,l.selectionEnd=Math.min(h,l.value.length);else{var d=l.ownerDocument||document,f=d&&d.defaultView||window;if(f.getSelection){var g=f.getSelection(),b=l.textContent.length,v=Math.min(c.start,b),S=c.end===void 0?v:Math.min(c.end,b);!g.extend&&v>S&&(a=S,S=v,v=a);var p=Px(l,v),w=Px(l,S);if(p&&w&&(g.rangeCount!==1||g.anchorNode!==p.node||g.anchorOffset!==p.offset||g.focusNode!==w.node||g.focusOffset!==w.offset)){var y=d.createRange();y.setStart(p.node,p.offset),g.removeAllRanges(),v>S?(g.addRange(y),g.extend(w.node,w.offset)):(y.setEnd(w.node,w.offset),g.addRange(y))}}}}for(d=[],g=l;g=g.parentNode;)g.nodeType===1&&d.push({element:g,left:g.scrollLeft,top:g.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<d.length;l++){var E=d[l];E.element.scrollLeft=E.left,E.element.scrollTop=E.top}}P0=!!zw,Fw=zw=null}finally{Ot=n,kt.p=s,st.T=e}}i.current=t,Xe=2}}function A2(){if(Xe===2){Xe=0;var i=Xo,t=jd,e=(t.flags&8772)!==0;if(t.subtreeFlags&8772||e){e=st.T,st.T=null;var s=kt.p;kt.p=2;var n=Ot;Ot|=4;try{ZC(i,t.alternate,t)}finally{Ot=n,kt.p=s,st.T=e}}Xe=3}}function S2(){if(Xe===4||Xe===3){Xe=0,KN();var i=Xo,t=jd,e=Aa,s=d2;t.subtreeFlags&10256||t.flags&10256?Xe=5:(Xe=0,jd=Xo=null,x2(i,i.pendingLanes));var n=i.pendingLanes;if(n===0&&(Vo=null),VA(e),t=t.stateNode,Bi&&typeof Bi.onCommitFiberRoot=="function")try{Bi.onCommitFiberRoot(dp,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=st.T,n=kt.p,kt.p=2,st.T=null;try{for(var r=i.onRecoverableError,a=0;a<s.length;a++){var l=s[a];r(l.value,{componentStack:l.stack})}}finally{st.T=t,kt.p=n}}Aa&3&&Ub(),Ar(i),n=i.pendingLanes,e&261930&&n&42?i===Bw?Kf++:(Kf=0,Bw=i):Kf=0,wp(0)}}function x2(i,t){(i.pooledCacheLanes&=t)===0&&(t=i.pooledCache,t!=null&&(i.pooledCache=null,yp(t)))}function Ub(){return _2(),A2(),S2(),E2()}function E2(){if(Xe!==5)return!1;var i=Xo,t=Lw;Lw=0;var e=VA(Aa),s=st.T,n=kt.p;try{kt.p=32>e?32:e,st.T=null,e=Pw,Pw=null;var r=Xo,a=Aa;if(Xe=0,jd=Xo=null,Aa=0,Ot&6)throw Error(M(331));var l=Ot;if(Ot|=4,c2(r.current),a2(r,r.current,a,e),Ot=l,wp(0,!1),Bi&&typeof Bi.onPostCommitFiberRoot=="function")try{Bi.onPostCommitFiberRoot(dp,r)}catch{}return!0}finally{kt.p=n,st.T=s,x2(i,t)}}function m1(i,t,e){t=hn(e,t),t=kw(i.stateNode,t,2),i=Go(i,t,2),i!==null&&(gp(i,2),Ar(i))}function Pt(i,t,e){if(i.tag===3)m1(i,i,e);else for(;t!==null;){if(t.tag===3){m1(t,i,e);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Vo===null||!Vo.has(s))){i=hn(e,i),e=zC(2),s=Go(t,e,2),s!==null&&(FC(e,s,t,i),gp(s,2),Ar(s));break}}t=t.return}}function Tv(i,t,e){var s=i.pingCache;if(s===null){s=i.pingCache=new _D;var n=new Set;s.set(t,n)}else n=s.get(t),n===void 0&&(n=new Set,s.set(t,n));n.has(e)||(CS=!0,n.add(e),i=TD.bind(null,i,t,e),t.then(i,i))}function TD(i,t,e){var s=i.pingCache;s!==null&&s.delete(t),i.pingedLanes|=i.suspendedLanes&e,i.warmLanes&=~e,Qt===i&&(_t&e)===e&&(Ee===4||Ee===3&&(_t&62914560)===_t&&300>Pi()-Pb?!(Ot&2)&&Ld(i,0):RS|=e,Dd===_t&&(Dd=0)),Ar(i)}function T2(i,t){t===0&&(t=yT()),i=su(i,t),i!==null&&(gp(i,t),Ar(i))}function CD(i){var t=i.memoizedState,e=0;t!==null&&(e=t.retryLane),T2(i,e)}function RD(i,t){var e=0;switch(i.tag){case 31:case 13:var s=i.stateNode,n=i.memoizedState;n!==null&&(e=n.retryLane);break;case 19:s=i.stateNode;break;case 22:s=i.stateNode._retryCache;break;default:throw Error(M(314))}s!==null&&s.delete(t),T2(i,e)}function OD(i,t){return qA(i,t)}var O0=null,bu=null,Iw=!1,k0=!1,Cv=!1,Fo=0;function Ar(i){i!==bu&&i.next===null&&(bu===null?O0=bu=i:bu=bu.next=i),k0=!0,Iw||(Iw=!0,ND())}function wp(i,t){if(!Cv&&k0){Cv=!0;do for(var e=!1,s=O0;s!==null;){if(i!==0){var n=s.pendingLanes;if(n===0)var r=0;else{var a=s.suspendedLanes,l=s.pingedLanes;r=(1<<31-Ii(42|i)+1)-1,r&=n&~(a&~l),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(e=!0,p1(s,r))}else r=_t,r=Eb(s,s===Qt?r:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),!(r&3)||fp(s,r)||(e=!0,p1(s,r));s=s.next}while(e);Cv=!1}}function kD(){C2()}function C2(){k0=Iw=!1;var i=0;Fo!==0&&FD()&&(i=Fo);for(var t=Pi(),e=null,s=O0;s!==null;){var n=s.next,r=R2(s,t);r===0?(s.next=null,e===null?O0=n:e.next=n,n===null&&(bu=e)):(e=s,(i!==0||r&3)&&(k0=!0)),s=n}Xe!==0&&Xe!==5||wp(i),Fo!==0&&(Fo=0)}function R2(i,t){for(var e=i.suspendedLanes,s=i.pingedLanes,n=i.expirationTimes,r=i.pendingLanes&-62914561;0<r;){var a=31-Ii(r),l=1<<a,c=n[a];c===-1?(!(l&e)||l&s)&&(n[a]=iM(l,t)):c<=t&&(i.expiredLanes|=l),r&=~l}if(t=Qt,e=_t,e=Eb(i,i===t?e:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),s=i.callbackNode,e===0||i===t&&(Lt===2||Lt===9)||i.cancelPendingCommit!==null)return s!==null&&s!==null&&ev(s),i.callbackNode=null,i.callbackPriority=0;if(!(e&3)||fp(i,e)){if(t=e&-e,t===i.callbackPriority)return t;switch(s!==null&&ev(s),VA(e)){case 2:case 8:e=mT;break;case 32:e=d0;break;case 268435456:e=pT;break;default:e=d0}return s=O2.bind(null,i),e=qA(e,s),i.callbackPriority=t,i.callbackNode=e,t}return s!==null&&s!==null&&ev(s),i.callbackPriority=2,i.callbackNode=null,2}function O2(i,t){if(Xe!==0&&Xe!==5)return i.callbackNode=null,i.callbackPriority=0,null;var e=i.callbackNode;if(Ub()&&i.callbackNode!==e)return null;var s=_t;return s=Eb(i,i===Qt?s:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),s===0?null:(g2(i,s,t),R2(i,Pi()),i.callbackNode!=null&&i.callbackNode===e?O2.bind(null,i):null)}function p1(i,t){if(Ub())return null;g2(i,t,!0)}function ND(){$D(function(){Ot&6?qA(gT,kD):C2()})}function kS(){if(Fo===0){var i=kd;i===0&&(i=Lp,Lp<<=1,!(Lp&261888)&&(Lp=256)),Fo=i}return Fo}function y1(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:gy(""+i)}function b1(i,t){var e=t.ownerDocument.createElement("input");return e.name=t.name,e.value=t.value,i.id&&e.setAttribute("form",i.id),t.parentNode.insertBefore(e,t),i=new FormData(i),e.parentNode.removeChild(e),i}function MD(i,t,e,s,n){if(t==="submit"&&e&&e.stateNode===n){var r=y1((n[ai]||null).action),a=s.submitter;a&&(t=(t=a[ai]||null)?y1(t.formAction):a.getAttribute("formAction"),t!==null&&(r=t,a=null));var l=new Tb("action","action",null,s,n);i.push({event:l,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(Fo!==0){var c=a?b1(n,a):new FormData(n);Rw(e,{pending:!0,data:c,method:n.method,action:r},null,c)}}else typeof r=="function"&&(l.preventDefault(),c=a?b1(n,a):new FormData(n),Rw(e,{pending:!0,data:c,method:n.method,action:r},r,c))},currentTarget:n}]})}}for(var Rv=0;Rv<pw.length;Rv++){var Ov=pw[Rv],DD=Ov.toLowerCase(),jD=Ov[0].toUpperCase()+Ov.slice(1);Fn(DD,"on"+jD)}Fn(FT,"onAnimationEnd");Fn(HT,"onAnimationIteration");Fn($T,"onAnimationStart");Fn("dblclick","onDoubleClick");Fn("focusin","onFocus");Fn("focusout","onBlur");Fn(WM,"onTransitionRun");Fn(QM,"onTransitionStart");Fn(JM,"onTransitionCancel");Fn(qT,"onTransitionEnd");Rd("onMouseEnter",["mouseout","mouseover"]);Rd("onMouseLeave",["mouseout","mouseover"]);Rd("onPointerEnter",["pointerout","pointerover"]);Rd("onPointerLeave",["pointerout","pointerover"]);Zc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cg));function k2(i,t){t=(t&4)!==0;for(var e=0;e<i.length;e++){var s=i[e],n=s.event;s=s.listeners;t:{var r=void 0;if(t)for(var a=s.length-1;0<=a;a--){var l=s[a],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==r&&n.isPropagationStopped())break t;r=l,n.currentTarget=u;try{r(n)}catch(h){g0(h)}n.currentTarget=null,r=c}else for(a=0;a<s.length;a++){if(l=s[a],c=l.instance,u=l.currentTarget,l=l.listener,c!==r&&n.isPropagationStopped())break t;r=l,n.currentTarget=u;try{r(n)}catch(h){g0(h)}n.currentTarget=null,r=c}}}}function pt(i,t){var e=t[lw];e===void 0&&(e=t[lw]=new Set);var s=i+"__bubble";e.has(s)||(N2(t,i,2,!1),e.add(s))}function kv(i,t,e){var s=0;t&&(s|=4),N2(e,i,s,t)}var Gp="_reactListening"+Math.random().toString(36).slice(2);function NS(i){if(!i[Gp]){i[Gp]=!0,AT.forEach(function(e){e!=="selectionchange"&&(LD.has(e)||kv(e,!1,i),kv(e,!0,i))});var t=i.nodeType===9?i:i.ownerDocument;t===null||t[Gp]||(t[Gp]=!0,kv("selectionchange",!1,t))}}function N2(i,t,e,s){switch(q2(t)){case 2:var n=cj;break;case 8:n=uj;break;default:n=LS}e=n.bind(null,t,e,i),n=void 0,!fw||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),s?n!==void 0?i.addEventListener(t,e,{capture:!0,passive:n}):i.addEventListener(t,e,!0):n!==void 0?i.addEventListener(t,e,{passive:n}):i.addEventListener(t,e,!1)}function Nv(i,t,e,s,n){var r=s;if(!(t&1)&&!(t&2)&&s!==null)t:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var l=s.stateNode.containerInfo;if(l===n)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&a.stateNode.containerInfo===n)return;a=a.return}for(;l!==null;){if(a=Nu(l),a===null)return;if(c=a.tag,c===5||c===6||c===26||c===27){s=r=a;continue t}l=l.parentNode}}s=s.return}kT(function(){var u=r,h=KA(e),d=[];t:{var f=GT.get(i);if(f!==void 0){var g=Tb,b=i;switch(i){case"keypress":if(py(e)===0)break t;case"keydown":case"keyup":g=RM;break;case"focusin":b="focus",g=av;break;case"focusout":b="blur",g=av;break;case"beforeblur":case"afterblur":g=av;break;case"click":if(e.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Tx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=pM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=NM;break;case FT:case HT:case $T:g=vM;break;case qT:g=DM;break;case"scroll":case"scrollend":g=gM;break;case"wheel":g=LM;break;case"copy":case"cut":case"paste":g=_M;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Rx;break;case"toggle":case"beforetoggle":g=BM}var v=(t&4)!==0,S=!v&&(i==="scroll"||i==="scrollend"),p=v?f!==null?f+"Capture":null:f;v=[];for(var w=u,y;w!==null;){var E=w;if(y=E.stateNode,E=E.tag,E!==5&&E!==26&&E!==27||y===null||p===null||(E=eg(w,p),E!=null&&v.push(ug(w,E,y))),S)break;w=w.return}0<v.length&&(f=new g(f,b,null,e,h),d.push({event:f,listeners:v}))}}if(!(t&7)){t:{if(f=i==="mouseover"||i==="pointerover",g=i==="mouseout"||i==="pointerout",f&&e!==dw&&(b=e.relatedTarget||e.fromElement)&&(Nu(b)||b[zd]))break t;if((g||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,g?(b=e.relatedTarget||e.toElement,g=u,b=b?Nu(b):null,b!==null&&(S=hp(b),v=b.tag,b!==S||v!==5&&v!==27&&v!==6)&&(b=null)):(g=null,b=u),g!==b)){if(v=Tx,E="onMouseLeave",p="onMouseEnter",w="mouse",(i==="pointerout"||i==="pointerover")&&(v=Rx,E="onPointerLeave",p="onPointerEnter",w="pointer"),S=g==null?f:df(g),y=b==null?f:df(b),f=new v(E,w+"leave",g,e,h),f.target=S,f.relatedTarget=y,E=null,Nu(h)===u&&(v=new v(p,w+"enter",b,e,h),v.target=y,v.relatedTarget=S,E=v),S=E,g&&b)e:{for(v=PD,p=g,w=b,y=0,E=p;E;E=v(E))y++;E=0;for(var T=w;T;T=v(T))E++;for(;0<y-E;)p=v(p),y--;for(;0<E-y;)w=v(w),E--;for(;y--;){if(p===w||w!==null&&p===w.alternate){v=p;break e}p=v(p),w=v(w)}v=null}else v=null;g!==null&&v1(d,f,g,v,!1),b!==null&&S!==null&&v1(d,S,b,v,!0)}}t:{if(f=u?df(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var C=Mx;else if(Nx(f))if(PT)C=XM;else{C=GM;var R=qM}else g=f.nodeName,!g||g.toLowerCase()!=="input"||f.type!=="checkbox"&&f.type!=="radio"?u&&YA(u.elementType)&&(C=Mx):C=VM;if(C&&(C=C(i,u))){LT(d,C,e,h);break t}R&&R(i,f,u),i==="focusout"&&u&&f.type==="number"&&u.memoizedProps.value!=null&&hw(f,"number",f.value)}switch(R=u?df(u):window,i){case"focusin":(Nx(R)||R.contentEditable==="true")&&(ju=R,gw=u,zf=null);break;case"focusout":zf=gw=ju=null;break;case"mousedown":mw=!0;break;case"contextmenu":case"mouseup":case"dragend":mw=!1,Bx(d,e,h);break;case"selectionchange":if(KM)break;case"keydown":case"keyup":Bx(d,e,h)}var O;if(JA)t:{switch(i){case"compositionstart":var k="onCompositionStart";break t;case"compositionend":k="onCompositionEnd";break t;case"compositionupdate":k="onCompositionUpdate";break t}k=void 0}else Du?DT(i,e)&&(k="onCompositionEnd"):i==="keydown"&&e.keyCode===229&&(k="onCompositionStart");k&&(MT&&e.locale!=="ko"&&(Du||k!=="onCompositionStart"?k==="onCompositionEnd"&&Du&&(O=NT()):(Io=h,WA="value"in Io?Io.value:Io.textContent,Du=!0)),R=N0(u,k),0<R.length&&(k=new Cx(k,i,null,e,h),d.push({event:k,listeners:R}),O?k.data=O:(O=jT(e),O!==null&&(k.data=O)))),(O=UM?zM(i,e):FM(i,e))&&(k=N0(u,"onBeforeInput"),0<k.length&&(R=new Cx("onBeforeInput","beforeinput",null,e,h),d.push({event:R,listeners:k}),R.data=O)),MD(d,i,u,e,h)}k2(d,t)})}function ug(i,t,e){return{instance:i,listener:t,currentTarget:e}}function N0(i,t){for(var e=t+"Capture",s=[];i!==null;){var n=i,r=n.stateNode;if(n=n.tag,n!==5&&n!==26&&n!==27||r===null||(n=eg(i,e),n!=null&&s.unshift(ug(i,n,r)),n=eg(i,t),n!=null&&s.push(ug(i,n,r))),i.tag===3)return s;i=i.return}return[]}function PD(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function v1(i,t,e,s,n){for(var r=t._reactName,a=[];e!==null&&e!==s;){var l=e,c=l.alternate,u=l.stateNode;if(l=l.tag,c!==null&&c===s)break;l!==5&&l!==26&&l!==27||u===null||(c=u,n?(u=eg(e,r),u!=null&&a.unshift(ug(e,u,c))):n||(u=eg(e,r),u!=null&&a.push(ug(e,u,c)))),e=e.return}a.length!==0&&i.push({event:t,listeners:a})}var BD=/\r\n?/g,ID=/\u0000|\uFFFD/g;function w1(i){return(typeof i=="string"?i:""+i).replace(BD,`
`).replace(ID,"")}function M2(i,t){return t=w1(t),w1(i)===t}function qt(i,t,e,s,n,r){switch(e){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||Od(i,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&Od(i,""+s);break;case"className":Ip(i,"class",s);break;case"tabIndex":Ip(i,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":Ip(i,e,s);break;case"style":OT(i,s,r);break;case"data":if(t!=="object"){Ip(i,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||e!=="href")){i.removeAttribute(e);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){i.removeAttribute(e);break}s=gy(""+s),i.setAttribute(e,s);break;case"action":case"formAction":if(typeof s=="function"){i.setAttribute(e,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(e==="formAction"?(t!=="input"&&qt(i,t,"name",n.name,n,null),qt(i,t,"formEncType",n.formEncType,n,null),qt(i,t,"formMethod",n.formMethod,n,null),qt(i,t,"formTarget",n.formTarget,n,null)):(qt(i,t,"encType",n.encType,n,null),qt(i,t,"method",n.method,n,null),qt(i,t,"target",n.target,n,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){i.removeAttribute(e);break}s=gy(""+s),i.setAttribute(e,s);break;case"onClick":s!=null&&(i.onclick=ba);break;case"onScroll":s!=null&&pt("scroll",i);break;case"onScrollEnd":s!=null&&pt("scrollend",i);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(M(61));if(e=s.__html,e!=null){if(n.children!=null)throw Error(M(60));i.innerHTML=e}}break;case"multiple":i.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":i.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){i.removeAttribute("xlink:href");break}e=gy(""+s),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?i.setAttribute(e,""+s):i.removeAttribute(e);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?i.setAttribute(e,""):i.removeAttribute(e);break;case"capture":case"download":s===!0?i.setAttribute(e,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?i.setAttribute(e,s):i.removeAttribute(e);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?i.setAttribute(e,s):i.removeAttribute(e);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?i.removeAttribute(e):i.setAttribute(e,s);break;case"popover":pt("beforetoggle",i),pt("toggle",i),fy(i,"popover",s);break;case"xlinkActuate":Sr(i,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":Sr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":Sr(i,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":Sr(i,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":Sr(i,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":Sr(i,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":Sr(i,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":Sr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":Sr(i,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":fy(i,"is",s);break;case"innerText":case"textContent":break;default:(!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(e=dM.get(e)||e,fy(i,e,s))}}function Uw(i,t,e,s,n,r){switch(e){case"style":OT(i,s,r);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(M(61));if(e=s.__html,e!=null){if(n.children!=null)throw Error(M(60));i.innerHTML=e}}break;case"children":typeof s=="string"?Od(i,s):(typeof s=="number"||typeof s=="bigint")&&Od(i,""+s);break;case"onScroll":s!=null&&pt("scroll",i);break;case"onScrollEnd":s!=null&&pt("scrollend",i);break;case"onClick":s!=null&&(i.onclick=ba);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ST.hasOwnProperty(e))t:{if(e[0]==="o"&&e[1]==="n"&&(n=e.endsWith("Capture"),t=e.slice(2,n?e.length-7:void 0),r=i[ai]||null,r=r!=null?r[e]:null,typeof r=="function"&&i.removeEventListener(t,r,n),typeof s=="function")){typeof r!="function"&&r!==null&&(e in i?i[e]=null:i.hasAttribute(e)&&i.removeAttribute(e)),i.addEventListener(t,s,n);break t}e in i?i[e]=s:s===!0?i.setAttribute(e,""):fy(i,e,s)}}}function ws(i,t,e){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pt("error",i),pt("load",i);var s=!1,n=!1,r;for(r in e)if(e.hasOwnProperty(r)){var a=e[r];if(a!=null)switch(r){case"src":s=!0;break;case"srcSet":n=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(M(137,t));default:qt(i,t,r,a,e,null)}}n&&qt(i,t,"srcSet",e.srcSet,e,null),s&&qt(i,t,"src",e.src,e,null);return;case"input":pt("invalid",i);var l=r=a=n=null,c=null,u=null;for(s in e)if(e.hasOwnProperty(s)){var h=e[s];if(h!=null)switch(s){case"name":n=h;break;case"type":a=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(M(137,t));break;default:qt(i,t,s,h,e,null)}}TT(i,r,l,c,u,a,n,!1);return;case"select":pt("invalid",i),s=a=r=null;for(n in e)if(e.hasOwnProperty(n)&&(l=e[n],l!=null))switch(n){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":s=l;default:qt(i,t,n,l,e,null)}t=r,e=a,i.multiple=!!s,t!=null?Yu(i,!!s,t,!1):e!=null&&Yu(i,!!s,e,!0);return;case"textarea":pt("invalid",i),r=n=s=null;for(a in e)if(e.hasOwnProperty(a)&&(l=e[a],l!=null))switch(a){case"value":s=l;break;case"defaultValue":n=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(l!=null)throw Error(M(91));break;default:qt(i,t,a,l,e,null)}RT(i,s,n,r);return;case"option":for(c in e)if(e.hasOwnProperty(c)&&(s=e[c],s!=null))switch(c){case"selected":i.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:qt(i,t,c,s,e,null)}return;case"dialog":pt("beforetoggle",i),pt("toggle",i),pt("cancel",i),pt("close",i);break;case"iframe":case"object":pt("load",i);break;case"video":case"audio":for(s=0;s<cg.length;s++)pt(cg[s],i);break;case"image":pt("error",i),pt("load",i);break;case"details":pt("toggle",i);break;case"embed":case"source":case"link":pt("error",i),pt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in e)if(e.hasOwnProperty(u)&&(s=e[u],s!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(M(137,t));default:qt(i,t,u,s,e,null)}return;default:if(YA(t)){for(h in e)e.hasOwnProperty(h)&&(s=e[h],s!==void 0&&Uw(i,t,h,s,e,void 0));return}}for(l in e)e.hasOwnProperty(l)&&(s=e[l],s!=null&&qt(i,t,l,s,e,null))}function UD(i,t,e,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,r=null,a=null,l=null,c=null,u=null,h=null;for(g in e){var d=e[g];if(e.hasOwnProperty(g)&&d!=null)switch(g){case"checked":break;case"value":break;case"defaultValue":c=d;default:s.hasOwnProperty(g)||qt(i,t,g,null,s,d)}}for(var f in s){var g=s[f];if(d=e[f],s.hasOwnProperty(f)&&(g!=null||d!=null))switch(f){case"type":r=g;break;case"name":n=g;break;case"checked":u=g;break;case"defaultChecked":h=g;break;case"value":a=g;break;case"defaultValue":l=g;break;case"children":case"dangerouslySetInnerHTML":if(g!=null)throw Error(M(137,t));break;default:g!==d&&qt(i,t,f,g,s,d)}}uw(i,a,l,c,u,h,r,n);return;case"select":g=a=l=f=null;for(r in e)if(c=e[r],e.hasOwnProperty(r)&&c!=null)switch(r){case"value":break;case"multiple":g=c;default:s.hasOwnProperty(r)||qt(i,t,r,null,s,c)}for(n in s)if(r=s[n],c=e[n],s.hasOwnProperty(n)&&(r!=null||c!=null))switch(n){case"value":f=r;break;case"defaultValue":l=r;break;case"multiple":a=r;default:r!==c&&qt(i,t,n,r,s,c)}t=l,e=a,s=g,f!=null?Yu(i,!!e,f,!1):!!s!=!!e&&(t!=null?Yu(i,!!e,t,!0):Yu(i,!!e,e?[]:"",!1));return;case"textarea":g=f=null;for(l in e)if(n=e[l],e.hasOwnProperty(l)&&n!=null&&!s.hasOwnProperty(l))switch(l){case"value":break;case"children":break;default:qt(i,t,l,null,s,n)}for(a in s)if(n=s[a],r=e[a],s.hasOwnProperty(a)&&(n!=null||r!=null))switch(a){case"value":f=n;break;case"defaultValue":g=n;break;case"children":break;case"dangerouslySetInnerHTML":if(n!=null)throw Error(M(91));break;default:n!==r&&qt(i,t,a,n,s,r)}CT(i,f,g);return;case"option":for(var b in e)if(f=e[b],e.hasOwnProperty(b)&&f!=null&&!s.hasOwnProperty(b))switch(b){case"selected":i.selected=!1;break;default:qt(i,t,b,null,s,f)}for(c in s)if(f=s[c],g=e[c],s.hasOwnProperty(c)&&f!==g&&(f!=null||g!=null))switch(c){case"selected":i.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:qt(i,t,c,f,s,g)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var v in e)f=e[v],e.hasOwnProperty(v)&&f!=null&&!s.hasOwnProperty(v)&&qt(i,t,v,null,s,f);for(u in s)if(f=s[u],g=e[u],s.hasOwnProperty(u)&&f!==g&&(f!=null||g!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(M(137,t));break;default:qt(i,t,u,f,s,g)}return;default:if(YA(t)){for(var S in e)f=e[S],e.hasOwnProperty(S)&&f!==void 0&&!s.hasOwnProperty(S)&&Uw(i,t,S,void 0,s,f);for(h in s)f=s[h],g=e[h],!s.hasOwnProperty(h)||f===g||f===void 0&&g===void 0||Uw(i,t,h,f,s,g);return}}for(var p in e)f=e[p],e.hasOwnProperty(p)&&f!=null&&!s.hasOwnProperty(p)&&qt(i,t,p,null,s,f);for(d in s)f=s[d],g=e[d],!s.hasOwnProperty(d)||f===g||f==null&&g==null||qt(i,t,d,f,s,g)}function _1(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function zD(){if(typeof performance.getEntriesByType=="function"){for(var i=0,t=0,e=performance.getEntriesByType("resource"),s=0;s<e.length;s++){var n=e[s],r=n.transferSize,a=n.initiatorType,l=n.duration;if(r&&l&&_1(a)){for(a=0,l=n.responseEnd,s+=1;s<e.length;s++){var c=e[s],u=c.startTime;if(u>l)break;var h=c.transferSize,d=c.initiatorType;h&&_1(d)&&(c=c.responseEnd,a+=h*(c<l?1:(l-u)/(c-u)))}if(--s,t+=8*(r+a)/(n.duration/1e3),i++,10<i)break}}if(0<i)return t/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var zw=null,Fw=null;function M0(i){return i.nodeType===9?i:i.ownerDocument}function A1(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function D2(i,t){if(i===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&t==="foreignObject"?0:i}function Hw(i,t){return i==="textarea"||i==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Mv=null;function FD(){var i=window.event;return i&&i.type==="popstate"?i===Mv?!1:(Mv=i,!0):(Mv=null,!1)}var j2=typeof setTimeout=="function"?setTimeout:void 0,HD=typeof clearTimeout=="function"?clearTimeout:void 0,S1=typeof Promise=="function"?Promise:void 0,$D=typeof queueMicrotask=="function"?queueMicrotask:typeof S1<"u"?function(i){return S1.resolve(null).then(i).catch(qD)}:j2;function qD(i){setTimeout(function(){throw i})}function rl(i){return i==="head"}function x1(i,t){var e=t,s=0;do{var n=e.nextSibling;if(i.removeChild(e),n&&n.nodeType===8)if(e=n.data,e==="/$"||e==="/&"){if(s===0){i.removeChild(n),Bd(t);return}s--}else if(e==="$"||e==="$?"||e==="$~"||e==="$!"||e==="&")s++;else if(e==="html")Wf(i.ownerDocument.documentElement);else if(e==="head"){e=i.ownerDocument.head,Wf(e);for(var r=e.firstChild;r;){var a=r.nextSibling,l=r.nodeName;r[mp]||l==="SCRIPT"||l==="STYLE"||l==="LINK"&&r.rel.toLowerCase()==="stylesheet"||e.removeChild(r),r=a}}else e==="body"&&Wf(i.ownerDocument.body);e=n}while(e);Bd(t)}function E1(i,t){var e=i;i=0;do{var s=e.nextSibling;if(e.nodeType===1?t?(e._stashedDisplay=e.style.display,e.style.display="none"):(e.style.display=e._stashedDisplay||"",e.getAttribute("style")===""&&e.removeAttribute("style")):e.nodeType===3&&(t?(e._stashedText=e.nodeValue,e.nodeValue=""):e.nodeValue=e._stashedText||""),s&&s.nodeType===8)if(e=s.data,e==="/$"){if(i===0)break;i--}else e!=="$"&&e!=="$?"&&e!=="$~"&&e!=="$!"||i++;e=s}while(e)}function $w(i){var t=i.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var e=t;switch(t=t.nextSibling,e.nodeName){case"HTML":case"HEAD":case"BODY":$w(e),XA(e);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(e.rel.toLowerCase()==="stylesheet")continue}i.removeChild(e)}}function GD(i,t,e,s){for(;i.nodeType===1;){var n=e;if(i.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(s){if(!i[mp])switch(t){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(r=i.getAttribute("rel"),r==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(r!==n.rel||i.getAttribute("href")!==(n.href==null||n.href===""?null:n.href)||i.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin)||i.getAttribute("title")!==(n.title==null?null:n.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(r=i.getAttribute("src"),(r!==(n.src==null?null:n.src)||i.getAttribute("type")!==(n.type==null?null:n.type)||i.getAttribute("crossorigin")!==(n.crossOrigin==null?null:n.crossOrigin))&&r&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(t==="input"&&i.type==="hidden"){var r=n.name==null?null:""+n.name;if(n.type==="hidden"&&i.getAttribute("name")===r)return i}else return i;if(i=mn(i.nextSibling),i===null)break}return null}function VD(i,t,e){if(t==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!e||(i=mn(i.nextSibling),i===null))return null;return i}function L2(i,t){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!t||(i=mn(i.nextSibling),i===null))return null;return i}function qw(i){return i.data==="$?"||i.data==="$~"}function Gw(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function XD(i,t){var e=i.ownerDocument;if(i.data==="$~")i._reactRetry=t;else if(i.data!=="$?"||e.readyState!=="loading")t();else{var s=function(){t(),e.removeEventListener("DOMContentLoaded",s)};e.addEventListener("DOMContentLoaded",s),i._reactRetry=s}}function mn(i){for(;i!=null;i=i.nextSibling){var t=i.nodeType;if(t===1||t===3)break;if(t===8){if(t=i.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return i}var Vw=null;function T1(i){i=i.nextSibling;for(var t=0;i;){if(i.nodeType===8){var e=i.data;if(e==="/$"||e==="/&"){if(t===0)return mn(i.nextSibling);t--}else e!=="$"&&e!=="$!"&&e!=="$?"&&e!=="$~"&&e!=="&"||t++}i=i.nextSibling}return null}function C1(i){i=i.previousSibling;for(var t=0;i;){if(i.nodeType===8){var e=i.data;if(e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"){if(t===0)return i;t--}else e!=="/$"&&e!=="/&"||t++}i=i.previousSibling}return null}function P2(i,t,e){switch(t=M0(e),i){case"html":if(i=t.documentElement,!i)throw Error(M(452));return i;case"head":if(i=t.head,!i)throw Error(M(453));return i;case"body":if(i=t.body,!i)throw Error(M(454));return i;default:throw Error(M(451))}}function Wf(i){for(var t=i.attributes;t.length;)i.removeAttributeNode(t[0]);XA(i)}var yn=new Map,R1=new Set;function D0(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Da=kt.d;kt.d={f:YD,r:KD,D:WD,C:QD,L:JD,m:ZD,X:ej,S:tj,M:sj};function YD(){var i=Da.f(),t=Bb();return i||t}function KD(i){var t=Fd(i);t!==null&&t.tag===5&&t.type==="form"?OC(t):Da.r(i)}var Gd=typeof document>"u"?null:document;function B2(i,t,e){var s=Gd;if(s&&typeof t=="string"&&t){var n=un(t);n='link[rel="'+i+'"][href="'+n+'"]',typeof e=="string"&&(n+='[crossorigin="'+e+'"]'),R1.has(n)||(R1.add(n),i={rel:i,crossOrigin:e,href:t},s.querySelector(n)===null&&(t=s.createElement("link"),ws(t,"link",i),rs(t),s.head.appendChild(t)))}}function WD(i){Da.D(i),B2("dns-prefetch",i,null)}function QD(i,t){Da.C(i,t),B2("preconnect",i,t)}function JD(i,t,e){Da.L(i,t,e);var s=Gd;if(s&&i&&t){var n='link[rel="preload"][as="'+un(t)+'"]';t==="image"&&e&&e.imageSrcSet?(n+='[imagesrcset="'+un(e.imageSrcSet)+'"]',typeof e.imageSizes=="string"&&(n+='[imagesizes="'+un(e.imageSizes)+'"]')):n+='[href="'+un(i)+'"]';var r=n;switch(t){case"style":r=Pd(i);break;case"script":r=Vd(i)}yn.has(r)||(i=oe({rel:"preload",href:t==="image"&&e&&e.imageSrcSet?void 0:i,as:t},e),yn.set(r,i),s.querySelector(n)!==null||t==="style"&&s.querySelector(_p(r))||t==="script"&&s.querySelector(Ap(r))||(t=s.createElement("link"),ws(t,"link",i),rs(t),s.head.appendChild(t)))}}function ZD(i,t){Da.m(i,t);var e=Gd;if(e&&i){var s=t&&typeof t.as=="string"?t.as:"script",n='link[rel="modulepreload"][as="'+un(s)+'"][href="'+un(i)+'"]',r=n;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Vd(i)}if(!yn.has(r)&&(i=oe({rel:"modulepreload",href:i},t),yn.set(r,i),e.querySelector(n)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(e.querySelector(Ap(r)))return}s=e.createElement("link"),ws(s,"link",i),rs(s),e.head.appendChild(s)}}}function tj(i,t,e){Da.S(i,t,e);var s=Gd;if(s&&i){var n=Xu(s).hoistableStyles,r=Pd(i);t=t||"default";var a=n.get(r);if(!a){var l={loading:0,preload:null};if(a=s.querySelector(_p(r)))l.loading=5;else{i=oe({rel:"stylesheet",href:i,"data-precedence":t},e),(e=yn.get(r))&&MS(i,e);var c=a=s.createElement("link");rs(c),ws(c,"link",i),c._p=new Promise(function(u,h){c.onload=u,c.onerror=h}),c.addEventListener("load",function(){l.loading|=1}),c.addEventListener("error",function(){l.loading|=2}),l.loading|=4,xy(a,t,s)}a={type:"stylesheet",instance:a,count:1,state:l},n.set(r,a)}}}function ej(i,t){Da.X(i,t);var e=Gd;if(e&&i){var s=Xu(e).hoistableScripts,n=Vd(i),r=s.get(n);r||(r=e.querySelector(Ap(n)),r||(i=oe({src:i,async:!0},t),(t=yn.get(n))&&DS(i,t),r=e.createElement("script"),rs(r),ws(r,"link",i),e.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(n,r))}}function sj(i,t){Da.M(i,t);var e=Gd;if(e&&i){var s=Xu(e).hoistableScripts,n=Vd(i),r=s.get(n);r||(r=e.querySelector(Ap(n)),r||(i=oe({src:i,async:!0,type:"module"},t),(t=yn.get(n))&&DS(i,t),r=e.createElement("script"),rs(r),ws(r,"link",i),e.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(n,r))}}function O1(i,t,e,s){var n=(n=Ho.current)?D0(n):null;if(!n)throw Error(M(446));switch(i){case"meta":case"title":return null;case"style":return typeof e.precedence=="string"&&typeof e.href=="string"?(t=Pd(e.href),e=Xu(n).hoistableStyles,s=e.get(t),s||(s={type:"style",instance:null,count:0,state:null},e.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(e.rel==="stylesheet"&&typeof e.href=="string"&&typeof e.precedence=="string"){i=Pd(e.href);var r=Xu(n).hoistableStyles,a=r.get(i);if(a||(n=n.ownerDocument||n,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(i,a),(r=n.querySelector(_p(i)))&&!r._p&&(a.instance=r,a.state.loading=5),yn.has(i)||(e={rel:"preload",as:"style",href:e.href,crossOrigin:e.crossOrigin,integrity:e.integrity,media:e.media,hrefLang:e.hrefLang,referrerPolicy:e.referrerPolicy},yn.set(i,e),r||ij(n,i,e,a.state))),t&&s===null)throw Error(M(528,""));return a}if(t&&s!==null)throw Error(M(529,""));return null;case"script":return t=e.async,e=e.src,typeof e=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Vd(e),e=Xu(n).hoistableScripts,s=e.get(t),s||(s={type:"script",instance:null,count:0,state:null},e.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(M(444,i))}}function Pd(i){return'href="'+un(i)+'"'}function _p(i){return'link[rel="stylesheet"]['+i+"]"}function I2(i){return oe({},i,{"data-precedence":i.precedence,precedence:null})}function ij(i,t,e,s){i.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=i.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),ws(t,"link",e),rs(t),i.head.appendChild(t))}function Vd(i){return'[src="'+un(i)+'"]'}function Ap(i){return"script[async]"+i}function k1(i,t,e){if(t.count++,t.instance===null)switch(t.type){case"style":var s=i.querySelector('style[data-href~="'+un(e.href)+'"]');if(s)return t.instance=s,rs(s),s;var n=oe({},e,{"data-href":e.href,"data-precedence":e.precedence,href:null,precedence:null});return s=(i.ownerDocument||i).createElement("style"),rs(s),ws(s,"style",n),xy(s,e.precedence,i),t.instance=s;case"stylesheet":n=Pd(e.href);var r=i.querySelector(_p(n));if(r)return t.state.loading|=4,t.instance=r,rs(r),r;s=I2(e),(n=yn.get(n))&&MS(s,n),r=(i.ownerDocument||i).createElement("link"),rs(r);var a=r;return a._p=new Promise(function(l,c){a.onload=l,a.onerror=c}),ws(r,"link",s),t.state.loading|=4,xy(r,e.precedence,i),t.instance=r;case"script":return r=Vd(e.src),(n=i.querySelector(Ap(r)))?(t.instance=n,rs(n),n):(s=e,(n=yn.get(r))&&(s=oe({},e),DS(s,n)),i=i.ownerDocument||i,n=i.createElement("script"),rs(n),ws(n,"link",s),i.head.appendChild(n),t.instance=n);case"void":return null;default:throw Error(M(443,t.type))}else t.type==="stylesheet"&&!(t.state.loading&4)&&(s=t.instance,t.state.loading|=4,xy(s,e.precedence,i));return t.instance}function xy(i,t,e){for(var s=e.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=s.length?s[s.length-1]:null,r=n,a=0;a<s.length;a++){var l=s[a];if(l.dataset.precedence===t)r=l;else if(r!==n)break}r?r.parentNode.insertBefore(i,r.nextSibling):(t=e.nodeType===9?e.head:e,t.insertBefore(i,t.firstChild))}function MS(i,t){i.crossOrigin==null&&(i.crossOrigin=t.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=t.referrerPolicy),i.title==null&&(i.title=t.title)}function DS(i,t){i.crossOrigin==null&&(i.crossOrigin=t.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=t.referrerPolicy),i.integrity==null&&(i.integrity=t.integrity)}var Ey=null;function N1(i,t,e){if(Ey===null){var s=new Map,n=Ey=new Map;n.set(e,s)}else n=Ey,s=n.get(e),s||(s=new Map,n.set(e,s));if(s.has(i))return s;for(s.set(i,null),e=e.getElementsByTagName(i),n=0;n<e.length;n++){var r=e[n];if(!(r[mp]||r[ps]||i==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var a=r.getAttribute(t)||"";a=i+a;var l=s.get(a);l?l.push(r):s.set(a,[r])}}return s}function M1(i,t,e){i=i.ownerDocument||i,i.head.insertBefore(e,t==="title"?i.querySelector("head > title"):null)}function nj(i,t,e){if(e===1||t.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return i=t.disabled,typeof t.precedence=="string"&&i==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function U2(i){return!(i.type==="stylesheet"&&!(i.state.loading&3))}function rj(i,t,e,s){if(e.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&!(e.state.loading&4)){if(e.instance===null){var n=Pd(s.href),r=t.querySelector(_p(n));if(r){t=r._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(i.count++,i=j0.bind(i),t.then(i,i)),e.state.loading|=4,e.instance=r,rs(r);return}r=t.ownerDocument||t,s=I2(s),(n=yn.get(n))&&MS(s,n),r=r.createElement("link"),rs(r);var a=r;a._p=new Promise(function(l,c){a.onload=l,a.onerror=c}),ws(r,"link",s),e.instance=r}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(e,t),(t=e.state.preload)&&!(e.state.loading&3)&&(i.count++,e=j0.bind(i),t.addEventListener("load",e),t.addEventListener("error",e))}}var Dv=0;function aj(i,t){return i.stylesheets&&i.count===0&&Ty(i,i.stylesheets),0<i.count||0<i.imgCount?function(e){var s=setTimeout(function(){if(i.stylesheets&&Ty(i,i.stylesheets),i.unsuspend){var r=i.unsuspend;i.unsuspend=null,r()}},6e4+t);0<i.imgBytes&&Dv===0&&(Dv=62500*zD());var n=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Ty(i,i.stylesheets),i.unsuspend)){var r=i.unsuspend;i.unsuspend=null,r()}},(i.imgBytes>Dv?50:800)+t);return i.unsuspend=e,function(){i.unsuspend=null,clearTimeout(s),clearTimeout(n)}}:null}function j0(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ty(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var L0=null;function Ty(i,t){i.stylesheets=null,i.unsuspend!==null&&(i.count++,L0=new Map,t.forEach(oj,i),L0=null,j0.call(i))}function oj(i,t){if(!(t.state.loading&4)){var e=L0.get(i);if(e)var s=e.get(null);else{e=new Map,L0.set(i,e);for(var n=i.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<n.length;r++){var a=n[r];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(e.set(a.dataset.precedence,a),s=a)}s&&e.set(null,s)}n=t.instance,a=n.getAttribute("data-precedence"),r=e.get(a)||s,r===s&&e.set(null,n),e.set(a,n),this.count++,s=j0.bind(this),n.addEventListener("load",s),n.addEventListener("error",s),r?r.parentNode.insertBefore(n,r.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(n,i.firstChild)),t.state.loading|=4}}var hg={$$typeof:ya,Provider:null,Consumer:null,_currentValue:zc,_currentValue2:zc,_threadCount:0};function lj(i,t,e,s,n,r,a,l,c){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=sv(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sv(0),this.hiddenUpdates=sv(null),this.identifierPrefix=s,this.onUncaughtError=n,this.onCaughtError=r,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function z2(i,t,e,s,n,r,a,l,c,u,h,d){return i=new lj(i,t,e,a,c,u,h,d,l),t=1,r===!0&&(t|=24),r=Mi(3,null,null,t),i.current=r,r.stateNode=i,t=rS(),t.refCount++,i.pooledCache=t,t.refCount++,r.memoizedState={element:s,isDehydrated:e,cache:t},lS(r),i}function F2(i){return i?(i=Bu,i):Bu}function H2(i,t,e,s,n,r){n=F2(n),s.context===null?s.context=n:s.pendingContext=n,s=qo(t),s.payload={element:e},r=r===void 0?null:r,r!==null&&(s.callback=r),e=Go(i,s,t),e!==null&&(ri(e,i,t),Hf(e,i,t))}function D1(i,t){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var e=i.retryLane;i.retryLane=e!==0&&e<t?e:t}}function jS(i,t){D1(i,t),(i=i.alternate)&&D1(i,t)}function $2(i){if(i.tag===13||i.tag===31){var t=su(i,67108864);t!==null&&ri(t,i,67108864),jS(i,67108864)}}function j1(i){if(i.tag===13||i.tag===31){var t=Ui();t=GA(t);var e=su(i,t);e!==null&&ri(e,i,t),jS(i,t)}}var P0=!0;function cj(i,t,e,s){var n=st.T;st.T=null;var r=kt.p;try{kt.p=2,LS(i,t,e,s)}finally{kt.p=r,st.T=n}}function uj(i,t,e,s){var n=st.T;st.T=null;var r=kt.p;try{kt.p=8,LS(i,t,e,s)}finally{kt.p=r,st.T=n}}function LS(i,t,e,s){if(P0){var n=Xw(s);if(n===null)Nv(i,t,s,B0,e),L1(i,s);else if(dj(n,i,t,e,s))s.stopPropagation();else if(L1(i,s),t&4&&-1<hj.indexOf(i)){for(;n!==null;){var r=Fd(n);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var a=dl(r.pendingLanes);if(a!==0){var l=r;for(l.pendingLanes|=2,l.entangledLanes|=2;a;){var c=1<<31-Ii(a);l.entanglements[1]|=c,a&=~c}Ar(r),!(Ot&6)&&(T0=Pi()+500,wp(0))}}break;case 31:case 13:l=su(r,2),l!==null&&ri(l,r,2),Bb(),jS(r,2)}if(r=Xw(s),r===null&&Nv(i,t,s,B0,e),r===n)break;n=r}n!==null&&s.stopPropagation()}else Nv(i,t,s,null,e)}}function Xw(i){return i=KA(i),PS(i)}var B0=null;function PS(i){if(B0=null,i=Nu(i),i!==null){var t=hp(i);if(t===null)i=null;else{var e=t.tag;if(e===13){if(i=cT(t),i!==null)return i;i=null}else if(e===31){if(i=uT(t),i!==null)return i;i=null}else if(e===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;i=null}else t!==i&&(i=null)}}return B0=i,null}function q2(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(WN()){case gT:return 2;case mT:return 8;case d0:case QN:return 32;case pT:return 268435456;default:return 32}default:return 32}}var Yw=!1,Yo=null,Ko=null,Wo=null,dg=new Map,fg=new Map,Ha=[],hj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function L1(i,t){switch(i){case"focusin":case"focusout":Yo=null;break;case"dragenter":case"dragleave":Ko=null;break;case"mouseover":case"mouseout":Wo=null;break;case"pointerover":case"pointerout":dg.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fg.delete(t.pointerId)}}function nf(i,t,e,s,n,r){return i===null||i.nativeEvent!==r?(i={blockedOn:t,domEventName:e,eventSystemFlags:s,nativeEvent:r,targetContainers:[n]},t!==null&&(t=Fd(t),t!==null&&$2(t)),i):(i.eventSystemFlags|=s,t=i.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),i)}function dj(i,t,e,s,n){switch(t){case"focusin":return Yo=nf(Yo,i,t,e,s,n),!0;case"dragenter":return Ko=nf(Ko,i,t,e,s,n),!0;case"mouseover":return Wo=nf(Wo,i,t,e,s,n),!0;case"pointerover":var r=n.pointerId;return dg.set(r,nf(dg.get(r)||null,i,t,e,s,n)),!0;case"gotpointercapture":return r=n.pointerId,fg.set(r,nf(fg.get(r)||null,i,t,e,s,n)),!0}return!1}function G2(i){var t=Nu(i.target);if(t!==null){var e=hp(t);if(e!==null){if(t=e.tag,t===13){if(t=cT(e),t!==null){i.blockedOn=t,vx(i.priority,function(){j1(e)});return}}else if(t===31){if(t=uT(e),t!==null){i.blockedOn=t,vx(i.priority,function(){j1(e)});return}}else if(t===3&&e.stateNode.current.memoizedState.isDehydrated){i.blockedOn=e.tag===3?e.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Cy(i){if(i.blockedOn!==null)return!1;for(var t=i.targetContainers;0<t.length;){var e=Xw(i.nativeEvent);if(e===null){e=i.nativeEvent;var s=new e.constructor(e.type,e);dw=s,e.target.dispatchEvent(s),dw=null}else return t=Fd(e),t!==null&&$2(t),i.blockedOn=e,!1;t.shift()}return!0}function P1(i,t,e){Cy(i)&&e.delete(t)}function fj(){Yw=!1,Yo!==null&&Cy(Yo)&&(Yo=null),Ko!==null&&Cy(Ko)&&(Ko=null),Wo!==null&&Cy(Wo)&&(Wo=null),dg.forEach(P1),fg.forEach(P1)}function Vp(i,t){i.blockedOn===t&&(i.blockedOn=null,Yw||(Yw=!0,Ke.unstable_scheduleCallback(Ke.unstable_NormalPriority,fj)))}var Xp=null;function B1(i){Xp!==i&&(Xp=i,Ke.unstable_scheduleCallback(Ke.unstable_NormalPriority,function(){Xp===i&&(Xp=null);for(var t=0;t<i.length;t+=3){var e=i[t],s=i[t+1],n=i[t+2];if(typeof s!="function"){if(PS(s||e)===null)continue;break}var r=Fd(e);r!==null&&(i.splice(t,3),t-=3,Rw(r,{pending:!0,data:n,method:e.method,action:s},s,n))}}))}function Bd(i){function t(c){return Vp(c,i)}Yo!==null&&Vp(Yo,i),Ko!==null&&Vp(Ko,i),Wo!==null&&Vp(Wo,i),dg.forEach(t),fg.forEach(t);for(var e=0;e<Ha.length;e++){var s=Ha[e];s.blockedOn===i&&(s.blockedOn=null)}for(;0<Ha.length&&(e=Ha[0],e.blockedOn===null);)G2(e),e.blockedOn===null&&Ha.shift();if(e=(i.ownerDocument||i).$$reactFormReplay,e!=null)for(s=0;s<e.length;s+=3){var n=e[s],r=e[s+1],a=n[ai]||null;if(typeof r=="function")a||B1(e);else if(a){var l=null;if(r&&r.hasAttribute("formAction")){if(n=r,a=r[ai]||null)l=a.formAction;else if(PS(n)!==null)continue}else l=a.action;typeof l=="function"?e[s+1]=l:(e.splice(s,3),s-=3),B1(e)}}}function V2(){function i(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(a){return n=a})},focusReset:"manual",scroll:"manual"})}function t(){n!==null&&(n(),n=null),s||setTimeout(e,20)}function e(){if(!s&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var s=!1,n=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(e,100),function(){s=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),n!==null&&(n(),n=null)}}}function BS(i){this._internalRoot=i}zb.prototype.render=BS.prototype.render=function(i){var t=this._internalRoot;if(t===null)throw Error(M(409));var e=t.current,s=Ui();H2(e,s,i,t,null,null)};zb.prototype.unmount=BS.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var t=i.containerInfo;H2(i.current,2,null,i,null,null),Bb(),t[zd]=null}};function zb(i){this._internalRoot=i}zb.prototype.unstable_scheduleHydration=function(i){if(i){var t=_T();i={blockedOn:null,target:i,priority:t};for(var e=0;e<Ha.length&&t!==0&&t<Ha[e].priority;e++);Ha.splice(e,0,i),e===0&&G2(i)}};var I1=oT.version;if(I1!=="19.2.0")throw Error(M(527,I1,"19.2.0"));kt.findDOMNode=function(i){var t=i._reactInternals;if(t===void 0)throw typeof i.render=="function"?Error(M(188)):(i=Object.keys(i).join(","),Error(M(268,i)));return i=$N(t),i=i!==null?hT(i):null,i=i===null?null:i.stateNode,i};var gj={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:st,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yp.isDisabled&&Yp.supportsFiber)try{dp=Yp.inject(gj),Bi=Yp}catch{}}Sb.createRoot=function(i,t){if(!lT(i))throw Error(M(299));var e=!1,s="",n=BC,r=IC,a=UC;return t!=null&&(t.unstable_strictMode===!0&&(e=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(n=t.onUncaughtError),t.onCaughtError!==void 0&&(r=t.onCaughtError),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=z2(i,1,!1,null,null,e,s,null,n,r,a,V2),i[zd]=t.current,NS(i),new BS(t)};Sb.hydrateRoot=function(i,t,e){if(!lT(i))throw Error(M(299));var s=!1,n="",r=BC,a=IC,l=UC,c=null;return e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onUncaughtError!==void 0&&(r=e.onUncaughtError),e.onCaughtError!==void 0&&(a=e.onCaughtError),e.onRecoverableError!==void 0&&(l=e.onRecoverableError),e.formState!==void 0&&(c=e.formState)),t=z2(i,1,!0,t,e??null,s,n,c,r,a,l,V2),t.context=F2(null),e=t.current,s=Ui(),s=GA(s),n=qo(s),n.callback=null,Go(e,n,s),e=s,t.current.lanes=e,gp(t,e),Ar(t),i[zd]=t.current,NS(i),new zb(t)};Sb.version="19.2.0";function X2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X2)}catch(i){console.error(i)}}X2(),eT.exports=Sb;var mj=eT.exports;const pj=GE(mj);var Kw=function(i,t){return Kw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])},Kw(i,t)};function Y2(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Kw(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var I0=function(){return I0=Object.assign||function(t){for(var e,s=1,n=arguments.length;s<n;s++){e=arguments[s];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},I0.apply(this,arguments)};function Xd(i,t){var e={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.indexOf(s)<0&&(e[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(i);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(i,s[n])&&(e[s[n]]=i[s[n]]);return e}function K2(i,t,e,s){var n=arguments.length,r=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var l=i.length-1;l>=0;l--)(a=i[l])&&(r=(n<3?a(r):n>3?a(t,e,r):a(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}function W2(i,t){return function(e,s){t(e,s,i)}}function Q2(i,t,e,s,n,r){function a(p){if(p!==void 0&&typeof p!="function")throw new TypeError("Function expected");return p}for(var l=s.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&i?s.static?i:i.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,s.name):{}),d,f=!1,g=e.length-1;g>=0;g--){var b={};for(var v in s)b[v]=v==="access"?{}:s[v];for(var v in s.access)b.access[v]=s.access[v];b.addInitializer=function(p){if(f)throw new TypeError("Cannot add initializers after decoration has completed");r.push(a(p||null))};var S=(0,e[g])(l==="accessor"?{get:h.get,set:h.set}:h[c],b);if(l==="accessor"){if(S===void 0)continue;if(S===null||typeof S!="object")throw new TypeError("Object expected");(d=a(S.get))&&(h.get=d),(d=a(S.set))&&(h.set=d),(d=a(S.init))&&n.unshift(d)}else(d=a(S))&&(l==="field"?n.unshift(d):h[c]=d)}u&&Object.defineProperty(u,s.name,h),f=!0}function J2(i,t,e){for(var s=arguments.length>2,n=0;n<t.length;n++)e=s?t[n].call(i,e):t[n].call(i);return s?e:void 0}function Z2(i){return typeof i=="symbol"?i:"".concat(i)}function tR(i,t,e){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(i,"name",{configurable:!0,value:e?"".concat(e," ",t):t})}function eR(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}function X(i,t,e,s){function n(r){return r instanceof e?r:new e(function(a){a(r)})}return new(e||(e=Promise))(function(r,a){function l(h){try{u(s.next(h))}catch(d){a(d)}}function c(h){try{u(s.throw(h))}catch(d){a(d)}}function u(h){h.done?r(h.value):n(h.value).then(l,c)}u((s=s.apply(i,t||[])).next())})}function sR(i,t){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},s,n,r,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(h){return c([u,h])}}function c(u){if(s)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(e=0)),e;)try{if(s=1,n&&(r=u[0]&2?n.return:u[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,u[1])).done)return r;switch(n=0,r&&(u=[u[0]&2,r.value]),u[0]){case 0:case 1:r=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,n=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(r=e.trys,!(r=r.length>0&&r[r.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!r||u[1]>r[0]&&u[1]<r[3])){e.label=u[1];break}if(u[0]===6&&e.label<r[1]){e.label=r[1],r=u;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(u);break}r[2]&&e.ops.pop(),e.trys.pop();continue}u=t.call(i,e)}catch(h){u=[6,h],n=0}finally{s=r=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var Fb=Object.create?function(i,t,e,s){s===void 0&&(s=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(i,s,n)}:function(i,t,e,s){s===void 0&&(s=e),i[s]=t[e]};function iR(i,t){for(var e in i)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&Fb(t,i,e)}function U0(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],s=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function IS(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var s=e.call(i),n,r=[],a;try{for(;(t===void 0||t-- >0)&&!(n=s.next()).done;)r.push(n.value)}catch(l){a={error:l}}finally{try{n&&!n.done&&(e=s.return)&&e.call(s)}finally{if(a)throw a.error}}return r}function nR(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(IS(arguments[t]));return i}function rR(){for(var i=0,t=0,e=arguments.length;t<e;t++)i+=arguments[t].length;for(var s=Array(i),n=0,t=0;t<e;t++)for(var r=arguments[t],a=0,l=r.length;a<l;a++,n++)s[n]=r[a];return s}function aR(i,t,e){if(e||arguments.length===2)for(var s=0,n=t.length,r;s<n;s++)(r||!(s in t))&&(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return i.concat(r||Array.prototype.slice.call(t))}function Id(i){return this instanceof Id?(this.v=i,this):new Id(i)}function oR(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e.apply(i,t||[]),n,r=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(g){return function(b){return Promise.resolve(b).then(g,d)}}function l(g,b){s[g]&&(n[g]=function(v){return new Promise(function(S,p){r.push([g,v,S,p])>1||c(g,v)})},b&&(n[g]=b(n[g])))}function c(g,b){try{u(s[g](b))}catch(v){f(r[0][3],v)}}function u(g){g.value instanceof Id?Promise.resolve(g.value.v).then(h,d):f(r[0][2],g)}function h(g){c("next",g)}function d(g){c("throw",g)}function f(g,b){g(b),r.shift(),r.length&&c(r[0][0],r[0][1])}}function lR(i){var t,e;return t={},s("next"),s("throw",function(n){throw n}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(n,r){t[n]=i[n]?function(a){return(e=!e)?{value:Id(i[n](a)),done:!1}:r?r(a):a}:r}}function cR(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof U0=="function"?U0(i):i[Symbol.iterator](),e={},s("next"),s("throw"),s("return"),e[Symbol.asyncIterator]=function(){return this},e);function s(r){e[r]=i[r]&&function(a){return new Promise(function(l,c){a=i[r](a),n(l,c,a.done,a.value)})}}function n(r,a,l,c){Promise.resolve(c).then(function(u){r({value:u,done:l})},a)}}function uR(i,t){return Object.defineProperty?Object.defineProperty(i,"raw",{value:t}):i.raw=t,i}var yj=Object.create?function(i,t){Object.defineProperty(i,"default",{enumerable:!0,value:t})}:function(i,t){i.default=t},Ww=function(i){return Ww=Object.getOwnPropertyNames||function(t){var e=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[e.length]=s);return e},Ww(i)};function hR(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e=Ww(i),s=0;s<e.length;s++)e[s]!=="default"&&Fb(t,i,e[s]);return yj(t,i),t}function dR(i){return i&&i.__esModule?i:{default:i}}function fR(i,t,e,s){if(e==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?i!==t||!s:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?s:e==="a"?s.call(i):s?s.value:t.get(i)}function gR(i,t,e,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?i!==t||!n:!t.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(i,e):n?n.value=e:t.set(i,e),e}function mR(i,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof i=="function"?t===i:i.has(t)}function pR(i,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,n;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],e&&(n=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(r){return Promise.reject(r)}}),i.stack.push({value:t,dispose:s,async:e})}else e&&i.stack.push({async:!0});return t}var bj=typeof SuppressedError=="function"?SuppressedError:function(i,t,e){var s=new Error(e);return s.name="SuppressedError",s.error=i,s.suppressed=t,s};function yR(i){function t(r){i.error=i.hasError?new bj(r,i.error,"An error was suppressed during disposal."):r,i.hasError=!0}var e,s=0;function n(){for(;e=i.stack.pop();)try{if(!e.async&&s===1)return s=0,i.stack.push(e),Promise.resolve().then(n);if(e.dispose){var r=e.dispose.call(e.value);if(e.async)return s|=2,Promise.resolve(r).then(n,function(a){return t(a),n()})}else s|=1}catch(a){t(a)}if(s===1)return i.hasError?Promise.reject(i.error):Promise.resolve();if(i.hasError)throw i.error}return n()}function bR(i,t){return typeof i=="string"&&/^\.\.?\//.test(i)?i.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,s,n,r,a){return s?t?".jsx":".js":n&&(!r||!a)?e:n+r+"."+a.toLowerCase()+"js"}):i}const vj={__extends:Y2,__assign:I0,__rest:Xd,__decorate:K2,__param:W2,__esDecorate:Q2,__runInitializers:J2,__propKey:Z2,__setFunctionName:tR,__metadata:eR,__awaiter:X,__generator:sR,__createBinding:Fb,__exportStar:iR,__values:U0,__read:IS,__spread:nR,__spreadArrays:rR,__spreadArray:aR,__await:Id,__asyncGenerator:oR,__asyncDelegator:lR,__asyncValues:cR,__makeTemplateObject:uR,__importStar:hR,__importDefault:dR,__classPrivateFieldGet:fR,__classPrivateFieldSet:gR,__classPrivateFieldIn:mR,__addDisposableResource:pR,__disposeResources:yR,__rewriteRelativeImportExtension:bR},wj=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:pR,get __assign(){return I0},__asyncDelegator:lR,__asyncGenerator:oR,__asyncValues:cR,__await:Id,__awaiter:X,__classPrivateFieldGet:fR,__classPrivateFieldIn:mR,__classPrivateFieldSet:gR,__createBinding:Fb,__decorate:K2,__disposeResources:yR,__esDecorate:Q2,__exportStar:iR,__extends:Y2,__generator:sR,__importDefault:dR,__importStar:hR,__makeTemplateObject:uR,__metadata:eR,__param:W2,__propKey:Z2,__read:IS,__rest:Xd,__rewriteRelativeImportExtension:bR,__runInitializers:J2,__setFunctionName:tR,__spread:nR,__spreadArray:aR,__spreadArrays:rR,__values:U0,default:vj},Symbol.toStringTag,{value:"Module"})),_j=i=>i?(...t)=>i(...t):(...t)=>fetch(...t);class US extends Error{constructor(t,e="FunctionsError",s){super(t),this.name=e,this.context=s}}class U1 extends US{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class z1 extends US{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class F1 extends US{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Qw;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Qw||(Qw={}));class Aj{constructor(t,{headers:e={},customFetch:s,region:n=Qw.Any}={}){this.url=t,this.headers=e,this.region=n,this.fetch=_j(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return X(this,arguments,void 0,function*(e,s={}){var n;try{const{headers:r,method:a,body:l,signal:c}=s;let u={},{region:h}=s;h||(h=this.region);const d=new URL(`${this.url}/${e}`);h&&h!=="any"&&(u["x-region"]=h,d.searchParams.set("forceFunctionRegion",h));let f;l&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",f=l):typeof l=="string"?(u["Content-Type"]="text/plain",f=l):typeof FormData<"u"&&l instanceof FormData?f=l:(u["Content-Type"]="application/json",f=JSON.stringify(l)):f=l;const g=yield this.fetch(d.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),r),body:f,signal:c}).catch(p=>{throw p.name==="AbortError"?p:new U1(p)}),b=g.headers.get("x-relay-error");if(b&&b==="true")throw new z1(g);if(!g.ok)throw new F1(g);let v=((n=g.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),S;return v==="application/json"?S=yield g.json():v==="application/octet-stream"||v==="application/pdf"?S=yield g.blob():v==="text/event-stream"?S=g:v==="multipart/form-data"?S=yield g.formData():S=yield g.text(),{data:S,error:null,response:g}}catch(r){return r instanceof Error&&r.name==="AbortError"?{data:null,error:new U1(r)}:{data:null,error:r,response:r instanceof F1||r instanceof z1?r.context:void 0}}})}}var Us={};const Yd=yN(wj);var Kp={},Wp={},Qp={},Jp={},Zp={},ty={},H1;function vR(){if(H1)return ty;H1=1,Object.defineProperty(ty,"__esModule",{value:!0});class i extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return ty.default=i,ty}var $1;function wR(){if($1)return Zp;$1=1,Object.defineProperty(Zp,"__esModule",{value:!0});const t=Yd.__importDefault(vR());class e{constructor(n){var r,a;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(r=n.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=n.signal,this.isMaybeSingle=(a=n.isMaybeSingle)!==null&&a!==void 0?a:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,r){return this.headers=new Headers(this.headers),this.headers.set(n,r),this}then(n,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d,f;let g=null,b=null,v=null,S=c.status,p=c.statusText;if(c.ok){if(this.method!=="HEAD"){const T=await c.text();T===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?b=T:b=JSON.parse(T))}const y=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),E=(d=c.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");y&&E&&E.length>1&&(v=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(g={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,v=null,S=406,p="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const y=await c.text();try{g=JSON.parse(y),Array.isArray(g)&&c.status===404&&(b=[],g=null,S=200,p="OK")}catch{c.status===404&&y===""?(S=204,p="No Content"):g={message:y}}if(g&&this.isMaybeSingle&&(!((f=g==null?void 0:g.details)===null||f===void 0)&&f.includes("0 rows"))&&(g=null,S=200,p="OK"),g&&this.shouldThrowOnError)throw new t.default(g)}return{error:g,data:b,count:v,status:S,statusText:p}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c==null?void 0:c.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(n,r)}returns(){return this}overrideTypes(){return this}}return Zp.default=e,Zp}var q1;function _R(){if(q1)return Jp;q1=1,Object.defineProperty(Jp,"__esModule",{value:!0});const t=Yd.__importDefault(wR());class e extends t.default{select(n){let r=!1;const a=(n??"*").split("").map(l=>/\s/.test(l)&&!r?"":(l==='"'&&(r=!r),l)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:r=!0,nullsFirst:a,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",h=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${h?`${h},`:""}${n}.${r?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:r,referencedTable:a=r}={}){const l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${n}`),this}range(n,r,{foreignTable:a,referencedTable:l=a}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(u,`${r-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:r=!1,settings:a=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var h;const d=[n?"analyze":null,r?"verbose":null,a?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${f}"; options=${d};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return Jp.default=e,Jp}var G1;function zS(){if(G1)return Qp;G1=1,Object.defineProperty(Qp,"__esModule",{value:!0});const t=Yd.__importDefault(_R()),e=new RegExp("[,()]");class s extends t.default{eq(r,a){return this.url.searchParams.append(r,`eq.${a}`),this}neq(r,a){return this.url.searchParams.append(r,`neq.${a}`),this}gt(r,a){return this.url.searchParams.append(r,`gt.${a}`),this}gte(r,a){return this.url.searchParams.append(r,`gte.${a}`),this}lt(r,a){return this.url.searchParams.append(r,`lt.${a}`),this}lte(r,a){return this.url.searchParams.append(r,`lte.${a}`),this}like(r,a){return this.url.searchParams.append(r,`like.${a}`),this}likeAllOf(r,a){return this.url.searchParams.append(r,`like(all).{${a.join(",")}}`),this}likeAnyOf(r,a){return this.url.searchParams.append(r,`like(any).{${a.join(",")}}`),this}ilike(r,a){return this.url.searchParams.append(r,`ilike.${a}`),this}ilikeAllOf(r,a){return this.url.searchParams.append(r,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(r,a){return this.url.searchParams.append(r,`ilike(any).{${a.join(",")}}`),this}is(r,a){return this.url.searchParams.append(r,`is.${a}`),this}in(r,a){const l=Array.from(new Set(a)).map(c=>typeof c=="string"&&e.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(r,`in.(${l})`),this}contains(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cs.{${a.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(a)}`),this}containedBy(r,a){return typeof a=="string"?this.url.searchParams.append(r,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(r,`cd.{${a.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(a)}`),this}rangeGt(r,a){return this.url.searchParams.append(r,`sr.${a}`),this}rangeGte(r,a){return this.url.searchParams.append(r,`nxl.${a}`),this}rangeLt(r,a){return this.url.searchParams.append(r,`sl.${a}`),this}rangeLte(r,a){return this.url.searchParams.append(r,`nxr.${a}`),this}rangeAdjacent(r,a){return this.url.searchParams.append(r,`adj.${a}`),this}overlaps(r,a){return typeof a=="string"?this.url.searchParams.append(r,`ov.${a}`):this.url.searchParams.append(r,`ov.{${a.join(",")}}`),this}textSearch(r,a,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(r,`${u}fts${h}.${a}`),this}match(r){return Object.entries(r).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(r,a,l){return this.url.searchParams.append(r,`not.${a}.${l}`),this}or(r,{foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${r})`),this}filter(r,a,l){return this.url.searchParams.append(r,`${a}.${l}`),this}}return Qp.default=s,Qp}var V1;function AR(){if(V1)return Wp;V1=1,Object.defineProperty(Wp,"__esModule",{value:!0});const t=Yd.__importDefault(zS());class e{constructor(n,{headers:r={},schema:a,fetch:l}){this.url=n,this.headers=new Headers(r),this.schema=a,this.fetch=l}select(n,r){const{head:a=!1,count:l}=r??{},c=a?"HEAD":"GET";let u=!1;const h=(n??"*").split("").map(d=>/\s/.test(d)&&!u?"":(d==='"'&&(u=!u),d)).join("");return this.url.searchParams.set("select",h),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:r,defaultToNull:a=!0}={}){var l;const c="POST";if(r&&this.headers.append("Prefer",`count=${r}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const u=n.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(n,{onConflict:r,ignoreDuplicates:a=!1,count:l,defaultToNull:c=!0}={}){var u;const h="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((f,g)=>f.concat(Object.keys(g)),[]);if(d.length>0){const f=[...new Set(d)].map(g=>`"${g}"`);this.url.searchParams.set("columns",f.join(","))}}return new t.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(n,{count:r}={}){var a;const l="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:n}={}){var r;const a="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}}return Wp.default=e,Wp}var X1;function Sj(){if(X1)return Kp;X1=1,Object.defineProperty(Kp,"__esModule",{value:!0});const i=Yd,t=i.__importDefault(AR()),e=i.__importDefault(zS());class s{constructor(r,{headers:a={},schema:l,fetch:c}={}){this.url=r,this.headers=new Headers(a),this.schemaName=l,this.fetch=c}from(r){const a=new URL(`${this.url}/${r}`);return new t.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(r){return new s(this.url,{headers:this.headers,schema:r,fetch:this.fetch})}rpc(r,a={},{head:l=!1,get:c=!1,count:u}={}){var h;let d;const f=new URL(`${this.url}/rpc/${r}`);let g;l||c?(d=l?"HEAD":"GET",Object.entries(a).filter(([v,S])=>S!==void 0).map(([v,S])=>[v,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([v,S])=>{f.searchParams.append(v,S)})):(d="POST",g=a);const b=new Headers(this.headers);return u&&b.set("Prefer",`count=${u}`),new e.default({method:d,url:f,headers:b,schema:this.schemaName,body:g,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Kp.default=s,Kp}Object.defineProperty(Us,"__esModule",{value:!0});var SR=Us.PostgrestError=DR=Us.PostgrestBuilder=NR=Us.PostgrestTransformBuilder=OR=Us.PostgrestFilterBuilder=CR=Us.PostgrestQueryBuilder=ER=Us.PostgrestClient=void 0;const Kd=Yd,xR=Kd.__importDefault(Sj());var ER=Us.PostgrestClient=xR.default;const TR=Kd.__importDefault(AR());var CR=Us.PostgrestQueryBuilder=TR.default;const RR=Kd.__importDefault(zS());var OR=Us.PostgrestFilterBuilder=RR.default;const kR=Kd.__importDefault(_R());var NR=Us.PostgrestTransformBuilder=kR.default;const MR=Kd.__importDefault(wR());var DR=Us.PostgrestBuilder=MR.default;const jR=Kd.__importDefault(vR());SR=Us.PostgrestError=jR.default;var LR=Us.default={PostgrestClient:xR.default,PostgrestQueryBuilder:TR.default,PostgrestFilterBuilder:RR.default,PostgrestTransformBuilder:kR.default,PostgrestBuilder:MR.default,PostgrestError:jR.default};const xj=pN({__proto__:null,get PostgrestBuilder(){return DR},get PostgrestClient(){return ER},get PostgrestError(){return SR},get PostgrestFilterBuilder(){return OR},get PostgrestQueryBuilder(){return CR},get PostgrestTransformBuilder(){return NR},default:LR},[Us]),{PostgrestClient:Ej,PostgrestQueryBuilder:U4,PostgrestFilterBuilder:z4,PostgrestTransformBuilder:F4,PostgrestBuilder:H4,PostgrestError:$4}=LR||xj;class Tj{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const e=process.versions;if(e&&e.node){const s=e.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let e=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(e+=`

Suggested solution: ${t.workaround}`),new Error(e)}static createWebSocket(t,e){const s=this.getWebSocketConstructor();return new s(t,e)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Cj="2.80.0",Rj=`realtime-js/${Cj}`,Oj="1.0.0",Jw=1e4,kj=1e3,Nj=100;var Qf;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Qf||(Qf={}));var He;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(He||(He={}));var In;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(In||(In={}));var Zw;(function(i){i.websocket="websocket"})(Zw||(Zw={}));var vl;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(vl||(vl={}));class Mj{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),s=new TextDecoder;return this._decodeBroadcast(t,e,s)}_decodeBroadcast(t,e,s){const n=e.getUint8(1),r=e.getUint8(2);let a=this.HEADER_LENGTH+2;const l=s.decode(t.slice(a,a+n));a=a+n;const c=s.decode(t.slice(a,a+r));a=a+r;const u=JSON.parse(s.decode(t.slice(a,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}let PR=class{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Jt;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(Jt||(Jt={}));const Y1=(i,t,e={})=>{var s;const n=(s=e.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((r,a)=>(r[a]=Dj(a,i,t,n),r),{}):{}},Dj=(i,t,e,s)=>{const n=t.find(l=>l.name===i),r=n==null?void 0:n.type,a=e[i];return r&&!s.includes(r)?BR(r,a):t_(a)},BR=(i,t)=>{if(i.charAt(0)==="_"){const e=i.slice(1,i.length);return Bj(t,e)}switch(i){case Jt.bool:return jj(t);case Jt.float4:case Jt.float8:case Jt.int2:case Jt.int4:case Jt.int8:case Jt.numeric:case Jt.oid:return Lj(t);case Jt.json:case Jt.jsonb:return Pj(t);case Jt.timestamp:return Ij(t);case Jt.abstime:case Jt.date:case Jt.daterange:case Jt.int4range:case Jt.int8range:case Jt.money:case Jt.reltime:case Jt.text:case Jt.time:case Jt.timestamptz:case Jt.timetz:case Jt.tsrange:case Jt.tstzrange:return t_(t);default:return t_(t)}},t_=i=>i,jj=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Lj=i=>{if(typeof i=="string"){const t=parseFloat(i);if(!Number.isNaN(t))return t}return i},Pj=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(t){return console.log(`JSON parse error: ${t}`),i}return i},Bj=(i,t)=>{if(typeof i!="string")return i;const e=i.length-1,s=i[e];if(i[0]==="{"&&s==="}"){let r;const a=i.slice(1,e);try{r=JSON.parse("["+a+"]")}catch{r=a?a.split(","):[]}return r.map(l=>BR(t,l))}return i},Ij=i=>typeof i=="string"?i.replace(" ","T"):i,IR=i=>{const t=new URL(i);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class jv{constructor(t,e,s={},n=Jw){this.channel=t,this.event=e,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var s;return this._hasReceived(t)&&e((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var K1;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(K1||(K1={}));class Jf{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:r,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Jf.syncState(this.state,n,r,a),this.pendingDiffs.forEach(c=>{this.state=Jf.syncDiff(this.state,c,r,a)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:r,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Jf.syncDiff(this.state,n,r,a),l())}),this.onJoin((n,r,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:r,newPresences:a})}),this.onLeave((n,r,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:r,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,s,n){const r=this.cloneDeep(t),a=this.transformState(e),l={},c={};return this.map(r,(u,h)=>{a[u]||(c[u]=h)}),this.map(a,(u,h)=>{const d=r[u];if(d){const f=h.map(S=>S.presence_ref),g=d.map(S=>S.presence_ref),b=h.filter(S=>g.indexOf(S.presence_ref)<0),v=d.filter(S=>f.indexOf(S.presence_ref)<0);b.length>0&&(l[u]=b),v.length>0&&(c[u]=v)}else l[u]=h}),this.syncDiff(r,{joins:l,leaves:c},s,n)}static syncDiff(t,e,s,n){const{joins:r,leaves:a}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(r,(l,c)=>{var u;const h=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),h.length>0){const d=t[l].map(g=>g.presence_ref),f=h.filter(g=>d.indexOf(g.presence_ref)<0);t[l].unshift(...f)}s(l,h,c)}),this.map(a,(l,c)=>{let u=t[l];if(!u)return;const h=c.map(d=>d.presence_ref);u=u.filter(d=>h.indexOf(d.presence_ref)<0),t[l]=u,n(l,u,c),u.length===0&&delete t[l]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(s=>e(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,s)=>{const n=t[s];return"metas"in n?e[s]=n.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):e[s]=n,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var W1;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(W1||(W1={}));var Zf;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(Zf||(Zf={}));var Nr;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Nr||(Nr={}));class FS{constructor(t,e={config:{}},s){var n,r;if(this.topic=t,this.params=e,this.socket=s,this.bindings={},this.state=He.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new jv(this,In.join,this.params,this.timeout),this.rejoinTimer=new PR(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=He.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=He.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=He.errored,this.rejoinTimer.scheduleTimeout())}),this._on(In.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new Jf(this),this.broadcastEndpointURL=IR(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((r=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||r===void 0)&&r.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,e=this.timeout){var s,n,r;if(this.socket.isConnected()||this.socket.connect(),this.state==He.closed){const{config:{broadcast:a,presence:l,private:c}}=this.params,u=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(g=>g.filter))!==null&&n!==void 0?n:[],h=!!this.bindings[Zf.PRESENCE]&&this.bindings[Zf.PRESENCE].length>0||((r=this.params.config.presence)===null||r===void 0?void 0:r.enabled)===!0,d={},f={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(g=>t==null?void 0:t(Nr.CHANNEL_ERROR,g)),this._onClose(()=>t==null?void 0:t(Nr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:g})=>{var b;if(this.socket.setAuth(),g===void 0){t==null||t(Nr.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,S=(b=v==null?void 0:v.length)!==null&&b!==void 0?b:0,p=[];for(let w=0;w<S;w++){const y=v[w],{filter:{event:E,schema:T,table:C,filter:R}}=y,O=g&&g[w];if(O&&O.event===E&&O.schema===T&&O.table===C&&O.filter===R)p.push(Object.assign(Object.assign({},y),{id:O.id}));else{this.unsubscribe(),this.state=He.errored,t==null||t(Nr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,t&&t(Nr.SUBSCRIBED);return}}).receive("error",g=>{this.state=He.errored,t==null||t(Nr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Nr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,s){return this.state===He.joined&&t===Zf.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,e,s)}async httpSend(t,e,s={}){var n;const r=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(e==null)return Promise.reject("Payload is required for httpSend()");const a={method:"POST",headers:{Authorization:r,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:e,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,e={}){var s,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:r,payload:a}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=e.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var a,l,c;const u=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&r("ok"),u.receive("ok",()=>r("ok")),u.receive("error",()=>r("error")),u.receive("timeout",()=>r("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=He.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(In.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new jv(this,In.leave,{},t),s.receive("ok",()=>{e(),n("ok")}).receive("timeout",()=>{e(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=He.closed,this.bindings={}}async _fetchWithTimeout(t,e,s){const n=new AbortController,r=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:n.signal}));return clearTimeout(r),a}_push(t,e,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new jv(this,t,e,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Nj){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(t,e,s){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,s){var n,r;const a=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:h}=In;if(s&&[l,c,u,h].indexOf(a)>=0&&s!==this._joinRef())return;let f=this._onMessage(a,e,s);if(e&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var b,v,S;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(v=g.filter)===null||v===void 0?void 0:v.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===a}).map(g=>g.callback(f,s)):(r=this.bindings[a])===null||r===void 0||r.filter(g=>{var b,v,S,p,w,y;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in g){const E=g.id,T=(b=g.filter)===null||b===void 0?void 0:b.event;return E&&((v=e.ids)===null||v===void 0?void 0:v.includes(E))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((S=e.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const E=(w=(p=g==null?void 0:g.filter)===null||p===void 0?void 0:p.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return E==="*"||E===((y=e==null?void 0:e.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===a}).map(g=>{if(typeof f=="object"&&"ids"in f){const b=f.data,{schema:v,table:S,commit_timestamp:p,type:w,errors:y}=b;f=Object.assign(Object.assign({},{schema:v,table:S,commit_timestamp:p,eventType:w,new:{},old:{},errors:y}),this._getPayloadRecords(b))}g.callback(f,s)})}_isClosed(){return this.state===He.closed}_isJoined(){return this.state===He.joined}_isJoining(){return this.state===He.joining}_isLeaving(){return this.state===He.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,s){const n=t.toLocaleLowerCase(),r={type:n,filter:e,callback:s};return this.bindings[n]?this.bindings[n].push(r):this.bindings[n]=[r],this}_off(t,e){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var r;return!(((r=n.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===s&&FS.isEqual(n.filter,e))})),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(t[s]!==e[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(In.close,{},t)}_onError(t){this._on(In.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=He.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=Y1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=Y1(t.columns,t.old_record)),e}}const Lv=()=>{},ey={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Uj=[1e3,2e3,5e3,1e4],zj=1e4,Fj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Hj{constructor(t,e){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Jw,this.transport=null,this.heartbeatIntervalMs=ey.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Lv,this.ref=0,this.reconnectTimer=null,this.logger=Lv,this.conn=null,this.sendBuffer=[],this.serializer=new Mj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...r)=>n(...r):(...r)=>fetch(...r),!(!((s=e==null?void 0:e.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${t}/${Zw.websocket}`,this.httpEndpoint=IR(t),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e==null?void 0:e.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Tj.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const e=t.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Oj}))}disconnect(t,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},t?this.conn.close(t,e??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const e=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const t=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,e,s){this.logger(t,e,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Qf.connecting:return vl.Connecting;case Qf.open:return vl.Open;case Qf.closing:return vl.Closing;default:return vl.Closed}}isConnected(){return this.connectionState()===vl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,e={config:{}}){const s=`realtime:${t}`,n=this.getChannels().find(r=>r.topic===s);if(n)return n;{const r=new FS(`realtime:${t}`,e,this);return this.channels.push(r),r}}push(t){const{topic:e,event:s,payload:n,ref:r}=t,a=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${e} ${s} (${r})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(kj,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},ey.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:r,ref:a}=e,l=a?`(${a})`:"",c=r.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),r),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(n,r,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(t){var e;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var e;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(In.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const s=t.match(/\?/)?"&":"?",n=new URLSearchParams(e);return`${t}${s}${n}`}_workerObjectUrl(t){let e;if(t)e=t;else{const s=new Blob([Fj],{type:"application/javascript"});e=URL.createObjectURL(s)}return e}_setConnectionState(t,e=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(t=null){let e;t?e=t:this.accessToken?e=await this.accessToken():e=this.accessTokenValue,this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(s=>{const n={access_token:e,version:Rj};e&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(In.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(e=>{this.log("error",`error setting auth in ${t}`,e)})}_triggerStateCallbacks(t,e){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(e)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new PR(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ey.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var e,s,n,r,a,l,c,u,h;if(this.transport=(e=t==null?void 0:t.transport)!==null&&e!==void 0?e:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:Jw,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:ey.HEARTBEAT_INTERVAL,this.worker=(r=t==null?void 0:t.worker)!==null&&r!==void 0?r:!1,this.accessToken=(a=t==null?void 0:t.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:Lv,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:d=>Uj[d-1]||zj,this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(d,f)=>f(JSON.stringify(d)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class HS extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function pe(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class $j extends HS{constructor(t,e,s){super(t),this.name="StorageApiError",this.status=e,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class e_ extends HS{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}const $S=i=>i?(...t)=>i(...t):(...t)=>fetch(...t),qj=()=>Response,s_=i=>{if(Array.isArray(i))return i.map(e=>s_(e));if(typeof i=="function"||i!==Object(i))return i;const t={};return Object.entries(i).forEach(([e,s])=>{const n=e.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));t[n]=s_(s)}),t},Gj=i=>{if(typeof i!="object"||i===null)return!1;const t=Object.getPrototypeOf(i);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},Pv=i=>{var t;return i.msg||i.message||i.error_description||(typeof i.error=="string"?i.error:(t=i.error)===null||t===void 0?void 0:t.message)||JSON.stringify(i)},Vj=(i,t,e)=>X(void 0,void 0,void 0,function*(){const s=yield qj();i instanceof s&&!(e!=null&&e.noResolveJson)?i.json().then(n=>{const r=i.status||500,a=(n==null?void 0:n.statusCode)||r+"";t(new $j(Pv(n),r,a))}).catch(n=>{t(new e_(Pv(n),n))}):t(new e_(Pv(i),i))}),Xj=(i,t,e,s)=>{const n={method:i,headers:(t==null?void 0:t.headers)||{}};return i==="GET"||!s?n:(Gj(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,t!=null&&t.duplex&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),e))};function Sp(i,t,e,s,n,r){return X(this,void 0,void 0,function*(){return new Promise((a,l)=>{i(e,Xj(t,s,n,r)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>Vj(c,l,s))})})}function gg(i,t,e,s){return X(this,void 0,void 0,function*(){return Sp(i,"GET",t,e,s)})}function xn(i,t,e,s,n){return X(this,void 0,void 0,function*(){return Sp(i,"POST",t,s,n,e)})}function i_(i,t,e,s,n){return X(this,void 0,void 0,function*(){return Sp(i,"PUT",t,s,n,e)})}function Yj(i,t,e,s){return X(this,void 0,void 0,function*(){return Sp(i,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),s)})}function qS(i,t,e,s,n){return X(this,void 0,void 0,function*(){return Sp(i,"DELETE",t,s,n,e)})}class Kj{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}execute(){return X(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(pe(t))return{data:null,error:t};throw t}})}}var UR;class Wj{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[UR]="BlobDownloadBuilder",this.promise=null}asStream(){return new Kj(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return X(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(pe(t))return{data:null,error:t};throw t}})}}UR=Symbol.toStringTag;const Qj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Q1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Jj{constructor(t,e={},s,n){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=s,this.fetch=$S(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,e,s,n){return X(this,void 0,void 0,function*(){try{let r;const a=Object.assign(Object.assign({},Q1),n);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&s instanceof Blob?(r=new FormData,r.append("cacheControl",a.cacheControl),c&&r.append("metadata",this.encodeMetadata(c)),r.append("",s)):typeof FormData<"u"&&s instanceof FormData?(r=s,r.has("cacheControl")||r.append("cacheControl",a.cacheControl),c&&!r.has("metadata")&&r.append("metadata",this.encodeMetadata(c))):(r=s,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&r instanceof ReadableStream||r&&typeof r=="object"&&"pipe"in r&&typeof r.pipe=="function")&&!a.duplex&&(a.duplex="half")),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const u=this._removeEmptyFolders(e),h=this._getFinalPath(u),d=yield(t=="PUT"?i_:xn)(this.fetch,`${this.url}/object/${h}`,r,Object.assign({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}})}upload(t,e,s){return X(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,s)})}uploadToSignedUrl(t,e,s,n){return X(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(t),a=this._getFinalPath(r),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",e);try{let c;const u=Object.assign({upsert:Q1.upsert},n),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",u.cacheControl)):(c=s,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType);const d=yield i_(this.fetch,l.toString(),c,{headers:h});return{data:{path:r,fullPath:d.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(pe(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,e){return X(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t);const n=Object.assign({},this.headers);e!=null&&e.upsert&&(n["x-upsert"]="true");const r=yield xn(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(this.url+r.url),l=a.searchParams.get("token");if(!l)throw new HS("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}})}update(t,e,s){return X(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,s)})}move(t,e,s){return X(this,void 0,void 0,function*(){try{return{data:yield xn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}copy(t,e,s){return X(this,void 0,void 0,function*(){try{return{data:{path:(yield xn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}createSignedUrl(t,e,s){return X(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),r=yield xn(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:e},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${a}`)},{data:r,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}createSignedUrls(t,e,s){return X(this,void 0,void 0,function*(){try{const n=yield xn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),r=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${r}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}download(t,e){const n=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),a=r?`?${r}`:"",l=this._getFinalPath(t),c=()=>gg(this.fetch,`${this.url}/${n}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new Wj(c,this.shouldThrowOnError)}info(t){return X(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{const s=yield gg(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:s_(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}})}exists(t){return X(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{return yield Yj(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s)&&s instanceof e_){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(t,e){const s=this._getFinalPath(t),n=[],r=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&n.push(r);const l=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});c!==""&&n.push(c);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${u}`)}}}remove(t){return X(this,void 0,void 0,function*(){try{return{data:yield qS(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pe(e))return{data:null,error:e};throw e}})}list(t,e,s){return X(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Qj),e),{prefix:t||""});return{data:yield xn(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}listV2(t,e){return X(this,void 0,void 0,function*(){try{const s=Object.assign({},t);return{data:yield xn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},e),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const zR="2.80.0",FR={"X-Client-Info":`storage-js/${zR}`};class Zj{constructor(t,e={},s,n){this.shouldThrowOnError=!1;const r=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},FR),e),this.fetch=$S(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return X(this,void 0,void 0,function*(){try{const e=this.listBucketOptionsToQueryString(t);return{data:yield gg(this.fetch,`${this.url}/bucket${e}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pe(e))return{data:null,error:e};throw e}})}getBucket(t){return X(this,void 0,void 0,function*(){try{return{data:yield gg(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pe(e))return{data:null,error:e};throw e}})}createBucket(t){return X(this,arguments,void 0,function*(e,s={public:!1}){try{return{data:yield xn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}updateBucket(t,e){return X(this,void 0,void 0,function*(){try{return{data:yield i_(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}})}emptyBucket(t){return X(this,void 0,void 0,function*(){try{return{data:yield xn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pe(e))return{data:null,error:e};throw e}})}deleteBucket(t){return X(this,void 0,void 0,function*(){try{return{data:yield qS(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pe(e))return{data:null,error:e};throw e}})}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}}class tL{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},FR),e),this.fetch=$S(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return X(this,void 0,void 0,function*(){try{return{data:yield xn(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pe(e))return{data:null,error:e};throw e}})}listBuckets(t){return X(this,void 0,void 0,function*(){try{const e=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&e.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&e.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&e.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&e.set("sortOrder",t.sortOrder),t!=null&&t.search&&e.set("search",t.search);const s=e.toString(),n=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield gg(this.fetch,n,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pe(e))return{data:null,error:e};throw e}})}deleteBucket(t){return X(this,void 0,void 0,function*(){try{return{data:yield qS(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pe(e))return{data:null,error:e};throw e}})}}const GS={"X-Client-Info":`storage-js/${zR}`,"Content-Type":"application/json"};class HR extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Di(i){return typeof i=="object"&&i!==null&&"__isStorageVectorsError"in i}class Bv extends HR{constructor(t,e,s){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class eL extends HR{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}}var J1;(function(i){i.InternalError="InternalError",i.S3VectorConflictException="S3VectorConflictException",i.S3VectorNotFoundException="S3VectorNotFoundException",i.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",i.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",i.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(J1||(J1={}));const VS=i=>i?(...t)=>i(...t):(...t)=>fetch(...t),sL=i=>{if(typeof i!="object"||i===null)return!1;const t=Object.getPrototypeOf(i);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},Z1=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),iL=(i,t,e)=>X(void 0,void 0,void 0,function*(){if(i&&typeof i=="object"&&"status"in i&&"ok"in i&&typeof i.status=="number"&&!(e!=null&&e.noResolveJson)){const n=i.status||500,r=i;if(typeof r.json=="function")r.json().then(a=>{const l=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||n+"";t(new Bv(Z1(a),n,l))}).catch(()=>{const a=n+"",l=r.statusText||`HTTP ${n} error`;t(new Bv(l,n,a))});else{const a=n+"",l=r.statusText||`HTTP ${n} error`;t(new Bv(l,n,a))}}else t(new eL(Z1(i),i))}),nL=(i,t,e,s)=>{const n={method:i,headers:(t==null?void 0:t.headers)||{}};return s?(sL(s)?(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(s)):n.body=s,Object.assign(Object.assign({},n),e)):n};function rL(i,t,e,s,n,r){return X(this,void 0,void 0,function*(){return new Promise((a,l)=>{i(e,nL(t,s,n,r)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>a(c)).catch(c=>iL(c,l,s))})})}function ji(i,t,e,s,n){return X(this,void 0,void 0,function*(){return rL(i,"POST",t,s,n,e)})}class aL{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},GS),e),this.fetch=VS(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return X(this,void 0,void 0,function*(){try{return{data:(yield ji(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}getIndex(t,e){return X(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Di(s))return{data:null,error:s};throw s}})}listIndexes(t){return X(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}deleteIndex(t,e){return X(this,void 0,void 0,function*(){try{return{data:(yield ji(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Di(s))return{data:null,error:s};throw s}})}}class oL{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},GS),e),this.fetch=VS(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return X(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield ji(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}getVectors(t){return X(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}listVectors(t){return X(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield ji(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}queryVectors(t){return X(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}deleteVectors(t){return X(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield ji(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}}class lL{constructor(t,e={},s){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},GS),e),this.fetch=VS(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return X(this,void 0,void 0,function*(){try{return{data:(yield ji(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}getBucket(t){return X(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}listBuckets(){return X(this,arguments,void 0,function*(t={}){try{return{data:yield ji(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}deleteBucket(t){return X(this,void 0,void 0,function*(){try{return{data:(yield ji(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Di(e))return{data:null,error:e};throw e}})}}class cL extends lL{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new uL(this.url,this.headers,t,this.fetch)}}class uL extends aL{constructor(t,e,s,n){super(t,e,n),this.vectorBucketName=s}createIndex(t){const e=Object.create(null,{createIndex:{get:()=>super.createIndex}});return X(this,void 0,void 0,function*(){return e.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return X(this,arguments,void 0,function*(e={}){return t.listIndexes.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const e=Object.create(null,{getIndex:{get:()=>super.getIndex}});return X(this,void 0,void 0,function*(){return e.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const e=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return X(this,void 0,void 0,function*(){return e.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new hL(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class hL extends oL{constructor(t,e,s,n,r){super(t,e,r),this.vectorBucketName=s,this.indexName=n}putVectors(t){const e=Object.create(null,{putVectors:{get:()=>super.putVectors}});return X(this,void 0,void 0,function*(){return e.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const e=Object.create(null,{getVectors:{get:()=>super.getVectors}});return X(this,void 0,void 0,function*(){return e.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return X(this,arguments,void 0,function*(e={}){return t.listVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const e=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return X(this,void 0,void 0,function*(){return e.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const e=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return X(this,void 0,void 0,function*(){return e.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class dL extends Zj{constructor(t,e={},s,n){super(t,e,s,n)}from(t){return new Jj(this.url,this.headers,t,this.fetch)}get vectors(){return new cL(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new tL(this.url+"/iceberg",this.headers,this.fetch)}}const fL="2.80.0";let mf="";typeof Deno<"u"?mf="deno":typeof document<"u"?mf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?mf="react-native":mf="node";const gL={"X-Client-Info":`supabase-js-${mf}/${fL}`},mL={headers:gL},pL={schema:"public"},yL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bL={},vL=i=>i?(...t)=>i(...t):(...t)=>fetch(...t),wL=()=>Headers,_L=(i,t,e)=>{const s=vL(e),n=wL();return async(r,a)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:i;let u=new n(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",i),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(r,Object.assign(Object.assign({},a),{headers:u}))}};function AL(i){return i.endsWith("/")?i:i+"/"}function SL(i,t){var e,s;const{db:n,auth:r,realtime:a,global:l}=i,{db:c,auth:u,realtime:h,global:d}=t,f={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},u),r),realtime:Object.assign(Object.assign({},h),a),storage:{},global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},(e=d==null?void 0:d.headers)!==null&&e!==void 0?e:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return i.accessToken?f.accessToken=i.accessToken:delete f.accessToken,f}function xL(i){const t=i==null?void 0:i.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(AL(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const $R="2.80.0",vu=30*1e3,n_=3,Iv=n_*vu,EL="http://localhost:9999",TL="supabase.auth.token",CL={"X-Client-Info":`gotrue-js/${$R}`},r_="X-Supabase-Api-Version",qR={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},RL=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,OL=10*60*1e3;class mg extends Error{constructor(t,e,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=s}}function Y(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class kL extends mg{constructor(t,e,s){super(t,e,s),this.name="AuthApiError",this.status=e,this.code=s}}function NL(i){return Y(i)&&i.name==="AuthApiError"}class wl extends mg{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class al extends mg{constructor(t,e,s,n){super(t,s,n),this.name=e,this.status=s}}class wn extends al{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ML(i){return Y(i)&&i.name==="AuthSessionMissingError"}class uu extends al{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class sy extends al{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class iy extends al{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function DL(i){return Y(i)&&i.name==="AuthImplicitGrantRedirectError"}class tE extends al{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class a_ extends al{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function Uv(i){return Y(i)&&i.name==="AuthRetryableFetchError"}class eE extends al{constructor(t,e,s){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=s}}class o_ extends al{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const z0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),sE=` 	
\r=`.split(""),jL=(()=>{const i=new Array(128);for(let t=0;t<i.length;t+=1)i[t]=-1;for(let t=0;t<sE.length;t+=1)i[sE[t].charCodeAt(0)]=-2;for(let t=0;t<z0.length;t+=1)i[z0[t].charCodeAt(0)]=t;return i})();function iE(i,t,e){if(i!==null)for(t.queue=t.queue<<8|i,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;e(z0[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;e(z0[s]),t.queuedBits-=6}}function GR(i,t,e){const s=jL[i];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function nE(i){const t=[],e=a=>{t.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},r=a=>{BL(a,s,e)};for(let a=0;a<i.length;a+=1)GR(i.charCodeAt(a),n,r);return t.join("")}function LL(i,t){if(i<=127){t(i);return}else if(i<=2047){t(192|i>>6),t(128|i&63);return}else if(i<=65535){t(224|i>>12),t(128|i>>6&63),t(128|i&63);return}else if(i<=1114111){t(240|i>>18),t(128|i>>12&63),t(128|i>>6&63),t(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function PL(i,t){for(let e=0;e<i.length;e+=1){let s=i.charCodeAt(e);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(i.charCodeAt(e+1)-56320&65535|n)+65536,e+=1}LL(s,t)}}function BL(i,t,e){if(t.utf8seq===0){if(i<=127){e(i);return}for(let s=1;s<6;s+=1)if(!(i>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=i&31;else if(t.utf8seq===3)t.codepoint=i&15;else if(t.utf8seq===4)t.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|i&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function th(i){const t=[],e={queue:0,queuedBits:0},s=n=>{t.push(n)};for(let n=0;n<i.length;n+=1)GR(i.charCodeAt(n),e,s);return new Uint8Array(t)}function IL(i){const t=[];return PL(i,e=>t.push(e)),new Uint8Array(t)}function xl(i){const t=[],e={queue:0,queuedBits:0},s=n=>{t.push(n)};return i.forEach(n=>iE(n,e,s)),iE(null,e,s),t.join("")}function UL(i){return Math.round(Date.now()/1e3)+i}function zL(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const t=Math.random()*16|0;return(i=="x"?t:t&3|8).toString(16)})}const Ss=()=>typeof window<"u"&&typeof document<"u",cl={tested:!1,writable:!1},VR=()=>{if(!Ss())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(cl.tested)return cl.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),cl.tested=!0,cl.writable=!0}catch{cl.tested=!0,cl.writable=!1}return cl.writable};function FL(i){const t={},e=new URL(i);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((n,r)=>{t[r]=n})}catch{}return e.searchParams.forEach((s,n)=>{t[n]=s}),t}const XR=i=>i?(...t)=>i(...t):(...t)=>fetch(...t),HL=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",wu=async(i,t,e)=>{await i.setItem(t,JSON.stringify(e))},ul=async(i,t)=>{const e=await i.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}},La=async(i,t)=>{await i.removeItem(t)};class Hb{constructor(){this.promise=new Hb.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}Hb.promiseConstructor=Promise;function zv(i){const t=i.split(".");if(t.length!==3)throw new o_("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!RL.test(t[s]))throw new o_("JWT not in base64url format");return{header:JSON.parse(nE(t[0])),payload:JSON.parse(nE(t[1])),signature:th(t[2]),raw:{header:t[0],payload:t[1]}}}async function $L(i){return await new Promise(t=>{setTimeout(()=>t(null),i)})}function qL(i,t){return new Promise((s,n)=>{(async()=>{for(let r=0;r<1/0;r++)try{const a=await i(r);if(!t(r,null,a)){s(a);return}}catch(a){if(!t(r,a)){n(a);return}}})()})}function GL(i){return("0"+i.toString(16)).substr(-2)}function VL(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=e.length;let n="";for(let r=0;r<56;r++)n+=e.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(t),Array.from(t,GL).join("")}async function XL(i){const e=new TextEncoder().encode(i),s=await crypto.subtle.digest("SHA-256",e),n=new Uint8Array(s);return Array.from(n).map(r=>String.fromCharCode(r)).join("")}async function YL(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const e=await XL(i);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function hu(i,t,e=!1){const s=VL();let n=s;e&&(n+="/PASSWORD_RECOVERY"),await wu(i,`${t}-code-verifier`,n);const r=await YL(s);return[r,s===r?"plain":"s256"]}const KL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function WL(i){const t=i.headers.get(r_);if(!t||!t.match(KL))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function QL(i){if(!i)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(i<=t)throw new Error("JWT has expired")}function JL(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ZL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function du(i){if(!ZL.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Fv(){const i={};return new Proxy(i,{get:(t,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const s=e.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tP(i,t){return new Proxy(i,{get:(e,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const r=s.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)"||r==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(e,s,n)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,s,n)}})}function rE(i){return JSON.parse(JSON.stringify(i))}const ml=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),eP=[502,503,504];async function aE(i){var t;if(!HL(i))throw new a_(ml(i),0);if(eP.includes(i.status))throw new a_(ml(i),i.status);let e;try{e=await i.json()}catch(r){throw new wl(ml(r),r)}let s;const n=WL(i);if(n&&n.getTime()>=qR["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?s=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(s=e.error_code),s){if(s==="weak_password")throw new eE(ml(e),i.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new wn}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0))throw new eE(ml(e),i.status,e.weak_password.reasons);throw new kL(ml(e),i.status||500,s)}const sP=(i,t,e,s)=>{const n={method:i,headers:(t==null?void 0:t.headers)||{}};return i==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),e))};async function et(i,t,e,s){var n;const r=Object.assign({},s==null?void 0:s.headers);r[r_]||(r[r_]=qR["2024-01-01"].name),s!=null&&s.jwt&&(r.Authorization=`Bearer ${s.jwt}`);const a=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await iP(i,t,e+l,{headers:r,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function iP(i,t,e,s,n,r){const a=sP(t,s,n,r);let l;try{l=await i(e,Object.assign({},a))}catch(c){throw console.error(c),new a_(ml(c),0)}if(l.ok||await aE(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await aE(c)}}function _n(i){var t;let e=null;aP(i)&&(e=Object.assign({},i),i.expires_at||(e.expires_at=UL(i.expires_in)));const s=(t=i.user)!==null&&t!==void 0?t:i;return{data:{session:e,user:s},error:null}}function oE(i){const t=_n(i);return!t.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((e,s)=>e&&typeof s=="string",!0)&&(t.data.weak_password=i.weak_password),t}function $a(i){var t;return{data:{user:(t=i.user)!==null&&t!==void 0?t:i},error:null}}function nP(i){return{data:i,error:null}}function rP(i){const{action_link:t,email_otp:e,hashed_token:s,redirect_to:n,verification_type:r}=i,a=Xd(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:e,hashed_token:s,redirect_to:n,verification_type:r},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function lE(i){return i}function aP(i){return i.access_token&&i.refresh_token&&i.expires_in}const Hv=["global","local","others"];class oP{constructor({url:t="",headers:e={},fetch:s}){this.url=t,this.headers=e,this.fetch=XR(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,e=Hv[0]){if(Hv.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Hv.join(", ")}`);try{return await et(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,e={}){try{return await et(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:$a})}catch(s){if(Y(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:e}=t,s=Xd(t,["options"]),n=Object.assign(Object.assign({},s),e);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await et(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:rP,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(Y(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(t){try{return await et(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:$a})}catch(e){if(Y(e))return{data:{user:null},error:e};throw e}}async listUsers(t){var e,s,n,r,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},h=await et(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(e=t==null?void 0:t.page)===null||e===void 0?void 0:e.toString())!==null&&s!==void 0?s:"",per_page:(r=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:""},xform:lE});if(h.error)throw h.error;const d=await h.json(),f=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,g=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(b=>{const v=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);u[`${S}Page`]=v}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Y(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){du(t);try{return await et(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:$a})}catch(e){if(Y(e))return{data:{user:null},error:e};throw e}}async updateUserById(t,e){du(t);try{return await et(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:$a})}catch(s){if(Y(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,e=!1){du(t);try{return await et(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:$a})}catch(s){if(Y(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){du(t.userId);try{const{data:e,error:s}=await et(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:e,error:s}}catch(e){if(Y(e))return{data:null,error:e};throw e}}async _deleteFactor(t){du(t.userId),du(t.id);try{return{data:await et(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(Y(e))return{data:null,error:e};throw e}}async _listOAuthClients(t){var e,s,n,r,a,l,c;try{const u={nextPage:null,lastPage:0,total:0},h=await et(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(e=t==null?void 0:t.page)===null||e===void 0?void 0:e.toString())!==null&&s!==void 0?s:"",per_page:(r=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:""},xform:lE});if(h.error)throw h.error;const d=await h.json(),f=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,g=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(b=>{const v=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);u[`${S}Page`]=v}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Y(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await et(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Y(e))return{data:null,error:e};throw e}}async _getOAuthClient(t){try{return await et(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Y(e))return{data:null,error:e};throw e}}async _updateOAuthClient(t,e){try{return await et(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:e,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Y(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await et(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(Y(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(t){try{return await et(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Y(e))return{data:null,error:e};throw e}}}function cE(i={}){return{getItem:t=>i[t]||null,setItem:(t,e)=>{i[t]=e},removeItem:t=>{delete i[t]}}}const fu={debug:!!(globalThis&&VR()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class YR extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class lP extends YR{}async function cP(i,t,e){fu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),fu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){fu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,n.name);try{return await e()}finally{fu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,n.name)}}else{if(t===0)throw fu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new lP(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(fu.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}function uP(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function KR(i){if(!/^0x[a-fA-F0-9]{40}$/.test(i))throw new Error(`@supabase/auth-js: Address "${i}" is invalid.`);return i.toLowerCase()}function hP(i){return parseInt(i,16)}function dP(i){const t=new TextEncoder().encode(i);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function fP(i){var t;const{chainId:e,domain:s,expirationTime:n,issuedAt:r=new Date,nonce:a,notBefore:l,requestId:c,resources:u,scheme:h,uri:d,version:f}=i;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=i.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${i.statement}`)}const g=KR(i.address),b=h?`${h}://${s}`:s,v=i.statement?`${i.statement}
`:"",S=`${b} wants you to sign in with your Ethereum account:
${g}

${v}`;let p=`URI: ${d}
Version: ${f}
Chain ID: ${e}${a?`
Nonce: ${a}`:""}
Issued At: ${r.toISOString()}`;if(n&&(p+=`
Expiration Time: ${n.toISOString()}`),l&&(p+=`
Not Before: ${l.toISOString()}`),c&&(p+=`
Request ID: ${c}`),u){let w=`
Resources:`;for(const y of u){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);w+=`
- ${y}`}p+=w}return`${S}
${p}`}class je extends Error{constructor({message:t,code:e,cause:s,name:n}){var r;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(r=n??(s instanceof Error?s.name:void 0))!==null&&r!==void 0?r:"Unknown Error",this.code=e}}class F0 extends je{constructor(t,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:t}),this.name="WebAuthnUnknownError",this.originalError=e}}function gP({error:i,options:t}){var e,s,n;const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(t.signal instanceof AbortSignal)return new je({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else if(i.name==="ConstraintError"){if(((e=r.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new je({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:i});if(t.mediation==="conditional"&&((s=r.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new je({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:i});if(((n=r.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new je({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:i})}else{if(i.name==="InvalidStateError")return new je({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:i});if(i.name==="NotAllowedError")return new je({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="NotSupportedError")return r.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new je({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:i}):new je({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:i});if(i.name==="SecurityError"){const a=window.location.hostname;if(WR(a)){if(r.rp.id!==a)return new je({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="TypeError"){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new je({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:i})}else if(i.name==="UnknownError")return new je({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}function mP({error:i,options:t}){const{publicKey:e}=t;if(!e)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(t.signal instanceof AbortSignal)return new je({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else{if(i.name==="NotAllowedError")return new je({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="SecurityError"){const s=window.location.hostname;if(WR(s)){if(e.rpId!==s)return new je({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="UnknownError")return new je({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}class pP{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const yP=new pP;function bP(i){if(!i)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(i);const{challenge:t,user:e,excludeCredentials:s}=i,n=Xd(i,["challenge","user","excludeCredentials"]),r=th(t).buffer,a=Object.assign(Object.assign({},e),{id:th(e.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:r,user:a});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const u=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:th(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function vP(i){if(!i)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(i);const{challenge:t,allowCredentials:e}=i,s=Xd(i,["challenge","allowCredentials"]),n=th(t).buffer,r=Object.assign(Object.assign({},s),{challenge:n});if(e&&e.length>0){r.allowCredentials=new Array(e.length);for(let a=0;a<e.length;a++){const l=e[a];r.allowCredentials[a]=Object.assign(Object.assign({},l),{id:th(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return r}function wP(i){var t;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const e=i;return{id:i.id,rawId:i.id,response:{attestationObject:xl(new Uint8Array(i.response.attestationObject)),clientDataJSON:xl(new Uint8Array(i.response.clientDataJSON))},type:"public-key",clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function _P(i){var t;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const e=i,s=i.getClientExtensionResults(),n=i.response;return{id:i.id,rawId:i.id,response:{authenticatorData:xl(new Uint8Array(n.authenticatorData)),clientDataJSON:xl(new Uint8Array(n.clientDataJSON)),signature:xl(new Uint8Array(n.signature)),userHandle:n.userHandle?xl(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function WR(i){return i==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(i)}function uE(){var i,t;return!!(Ss()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((i=navigator==null?void 0:navigator.credentials)===null||i===void 0?void 0:i.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function AP(i){try{const t=await navigator.credentials.create(i);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new F0("Browser returned unexpected credential type",t)}:{data:null,error:new F0("Empty credential response",t)}}catch(t){return{data:null,error:gP({error:t,options:i})}}}async function SP(i){try{const t=await navigator.credentials.get(i);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new F0("Browser returned unexpected credential type",t)}:{data:null,error:new F0("Empty credential response",t)}}catch(t){return{data:null,error:mP({error:t,options:i})}}}const xP={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},EP={userVerification:"preferred",hints:["security-key"]};function H0(...i){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),e=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of i)if(n)for(const r in n){const a=n[r];if(a!==void 0)if(Array.isArray(a))s[r]=a;else if(e(a))s[r]=a;else if(t(a)){const l=s[r];t(l)?s[r]=H0(l,a):s[r]=H0(a)}else s[r]=a}return s}function TP(i,t){return H0(xP,i,t||{})}function CP(i,t){return H0(EP,i,t||{})}class RP{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:e,friendlyName:s,signal:n},r){try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:e});if(!a)return{data:null,error:l};const c=n??yP.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:u}=a.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(a.webauthn.type){case"create":{const u=TP(a.webauthn.credential_options.publicKey,r==null?void 0:r.create),{data:h,error:d}=await AP({publicKey:u,signal:c});return h?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}case"request":{const u=CP(a.webauthn.credential_options.publicKey,r==null?void 0:r.request),{data:h,error:d}=await SP(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:u,signal:c}));return h?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}}}catch(a){return Y(a)?{data:null,error:a}:{data:null,error:new wl("Unexpected error in challenge",a)}}}async _verify({challengeId:t,factorId:e,webauthn:s}){return this.client.mfa.verify({factorId:e,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}},r){if(!e)return{data:null,error:new mg("rpId is required for WebAuthn authentication")};try{if(!uE())return{data:null,error:new wl("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this.challenge({factorId:t,webauthn:{rpId:e,rpOrigins:s},signal:n},{request:r});if(!a)return{data:null,error:l};const{webauthn:c}=a;return this._verify({factorId:t,challengeId:a.challengeId,webauthn:{type:c.type,rpId:e,rpOrigins:s,credential_response:c.credential_response}})}catch(a){return Y(a)?{data:null,error:a}:{data:null,error:new wl("Unexpected error in authenticate",a)}}}async _register({friendlyName:t,rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n},r){if(!e)return{data:null,error:new mg("rpId is required for WebAuthn registration")};try{if(!uE())return{data:null,error:new wl("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this._enroll({friendlyName:t});if(!a)return await this.client.mfa.listFactors().then(h=>{var d;return(d=h.data)===null||d===void 0?void 0:d.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:e,rpOrigins:s},signal:n},{create:r});return c?this._verify({factorId:a.id,challengeId:c.challengeId,webauthn:{rpId:e,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(a){return Y(a)?{data:null,error:a}:{data:null,error:new wl("Unexpected error in register",a)}}}}uP();const OP={url:EL,storageKey:TL,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:CL,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function hE(i,t,e){return await e()}const gu={};class pg{get jwks(){var t,e;return(e=(t=gu[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(t){gu[this.storageKey]=Object.assign(Object.assign({},gu[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,e;return(e=(t=gu[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){gu[this.storageKey]=Object.assign(Object.assign({},gu[this.storageKey]),{cachedAt:t})}constructor(t){var e,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const r=Object.assign(Object.assign({},OP),t);if(this.storageKey=r.storageKey,this.instanceID=(e=pg.nextInstanceID[this.storageKey])!==null&&e!==void 0?e:0,pg.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.instanceID>0&&Ss()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=r.persistSession,this.autoRefreshToken=r.autoRefreshToken,this.admin=new oP({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=XR(r.fetch),this.lock=r.lock||hE,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,this.throwOnError=r.throwOnError,r.lock?this.lock=r.lock:Ss()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=cP:this.lock=hE,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new RP(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:VR()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=cE(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=cE(this.memoryStorage)),Ss()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${$R}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let e={},s="none";if(Ss()&&(e=FL(window.location.href),this._isImplicitGrantCallback(e)?s="implicit":await this._isPKCECallback(e)&&(s="pkce")),Ss()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:r}=await this._getSessionFromURL(e,s);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),DL(r)){const c=(t=r.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:r}}return await this._removeSession(),{error:r}}const{session:a,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Y(e)?this._returnResult({error:e}):this._returnResult({error:new wl("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var e,s,n;try{const r=await et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(e=t==null?void 0:t.options)===null||e===void 0?void 0:e.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:_n}),{data:a,error:l}=r;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(r){if(Y(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signUp(t){var e,s,n;try{let r;if("email"in t){const{email:h,password:d,options:f}=t;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await hu(this.storage,this.storageKey)),r=await et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:h,password:d,data:(e=f==null?void 0:f.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:g,code_challenge_method:b},xform:_n})}else if("phone"in t){const{phone:h,password:d,options:f}=t;r=await et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:_n})}else throw new sy("You must provide either an email or phone number and a password");const{data:a,error:l}=r;if(l||!a)return this._returnResult({data:{user:null,session:null},error:l});const c=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(r){if(Y(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithPassword(t){try{let e;if("email"in t){const{email:r,password:a,options:l}=t;e=await et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:oE})}else if("phone"in t){const{phone:r,password:a,options:l}=t;e=await et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:oE})}else throw new sy("You must provide either an email or phone number and a password");const{data:s,error:n}=e;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const r=new uu;return this._returnResult({data:{user:null,session:null},error:r})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(e){if(Y(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(t){var e,s,n,r;return await this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(r=t.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:e}=t;switch(e){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}}async signInWithEthereum(t){var e,s,n,r,a,l,c,u,h,d,f;let g,b;if("message"in t)g=t.message,b=t.signature;else{const{chain:v,wallet:S,statement:p,options:w}=t;let y;if(Ss())if(typeof S=="object")y=S;else{const k=window;if("ethereum"in k&&typeof k.ethereum=="object"&&"request"in k.ethereum&&typeof k.ethereum.request=="function")y=k.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=S}const E=new URL((e=w==null?void 0:w.url)!==null&&e!==void 0?e:window.location.href),T=await y.request({method:"eth_requestAccounts"}).then(k=>k).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=KR(T[0]);let R=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!R){const k=await y.request({method:"eth_chainId"});R=hP(k)}const O={domain:E.host,address:C,statement:p,uri:E.href,version:"1",chainId:R,nonce:(n=w==null?void 0:w.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(a=(r=w==null?void 0:w.signInWithEthereum)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(h=w==null?void 0:w.signInWithEthereum)===null||h===void 0?void 0:h.resources};g=fP(O),b=await y.request({method:"personal_sign",params:[dP(g),C]})}try{const{data:v,error:S}=await et(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:b},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:_n});if(S)throw S;if(!v||!v.session||!v.user){const p=new uu;return this._returnResult({data:{user:null,session:null},error:p})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:S})}catch(v){if(Y(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(t){var e,s,n,r,a,l,c,u,h,d,f,g;let b,v;if("message"in t)b=t.message,v=t.signature;else{const{chain:S,wallet:p,statement:w,options:y}=t;let E;if(Ss())if(typeof p=="object")E=p;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))E=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=p}const T=new URL((e=y==null?void 0:y.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in E&&E.signIn){const C=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),w?{statement:w}:null));let R;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")R=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)R=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)b=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),v=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${T.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(n=(s=y==null?void 0:y.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((r=y==null?void 0:y.signInWithSolana)===null||r===void 0)&&r.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y==null?void 0:y.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((d=(h=y==null?void 0:y.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||d===void 0)&&d.length?["Resources",...y.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const C=await E.signMessage(new TextEncoder().encode(b),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=C}}try{const{data:S,error:p}=await et(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:xl(v)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(g=t.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:_n});if(p)throw p;if(!S||!S.session||!S.user){const w=new uu;return this._returnResult({data:{user:null,session:null},error:w})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:p})}catch(S){if(Y(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const e=await ul(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(e??"").split("/");try{const{data:r,error:a}=await et(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:_n});if(await La(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!r||!r.session||!r.user){const l=new uu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign(Object.assign({},r),{redirectType:n??null}),error:a})}catch(r){if(Y(r))return this._returnResult({data:{user:null,session:null,redirectType:null},error:r});throw r}}async signInWithIdToken(t){try{const{options:e,provider:s,token:n,access_token:r,nonce:a}=t,l=await et(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:r,nonce:a,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:_n}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const h=new uu;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(e){if(Y(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(t){var e,s,n,r,a;try{if("email"in t){const{email:l,options:c}=t;let u=null,h=null;this.flowType==="pkce"&&([u,h]=await hu(this.storage,this.storageKey));const{error:d}=await et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(e=c==null?void 0:c.data)!==null&&e!==void 0?e:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:h},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:h}=await et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:h})}throw new sy("You must provide either an email or phone number.")}catch(l){if(Y(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var e,s;try{let n,r;"options"in t&&(n=(e=t.options)===null||e===void 0?void 0:e.redirectTo,r=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:l}=await et(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:r}}),redirectTo:n,xform:_n});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,u=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(n){if(Y(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(t){var e,s,n;try{let r=null,a=null;this.flowType==="pkce"&&([r,a]=await hu(this.storage,this.storageKey));const l=await et(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:a}),headers:this.headers,xform:nP});return this._returnResult(l)}catch(r){if(Y(r))return this._returnResult({data:null,error:r});throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:e},error:s}=t;if(s)throw s;if(!e)throw new wn;const{error:n}=await et(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(t){if(Y(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const e=`${this.url}/resend`;if("email"in t){const{email:s,type:n,options:r}=t,{error:a}=await et(this.fetch,"POST",e,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},redirectTo:r==null?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in t){const{phone:s,type:n,options:r}=t,{data:a,error:l}=await et(this.fetch,"POST",e,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l})}throw new sy("You must provide either an email or phone number and a type")}catch(e){if(Y(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await e()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=e();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const e=await ul(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<Iv:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const a=await ul(this.userStorage,this.storageKey+"-user");a!=null&&a.user?t.user=a.user:t.user=Fv()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};t.user=tP(t.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:n,error:r}=await this._callRefreshToken(t.refresh_token);return r?this._returnResult({data:{session:null},error:r}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:$a}):await this._useSession(async e=>{var s,n,r;const{data:a,error:l}=e;if(l)throw l;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new wn}:await et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&r!==void 0?r:void 0,xform:$a})})}catch(e){if(Y(e))return ML(e)&&(await this._removeSession(),await La(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async s=>{const{data:n,error:r}=s;if(r)throw r;if(!n.session)throw new wn;const a=n.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await hu(this.storage,this.storageKey));const{data:u,error:h}=await et(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:$a});if(h)throw h;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(s){if(Y(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new wn;const e=Date.now()/1e3;let s=e,n=!0,r=null;const{payload:a}=zv(t.access_token);if(a.exp&&(s=a.exp,n=s<=e),n){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};r=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;r={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:s-e,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return this._returnResult({data:{user:r.user,session:r},error:null})}catch(e){if(Y(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var s;if(!t){const{data:a,error:l}=e;if(l)throw l;t=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new wn;const{data:n,error:r}=await this._callRefreshToken(t.refresh_token);return r?this._returnResult({data:{user:null,session:null},error:r}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(Y(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(t,e){try{if(!Ss())throw new iy("No browser detected.");if(t.error||t.error_description||t.error_code)throw new iy(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new tE("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new iy("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new tE("No code detected.");const{data:w,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:r,refresh_token:a,expires_in:l,expires_at:c,token_type:u}=t;if(!r||!l||!a||!u)throw new iy("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(l);let f=h+d;c&&(f=parseInt(c));const g=f-h;g*1e3<=vu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${d}s`);const b=f-d;h-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,f,h):h-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,f,h);const{data:v,error:S}=await this._getUser(r);if(S)throw S;const p={provider_token:s,provider_refresh_token:n,access_token:r,expires_in:d,expires_at:f,refresh_token:a,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:p,redirectType:t.type},error:null})}catch(s){if(Y(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const e=await ul(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var s;const{data:n,error:r}=e;if(r)return this._returnResult({error:r});const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:l}=await this.admin.signOut(a,t);if(l&&!(NL(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await La(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const e=zL(),s={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async e=>{var s,n;try{const{data:{session:r},error:a}=e;if(a)throw a;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",t,"session",r)}catch(r){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",r),console.error(r)}})}async resetPasswordForEmail(t,e={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await hu(this.storage,this.storageKey,!0));try{return await et(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(r){if(Y(r))return this._returnResult({data:null,error:r});throw r}}async getUserIdentities(){var t;try{const{data:e,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=e.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(e){if(Y(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var e;try{const{data:s,error:n}=await this._useSession(async r=>{var a,l,c,u,h;const{data:d,error:f}=r;if(f)throw f;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await et(this.fetch,"GET",g,{headers:this.headers,jwt:(h=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&h!==void 0?h:void 0})});if(n)throw n;return Ss()&&!(!((e=t.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:t.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Y(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async e=>{var s;try{const{error:n,data:{session:r}}=e;if(n)throw n;const{options:a,provider:l,token:c,access_token:u,nonce:h}=t,d=await et(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=r==null?void 0:r.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:u,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:_n}),{data:f,error:g}=d;return g?this._returnResult({data:{user:null,session:null},error:g}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new uu}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:g}))}catch(n){if(Y(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(t){try{return await this._useSession(async e=>{var s,n;const{data:r,error:a}=e;if(a)throw a;return await et(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(e){if(Y(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(t){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const s=Date.now();return await qL(async n=>(n>0&&await $L(200*Math.pow(2,n-1)),this._debug(e,"refreshing attempt",n),await et(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:_n})),(n,r)=>{const a=200*Math.pow(2,n);return r&&Uv(r)&&Date.now()+a-s<vu})}catch(s){if(this._debug(e,"error",s),Y(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(e,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",s),Ss()&&!e.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,e;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await ul(this.storage,this.storageKey);if(n&&this.userStorage){let a=await ul(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:n.user},await wu(this.userStorage,this.storageKey+"-user",a)),n.user=(t=a==null?void 0:a.user)!==null&&t!==void 0?t:Fv()}else if(n&&!n.user&&!n.user){const a=await ul(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(n.user=a.user,await La(this.storage,this.storageKey+"-user"),await wu(this.storage,this.storageKey,n)):n.user=Fv()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const r=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Iv;if(this._debug(s,`session has${r?"":" not"} expired with margin of ${Iv}s`),r){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),Uv(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(n.access_token);!l&&(a!=null&&a.user)?(n.user=a.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var e,s;if(!t)throw new wn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Hb;const{data:r,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!r.session)throw new wn;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const l={data:r.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(r){if(this._debug(n,"error",r),Y(r)){const a={data:null,error:r};return Uv(r)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,e,s=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",e,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:e});const r=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,e)}catch(c){r.push(c)}});if(await Promise.all(a),r.length>0){for(let l=0;l<r.length;l+=1)console.error(r[l]);throw r[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const e=Object.assign({},t),s=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&e.user&&await wu(this.userStorage,this.storageKey+"-user",{user:e.user});const n=Object.assign({},e);delete n.user;const r=rE(n);await wu(this.storage,this.storageKey,r)}else{const n=rE(e);await wu(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await La(this.storage,this.storageKey),await La(this.storage,this.storageKey+"-code-verifier"),await La(this.storage,this.storageKey+"-user"),this.userStorage&&await La(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ss()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),vu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-t)/vu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${vu}ms, refresh threshold is ${n_} ticks`),n<=n_&&await this._callRefreshToken(s.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof YR)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ss()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e,s){const n=[`provider=${encodeURIComponent(e)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[r,a]=await hu(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const r=new URLSearchParams(s.queryParams);n.push(r.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var s;const{data:n,error:r}=e;return r?this._returnResult({data:null,error:r}):await et(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(e){if(Y(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(t){try{return await this._useSession(async e=>{var s,n;const{data:r,error:a}=e;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await et(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(e){if(Y(e))return this._returnResult({data:null,error:e});throw e}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var s;const{data:n,error:r}=e;if(r)return this._returnResult({data:null,error:r});const a=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?wP(t.webauthn.credential_response):_P(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await et(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:a,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(e){if(Y(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var s;const{data:n,error:r}=e;if(r)return this._returnResult({data:null,error:r});const a=await et(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(a.error)return a;const{data:l}=a;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:bP(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:vP(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(Y(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(t){const{data:e,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){var t;const{data:{user:e},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const r of(t=e==null?void 0:e.factors)!==null&&t!==void 0?t:[])n.all.push(r),r.status==="verified"&&n[r.factor_type].push(r);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var t,e;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:r}=zv(s.access_token);let a=null;r.aal&&(a=r.aal);let l=a;((e=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&e!==void 0?e:[]).length>0&&(l="aal2");const u=r.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async e=>{const{data:{session:s},error:n}=e;return n?this._returnResult({data:null,error:n}):s?await et(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new wn})})}catch(e){if(Y(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(t,e){try{return await this._useSession(async s=>{const{data:{session:n},error:r}=s;if(r)return this._returnResult({data:null,error:r});if(!n)return this._returnResult({data:null,error:new wn});const a=await et(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&Ss()&&!(e!=null&&e.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(Y(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,e){try{return await this._useSession(async s=>{const{data:{session:n},error:r}=s;if(r)return this._returnResult({data:null,error:r});if(!n)return this._returnResult({data:null,error:new wn});const a=await et(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return a.data&&a.data.redirect_url&&Ss()&&!(e!=null&&e.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(Y(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(t,e={keys:[]}){let s=e.keys.find(l=>l.kid===t);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===t),s&&this.jwks_cached_at+OL>n)return s;const{data:r,error:a}=await et(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!r.keys||r.keys.length===0||(this.jwks=r,this.jwks_cached_at=n,s=r.keys.find(l=>l.kid===t),!s)?null:s}async getClaims(t,e={}){try{let s=t;if(!s){const{data:g,error:b}=await this.getSession();if(b||!g.session)return this._returnResult({data:null,error:b});s=g.session.access_token}const{header:n,payload:r,signature:a,raw:{header:l,payload:c}}=zv(s);e!=null&&e.allowExpired||QL(r.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,e!=null&&e.keys?{keys:e.keys}:e==null?void 0:e.jwks);if(!u){const{error:g}=await this.getUser(s);if(g)throw g;return{data:{claims:r,header:n,signature:a},error:null}}const h=JL(n.alg),d=await crypto.subtle.importKey("jwk",u,h,!0,["verify"]);if(!await crypto.subtle.verify(h,d,a,IL(`${l}.${c}`)))throw new o_("Invalid JWT signature");return{data:{claims:r,header:n,signature:a},error:null}}catch(s){if(Y(s))return this._returnResult({data:null,error:s});throw s}}}pg.nextInstanceID={};const kP=pg;class NP extends kP{constructor(t){super(t)}}class MP{constructor(t,e,s){var n,r,a;this.supabaseUrl=t,this.supabaseKey=e;const l=xL(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:pL,realtime:bL,auth:Object.assign(Object.assign({},yL),{storageKey:c}),global:mL},h=SL(s??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(r=h.global.headers)!==null&&r!==void 0?r:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=_L(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Ej(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new dL(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new Aj(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,s)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,e;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(e=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:n,userStorage:r,storageKey:a,flowType:l,lock:c,debug:u,throwOnError:h},d,f){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new NP({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),d),storageKey:a,autoRefreshToken:t,persistSession:e,detectSessionInUrl:s,storage:n,userStorage:r,flowType:l,lock:c,debug:u,throwOnError:h,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Hj(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,s)=>{this._handleTokenChanged(e,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(t,e,s){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const DP=(i,t,e)=>new MP(i,t,e);function jP(){if(typeof window<"u"||typeof process>"u")return!1;const i=process.version;if(i==null)return!1;const t=i.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}jP()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const LP="https://mkpldwagksjhzjmyfeok.supabase.co",PP="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1rcGxkd2Fna3NqaHpqbXlmZW9rIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1OTY2MzMsImV4cCI6MjA3NjE3MjYzM30.sP5HXQl4U24U0WIRzFRj-shk3RFDGpXG6LqJn3MIcjw",$t=DP(LP,PP),QR=q.createContext(void 0);function nu(){const i=q.useContext(QR);if(i===void 0)throw new Error("useAuth must be used within an AuthProvider");return i}function BP({children:i}){const[t,e]=q.useState(null),[s,n]=q.useState(null),[r,a]=q.useState(!0);q.useEffect(()=>{$t.auth.getSession().then(({data:{session:f}})=>{n(f),e((f==null?void 0:f.user)??null),a(!1)});const{data:{subscription:d}}=$t.auth.onAuthStateChange((f,g)=>{n(g),e((g==null?void 0:g.user)??null),a(!1)});return()=>d.unsubscribe()},[]);const h={user:t,session:s,loading:r,signIn:async(d,f)=>{const{error:g}=await $t.auth.signInWithPassword({email:d,password:f});return{error:g}},signUp:async(d,f)=>{const{error:g}=await $t.auth.signUp({email:d,password:f});return{error:g}},signOut:async()=>{await $t.auth.signOut()}};return _.jsx(QR.Provider,{value:h,children:i})}/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),UP=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,s)=>s?s.toUpperCase():e.toLowerCase()),dE=i=>{const t=UP(i);return t.charAt(0).toUpperCase()+t.slice(1)},JR=(...i)=>i.filter((t,e,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===e).join(" ").trim(),zP=i=>{for(const t in i)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var FP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=q.forwardRef(({color:i="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:s,className:n="",children:r,iconNode:a,...l},c)=>q.createElement("svg",{ref:c,...FP,width:t,height:t,stroke:i,strokeWidth:s?Number(e)*24/Number(t):e,className:JR("lucide",n),...!r&&!zP(l)&&{"aria-hidden":"true"},...l},[...a.map(([u,h])=>q.createElement(u,h)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=(i,t)=>{const e=q.forwardRef(({className:s,...n},r)=>q.createElement(HP,{ref:r,iconNode:t,className:JR(`lucide-${IP(dE(i))}`,`lucide-${i}`,s),...n}));return e.displayName=dE(i),e};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],fE=Bt("bot",$P);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Ry=Bt("brain",qP);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],XS=Bt("circle-alert",GP);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],YS=Bt("circle-check",VP);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],YP=Bt("circle",XP);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],WP=Bt("clock",KP);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],$v=Bt("crown",QP);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ZP=Bt("download",JP);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],$0=Bt("file-text",tB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],br=Bt("loader",eB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],iB=Bt("lock",sB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],rB=Bt("log-in",nB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],oB=Bt("log-out",aB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],cB=Bt("mail",lB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],hB=Bt("message-circle",uB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],gE=Bt("pause",dB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],l_=Bt("play",fB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],mB=Bt("plus",gB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],yB=Bt("rotate-ccw",pB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ZR=Bt("send",bB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],mE=Bt("settings",vB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],_B=Bt("target",wB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],SB=Bt("timer",AB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],EB=Bt("trash-2",xB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],$b=Bt("trophy",TB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],RB=Bt("upload",CB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],pE=Bt("user-check",OB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],NB=Bt("user",kB);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],tO=Bt("users",MB);function DB({children:i,currentPage:t,onPageChange:e}){const{user:s,signOut:n}=nu(),r=[{id:"documents",name:"Documents",icon:$0},{id:"chat",name:"Q&A Chat",icon:hB},{id:"quiz",name:"Self Quiz",icon:Ry},{id:"team",name:"Team Challenge",icon:tO}];return _.jsxs("div",{className:"min-h-screen bg-gray-50",children:[_.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:_.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:_.jsxs("div",{className:"flex justify-between items-center h-16",children:[_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx("div",{className:"flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 bg-primary-600 rounded-lg",children:_.jsx($b,{className:"w-4 h-4 sm:w-6 sm:h-6 text-white"})}),_.jsxs("div",{className:"hidden sm:block",children:[_.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Formula Student Trainer"}),_.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"CTM Quiz Training Platform"})]}),_.jsx("div",{className:"sm:hidden",children:_.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"FS Trainer"})})]}),_.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[_.jsxs("span",{className:"text-xs sm:text-sm text-gray-600 hidden sm:inline",children:["Welcome, ",s==null?void 0:s.email]}),_.jsxs("button",{onClick:n,className:"flex items-center space-x-1 sm:space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[_.jsx(oB,{className:"w-3 h-3 sm:w-4 sm:h-4"}),_.jsx("span",{className:"text-xs sm:text-sm",children:"Sign Out"})]})]})]})})}),_.jsxs("div",{className:"flex",children:[_.jsx("nav",{className:"w-16 sm:w-64 bg-white shadow-sm min-h-screen border-r border-gray-200",children:_.jsx("div",{className:"p-2 sm:p-4",children:_.jsx("div",{className:"space-y-2",children:r.map(a=>{const l=a.icon;return _.jsxs("button",{onClick:()=>e(a.id),className:`nav-link w-full text-left justify-center sm:justify-start ${t===a.id?"active":""}`,title:a.name,children:[_.jsx(l,{className:"w-4 h-4 sm:w-5 sm:h-5"}),_.jsx("span",{className:"hidden sm:inline",children:a.name})]},a.id)})})})}),_.jsx("main",{className:"flex-1 p-2 sm:p-4 lg:p-6",children:_.jsx("div",{className:"max-w-6xl mx-auto",children:i})})]})]})}function jB(){const[i,t]=q.useState(!1),[e,s]=q.useState(""),[n,r]=q.useState(""),[a,l]=q.useState(!1),[c,u]=q.useState(""),{signIn:h,signUp:d}=nu(),f=async g=>{g.preventDefault(),l(!0),u("");try{const{error:b}=i?await d(e,n):await h(e,n);b&&u(b.message)}catch{u("An unexpected error occurred")}finally{l(!1)}};return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center p-4",children:_.jsxs("div",{className:"max-w-md w-full",children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("div",{className:"flex items-center justify-center w-16 h-16 bg-primary-600 rounded-2xl mx-auto mb-4",children:_.jsx($b,{className:"w-8 h-8 text-white"})}),_.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Formula Student Trainer"}),_.jsx("p",{className:"text-gray-600",children:"CTM Quiz Training Platform"})]}),_.jsxs("div",{className:"card",children:[_.jsxs("div",{className:"mb-6",children:[_.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:i?"Create Account":"Welcome Back"}),_.jsx("p",{className:"text-gray-600",children:i?"Join your team and start training":"Sign in to continue your training"})]}),c&&_.jsxs("div",{className:"mb-4 p-3 bg-danger-50 border border-danger-200 rounded-lg flex items-center space-x-2",children:[_.jsx(XS,{className:"w-5 h-5 text-danger-600"}),_.jsx("span",{className:"text-danger-700 text-sm",children:c})]}),_.jsxs("form",{onSubmit:f,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),_.jsxs("div",{className:"relative",children:[_.jsx(cB,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),_.jsx("input",{id:"email",type:"email",value:e,onChange:g=>s(g.target.value),className:"input-field pl-10",placeholder:"Enter your email",required:!0})]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),_.jsxs("div",{className:"relative",children:[_.jsx(iB,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),_.jsx("input",{id:"password",type:"password",value:n,onChange:g=>r(g.target.value),className:"input-field pl-10",placeholder:"Enter your password",required:!0,minLength:6})]})]}),_.jsx("button",{type:"submit",disabled:a,className:"btn-primary w-full",children:a?_.jsx("span",{className:"loading-dots",children:i?"Creating Account":"Signing In"}):i?"Create Account":"Sign In"})]}),_.jsx("div",{className:"mt-6 text-center",children:_.jsx("button",{onClick:()=>t(!i),className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:i?"Already have an account? Sign in":"Don't have an account? Sign up"})})]}),_.jsx("div",{className:"mt-8 text-center text-sm text-gray-500",children:_.jsx("p",{children:"Powered by AI  Secure  Real-time Collaboration"})})]})})}const Bs=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),c_=[.001,0,0,.001,0,0],qv=1.35,Ci={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},qa={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},yg="pdfjs_internal_editor_",ot={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},At={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},LB={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},u_={TRIANGLES:1,LATTICE:2},os={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Oy={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Me={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},_u={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},qb={ERRORS:0,WARNINGS:1,INFOS:5},bg={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},rf={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},PB={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Gb=qb.WARNINGS;function BB(i){Number.isInteger(i)&&(Gb=i)}function IB(){return Gb}function Vb(i){Gb>=qb.INFOS&&console.info(`Info: ${i}`)}function nt(i){Gb>=qb.WARNINGS&&console.warn(`Warning: ${i}`)}function Wt(i){throw new Error(i)}function St(i,t){i||Wt(t)}function UB(i){switch(i==null?void 0:i.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function eO(i,t=null,e=null){if(!i)return null;if(e&&typeof i=="string"){if(e.addDefaultProtocol&&i.startsWith("www.")){const n=i.match(/\./g);(n==null?void 0:n.length)>=2&&(i=`http://${i}`)}if(e.tryConvertEncoding)try{i=qB(i)}catch{}}const s=t?URL.parse(i,t):URL.parse(i);return UB(s)?s:null}function sO(i,t,e=!1){const s=URL.parse(i);return s?(s.hash=t,s.href):e&&eO(i,"http://example.com")?i.split("#",1)[0]+`${t?`#${t}`:""}`:""}function ut(i,t,e,s=!1){return Object.defineProperty(i,t,{value:e,enumerable:!s,configurable:!0,writable:!1}),e}const ru=function(){function t(e,s){this.message=e,this.name=s}return t.prototype=new Error,t.constructor=t,t}();class yE extends ru{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Gv extends ru{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class h_ extends ru{constructor(t){super(t,"InvalidPDFException")}}class q0 extends ru{constructor(t,e,s){super(t,"ResponseException"),this.status=e,this.missing=s}}class zB extends ru{constructor(t){super(t,"FormatError")}}class el extends ru{constructor(t){super(t,"AbortException")}}function iO(i){(typeof i!="object"||(i==null?void 0:i.length)===void 0)&&Wt("Invalid argument for bytesToString");const t=i.length,e=8192;if(t<e)return String.fromCharCode.apply(null,i);const s=[];for(let n=0;n<t;n+=e){const r=Math.min(n+e,t),a=i.subarray(n,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function xp(i){typeof i!="string"&&Wt("Invalid argument for stringToBytes");const t=i.length,e=new Uint8Array(t);for(let s=0;s<t;++s)e[s]=i.charCodeAt(s)&255;return e}function FB(i){return String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255)}function HB(){const i=new Uint8Array(4);return i[0]=1,new Uint32Array(i.buffer,0,1)[0]===1}function $B(){try{return new Function(""),!0}catch{return!1}}class _s{static get isLittleEndian(){return ut(this,"isLittleEndian",HB())}static get isEvalSupported(){return ut(this,"isEvalSupported",$B())}static get isOffscreenCanvasSupported(){return ut(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ut(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ut(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ut(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return ut(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){var t,e;return ut(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const Vv=Array.from(Array(256).keys(),i=>i.toString(16).padStart(2,"0"));var Sa,ky,d_;class ${static makeHexColor(t,e,s){return`#${Vv[t]}${Vv[e]}${Vv[s]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let s;t[0]?(t[0]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[3],e[3]*=t[3]):(s=e[0],e[0]=e[1],e[1]=s,s=e[2],e[2]=e[3],e[3]=s,t[1]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,s=0){const n=t[s],r=t[s+1];t[s]=n*e[0]+r*e[2]+e[4],t[s+1]=n*e[1]+r*e[3]+e[5]}static applyTransformToBezier(t,e,s=0){const n=e[0],r=e[1],a=e[2],l=e[3],c=e[4],u=e[5];for(let h=0;h<6;h+=2){const d=t[s+h],f=t[s+h+1];t[s+h]=d*n+f*a+c,t[s+h+1]=d*r+f*l+u}}static applyInverseTransform(t,e){const s=t[0],n=t[1],r=e[0]*e[3]-e[1]*e[2];t[0]=(s*e[3]-n*e[2]+e[2]*e[5]-e[4]*e[3])/r,t[1]=(-s*e[1]+n*e[0]+e[4]*e[1]-e[5]*e[0])/r}static axialAlignedBoundingBox(t,e,s){const n=e[0],r=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=t[0],d=t[1],f=t[2],g=t[3];let b=n*h+c,v=b,S=n*f+c,p=S,w=l*d+u,y=w,E=l*g+u,T=E;if(r!==0||a!==0){const C=r*h,R=r*f,O=a*d,k=a*g;b+=O,p+=O,S+=k,v+=k,w+=C,T+=C,E+=R,y+=R}s[0]=Math.min(s[0],b,S,v,p),s[1]=Math.min(s[1],w,E,y,T),s[2]=Math.max(s[2],b,S,v,p),s[3]=Math.max(s[3],w,E,y,T)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const s=t[0],n=t[1],r=t[2],a=t[3],l=s**2+n**2,c=s*r+n*a,u=r**2+a**2,h=(l+u)/2,d=Math.sqrt(h**2-(l*u-c**2));e[0]=Math.sqrt(h+d||1),e[1]=Math.sqrt(h-d||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>n)return null;const r=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return r>a?null:[s,r,n,a]}static pointBoundingBox(t,e,s){s[0]=Math.min(s[0],t),s[1]=Math.min(s[1],e),s[2]=Math.max(s[2],t),s[3]=Math.max(s[3],e)}static rectBoundingBox(t,e,s,n,r){r[0]=Math.min(r[0],t,s),r[1]=Math.min(r[1],e,n),r[2]=Math.max(r[2],t,s),r[3]=Math.max(r[3],e,n)}static bezierBoundingBox(t,e,s,n,r,a,l,c,u){u[0]=Math.min(u[0],t,l),u[1]=Math.min(u[1],e,c),u[2]=Math.max(u[2],t,l),u[3]=Math.max(u[3],e,c),x(this,Sa,d_).call(this,t,s,r,l,e,n,a,c,3*(-t+3*(s-r)+l),6*(t-2*s+r),3*(s-t),u),x(this,Sa,d_).call(this,t,s,r,l,e,n,a,c,3*(-e+3*(n-a)+c),6*(e-2*n+a),3*(n-e),u)}}Sa=new WeakSet,ky=function(t,e,s,n,r,a,l,c,u,h){if(u<=0||u>=1)return;const d=1-u,f=u*u,g=f*u,b=d*(d*(d*t+3*u*e)+3*f*s)+g*n,v=d*(d*(d*r+3*u*a)+3*f*l)+g*c;h[0]=Math.min(h[0],b),h[1]=Math.min(h[1],v),h[2]=Math.max(h[2],b),h[3]=Math.max(h[3],v)},d_=function(t,e,s,n,r,a,l,c,u,h,d,f){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&x(this,Sa,ky).call(this,t,e,s,n,r,a,l,c,-d/h,f);return}const g=h**2-4*d*u;if(g<0)return;const b=Math.sqrt(g),v=2*u;x(this,Sa,ky).call(this,t,e,s,n,r,a,l,c,(-h+b)/v,f),x(this,Sa,ky).call(this,t,e,s,n,r,a,l,c,(-h-b)/v,f)},A($,Sa);function qB(i){return decodeURIComponent(escape(i))}let Xv=null,bE=null;function GB(i){return Xv||(Xv=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,bE=new Map([["","t"]])),i.replaceAll(Xv,(t,e,s)=>e?e.normalize("NFKC"):bE.get(s))}function nO(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const i=new Uint8Array(32);return crypto.getRandomValues(i),iO(i)}const Fu="pdfjs_internal_id_";function VB(i,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[s,n,...r]=e;if(!i(s)&&!Number.isInteger(s)||!t(n))return!1;const a=r.length;let l=!0;switch(n.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;l=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||l&&c===null))return!1;return!0}function Is(i,t,e){return Math.min(Math.max(i,t),e)}function rO(i){return Uint8Array.prototype.toBase64?i.toBase64():btoa(iO(i))}function XB(i){return Uint8Array.fromBase64?Uint8Array.fromBase64(i):xp(atob(i))}typeof Promise.try!="function"&&(Promise.try=function(i,...t){return new Promise(e=>{e(i(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(i){return i.reduce((t,e)=>t+e,0)});class vg{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};function n(r){var c;if(!r)return;let a=null;const l=r.name;if(l==="#text")a=r.value;else if(vg.shouldBuildText(l))(c=r==null?void 0:r.attributes)!=null&&c.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&e.push({str:a}),!!r.children)for(const u of r.children)n(u)}return n(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class aO{static setupStorage(t,e,s,n,r){const a=n.getValue(e,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),r==="print")break;t.addEventListener("input",l=>{n.setValue(e,{value:l.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?t.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&t.removeAttribute("checked"),r==="print")break;t.addEventListener("change",l=>{n.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),r==="print")break;t.addEventListener("input",l=>{n.setValue(e,{value:l.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const l of s.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const c=l.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;n.setValue(e,{value:u})});break}}static setAttributes({html:t,element:e,storage:s=null,intent:n,linkService:r}){const{attributes:a}=e,l=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${n}`);for(const[c,u]of Object.entries(a))if(u!=null)switch(c){case"class":u.length&&t.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",u);break;case"style":Object.assign(t.style,u);break;case"textContent":t.textContent=u;break;default:(!l||c!=="href"&&c!=="newWindow")&&t.setAttribute(c,u)}l&&r.addLinkAttributes(t,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(t,a.dataId,e,s)}static render(t){var d,f;const e=t.annotationStorage,s=t.linkService,n=t.xfaHtml,r=t.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:r,linkService:s});const l=r!=="richText",c=t.div;if(c.append(a),t.viewport){const g=`matrix(${t.viewport.transform.join(",")})`;c.style.transform=g}l&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(n.children.length===0){if(n.value){const g=document.createTextNode(n.value);a.append(g),l&&vg.shouldBuildText(n.name)&&u.push(g)}return{textDivs:u}}const h=[[n,-1,a]];for(;h.length>0;){const[g,b,v]=h.at(-1);if(b+1===g.children.length){h.pop();continue}const S=g.children[++h.at(-1)[1]];if(S===null)continue;const{name:p}=S;if(p==="#text"){const y=document.createTextNode(S.value);u.push(y),v.append(y);continue}const w=(d=S==null?void 0:S.attributes)!=null&&d.xmlns?document.createElementNS(S.attributes.xmlns,p):document.createElement(p);if(v.append(w),S.attributes&&this.setAttributes({html:w,element:S,storage:e,intent:r,linkService:s}),((f=S.children)==null?void 0:f.length)>0)h.push([S,-1,w]);else if(S.value){const y=document.createTextNode(S.value);l&&vg.shouldBuildText(p)&&u.push(y),w.append(y)}}for(const g of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:u}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Rr="http://www.w3.org/2000/svg",_l=class _l{};B(_l,"CSS",96),B(_l,"PDF",72),B(_l,"PDF_TO_CSS_UNITS",_l.CSS/_l.PDF);let sl=_l;async function Ep(i,t="text"){if(pf(i,document.baseURI)){const e=await fetch(i);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,s)=>{const n=new XMLHttpRequest;n.open("GET",i,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200||n.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(n.response);return}e(n.responseText);return}s(new Error(n.statusText))}},n.send(null)})}class Tp{constructor({viewBox:t,userUnit:e,scale:s,rotation:n,offsetX:r=0,offsetY:a=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=e,this.scale=s,this.rotation=n,this.offsetX=r,this.offsetY=a,s*=e;const c=(t[2]+t[0])/2,u=(t[3]+t[1])/2;let h,d,f,g;switch(n%=360,n<0&&(n+=360),n){case 180:h=-1,d=0,f=0,g=1;break;case 90:h=0,d=1,f=1,g=0;break;case 270:h=0,d=-1,f=-1,g=0;break;case 0:h=1,d=0,f=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(f=-f,g=-g);let b,v,S,p;h===0?(b=Math.abs(u-t[1])*s+r,v=Math.abs(c-t[0])*s+a,S=(t[3]-t[1])*s,p=(t[2]-t[0])*s):(b=Math.abs(c-t[0])*s+r,v=Math.abs(u-t[1])*s+a,S=(t[2]-t[0])*s,p=(t[3]-t[1])*s),this.transform=[h*s,d*s,f*s,g*s,b-h*s*c-f*s*u,v-d*s*c-g*s*u],this.width=S,this.height=p}get rawDims(){const t=this.viewBox;return ut(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:r=!1}={}){return new Tp({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:n,dontFlip:r})}convertToViewportPoint(t,e){const s=[t,e];return $.applyTransform(s,this.transform),s}convertToViewportRectangle(t){const e=[t[0],t[1]];$.applyTransform(e,this.transform);const s=[t[2],t[3]];return $.applyTransform(s,this.transform),[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){const s=[t,e];return $.applyInverseTransform(s,this.transform),s}}class KS extends ru{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Xb(i){const t=i.length;let e=0;for(;e<t&&i[e].trim()==="";)e++;return i.substring(e,e+5).toLowerCase()==="data:"}function WS(i){return typeof i=="string"&&/\.pdf$/i.test(i)}function YB(i){return[i]=i.split(/[#?]/,1),i.substring(i.lastIndexOf("/")+1)}function KB(i,t="document.pdf"){if(typeof i!="string")return t;if(Xb(i))return nt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=(l=>{try{return new URL(l)}catch{try{return new URL(decodeURIComponent(l))}catch{try{return new URL(l,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(l),"https://foo.bar")}catch{return null}}}}})(i);if(!s)return t;const n=l=>{try{let c=decodeURIComponent(l);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:l):c}catch{return l}},r=/\.pdf$/i,a=s.pathname.split("/").at(-1);if(r.test(a))return n(a);if(s.searchParams.size>0){const l=Array.from(s.searchParams.values()).reverse();for(const u of l)if(r.test(u))return n(u);const c=Array.from(s.searchParams.keys()).reverse();for(const u of c)if(r.test(u))return n(u)}if(s.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(c)return n(c[0])}return t}class vE{constructor(){B(this,"started",Object.create(null));B(this,"times",[])}time(t){t in this.started&&nt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||nt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:s}of this.times)e=Math.max(s.length,e);for(const{name:s,start:n,end:r}of this.times)t.push(`${s.padEnd(e)} ${r-n}ms
`);return t.join("")}}function pf(i,t){const e=t?URL.parse(i,t):URL.parse(i);return(e==null?void 0:e.protocol)==="http:"||(e==null?void 0:e.protocol)==="https:"}function bn(i){i.preventDefault()}function xe(i){i.preventDefault(),i.stopPropagation()}function WB(i){console.log("Deprecated API usage: "+i)}var Ag;class G0{static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;o(this,Ag)||m(this,Ag,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=o(this,Ag).exec(t);if(!e)return null;const s=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(e[6],10);c=c>=0&&c<=59?c:0;const u=e[7]||"Z";let h=parseInt(e[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(e[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(a+=h,l+=d):u==="+"&&(a-=h,l-=d),new Date(Date.UTC(s,n,r,a,l,c))}}Ag=new WeakMap,A(G0,Ag);function QB(i,{scale:t=1,rotation:e=0}){const{width:s,height:n}=i.attributes.style,r=[0,0,parseInt(s),parseInt(n)];return new Tp({viewBox:r,userUnit:1,scale:t,rotation:e})}function Cp(i){if(i.startsWith("#")){const t=parseInt(i.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return i.startsWith("rgb(")?i.slice(4,-1).split(",").map(t=>parseInt(t)):i.startsWith("rgba(")?i.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(nt(`Not a valid color format: "${i}"`),[0,0,0])}function JB(i){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of i.keys()){t.style.color=e;const s=window.getComputedStyle(t).color;i.set(e,Cp(s))}t.remove()}function me(i){const{a:t,b:e,c:s,d:n,e:r,f:a}=i.getTransform();return[t,e,s,n,r,a]}function Hn(i){const{a:t,b:e,c:s,d:n,e:r,f:a}=i.getTransform().invertSelf();return[t,e,s,n,r,a]}function Wc(i,t,e=!1,s=!0){if(t instanceof Tp){const{pageWidth:n,pageHeight:r}=t.rawDims,{style:a}=i,l=_s.isCSSRoundSupported,c=`var(--total-scale-factor) * ${n}px`,u=`var(--total-scale-factor) * ${r}px`,h=l?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,d=l?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!e||t.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}s&&i.setAttribute("data-main-rotation",t.rotation)}class vr{constructor(){const{pixelRatio:t}=vr;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,s,n,r=-1){let a=1/0,l=1/0,c=1/0;s=vr.capPixels(s,r),s>0&&(a=Math.sqrt(s/(t*e))),n!==-1&&(l=n/t,c=n/e);const u=Math.min(a,l,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,s):s}return t}}const f_=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class ZB{static get isDarkMode(){var t;return ut(this,"isDarkMode",!!((t=window==null?void 0:window.matchMedia)!=null&&t.call(window,"(prefers-color-scheme: dark)").matches))}}class t3{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:s}=window.getComputedStyle(t);return t.remove(),ut(this,"commentForegroundColor",Cp(s))}}function e3(i,t,e,s){s=Math.min(Math.max(s??1,0),1);const n=255*(1-s);return i=Math.round(i*s+n),t=Math.round(t*s+n),e=Math.round(e*s+n),[i,t,e]}function wE(i,t){const e=i[0]/255,s=i[1]/255,n=i[2]/255,r=Math.max(e,s,n),a=Math.min(e,s,n),l=(r+a)/2;if(r===a)t[0]=t[1]=0;else{const c=r-a;switch(t[1]=l<.5?c/(r+a):c/(2-r-a),r){case e:t[0]=((s-n)/c+(s<n?6:0))*60;break;case s:t[0]=((n-e)/c+2)*60;break;case n:t[0]=((e-s)/c+4)*60;break}}t[2]=l}function g_(i,t){const e=i[0],s=i[1],n=i[2],r=(1-Math.abs(2*n-1))*s,a=r*(1-Math.abs(e/60%2-1)),l=n-r/2;switch(Math.floor(e/60)){case 0:t[0]=r+l,t[1]=a+l,t[2]=l;break;case 1:t[0]=a+l,t[1]=r+l,t[2]=l;break;case 2:t[0]=l,t[1]=r+l,t[2]=a+l;break;case 3:t[0]=l,t[1]=a+l,t[2]=r+l;break;case 4:t[0]=a+l,t[1]=l,t[2]=r+l;break;case 5:case 6:t[0]=r+l,t[1]=l,t[2]=a+l;break}}function _E(i){return i<=.03928?i/12.92:((i+.055)/1.055)**2.4}function AE(i,t,e){g_(i,e),e.map(_E);const s=.2126*e[0]+.7152*e[1]+.0722*e[2];g_(t,e),e.map(_E);const n=.2126*e[0]+.7152*e[1]+.0722*e[2];return s>n?(s+.05)/(n+.05):(n+.05)/(s+.05)}const SE=new Map;function s3(i,t){const e=i[0]+i[1]*256+i[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let s=SE.get(e);if(s)return s;const n=new Float32Array(9),r=n.subarray(0,3),a=n.subarray(3,6);wE(i,a);const l=n.subarray(6,9);wE(t,l);const c=l[2]<.5,u=c?12:4.5;if(a[2]=c?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),AE(a,l,r)<u){let h,d;c?(h=a[2],d=1):(h=0,d=a[2]);const f=.005;for(;d-h>f;){const g=a[2]=(h+d)/2;c===AE(a,l,r)<u?h=g:d=g}a[2]=c?d:h}return g_(a,r),s=$.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),SE.set(e,s),s}function oO({html:i,dir:t,className:e},s){const n=document.createDocumentFragment();if(typeof i=="string"){const r=document.createElement("p");r.dir=t||"auto";const a=i.split(/(?:\r\n?|\n)/);for(let l=0,c=a.length;l<c;++l){const u=a[l];r.append(document.createTextNode(u)),l<c-1&&r.append(document.createElement("br"))}n.append(r)}else aO.render({xfaHtml:i,div:n,intent:"richText"});n.firstChild.classList.add("richText",e),s.append(n)}function lO(i){const t=new Path2D;if(!i)return t;for(let e=0,s=i.length;e<s;)switch(i[e++]){case rf.moveTo:t.moveTo(i[e++],i[e++]);break;case rf.lineTo:t.lineTo(i[e++],i[e++]);break;case rf.curveTo:t.bezierCurveTo(i[e++],i[e++],i[e++],i[e++],i[e++],i[e++]);break;case rf.quadraticCurveTo:t.quadraticCurveTo(i[e++],i[e++],i[e++],i[e++]);break;case rf.closePath:t.closePath();break;default:nt(`Unrecognized drawing path operator: ${i[e-1]}`);break}return t}var Ga,Va,Xi,Yi,Sg,Xa,sh,ih,xg,ib,cO,bs,uO,hO,Au,yf;const Mr=class Mr{constructor(t){A(this,bs);A(this,Ga,null);A(this,Va,null);A(this,Xi);A(this,Yi,null);A(this,Sg,null);A(this,Xa,null);A(this,sh,null);A(this,ih,null);m(this,Xi,t),o(Mr,xg)||m(Mr,xg,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=m(this,Ga,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=o(this,Xi)._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",bn,{signal:e}),t.addEventListener("pointerdown",x(Mr,ib,cO),{signal:e}));const s=m(this,Yi,document.createElement("div"));s.className="buttons",t.append(s);const n=o(this,Xi).toolbarPosition;if(n){const{style:r}=t,a=o(this,Xi)._uiManager.direction==="ltr"?1-n[0]:n[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return o(this,Ga)}hide(){var t;o(this,Ga).classList.add("hidden"),(t=o(this,Va))==null||t.hideDropdown()}show(){var t,e;o(this,Ga).classList.remove("hidden"),(t=o(this,Sg))==null||t.shown(),(e=o(this,Xa))==null||e.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=o(this,Xi),s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",o(Mr,xg)[t]),x(this,bs,Au).call(this,s)&&s.addEventListener("click",n=>{e.delete()},{signal:e._signal}),o(this,Yi).append(s)}async addAltText(t){const e=await t.render();x(this,bs,Au).call(this,e),o(this,Yi).append(e,o(this,bs,yf)),m(this,Sg,t)}addComment(t,e=null){if(o(this,Xa))return;const s=t.renderForToolbar();if(!s)return;x(this,bs,Au).call(this,s);const n=m(this,sh,o(this,bs,yf));e?(o(this,Yi).insertBefore(s,e),o(this,Yi).insertBefore(n,e)):o(this,Yi).append(s,n),m(this,Xa,t),t.toolbar=this}addColorPicker(t){if(o(this,Va))return;m(this,Va,t);const e=t.renderButton();x(this,bs,Au).call(this,e),o(this,Yi).append(e,o(this,bs,yf))}async addEditSignatureButton(t){const e=m(this,ih,await t.renderEditButton(o(this,Xi)));x(this,bs,Au).call(this,e),o(this,Yi).append(e,o(this,bs,yf))}removeButton(t){var e,s;switch(t){case"comment":(e=o(this,Xa))==null||e.removeToolbarCommentButton(),m(this,Xa,null),(s=o(this,sh))==null||s.remove(),m(this,sh,null);break}}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,s){if(!e&&t==="comment")return;const n=o(this,Yi).querySelector(s);n&&t==="comment"&&this.addComment(e,n)}updateEditSignatureButton(t){o(this,ih)&&(o(this,ih).title=t)}remove(){var t;o(this,Ga).remove(),(t=o(this,Va))==null||t.destroy(),m(this,Va,null)}};Ga=new WeakMap,Va=new WeakMap,Xi=new WeakMap,Yi=new WeakMap,Sg=new WeakMap,Xa=new WeakMap,sh=new WeakMap,ih=new WeakMap,xg=new WeakMap,ib=new WeakSet,cO=function(t){t.stopPropagation()},bs=new WeakSet,uO=function(t){o(this,Xi)._focusEventsAllowed=!1,xe(t)},hO=function(t){o(this,Xi)._focusEventsAllowed=!0,xe(t)},Au=function(t){const e=o(this,Xi)._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",x(this,bs,uO).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",x(this,bs,hO).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",bn,{signal:e}),!0)},yf=function(){const t=document.createElement("div");return t.className="divider",t},A(Mr,ib),A(Mr,xg,null);let m_=Mr;var Eg,El,Lr,Na,dO,fO,p_;class i3{constructor(t){A(this,Na);A(this,Eg,null);A(this,El,null);A(this,Lr);m(this,Lr,t)}show(t,e,s){const[n,r]=x(this,Na,fO).call(this,e,s),{style:a}=o(this,El)||m(this,El,x(this,Na,dO).call(this));t.append(o(this,El)),a.insetInlineEnd=`${100*n}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){o(this,El).remove()}}Eg=new WeakMap,El=new WeakMap,Lr=new WeakMap,Na=new WeakSet,dO=function(){const t=m(this,El,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar");const e=o(this,Lr)._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",bn,{signal:e});const s=m(this,Eg,document.createElement("div"));return s.className="buttons",t.append(s),o(this,Lr).hasCommentManager()&&x(this,Na,p_).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{o(this,Lr).commentSelection("floating_button")}),x(this,Na,p_).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{o(this,Lr).highlightSelection("floating_button")}),t},fO=function(t,e){let s=0,n=0;for(const r of t){const a=r.y+r.height;if(a<s)continue;const l=r.x+(e?r.width:0);if(a>s){n=l,s=a;continue}e?l>n&&(n=l):l<n&&(n=l)}return[e?1-n:n,s]},p_=function(t,e,s,n){const r=document.createElement("button");r.classList.add("basic",t),r.tabIndex=0,r.setAttribute("data-l10n-id",e);const a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",s);const l=o(this,Lr)._signal;l instanceof AbortSignal&&!l.aborted&&(r.addEventListener("contextmenu",bn,{signal:l}),r.addEventListener("click",n,{signal:l})),o(this,Eg).append(r)};function gO(i,t,e){for(const s of e)t.addEventListener(s,i[s].bind(i))}var Tl,Cl,nh,Rl;const It=class It{static initializeAndAddPointerId(t){(o(It,Cl)||m(It,Cl,new Set)).add(t)}static setPointer(t,e){o(It,Tl)||m(It,Tl,e),o(It,Rl)??m(It,Rl,t)}static setTimeStamp(t){m(It,nh,t)}static isSamePointerId(t){return o(It,Tl)===t}static isSamePointerIdOrRemove(t){var e;return o(It,Tl)===t?!0:((e=o(It,Cl))==null||e.delete(t),!1)}static isSamePointerType(t){return o(It,Rl)===t}static isInitializedAndDifferentPointerType(t){return o(It,Rl)!==null&&!It.isSamePointerType(t)}static isSameTimeStamp(t){return o(It,nh)===t}static isUsingMultiplePointers(){var t;return((t=o(It,Cl))==null?void 0:t.size)>=1}static clearPointerType(){m(It,Rl,null)}static clearPointerIds(){m(It,Tl,NaN),m(It,Cl,null)}static clearTimeStamp(){m(It,nh,NaN)}};Tl=new WeakMap,Cl=new WeakMap,nh=new WeakMap,Rl=new WeakMap,A(It,Tl,NaN),A(It,Cl,null),A(It,nh,NaN),A(It,Rl,null);let xs=It;var nb;class n3{constructor(){A(this,nb,0)}get id(){return`${yg}${Fe(this,nb)._++}`}}nb=new WeakMap;var rh,Tg,Es,ah,Ny;const nx=class nx{constructor(){A(this,ah);A(this,rh,nO());A(this,Tg,0);A(this,Es,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=t;const r=n.decode().then(()=>(s.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ut(this,"_isSVGFittingCanvas",r)}async getFromFile(t){const{lastModified:e,name:s,size:n,type:r}=t;return x(this,ah,Ny).call(this,`${e}_${s}_${n}_${r}`,t)}async getFromUrl(t){return x(this,ah,Ny).call(this,t,t)}async getFromBlob(t,e){const s=await e;return x(this,ah,Ny).call(this,t,s)}async getFromId(t){o(this,Es)||m(this,Es,new Map);const e=o(this,Es).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:s}=e;return delete e.blobPromise,this.getFromBlob(e.id,s)}return this.getFromUrl(e.url)}getFromCanvas(t,e){o(this,Es)||m(this,Es,new Map);let s=o(this,Es).get(t);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const n=new OffscreenCanvas(e.width,e.height);return n.getContext("2d").drawImage(e,0,0),s={bitmap:n.transferToImageBitmap(),id:`image_${o(this,rh)}_${Fe(this,Tg)._++}`,refCounter:1,isSvg:!1},o(this,Es).set(t,s),o(this,Es).set(s.id,s),s}getSvgUrl(t){const e=o(this,Es).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var n;o(this,Es)||m(this,Es,new Map);const e=o(this,Es).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:s}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),e.blobPromise=r.convertToBlob()}(n=s.close)==null||n.call(s),e.bitmap=null}isValidId(t){return t.startsWith(`image_${o(this,rh)}_`)}};rh=new WeakMap,Tg=new WeakMap,Es=new WeakMap,ah=new WeakSet,Ny=async function(t,e){o(this,Es)||m(this,Es,new Map);let s=o(this,Es).get(t);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${o(this,rh)}_${Fe(this,Tg)._++}`,refCounter:0,isSvg:!1});let n;if(typeof e=="string"?(s.url=e,n=await Ep(e,"blob")):e instanceof File?n=s.file=e:e instanceof Blob&&(n=e),n.type==="image/svg+xml"){const r=nx._isSVGFittingCanvas,a=new FileReader,l=new Image,c=new Promise((u,h)=>{l.onload=()=>{s.bitmap=l,s.isSvg=!0,u()},a.onload=async()=>{const d=s.svgUrl=a.result;l.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},l.onerror=a.onerror=h});a.readAsDataURL(n),await c}else s.bitmap=await createImageBitmap(n);s.refCounter=1}catch(n){nt(n),s=null}return o(this,Es).set(t,s),s&&o(this,Es).set(s.id,s),s};let y_=nx;var Te,Ya,Cg,ge;class r3{constructor(t=128){A(this,Te,[]);A(this,Ya,!1);A(this,Cg);A(this,ge,-1);m(this,Cg,t)}add({cmd:t,undo:e,post:s,mustExec:n,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(n&&t(),o(this,Ya))return;const c={cmd:t,undo:e,post:s,type:r};if(o(this,ge)===-1){o(this,Te).length>0&&(o(this,Te).length=0),m(this,ge,0),o(this,Te).push(c);return}if(a&&o(this,Te)[o(this,ge)].type===r){l&&(c.undo=o(this,Te)[o(this,ge)].undo),o(this,Te)[o(this,ge)]=c;return}const u=o(this,ge)+1;u===o(this,Cg)?o(this,Te).splice(0,1):(m(this,ge,u),u<o(this,Te).length&&o(this,Te).splice(u)),o(this,Te).push(c)}undo(){if(o(this,ge)===-1)return;m(this,Ya,!0);const{undo:t,post:e}=o(this,Te)[o(this,ge)];t(),e==null||e(),m(this,Ya,!1),m(this,ge,o(this,ge)-1)}redo(){if(o(this,ge)<o(this,Te).length-1){m(this,ge,o(this,ge)+1),m(this,Ya,!0);const{cmd:t,post:e}=o(this,Te)[o(this,ge)];t(),e==null||e(),m(this,Ya,!1)}}hasSomethingToUndo(){return o(this,ge)!==-1}hasSomethingToRedo(){return o(this,ge)<o(this,Te).length-1}cleanType(t){if(o(this,ge)!==-1){for(let e=o(this,ge);e>=0;e--)if(o(this,Te)[e].type!==t){o(this,Te).splice(e+1,o(this,ge)-e),m(this,ge,e);return}o(this,Te).length=0,m(this,ge,-1)}}destroy(){m(this,Te,null)}}Te=new WeakMap,Ya=new WeakMap,Cg=new WeakMap,ge=new WeakMap;var rb,mO;class Rp{constructor(t){A(this,rb);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=_s.platform;for(const[s,n,r={}]of t)for(const a of s){const l=a.startsWith("mac+");e&&l?(this.callbacks.set(a.slice(4),{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1))):!e&&!l&&(this.callbacks.set(a,{callback:n,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(x(this,rb,mO).call(this,e));if(!s)return;const{callback:n,options:{bubbles:r=!1,args:a=[],checker:l=null}}=s;l&&!l(t,e)||(n.bind(t,...a,e)(),r||xe(e))}}rb=new WeakSet,mO=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const ab=class ab{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return JB(t),ut(this,"_colors",t)}convert(t){const e=Cp(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[s,n]of this._colors)if(n.every((r,a)=>r===e[a]))return ab._colorsMapping.get(s);return e}getHexCode(t){const e=this._colors.get(t);return e?$.makeHexColor(...e):t}};B(ab,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let b_=ab;var oh,ci,lh,ve,Ge,ch,Ki,uh,Wi,Ts,Ka,Wa,hh,Qa,Gn,Qi,Ol,Rg,Og,dh,kg,Vn,Ja,fh,Za,Xn,ob,to,gh,Ng,eo,kl,mh,so,Mg,De,Dt,Pr,io,no,Dg,ph,jg,ro,Yn,Br,Lg,Pg,Ji,U,My,v_,pO,yO,bf,bO,vO,wO,w_,_O,AO,SO,xO,Ns,Or,EO,TO,__,CO,vf,A_;const $u=class $u{constructor(t,e,s,n,r,a,l,c,u,h,d,f,g,b,v,S){A(this,U);A(this,oh,new AbortController);A(this,ci,null);A(this,lh,null);A(this,ve,new Map);A(this,Ge,new Map);A(this,ch,null);A(this,Ki,null);A(this,uh,null);A(this,Wi,new r3);A(this,Ts,null);A(this,Ka,null);A(this,Wa,null);A(this,hh,0);A(this,Qa,new Set);A(this,Gn,null);A(this,Qi,null);A(this,Ol,new Set);B(this,"_editorUndoBar",null);A(this,Rg,!1);A(this,Og,!1);A(this,dh,!1);A(this,kg,null);A(this,Vn,null);A(this,Ja,null);A(this,fh,null);A(this,Za,!1);A(this,Xn,null);A(this,ob,new n3);A(this,to,!1);A(this,gh,!1);A(this,Ng,!1);A(this,eo,null);A(this,kl,null);A(this,mh,null);A(this,so,null);A(this,Mg,null);A(this,De,ot.NONE);A(this,Dt,new Set);A(this,Pr,null);A(this,io,null);A(this,no,null);A(this,Dg,null);A(this,ph,null);A(this,jg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});A(this,ro,[0,0]);A(this,Yn,null);A(this,Br,null);A(this,Lg,null);A(this,Pg,null);A(this,Ji,null);const p=this._signal=o(this,oh).signal;m(this,Br,t),m(this,Lg,e),m(this,Pg,s),m(this,ch,n),m(this,Ts,r),m(this,io,a),m(this,ph,c),this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:p}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:p}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:p}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:p}),l._on("setpreference",this.onSetPreference.bind(this),{signal:p}),l._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:p}),window.addEventListener("pointerdown",()=>{m(this,gh,!0)},{capture:!0,signal:p}),window.addEventListener("pointerup",()=>{m(this,gh,!1)},{capture:!0,signal:p}),x(this,U,bO).call(this),x(this,U,xO).call(this),x(this,U,w_).call(this),m(this,Ki,c.annotationStorage),m(this,kg,c.filterFactory),m(this,no,u),m(this,fh,h||null),m(this,Rg,d),m(this,Og,f),m(this,dh,g),m(this,Mg,b||null),this.viewParameters={realScale:sl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=S!==!1,r==null||r.setSidebarUiManager(this)}static get _keyboardManager(){const t=$u.prototype,e=a=>o(a,Br).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},n=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ut(this,"_keyboardManager",new Rp([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&o(a,Br).contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&o(a,Br).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}]]))}destroy(){var t,e,s,n,r,a,l,c,u;(t=o(this,Ji))==null||t.resolve(),m(this,Ji,null),(e=o(this,oh))==null||e.abort(),m(this,oh,null),this._signal=null;for(const h of o(this,Ge).values())h.destroy();o(this,Ge).clear(),o(this,ve).clear(),o(this,Ol).clear(),(s=o(this,so))==null||s.clear(),m(this,ci,null),o(this,Dt).clear(),o(this,Wi).destroy(),(n=o(this,ch))==null||n.destroy(),(r=o(this,Ts))==null||r.destroy(),(a=o(this,io))==null||a.destroy(),(l=o(this,Xn))==null||l.hide(),m(this,Xn,null),(c=o(this,mh))==null||c.destroy(),m(this,mh,null),m(this,lh,null),o(this,Vn)&&(clearTimeout(o(this,Vn)),m(this,Vn,null)),o(this,Yn)&&(clearTimeout(o(this,Yn)),m(this,Yn,null)),(u=this._editorUndoBar)==null||u.destroy(),m(this,ph,null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return o(this,Mg)}get useNewAltTextFlow(){return o(this,Og)}get useNewAltTextWhenAddingImage(){return o(this,dh)}get hcmFilter(){return ut(this,"hcmFilter",o(this,no)?o(this,kg).addHCMFilter(o(this,no).foreground,o(this,no).background):"none")}get direction(){return ut(this,"direction",getComputedStyle(o(this,Br)).direction)}get _highlightColors(){return ut(this,"_highlightColors",o(this,fh)?new Map(o(this,fh).split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return ut(this,"highlightColors",null);const e=new Map,s=!!o(this,no);for(const[n,r]of t){const a=n.endsWith("_HCM");if(s&&a){e.set(n.replace("_HCM",""),r);continue}!s&&!a&&e.set(n,r)}return ut(this,"highlightColors",e)}get highlightColorNames(){return ut(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),m(this,Wa,t)}setMainHighlightColorPicker(t){m(this,mh,t)}editAltText(t,e=!1){var s;(s=o(this,ch))==null||s.editAltText(this,t,e)}hasCommentManager(){return!!o(this,Ts)}editComment(t,e,s,n){var r;(r=o(this,Ts))==null||r.showDialog(this,t,e,s,n)}selectComment(t,e){const s=o(this,Ge).get(t),n=s==null?void 0:s.getEditorByUID(e);n==null||n.toggleComment(!0,!0)}updateComment(t){var e;(e=o(this,Ts))==null||e.updateComment(t.getData())}updatePopupColor(t){var e;(e=o(this,Ts))==null||e.updatePopupColor(t)}removeComment(t){var e;(e=o(this,Ts))==null||e.removeComments([t.uid])}toggleComment(t,e,s=void 0){var n;(n=o(this,Ts))==null||n.toggleCommentPopup(t,e,s)}makeCommentColor(t,e){var s;return t&&((s=o(this,Ts))==null?void 0:s.makeCommentColor(t,e))||null}getCommentDialogElement(){var t;return((t=o(this,Ts))==null?void 0:t.dialogElement)||null}async waitForEditorsRendered(t){if(o(this,Ge).has(t-1))return;const{resolve:e,promise:s}=Promise.withResolvers(),n=r=>{r.pageNumber===t&&(this._eventBus._off("editorsrendered",n),e())};this._eventBus.on("editorsrendered",n),await s}getSignature(t){var e;(e=o(this,io))==null||e.getSignature({uiManager:this,editor:t})}get signatureManager(){return o(this,io)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":m(this,dh,e);break}}onPageChanging({pageNumber:t}){m(this,hh,t-1)}focusMainContainer(){o(this,Br).focus()}findParent(t,e){for(const s of o(this,Ge).values()){const{x:n,y:r,width:a,height:l}=s.div.getBoundingClientRect();if(t>=n&&t<=n+a&&e>=r&&e<=r+l)return s}return null}disableUserSelect(t=!1){o(this,Lg).classList.toggle("noUserSelect",t)}addShouldRescale(t){o(this,Ol).add(t)}removeShouldRescale(t){o(this,Ol).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*sl.PDF_TO_CSS_UNITS;for(const s of o(this,Ol))s.onScaleChanging();(e=o(this,Wa))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t="",e=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:n,anchorOffset:r,focusNode:a,focusOffset:l}=s,c=s.toString(),h=x(this,U,My).call(this,s).closest(".textLayer"),d=this.getSelectionBoxes(h);if(!d)return;s.empty();const f=x(this,U,v_).call(this,h),g=o(this,De)===ot.NONE,b=()=>{const v=f==null?void 0:f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:n,anchorOffset:r,focusNode:a,focusOffset:l,text:c});g&&this.showAllEditors("highlight",!0,!0),e&&(v==null||v.editComment())};if(g){this.switchToMode(ot.HIGHLIGHT,b);return}b()}commentSelection(t=""){this.highlightSelection(t,!0)}getAndRemoveDataFromAnnotationStorage(t){if(!o(this,Ki))return null;const e=`${yg}${t}`,s=o(this,Ki).getRawValue(e);return s&&o(this,Ki).remove(e),s}addToAnnotationStorage(t){!t.isEmpty()&&o(this,Ki)&&!o(this,Ki).has(t.id)&&o(this,Ki).setValue(t.id,t)}a11yAlert(t,e=null){const s=o(this,Pg);s&&(s.setAttribute("data-l10n-id",t),e?s.setAttribute("data-l10n-args",JSON.stringify(e)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,o(this,Za)&&(m(this,Za,!1),x(this,U,bf).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of o(this,Dt))if(e.div.contains(t)){m(this,kl,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!o(this,kl))return;const[t,e]=o(this,kl);m(this,kl,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){x(this,U,w_).call(this),this.setEditingState(!0)}removeEditListeners(){x(this,U,_O).call(this),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const s of o(this,Qi))if(s.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const s of o(this,Qi))if(s.isHandlingMimeForPasting(e.type)){s.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var s;if(t.preventDefault(),(s=o(this,ci))==null||s.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of o(this,Dt)){const r=n.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const a of o(this,Qi))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=e.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){nt(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const n=this.currentLayer;try{const r=[];for(const c of s){const u=await n.deserialize(c);if(!u)return;r.push(u)}const a=()=>{for(const c of r)x(this,U,__).call(this,c);x(this,U,A_).call(this,r)},l=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(r){nt(`paste: "${r.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),o(this,De)!==ot.NONE&&!this.isEditorHandlingKeyboard&&$u._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,o(this,Za)&&(m(this,Za,!1),x(this,U,bf).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(t){t?(x(this,U,vO).call(this),x(this,U,AO).call(this),x(this,U,Ns).call(this,{isEditing:o(this,De)!==ot.NONE,isEmpty:x(this,U,vf).call(this),hasSomethingToUndo:o(this,Wi).hasSomethingToUndo(),hasSomethingToRedo:o(this,Wi).hasSomethingToRedo(),hasSelectedEditor:!1})):(x(this,U,wO).call(this),x(this,U,SO).call(this),x(this,U,Ns).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!o(this,Qi)){m(this,Qi,t);for(const e of o(this,Qi))x(this,U,Or).call(this,e.defaultPropertiesToUpdate)}}getId(){return o(this,ob).id}get currentLayer(){return o(this,Ge).get(o(this,hh))}getLayer(t){return o(this,Ge).get(t)}get currentPageIndex(){return o(this,hh)}addLayer(t){o(this,Ge).set(t.pageIndex,t),o(this,to)?t.enable():t.disable()}removeLayer(t){o(this,Ge).delete(t.pageIndex)}async updateMode(t,e=null,s=!1,n=!1,r=!1){var a,l,c,u,h,d;if(o(this,De)!==t&&!(o(this,Ji)&&(await o(this,Ji).promise,!o(this,Ji)))){if(m(this,Ji,Promise.withResolvers()),(a=o(this,Wa))==null||a.commitOrRemove(),o(this,De)===ot.POPUP&&((l=o(this,Ts))==null||l.hideSidebar()),(c=o(this,Ts))==null||c.destroyPopup(),m(this,De,t),t===ot.NONE){this.setEditingState(!1),x(this,U,TO).call(this);for(const f of o(this,ve).values())f.hideStandaloneCommentButton();(u=this._editorUndoBar)==null||u.hide(),this.toggleComment(null),o(this,Ji).resolve();return}for(const f of o(this,ve).values())f.addStandaloneCommentButton();t===ot.SIGNATURE&&await((h=o(this,io))==null?void 0:h.loadSignatures()),this.setEditingState(!0),await x(this,U,EO).call(this),this.unselectAll();for(const f of o(this,Ge).values())f.updateMode(t);if(t===ot.POPUP){o(this,lh)||m(this,lh,await o(this,ph).getAnnotationsByType(new Set(o(this,Qi).map(b=>b._editorType))));const f=new Set,g=[];for(const b of o(this,ve).values()){const{annotationElementId:v,hasComment:S,deleted:p}=b;v&&f.add(v),S&&!p&&g.push(b.getData())}for(const b of o(this,lh)){const{id:v,popupRef:S,contentsObj:p}=b;S&&(p!=null&&p.str)&&!f.has(v)&&!o(this,Qa).has(v)&&g.push(b)}(d=o(this,Ts))==null||d.showSidebar(g)}if(!e){s&&this.addNewEditorFromKeyboard(),o(this,Ji).resolve();return}for(const f of o(this,ve).values())f.uid===e?(this.setSelected(f),r?f.editComment():n?f.enterInEditMode():f.focus()):f.unselect();o(this,Ji).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==o(this,De)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(o(this,Qi)){switch(t){case At.CREATE:this.currentLayer.addNewEditor(e);return;case At.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(o(this,Dg)||m(this,Dg,new Map)).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const s of o(this,Dt))s.updateParams(t,e);else for(const s of o(this,Qi))s.updateDefaultParams(t,e)}}showAllEditors(t,e,s=!1){var r;for(const a of o(this,ve).values())a.editorType===t&&a.show(e);(((r=o(this,Dg))==null?void 0:r.get(At.HIGHLIGHT_SHOW_ALL))??!0)!==e&&x(this,U,Or).call(this,[[At.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(o(this,Ng)!==t){m(this,Ng,t);for(const e of o(this,Ge).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}*getEditors(t){for(const e of o(this,ve).values())e.pageIndex===t&&(yield e)}getEditor(t){return o(this,ve).get(t)}addEditor(t){o(this,ve).set(t.id,t)}removeEditor(t){var e,s;t.div.contains(document.activeElement)&&(o(this,Vn)&&clearTimeout(o(this,Vn)),m(this,Vn,setTimeout(()=>{this.focusMainContainer(),m(this,Vn,null)},0))),o(this,ve).delete(t.id),t.annotationElementId&&((e=o(this,so))==null||e.delete(t.annotationElementId)),this.unselect(t),(!t.annotationElementId||!o(this,Qa).has(t.annotationElementId))&&((s=o(this,Ki))==null||s.remove(t.id))}addDeletedAnnotationElement(t){o(this,Qa).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return o(this,Qa).has(t)}removeDeletedAnnotationElement(t){o(this,Qa).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){o(this,ci)!==t&&(m(this,ci,t),t&&x(this,U,Or).call(this,t.propertiesToUpdate))}updateUI(t){o(this,U,CO)===t&&x(this,U,Or).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){x(this,U,Or).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(o(this,Dt).has(t)){o(this,Dt).delete(t),t.unselect(),x(this,U,Ns).call(this,{hasSelectedEditor:this.hasSelection});return}o(this,Dt).add(t),t.select(),x(this,U,Or).call(this,t.propertiesToUpdate),x(this,U,Ns).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;this.updateToolbar({mode:t.mode,editId:t.uid}),(e=o(this,Wa))==null||e.commitOrRemove();for(const s of o(this,Dt))s!==t&&s.unselect();o(this,Dt).clear(),o(this,Dt).add(t),t.select(),x(this,U,Or).call(this,t.propertiesToUpdate),x(this,U,Ns).call(this,{hasSelectedEditor:!0})}isSelected(t){return o(this,Dt).has(t)}get firstSelectedEditor(){return o(this,Dt).values().next().value}unselect(t){t.unselect(),o(this,Dt).delete(t),x(this,U,Ns).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return o(this,Dt).size!==0}get isEnterHandled(){return o(this,Dt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;o(this,Wi).undo(),x(this,U,Ns).call(this,{hasSomethingToUndo:o(this,Wi).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:x(this,U,vf).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){o(this,Wi).redo(),x(this,U,Ns).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:o(this,Wi).hasSomethingToRedo(),isEmpty:x(this,U,vf).call(this)})}addCommands(t){o(this,Wi).add(t),x(this,U,Ns).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:x(this,U,vf).call(this)})}cleanUndoStack(t){o(this,Wi).cleanType(t)}delete(){var r;this.commitOrRemove();const t=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...o(this,Dt)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(n,e.length===1?e[0].editorType:e.length);for(const l of e)l.remove()},n=()=>{for(const a of e)x(this,U,__).call(this,a)};this.addCommands({cmd:s,undo:n,mustExec:!0})}commitOrRemove(){var t;(t=o(this,ci))==null||t.commitOrRemove()}hasSomethingToControl(){return o(this,ci)||this.hasSelection}selectAll(){for(const t of o(this,Dt))t.commit();x(this,U,A_).call(this,o(this,ve).values())}unselectAll(){var t;if(!(o(this,ci)&&(o(this,ci).commitOrRemove(),o(this,De)!==ot.NONE))&&!((t=o(this,Wa))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of o(this,Dt))e.unselect();o(this,Dt).clear(),x(this,U,Ns).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;o(this,ro)[0]+=t,o(this,ro)[1]+=e;const[n,r]=o(this,ro),a=[...o(this,Dt)],l=1e3;o(this,Yn)&&clearTimeout(o(this,Yn)),m(this,Yn,setTimeout(()=>{m(this,Yn,null),o(this,ro)[0]=o(this,ro)[1]=0,this.addCommands({cmd:()=>{for(const c of a)o(this,ve).has(c.id)&&(c.translateInPage(n,r),c.translationDone())},undo:()=>{for(const c of a)o(this,ve).has(c.id)&&(c.translateInPage(-n,-r),c.translationDone())},mustExec:!1})},l));for(const c of a)c.translateInPage(t,e),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,Gn,new Map);for(const t of o(this,Dt))o(this,Gn).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!o(this,Gn))return!1;this.disableUserSelect(!1);const t=o(this,Gn);m(this,Gn,null);let e=!1;for(const[{x:n,y:r,pageIndex:a},l]of t)l.newX=n,l.newY=r,l.newPageIndex=a,e||(e=n!==l.savedX||r!==l.savedY||a!==l.savedPageIndex);if(!e)return!1;const s=(n,r,a,l)=>{if(o(this,ve).has(n.id)){const c=o(this,Ge).get(l);c?n._setParentAndPosition(c,r,a):(n.pageIndex=l,n.x=r,n.y=a)}};return this.addCommands({cmd:()=>{for(const[n,{newX:r,newY:a,newPageIndex:l}]of t)s(n,r,a,l)},undo:()=>{for(const[n,{savedX:r,savedY:a,savedPageIndex:l}]of t)s(n,r,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(o(this,Gn))for(const s of o(this,Gn).keys())s.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||o(this,Dt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return o(this,ci)===t}getActive(){return o(this,ci)}getMode(){return o(this,De)}isEditingMode(){return o(this,De)!==ot.NONE}get imageManager(){return ut(this,"imageManager",new y_)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let u=0,h=e.rangeCount;u<h;u++)if(!t.contains(e.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:n,width:r,height:a}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(u,h,d,f)=>({x:(h-n)/a,y:1-(u+d-s)/r,width:f/a,height:d/r});break;case"180":l=(u,h,d,f)=>({x:1-(u+d-s)/r,y:1-(h+f-n)/a,width:d/r,height:f/a});break;case"270":l=(u,h,d,f)=>({x:1-(h+f-n)/a,y:(u-s)/r,width:f/a,height:d/r});break;default:l=(u,h,d,f)=>({x:(u-s)/r,y:(h-n)/a,width:d/r,height:f/a});break}const c=[];for(let u=0,h=e.rangeCount;u<h;u++){const d=e.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:g,width:b,height:v}of d.getClientRects())b===0||v===0||c.push(l(f,g,b,v))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:e}){(o(this,uh)||m(this,uh,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=o(this,uh))==null||e.delete(t)}renderAnnotationElement(t){var n;const e=(n=o(this,uh))==null?void 0:n.get(t.data.id);if(!e)return;const s=o(this,Ki).getRawValue(e);s&&(o(this,De)===ot.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}setMissingCanvas(t,e,s){var r;const n=(r=o(this,so))==null?void 0:r.get(t);n&&(n.setCanvas(e,s),o(this,so).delete(t))}addMissingCanvas(t,e){(o(this,so)||m(this,so,new Map)).set(t,e)}};oh=new WeakMap,ci=new WeakMap,lh=new WeakMap,ve=new WeakMap,Ge=new WeakMap,ch=new WeakMap,Ki=new WeakMap,uh=new WeakMap,Wi=new WeakMap,Ts=new WeakMap,Ka=new WeakMap,Wa=new WeakMap,hh=new WeakMap,Qa=new WeakMap,Gn=new WeakMap,Qi=new WeakMap,Ol=new WeakMap,Rg=new WeakMap,Og=new WeakMap,dh=new WeakMap,kg=new WeakMap,Vn=new WeakMap,Ja=new WeakMap,fh=new WeakMap,Za=new WeakMap,Xn=new WeakMap,ob=new WeakMap,to=new WeakMap,gh=new WeakMap,Ng=new WeakMap,eo=new WeakMap,kl=new WeakMap,mh=new WeakMap,so=new WeakMap,Mg=new WeakMap,De=new WeakMap,Dt=new WeakMap,Pr=new WeakMap,io=new WeakMap,no=new WeakMap,Dg=new WeakMap,ph=new WeakMap,jg=new WeakMap,ro=new WeakMap,Yn=new WeakMap,Br=new WeakMap,Lg=new WeakMap,Pg=new WeakMap,Ji=new WeakMap,U=new WeakSet,My=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},v_=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const s of o(this,Ge).values())if(s.hasTextLayer(t))return s;return null},pO=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=x(this,U,My).call(this,t).closest(".textLayer"),n=this.getSelectionBoxes(s);n&&(o(this,Xn)||m(this,Xn,new i3(this)),o(this,Xn).show(s,n,this.direction==="ltr"))},yO=function(){var r,a,l;const t=document.getSelection();if(!t||t.isCollapsed){o(this,Pr)&&((r=o(this,Xn))==null||r.hide(),m(this,Pr,null),x(this,U,Ns).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===o(this,Pr))return;const n=x(this,U,My).call(this,t).closest(".textLayer");if(!n){o(this,Pr)&&((a=o(this,Xn))==null||a.hide(),m(this,Pr,null),x(this,U,Ns).call(this,{hasSelectedText:!1}));return}if((l=o(this,Xn))==null||l.hide(),m(this,Pr,e),x(this,U,Ns).call(this,{hasSelectedText:!0}),!(o(this,De)!==ot.HIGHLIGHT&&o(this,De)!==ot.NONE)&&(o(this,De)===ot.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,Za,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=o(this,De)===ot.HIGHLIGHT?x(this,U,v_).call(this,n):null;if(c==null||c.toggleDrawing(),o(this,gh)){const u=new AbortController,h=this.combinedSignal(u),d=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&x(this,U,bf).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}else c==null||c.toggleDrawing(!0),x(this,U,bf).call(this,"main_toolbar")}},bf=function(t=""){o(this,De)===ot.HIGHLIGHT?this.highlightSelection(t):o(this,Rg)&&x(this,U,pO).call(this)},bO=function(){document.addEventListener("selectionchange",x(this,U,yO).bind(this),{signal:this._signal})},vO=function(){if(o(this,Ja))return;m(this,Ja,new AbortController);const t=this.combinedSignal(o(this,Ja));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},wO=function(){var t;(t=o(this,Ja))==null||t.abort(),m(this,Ja,null)},w_=function(){if(o(this,eo))return;m(this,eo,new AbortController);const t=this.combinedSignal(o(this,eo));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},_O=function(){var t;(t=o(this,eo))==null||t.abort(),m(this,eo,null)},AO=function(){if(o(this,Ka))return;m(this,Ka,new AbortController);const t=this.combinedSignal(o(this,Ka));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},SO=function(){var t;(t=o(this,Ka))==null||t.abort(),m(this,Ka,null)},xO=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Ns=function(t){Object.entries(t).some(([s,n])=>o(this,jg)[s]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(o(this,jg),t)}),o(this,De)===ot.HIGHLIGHT&&t.hasSelectedEditor===!1&&x(this,U,Or).call(this,[[At.HIGHLIGHT_FREE,!0]]))},Or=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},EO=async function(){if(!o(this,to)){m(this,to,!0);const t=[];for(const e of o(this,Ge).values())t.push(e.enable());await Promise.all(t);for(const e of o(this,ve).values())e.enable()}},TO=function(){if(this.unselectAll(),o(this,to)){m(this,to,!1);for(const t of o(this,Ge).values())t.disable();for(const t of o(this,ve).values())t.disable()}},__=function(t){const e=o(this,Ge).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},CO=function(){let t=null;for(t of o(this,Dt));return t},vf=function(){if(o(this,ve).size===0)return!0;if(o(this,ve).size===1)for(const t of o(this,ve).values())return t.isEmpty();return!1},A_=function(t){for(const e of o(this,Dt))e.unselect();o(this,Dt).clear();for(const e of t)e.isEmpty()||(o(this,Dt).add(e),e.select());x(this,U,Ns).call(this,{hasSelectedEditor:this.hasSelection})},B($u,"TRANSLATE_SMALL",1),B($u,"TRANSLATE_BIG",10);let Qc=$u;var Qe,Kn,En,yh,Wn,ui,bh,Qn,Ks,Ir,Nl,Jn,ao,Un,wf,Dy;const Ms=class Ms{constructor(t){A(this,Un);A(this,Qe,null);A(this,Kn,!1);A(this,En,null);A(this,yh,null);A(this,Wn,null);A(this,ui,null);A(this,bh,!1);A(this,Qn,null);A(this,Ks,null);A(this,Ir,null);A(this,Nl,null);A(this,Jn,!1);m(this,Ks,t),m(this,Jn,t._uiManager.useNewAltTextFlow),o(Ms,ao)||m(Ms,ao,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Ms._l10n??(Ms._l10n=t)}async render(){const t=m(this,En,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=m(this,yh,document.createElement("span"));t.append(e),o(this,Jn)?(t.classList.add("new"),t.setAttribute("data-l10n-id",o(Ms,ao).missing),e.setAttribute("data-l10n-id",o(Ms,ao)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=o(this,Ks)._uiManager._signal;t.addEventListener("contextmenu",bn,{signal:s}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const n=r=>{r.preventDefault(),o(this,Ks)._uiManager.editAltText(o(this,Ks)),o(this,Jn)&&o(this,Ks)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:o(this,Un,wf)}})};return t.addEventListener("click",n,{capture:!0,signal:s}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(m(this,bh,!0),n(r))},{signal:s}),await x(this,Un,Dy).call(this),t}finish(){o(this,En)&&(o(this,En).focus({focusVisible:o(this,bh)}),m(this,bh,!1))}isEmpty(){return o(this,Jn)?o(this,Qe)===null:!o(this,Qe)&&!o(this,Kn)}hasData(){return o(this,Jn)?o(this,Qe)!==null||!!o(this,Ir):this.isEmpty()}get guessedText(){return o(this,Ir)}async setGuessedText(t){o(this,Qe)===null&&(m(this,Ir,t),m(this,Nl,await Ms._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),x(this,Un,Dy).call(this))}toggleAltTextBadge(t=!1){var e;if(!o(this,Jn)||o(this,Qe)){(e=o(this,Qn))==null||e.remove(),m(this,Qn,null);return}if(!o(this,Qn)){const s=m(this,Qn,document.createElement("div"));s.className="noAltTextBadge",o(this,Ks).div.append(s)}o(this,Qn).classList.toggle("hidden",!t)}serialize(t){let e=o(this,Qe);return!t&&o(this,Ir)===e&&(e=o(this,Nl)),{altText:e,decorative:o(this,Kn),guessedText:o(this,Ir),textWithDisclaimer:o(this,Nl)}}get data(){return{altText:o(this,Qe),decorative:o(this,Kn)}}set data({altText:t,decorative:e,guessedText:s,textWithDisclaimer:n,cancel:r=!1}){s&&(m(this,Ir,s),m(this,Nl,n)),!(o(this,Qe)===t&&o(this,Kn)===e)&&(r||(m(this,Qe,t),m(this,Kn,e)),x(this,Un,Dy).call(this))}toggle(t=!1){o(this,En)&&(!t&&o(this,ui)&&(clearTimeout(o(this,ui)),m(this,ui,null)),o(this,En).disabled=!t)}shown(){o(this,Ks)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:o(this,Un,wf)}})}destroy(){var t,e;(t=o(this,En))==null||t.remove(),m(this,En,null),m(this,yh,null),m(this,Wn,null),(e=o(this,Qn))==null||e.remove(),m(this,Qn,null)}};Qe=new WeakMap,Kn=new WeakMap,En=new WeakMap,yh=new WeakMap,Wn=new WeakMap,ui=new WeakMap,bh=new WeakMap,Qn=new WeakMap,Ks=new WeakMap,Ir=new WeakMap,Nl=new WeakMap,Jn=new WeakMap,ao=new WeakMap,Un=new WeakSet,wf=function(){return o(this,Qe)&&"added"||o(this,Qe)===null&&this.guessedText&&"review"||"missing"},Dy=async function(){var n,r,a;const t=o(this,En);if(!t)return;if(o(this,Jn)){if(t.classList.toggle("done",!!o(this,Qe)),t.setAttribute("data-l10n-id",o(Ms,ao)[o(this,Un,wf)]),(n=o(this,yh))==null||n.setAttribute("data-l10n-id",o(Ms,ao)[`${o(this,Un,wf)}-label`]),!o(this,Qe)){(r=o(this,Wn))==null||r.remove();return}}else{if(!o(this,Qe)&&!o(this,Kn)){t.classList.remove("done"),(a=o(this,Wn))==null||a.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=o(this,Wn);if(!e){m(this,Wn,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${o(this,Ks).id}`;const l=100,c=o(this,Ks)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(o(this,ui)),m(this,ui,null)},{once:!0}),t.addEventListener("mouseenter",()=>{m(this,ui,setTimeout(()=>{m(this,ui,null),o(this,Wn).classList.add("show"),o(this,Ks)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:c}),t.addEventListener("mouseleave",()=>{var u;o(this,ui)&&(clearTimeout(o(this,ui)),m(this,ui,null)),(u=o(this,Wn))==null||u.classList.remove("show")},{signal:c})}o(this,Kn)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=o(this,Qe)),e.parentNode||t.append(e);const s=o(this,Ks).getElementForAltText();s==null||s.setAttribute("aria-describedby",e.id)},A(Ms,ao,null),B(Ms,"_l10n",null);let V0=Ms;var ls,Zi,Ml,te,Bg,Dl,Tn,jl,Ll,Pl,Ig,S_;class ny{constructor(t){A(this,Ig);A(this,ls,null);A(this,Zi,null);A(this,Ml,!1);A(this,te,null);A(this,Bg,null);A(this,Dl,null);A(this,Tn,null);A(this,jl,null);A(this,Ll,!1);A(this,Pl,null);m(this,te,t)}renderForToolbar(){const t=m(this,Zi,document.createElement("button"));return t.className="comment",x(this,Ig,S_).call(this,t,!1)}renderForStandalone(){const t=m(this,ls,document.createElement("button"));t.className="annotationCommentButton";const e=o(this,te).commentButtonPosition;if(e){const{style:s}=t;s.insetInlineEnd=`calc(${100*(o(this,te)._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const n=o(this,te).commentButtonColor;n&&(s.backgroundColor=n)}return x(this,Ig,S_).call(this,t,!0)}focusButton(){setTimeout(()=>{var t;(t=o(this,ls)??o(this,Zi))==null||t.focus()},0)}onUpdatedColor(){if(!o(this,ls))return;const t=o(this,te).commentButtonColor;t&&(o(this,ls).style.backgroundColor=t),o(this,te)._uiManager.updatePopupColor(o(this,te))}get commentButtonWidth(){var t;return(((t=o(this,ls))==null?void 0:t.getBoundingClientRect().width)??0)/o(this,te).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(o(this,Pl))return o(this,Pl);if(!o(this,ls))return null;const{x:t,y:e,height:s}=o(this,ls).getBoundingClientRect(),{x:n,y:r,width:a,height:l}=o(this,te).parent.boundingClientRect;return[(t-n)/a,(e+s-r)/l]}set commentPopupPositionInLayer(t){m(this,Pl,t)}hasDefaultPopupPosition(){return o(this,Pl)===null}removeStandaloneCommentButton(){var t;(t=o(this,ls))==null||t.remove(),m(this,ls,null)}removeToolbarCommentButton(){var t;(t=o(this,Zi))==null||t.remove(),m(this,Zi,null)}setCommentButtonStates({selected:t,hasPopup:e}){o(this,ls)&&(o(this,ls).classList.toggle("selected",t),o(this,ls).ariaExpanded=e)}edit(t){const e=this.commentPopupPositionInLayer;let s,n;if(e)[s,n]=e;else{[s,n]=o(this,te).commentButtonPosition;const{width:h,height:d,x:f,y:g}=o(this,te);s=f+s*h,n=g+n*d}const r=o(this,te).parent.boundingClientRect,{x:a,y:l,width:c,height:u}=r;o(this,te)._uiManager.editComment(o(this,te),a+s*c,l+n*u,{...t,parentDimensions:r})}finish(){o(this,Zi)&&(o(this,Zi).focus({focusVisible:o(this,Ml)}),m(this,Ml,!1))}isDeleted(){return o(this,Ll)||o(this,Tn)===""}isEmpty(){return o(this,Tn)===null}hasBeenEdited(){return this.isDeleted()||o(this,Tn)!==o(this,Bg)}serialize(){return this.data}get data(){return{text:o(this,Tn),richText:o(this,Dl),date:o(this,jl),deleted:this.isDeleted()}}set data(t){if(t!==o(this,Tn)&&m(this,Dl,null),t===null){m(this,Tn,""),m(this,Ll,!0);return}m(this,Tn,t),m(this,jl,new Date),m(this,Ll,!1)}setInitialText(t,e=null){m(this,Bg,t),this.data=t,m(this,jl,null),m(this,Dl,e)}shown(){}destroy(){var t,e;(t=o(this,Zi))==null||t.remove(),m(this,Zi,null),(e=o(this,ls))==null||e.remove(),m(this,ls,null),m(this,Tn,""),m(this,Dl,null),m(this,jl,null),m(this,te,null),m(this,Ml,!1),m(this,Ll,!1)}}ls=new WeakMap,Zi=new WeakMap,Ml=new WeakMap,te=new WeakMap,Bg=new WeakMap,Dl=new WeakMap,Tn=new WeakMap,jl=new WeakMap,Ll=new WeakMap,Pl=new WeakMap,Ig=new WeakSet,S_=function(t,e){if(!o(this,te)._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[o(this,te)._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=o(this,te)._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return t;t.addEventListener("contextmenu",bn,{signal:s}),e&&(t.addEventListener("focusin",r=>{o(this,te)._focusEventsAllowed=!1,xe(r)},{capture:!0,signal:s}),t.addEventListener("focusout",r=>{o(this,te)._focusEventsAllowed=!0,xe(r)},{capture:!0,signal:s})),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const n=r=>{r.preventDefault(),t===o(this,Zi)?this.edit():o(this,te).toggleComment(!0)};return t.addEventListener("click",n,{capture:!0,signal:s}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(m(this,Ml,!0),n(r))},{signal:s}),t.addEventListener("pointerenter",()=>{o(this,te).toggleComment(!1,!0)},{signal:s}),t.addEventListener("pointerleave",()=>{o(this,te).toggleComment(!1,!1)},{signal:s}),t};var vh,Bl,Ug,zg,Fg,Hg,$g,Ur,Il,zr,Ul,Fr,il,RO,OO,kO;const rx=class rx{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:s=null,onPinchStart:n=null,onPinching:r=null,onPinchEnd:a=null,signal:l}){A(this,il);A(this,vh);A(this,Bl,!1);A(this,Ug,null);A(this,zg);A(this,Fg);A(this,Hg);A(this,$g);A(this,Ur,null);A(this,Il);A(this,zr,null);A(this,Ul);A(this,Fr,null);m(this,vh,t),m(this,Ug,s),m(this,zg,e),m(this,Fg,n),m(this,Hg,r),m(this,$g,a),m(this,Ul,new AbortController),m(this,Il,AbortSignal.any([l,o(this,Ul).signal])),t.addEventListener("touchstart",x(this,il,RO).bind(this),{passive:!1,signal:o(this,Il)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/vr.pixelRatio}destroy(){var t,e;(t=o(this,Ul))==null||t.abort(),m(this,Ul,null),(e=o(this,Ur))==null||e.abort(),m(this,Ur,null)}};vh=new WeakMap,Bl=new WeakMap,Ug=new WeakMap,zg=new WeakMap,Fg=new WeakMap,Hg=new WeakMap,$g=new WeakMap,Ur=new WeakMap,Il=new WeakMap,zr=new WeakMap,Ul=new WeakMap,Fr=new WeakMap,il=new WeakSet,RO=function(t){var n,r,a;if((n=o(this,zg))!=null&&n.call(this))return;if(t.touches.length===1){if(o(this,Ur))return;const l=m(this,Ur,new AbortController),c=AbortSignal.any([o(this,Il),l.signal]),u=o(this,vh),h={capture:!0,signal:c,passive:!1},d=f=>{var g;f.pointerType==="touch"&&((g=o(this,Ur))==null||g.abort(),m(this,Ur,null))};u.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(xe(f),d(f))},h),u.addEventListener("pointerup",d,h),u.addEventListener("pointercancel",d,h);return}if(!o(this,Fr)){m(this,Fr,new AbortController);const l=AbortSignal.any([o(this,Il),o(this,Fr).signal]),c=o(this,vh),u={signal:l,capture:!1,passive:!1};c.addEventListener("touchmove",x(this,il,OO).bind(this),u);const h=x(this,il,kO).bind(this);c.addEventListener("touchend",h,u),c.addEventListener("touchcancel",h,u),u.capture=!0,c.addEventListener("pointerdown",xe,u),c.addEventListener("pointermove",xe,u),c.addEventListener("pointercancel",xe,u),c.addEventListener("pointerup",xe,u),(r=o(this,Fg))==null||r.call(this)}if(xe(t),t.touches.length!==2||(a=o(this,Ug))!=null&&a.call(this)){m(this,zr,null);return}let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]),m(this,zr,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:s.screenX,touch1Y:s.screenY})},OO=function(t){var E;if(!o(this,zr)||t.touches.length!==2)return;xe(t);let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]);const{screenX:n,screenY:r}=e,{screenX:a,screenY:l}=s,c=o(this,zr),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=c,g=d-u,b=f-h,v=a-n,S=l-r,p=Math.hypot(v,S)||1,w=Math.hypot(g,b)||1;if(!o(this,Bl)&&Math.abs(w-p)<=rx.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=n,c.touch0Y=r,c.touch1X=a,c.touch1Y=l,!o(this,Bl)){m(this,Bl,!0);return}const y=[(n+a)/2,(r+l)/2];(E=o(this,Hg))==null||E.call(this,y,w,p)},kO=function(t){var e;t.touches.length>=2||(o(this,Fr)&&(o(this,Fr).abort(),m(this,Fr,null),(e=o(this,$g))==null||e.call(this)),o(this,zr)&&(xe(t),m(this,zr,null),m(this,Bl,!1)))};let X0=rx;var zl,Cn,ce,Xt,Hr,wh,oo,qg,cs,Fl,$r,tn,lo,Gg,Hl,hi,Vg,$l,qr,Zn,_h,Ah,en,ql,Xg,lb,J,x_,Yg,E_,jy,NO,MO,T_,Ly,C_,DO,jO,LO,R_,PO,O_,BO,IO,UO,k_,_f;const at=class at{constructor(t){A(this,J);A(this,zl,null);A(this,Cn,null);A(this,ce,null);A(this,Xt,null);A(this,Hr,null);A(this,wh,!1);A(this,oo,null);A(this,qg,"");A(this,cs,null);A(this,Fl,null);A(this,$r,null);A(this,tn,null);A(this,lo,null);A(this,Gg,"");A(this,Hl,!1);A(this,hi,null);A(this,Vg,!1);A(this,$l,!1);A(this,qr,!1);A(this,Zn,null);A(this,_h,0);A(this,Ah,0);A(this,en,null);A(this,ql,null);B(this,"isSelected",!1);B(this,"_isCopy",!1);B(this,"_editToolbar",null);B(this,"_initialOptions",Object.create(null));B(this,"_initialData",null);B(this,"_isVisible",!0);B(this,"_uiManager",null);B(this,"_focusEventsAllowed",!0);A(this,Xg,!1);A(this,lb,at._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:s,pageHeight:n,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,n],this.pageTranslation=[r,a];const[l,c]=this.parentDimensions;this.x=t.x/l,this.y=t.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=at.prototype._resizeWithKeyboard,e=Qc.TRANSLATE_SMALL,s=Qc.TRANSLATE_BIG;return ut(this,"_resizerKeyboardManager",new Rp([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],at.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ut(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new a3({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(at._l10n??(at._l10n=t),at._l10nResizer||(at._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),at._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);at._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Wt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return o(this,Xg)}set _isDraggable(t){var e;m(this,Xg,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=o(this,lb)}setParent(t){var e;t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(x(this,J,_f).call(this),(e=o(this,tn))==null||e.remove(),m(this,tn,null)),this.parent=t}focusin(t){this._focusEventsAllowed&&(o(this,Hl)?m(this,Hl,!1):this.parent.setSelected(this))}focusout(t){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,s,n){const[r,a]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(t+s)/r,this.y=(e+n)/a,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[s,n]=this.parentDimensions;this.setAt(t*s,e*n,this.width*s,this.height*n),this._onTranslated()}translate(t,e){x(this,J,x_).call(this,this.parentDimensions,t,e)}translateInPage(t,e){o(this,hi)||m(this,hi,[this.x,this.y,this.width,this.height]),x(this,J,x_).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){o(this,hi)||m(this,hi,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[n,r]}=this;if(this.x+=t/n,this.y+=e/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:l}=this;const[c,u]=this.getBaseTranslation();a+=c,l+=u;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*l).toFixed(2)}%`,this._onTranslating(a,l),s.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!o(this,hi)&&(o(this,hi)[0]!==this.x||o(this,hi)[1]!==this.y)}get _hasBeenResized(){return!!o(this,hi)&&(o(this,hi)[2]!==this.width||o(this,hi)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:s}=at,n=s/t,r=s/e;switch(this.rotation){case 90:return[-n,r];case 180:return[n,r];case 270:return[n,-r];default:return[-n,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[s,n]}=this;let{x:r,y:a,width:l,height:c}=this;if(l*=s,c*=n,r*=s,a*=n,this._mustFixPosition)switch(t){case 0:r=Is(r,0,s-l),a=Is(a,0,n-c);break;case 90:r=Is(r,0,s-c),a=Is(a,l,n);break;case 180:r=Is(r,l,s),a=Is(a,c,n);break;case 270:r=Is(r,c,s),a=Is(a,0,n-l);break}this.x=r/=s,this.y=a/=n;const[u,h]=this.getBaseTranslation();r+=u,a+=h,e.left=`${(100*r).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var s;return x(s=at,Yg,E_).call(s,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var s;return x(s=at,Yg,E_).call(s,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,s]}=this;return[e*t,s*t]}setDims(){const{div:{style:t},width:e,height:s}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=o(this,ce))==null||t.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||o(this,$l))return this._editToolbar;this._editToolbar=new m_(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,s]of t)await this._editToolbar.addButton(e,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var t;(t=this._editToolbar)==null||t.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var t;(t=this._editToolbar)==null||t.removeButton("comment")}removeEditToolbar(){var t,e;(t=this._editToolbar)==null||t.remove(),this._editToolbar=null,(e=o(this,ce))==null||e.destroy()}addContainer(t){var s;const e=(s=this._editToolbar)==null?void 0:s.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return o(this,ce)||(V0.initialize(at._l10n),m(this,ce,new V0(this)),o(this,zl)&&(o(this,ce).data=o(this,zl),m(this,zl,null))),o(this,ce)}get altTextData(){var t;return(t=o(this,ce))==null?void 0:t.data}set altTextData(t){o(this,ce)&&(o(this,ce).data=t)}get guessedAltText(){var t;return(t=o(this,ce))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=o(this,ce))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=o(this,ce))==null?void 0:e.serialize(t)}hasAltText(){return!!o(this,ce)&&!o(this,ce).isEmpty()}hasAltTextData(){var t;return((t=o(this,ce))==null?void 0:t.hasData())??!1}focusCommentButton(){var t;(t=o(this,Xt))==null||t.focusButton()}addCommentButton(){return this.canAddComment?o(this,Xt)||m(this,Xt,new ny(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(o(this,Hr)){this._uiManager.isEditingMode()&&o(this,Hr).classList.remove("hidden");return}this.hasComment&&(m(this,Hr,o(this,Xt).renderForStandalone()),this.div.append(o(this,Hr)))}}removeStandaloneCommentButton(){o(this,Xt).removeStandaloneCommentButton(),m(this,Hr,null)}hideStandaloneCommentButton(){var t;(t=o(this,Hr))==null||t.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:s,deleted:n}}=o(this,Xt);return{text:e,richText:t,date:s,deleted:n,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){o(this,Xt)||m(this,Xt,new ny(this)),o(this,Xt).data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:s}){if(!e||(o(this,Xt)||m(this,Xt,new ny(this)),o(this,Xt).setInitialText(t,s),!this.annotationElementId))return;const n=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);n&&this.updateFromAnnotationLayer(n)}get hasEditedComment(){var t;return(t=o(this,Xt))==null?void 0:t.hasBeenEdited()}get hasDeletedComment(){var t;return(t=o(this,Xt))==null?void 0:t.isDeleted()}get hasComment(){return!!o(this,Xt)&&!o(this,Xt).isEmpty()&&!o(this,Xt).isDeleted()}async editComment(t){o(this,Xt)||m(this,Xt,new ny(this)),o(this,Xt).edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){o(this,Xt).setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,n]=t.rect,[r]=this.pageDimensions,[a]=this.pageTranslation,l=a+r+1,c=n-100,u=l+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[l,c,u,n]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){o(this,Xt).data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=o(this,wh)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),x(this,J,O_).call(this);const[e,s]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*s/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/s).toFixed(2)}%`);const[n,r]=this.getInitialTranslation();return this.translate(n,r),gO(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(o(this,ql)||m(this,ql,new X0({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:x(this,J,DO).bind(this),onPinching:x(this,J,jO).bind(this),onPinchEnd:x(this,J,LO).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),t}pointerdown(t){const{isMac:e}=_s.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(m(this,Hl,!0),this._isDraggable){x(this,J,PO).call(this,t);return}x(this,J,R_).call(this,t)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){o(this,Zn)&&clearTimeout(o(this,Zn)),m(this,Zn,setTimeout(()=>{var t;m(this,Zn,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,s){t.changeParent(this),this.x=e,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,s=this.rotation){const n=this.parentScale,[r,a]=this.pageDimensions,[l,c]=this.pageTranslation,u=t/n,h=e/n,d=this.x*r,f=this.y*a,g=this.width*r,b=this.height*a;switch(s){case 0:return[d+u+l,a-f-h-b+c,d+u+g+l,a-f-h+c];case 90:return[d+h+l,a-f+u+c,d+h+b+l,a-f+u+g+c];case 180:return[d-u-g+l,a-f+h+c,d-u+l,a-f+h+b+c];case 270:return[d-h-b+l,a-f-u-g+c,d-h+l,a-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,n,r,a]=t,l=r-s,c=a-n;switch(this.rotation){case 0:return[s,e-a,l,c];case 90:return[s,e-n,c,l];case 180:return[r,e-n,l,c];case 270:return[r,e-a,c,l];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&at._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var t;(t=o(this,Xt))==null||t.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:s,opacity:n,deleted:r,richText:a},uid:l,pageIndex:c,creationDate:u,modificationDate:h}=this;return{id:l,pageIndex:c,rect:this.getPDFRect(),richText:a,contentsObj:{str:t},creationDate:u,modificationDate:s||h,popupRef:!r,color:e,opacity:n}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),m(this,$l,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),m(this,$l,!1),!0):!1}isInEditMode(){return o(this,$l)}shouldGetKeyboardEvents(){return o(this,qr)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:s,right:n}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return e<a&&n>0&&t<r&&s>0}rebuild(){x(this,J,O_).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){var s;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((s=this._initialData)==null?void 0:s.popupRef)||""}}static async deserialize(t,e,s){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});n.rotation=t.rotation,m(n,zl,t.accessibilityData),n._isCopy=t.isCopy||!1;const[r,a]=n.pageDimensions,[l,c,u,h]=n.getRectInCurrentCoords(t.rect,a);return n.x=l/r,n.y=c/a,n.width=u/r,n.height=h/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e,s;if((t=o(this,lo))==null||t.abort(),m(this,lo,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),o(this,Zn)&&(clearTimeout(o(this,Zn)),m(this,Zn,null)),x(this,J,_f).call(this),this.removeEditToolbar(),o(this,en)){for(const n of o(this,en).values())clearTimeout(n);m(this,en,null)}this.parent=null,(e=o(this,ql))==null||e.destroy(),m(this,ql,null),(s=o(this,tn))==null||s.remove(),m(this,tn,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(x(this,J,NO).call(this),o(this,cs).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[s,n,r,a]=this.getPDFRect();return[at._round(s+(r-s)*t),at._round(n+(a-n)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return o(this,Xt).commentPopupPositionInLayer}set commentPopupPosition(t){o(this,Xt).commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return o(this,Xt).hasDefaultPopupPosition()}get commentButtonWidth(){return o(this,Xt).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){var e;(e=o(this,Xt))==null||e.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),m(this,$r,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=o(this,cs).children;if(!o(this,Cn)){m(this,Cn,Array.from(e));const a=x(this,J,BO).bind(this),l=x(this,J,IO).bind(this),c=this._uiManager._signal;for(const u of o(this,Cn)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:c}),u.addEventListener("blur",l,{signal:c}),u.addEventListener("focus",x(this,J,UO).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",at._l10nResizer[h])}}const s=o(this,Cn)[0];let n=0;for(const a of e){if(a===s)break;n++}const r=(360-this.rotation+this.parentRotation)%360/90*(o(this,Cn).length/4);if(r!==n){if(r<n)for(let l=0;l<n-r;l++)o(this,cs).append(o(this,cs).firstChild);else if(r>n)for(let l=0;l<r-n;l++)o(this,cs).firstChild.before(o(this,cs).lastChild);let a=0;for(const l of e){const u=o(this,Cn)[a++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",at._l10nResizer[u])}}x(this,J,k_).call(this,0),m(this,qr,!0),o(this,cs).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){o(this,qr)&&x(this,J,C_).call(this,o(this,Gg),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){x(this,J,_f).call(this),this.div.focus()}select(){var t,e,s;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var n,r;(n=this.div)!=null&&n.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(e=this._editToolbar)==null||e.show(),(s=o(this,ce))==null||s.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var t;return(t=this.div)==null?void 0:t.focus({preventScroll:!0})},0)}unselect(){var t,e,s,n,r;this.isSelected&&(this.isSelected=!1,(t=o(this,cs))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(n=this._editToolbar)==null||n.hide(),(r=o(this,ce))==null||r.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return o(this,Vg)}set isEditing(t){m(this,Vg,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){o(this,en)||m(this,en,new Map);const{action:s}=t;let n=o(this,en).get(s);n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(t),o(this,en).delete(s),o(this,en).size===0&&m(this,en,null)},at._telemetryTimeout),o(this,en).set(s,n);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),m(this,wh,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,wh,!0)}updateFakeAnnotationElement(t){if(!o(this,tn)&&!this.deleted){m(this,tn,t.addFakeAnnotation(this));return}if(this.deleted){o(this,tn).remove(),m(this,tn,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&o(this,tn).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const s=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),s.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};zl=new WeakMap,Cn=new WeakMap,ce=new WeakMap,Xt=new WeakMap,Hr=new WeakMap,wh=new WeakMap,oo=new WeakMap,qg=new WeakMap,cs=new WeakMap,Fl=new WeakMap,$r=new WeakMap,tn=new WeakMap,lo=new WeakMap,Gg=new WeakMap,Hl=new WeakMap,hi=new WeakMap,Vg=new WeakMap,$l=new WeakMap,qr=new WeakMap,Zn=new WeakMap,_h=new WeakMap,Ah=new WeakMap,en=new WeakMap,ql=new WeakMap,Xg=new WeakMap,lb=new WeakMap,J=new WeakSet,x_=function([t,e],s,n){[s,n]=this.screenToPageTranslation(s,n),this.x+=s/t,this.y+=n/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Yg=new WeakSet,E_=function(t,e,s){switch(s){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},jy=function(t){switch(t){case 90:{const[e,s]=this.pageDimensions;return[0,-e/s,s/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,s]=this.pageDimensions;return[0,e/s,-s/e,0]}default:return[1,0,0,1]}},NO=function(){if(o(this,cs))return;m(this,cs,document.createElement("div")),o(this,cs).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const s of t){const n=document.createElement("div");o(this,cs).append(n),n.classList.add("resizer",s),n.setAttribute("data-resizer-name",s),n.addEventListener("pointerdown",x(this,J,MO).bind(this,s),{signal:e}),n.addEventListener("contextmenu",bn,{signal:e}),n.tabIndex=-1}this.div.prepend(o(this,cs))},MO=function(t,e){var h;e.preventDefault();const{isMac:s}=_s.platform;if(e.button!==0||e.ctrlKey&&s)return;(h=o(this,ce))==null||h.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,m(this,Fl,[e.screenX,e.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",x(this,J,C_).bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",xe,{passive:!1,signal:a}),window.addEventListener("contextmenu",bn,{signal:a}),m(this,$r,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{var d;r.abort(),this.parent.togglePointerEvents(!0),(d=o(this,ce))==null||d.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=l,this.div.style.cursor=c,x(this,J,Ly).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},T_=function(t,e,s,n){this.width=s,this.height=n,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()},Ly=function(){if(!o(this,$r))return;const{savedX:t,savedY:e,savedWidth:s,savedHeight:n}=o(this,$r);m(this,$r,null);const r=this.x,a=this.y,l=this.width,c=this.height;r===t&&a===e&&l===s&&c===n||this.addCommands({cmd:x(this,J,T_).bind(this,r,a,l,c),undo:x(this,J,T_).bind(this,t,e,s,n),mustExec:!0})},C_=function(t,e){const[s,n]=this.parentDimensions,r=this.x,a=this.y,l=this.width,c=this.height,u=at.MIN_SIZE/s,h=at.MIN_SIZE/n,d=x(this,J,jy).call(this,this.rotation),f=(N,L)=>[d[0]*N+d[2]*L,d[1]*N+d[3]*L],g=x(this,J,jy).call(this,360-this.rotation),b=(N,L)=>[g[0]*N+g[2]*L,g[1]*N+g[3]*L];let v,S,p=!1,w=!1;switch(t){case"topLeft":p=!0,v=(N,L)=>[0,0],S=(N,L)=>[N,L];break;case"topMiddle":v=(N,L)=>[N/2,0],S=(N,L)=>[N/2,L];break;case"topRight":p=!0,v=(N,L)=>[N,0],S=(N,L)=>[0,L];break;case"middleRight":w=!0,v=(N,L)=>[N,L/2],S=(N,L)=>[0,L/2];break;case"bottomRight":p=!0,v=(N,L)=>[N,L],S=(N,L)=>[0,0];break;case"bottomMiddle":v=(N,L)=>[N/2,L],S=(N,L)=>[N/2,0];break;case"bottomLeft":p=!0,v=(N,L)=>[0,L],S=(N,L)=>[N,0];break;case"middleLeft":w=!0,v=(N,L)=>[0,L/2],S=(N,L)=>[N,L/2];break}const y=v(l,c),E=S(l,c);let T=f(...E);const C=at._round(r+T[0]),R=at._round(a+T[1]);let O=1,k=1,D,P;if(e.fromKeyboard)({deltaX:D,deltaY:P}=e);else{const{screenX:N,screenY:L}=e,[z,tt]=o(this,Fl);[D,P]=this.screenToPageTranslation(N-z,L-tt),o(this,Fl)[0]=N,o(this,Fl)[1]=L}if([D,P]=b(D/s,P/n),p){const N=Math.hypot(l,c);O=k=Math.max(Math.min(Math.hypot(E[0]-y[0]-D,E[1]-y[1]-P)/N,1/l,1/c),u/l,h/c)}else w?O=Is(Math.abs(E[0]-y[0]-D),u,1)/l:k=Is(Math.abs(E[1]-y[1]-P),h,1)/c;const I=at._round(l*O),Z=at._round(c*k);T=f(...S(I,Z));const K=C-T[0],W=R-T[1];o(this,hi)||m(this,hi,[this.x,this.y,this.width,this.height]),this.width=I,this.height=Z,this.x=K,this.y=W,this.setDims(),this.fixAndSetPosition(),this._onResizing()},DO=function(){var t;m(this,$r,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=o(this,ce))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},jO=function(t,e,s){let r=.7*(s/e)+1-.7;if(r===1)return;const a=x(this,J,jy).call(this,this.rotation),l=(C,R)=>[a[0]*C+a[2]*R,a[1]*C+a[3]*R],[c,u]=this.parentDimensions,h=this.x,d=this.y,f=this.width,g=this.height,b=at.MIN_SIZE/c,v=at.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/g),b/f,v/g);const S=at._round(f*r),p=at._round(g*r);if(S===f&&p===g)return;o(this,hi)||m(this,hi,[h,d,f,g]);const w=l(f/2,g/2),y=at._round(h+w[0]),E=at._round(d+w[1]),T=l(S/2,p/2);this.x=y-T[0],this.y=E-T[1],this.width=S,this.height=p,this.setDims(),this.fixAndSetPosition(),this._onResizing()},LO=function(){var t;(t=o(this,ce))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),x(this,J,Ly).call(this)},R_=function(t){const{isMac:e}=_s.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},PO=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let s=!1;const n=new AbortController,r=this._uiManager.combinedSignal(n),a={capture:!0,passive:!1,signal:r},l=u=>{n.abort(),m(this,oo,null),m(this,Hl,!1),this._uiManager.endDragSession()||x(this,J,R_).call(this,u),s&&this._onStopDragging()};e&&(m(this,_h,t.clientX),m(this,Ah,t.clientY),m(this,oo,t.pointerId),m(this,qg,t.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:h,clientY:d,pointerId:f}=u;if(f!==o(this,oo)){xe(u);return}const[g,b]=this.screenToPageTranslation(h-o(this,_h),d-o(this,Ah));m(this,_h,h),m(this,Ah,d),this._uiManager.dragSelectedEditors(g,b)},a),window.addEventListener("touchmove",xe,a),window.addEventListener("pointerdown",u=>{u.pointerType===o(this,qg)&&(o(this,ql)||u.isPrimary)&&l(u),xe(u)},a));const c=u=>{if(!o(this,oo)||o(this,oo)===u.pointerId){l(u);return}xe(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},O_=function(){if(o(this,lo)||!this.div)return;m(this,lo,new AbortController);const t=this._uiManager.combinedSignal(o(this,lo));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},BO=function(t){at._resizerKeyboardManager.exec(this,t)},IO=function(t){var e;o(this,qr)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==o(this,cs)&&x(this,J,_f).call(this)},UO=function(t){m(this,Gg,o(this,qr)?t:"")},k_=function(t){if(o(this,Cn))for(const e of o(this,Cn))e.tabIndex=t},_f=function(){m(this,qr,!1),x(this,J,k_).call(this,-1),x(this,J,Ly).call(this)},A(at,Yg),B(at,"_l10n",null),B(at,"_l10nResizer",null),B(at,"_borderLineWidth",-1),B(at,"_colorManager",new b_),B(at,"_zIndex",1),B(at,"_telemetryTimeout",1e3);let ee=at;class a3 extends ee{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const xE=3285377520,Gi=4294901760,$n=65535;class zO{constructor(t){this.h1=t?t&4294967295:xE,this.h2=t?t&4294967295:xE}update(t){let e,s;if(typeof t=="string"){e=new Uint8Array(t.length*2),s=0;for(let v=0,S=t.length;v<S;v++){const p=t.charCodeAt(v);p<=255?e[s++]=p:(e[s++]=p>>>8,e[s++]=p&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),s=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const n=s>>2,r=s-n*4,a=new Uint32Array(e.buffer,0,n);let l=0,c=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,g=d&$n,b=f&$n;for(let v=0;v<n;v++)v&1?(l=a[v],l=l*d&Gi|l*g&$n,l=l<<15|l>>>17,l=l*f&Gi|l*b&$n,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(c=a[v],c=c*d&Gi|c*g&$n,c=c<<15|c>>>17,c=c*f&Gi|c*b&$n,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(l=0,r){case 3:l^=e[n*4+2]<<16;case 2:l^=e[n*4+1]<<8;case 1:l^=e[n*4],l=l*d&Gi|l*g&$n,l=l<<15|l>>>17,l=l*f&Gi|l*b&$n,n&1?u^=l:h^=l}this.h1=u,this.h2=h}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Gi|t*36045&$n,e=e*4283543511&Gi|((e<<16|t>>>16)*2950163797&Gi)>>>16,t^=e>>>1,t=t*444984403&Gi|t*60499&$n,e=e*3301882366&Gi|((e<<16|t>>>16)*3120437893&Gi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const N_=Object.freeze({map:null,hash:"",transfer:void 0});var Gl,Vl,Gr,us,cb,FO;class QS{constructor(){A(this,cb);A(this,Gl,!1);A(this,Vl,null);A(this,Gr,null);A(this,us,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const s=o(this,us).get(t);return s===void 0?e:Object.assign(e,s)}getRawValue(t){return o(this,us).get(t)}remove(t){const e=o(this,us).get(t);if(e!==void 0&&(e instanceof ee&&o(this,Gr).delete(e.annotationElementId),o(this,us).delete(t),o(this,us).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of o(this,us).values())if(s instanceof ee)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=o(this,us).get(t);let n=!1;if(s!==void 0)for(const[r,a]of Object.entries(e))s[r]!==a&&(n=!0,s[r]=a);else n=!0,o(this,us).set(t,e);n&&x(this,cb,FO).call(this),e instanceof ee&&((o(this,Gr)||m(this,Gr,new Map)).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return o(this,us).has(t)}get size(){return o(this,us).size}resetModified(){o(this,Gl)&&(m(this,Gl,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new HO(this)}get serializable(){if(o(this,us).size===0)return N_;const t=new Map,e=new zO,s=[],n=Object.create(null);let r=!1;for(const[a,l]of o(this,us)){const c=l instanceof ee?l.serialize(!1,n):l;c&&(t.set(a,c),e.update(`${a}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const a of t.values())a.bitmap&&s.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:s}:N_}get editorStats(){let t=null;const e=new Map;let s=0,n=0;for(const r of o(this,us).values()){if(!(r instanceof ee)){r.popup&&(r.popup.deleted?n+=1:s+=1);continue}r.isCommentDeleted?n+=1:r.hasEditedComment&&(s+=1);const a=r.telemetryFinalData;if(!a)continue;const{type:l}=a;e.has(l)||e.set(l,Object.getPrototypeOf(r).constructor),t||(t=Object.create(null));const c=t[l]||(t[l]=new Map);for(const[u,h]of Object.entries(a)){if(u==="type")continue;let d=c.get(u);d||(d=new Map,c.set(u,d));const f=d.get(h)??0;d.set(h,f+1)}}if((n>0||s>0)&&(t||(t=Object.create(null)),t.comments={deleted:n,edited:s}),!t)return null;for(const[r,a]of e)t[r]=a.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){m(this,Vl,null)}updateEditor(t,e){var n;const s=(n=o(this,Gr))==null?void 0:n.get(t);return s?(s.updateFromAnnotationLayer(e),!0):!1}getEditor(t){var e;return((e=o(this,Gr))==null?void 0:e.get(t))||null}get modifiedIds(){if(o(this,Vl))return o(this,Vl);const t=[];if(o(this,Gr))for(const e of o(this,Gr).values())e.serialize()&&t.push(e.annotationElementId);return m(this,Vl,{ids:new Set(t),hash:t.join(",")})}[Symbol.iterator](){return o(this,us).entries()}}Gl=new WeakMap,Vl=new WeakMap,Gr=new WeakMap,us=new WeakMap,cb=new WeakSet,FO=function(){o(this,Gl)||(m(this,Gl,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Kg;class HO extends QS{constructor(e){super();A(this,Kg);const{map:s,hash:n,transfer:r}=e.serializable,a=structuredClone(s,r?{transfer:r}:null);m(this,Kg,{map:a,hash:n,transfer:r})}get print(){Wt("Should not call PrintAnnotationStorage.print")}get serializable(){return o(this,Kg)}get modifiedIds(){return ut(this,"modifiedIds",{ids:new Set,hash:""})}}Kg=new WeakMap;var Sh;class o3{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){A(this,Sh,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),o(this,Sh).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:s}){if(!(!t||o(this,Sh).has(t.loadedName))){if(St(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:r,style:a}=t,l=new FontFace(n,r,a);this.addNativeFontFace(l);try{await l.load(),o(this,Sh).add(n),s==null||s(t)}catch{nt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Wt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(n){throw nt(`Failed to load font '${s.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const n=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,n)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return ut(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return ut(this,"isSyncFontLoadingSupported",Bs||_s.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(St(!n.done,"completeRequest() cannot be called twice."),n.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,n={done:!1,complete:e,callback:t};return s.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ut(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function s(E,T){return E.charCodeAt(T)<<24|E.charCodeAt(T+1)<<16|E.charCodeAt(T+2)<<8|E.charCodeAt(T+3)&255}function n(E,T,C,R){const O=E.substring(0,T),k=E.substring(T+C);return O+R+k}let r,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let u=0;function h(E,T){if(++u>30){nt("Load test font never loaded."),T();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){T();return}setTimeout(h.bind(null,E,T))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=n(f,976,d.length,d);const b=16,v=1482184792;let S=s(f,b);for(r=0,a=d.length-3;r<a;r+=4)S=S-v+s(d,r)|0;r<d.length&&(S=S-v+s(d+"XXX",r)|0),f=n(f,b,4,FB(S));const p=`url(data:font/opentype;base64,${btoa(f)});`,w=`@font-face {font-family:"${d}";src:${p}}`;this.insertRule(w);const y=this._document.createElement("div");y.style.visibility="hidden",y.style.width=y.style.height="10px",y.style.position="absolute",y.style.top=y.style.left="0px";for(const E of[t.loadedName,d]){const T=this._document.createElement("span");T.textContent="Hi",T.style.fontFamily=E,y.append(T)}this._document.body.append(y),h(d,()=>{y.remove(),e.complete()})}}Sh=new WeakMap;var Ut;class l3{constructor(t,e=null,s,n){A(this,Ut);this.compiledGlyphs=Object.create(null),m(this,Ut,t),this._inspectFont=e,s&&Object.assign(this,s),n&&(this.charProcOperatorList=n)}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${rO(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return(s=this._inspectFont)==null||s.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const s=this.loadedName+"_path_"+e;let n;try{n=t.get(s)}catch(a){nt(`getPathGenerator - ignoring character: "${a}".`)}const r=lO(n);return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[e]=r}get black(){return o(this,Ut).black}get bold(){return o(this,Ut).bold}get disableFontFace(){return o(this,Ut).disableFontFace??!1}get fontExtraProperties(){return o(this,Ut).fontExtraProperties??!1}get isInvalidPDFjsFont(){return o(this,Ut).isInvalidPDFjsFont}get isType3Font(){return o(this,Ut).isType3Font}get italic(){return o(this,Ut).italic}get missingFile(){return o(this,Ut).missingFile}get remeasure(){return o(this,Ut).remeasure}get vertical(){return o(this,Ut).vertical}get ascent(){return o(this,Ut).ascent}get defaultWidth(){return o(this,Ut).defaultWidth}get descent(){return o(this,Ut).descent}get bbox(){return o(this,Ut).bbox}get fontMatrix(){return o(this,Ut).fontMatrix}get fallbackName(){return o(this,Ut).fallbackName}get loadedName(){return o(this,Ut).loadedName}get mimetype(){return o(this,Ut).mimetype}get name(){return o(this,Ut).name}get data(){return o(this,Ut).data}clearData(){o(this,Ut).clearData()}get cssFontInfo(){return o(this,Ut).cssFontInfo}get systemFontInfo(){return o(this,Ut).systemFontInfo}get defaultVMetrics(){return o(this,Ut).defaultVMetrics}}Ut=new WeakMap;var xh,Eh,Wg,Th,Py;const qu=class qu{constructor(t){A(this,Th);A(this,xh);A(this,Eh);A(this,Wg);m(this,xh,t),m(this,Eh,new DataView(o(this,xh))),m(this,Wg,new TextDecoder)}static write(t){const e=new TextEncoder,s={};let n=0;for(const u of qu.strings){const h=e.encode(t[u]);s[u]=h,n+=4+h.length}const r=new ArrayBuffer(n),a=new Uint8Array(r),l=new DataView(r);let c=0;for(const u of qu.strings){const h=s[u],d=h.length;l.setUint32(c,d),a.set(h,c+4),c+=4+d}return St(c===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}get fontFamily(){return x(this,Th,Py).call(this,0)}get fontWeight(){return x(this,Th,Py).call(this,1)}get italicAngle(){return x(this,Th,Py).call(this,2)}};xh=new WeakMap,Eh=new WeakMap,Wg=new WeakMap,Th=new WeakSet,Py=function(t){St(t<qu.strings.length,"Invalid string index");let e=0;for(let n=0;n<t;n++)e+=o(this,Eh).getUint32(e)+4;const s=o(this,Eh).getUint32(e);return o(this,Wg).decode(new Uint8Array(o(this,xh),e+4,s))},B(qu,"strings",["fontFamily","fontWeight","italicAngle"]);let Y0=qu;var co,tr,Xl,Yl,Af;const Gu=class Gu{constructor(t){A(this,Yl);A(this,co);A(this,tr);A(this,Xl);m(this,co,t),m(this,tr,new DataView(o(this,co))),m(this,Xl,new TextDecoder)}static write(t){const e=new TextEncoder,s={};let n=0;for(const f of Gu.strings){const g=e.encode(t[f]);s[f]=g,n+=4+g.length}n+=4;let r,a,l=1+n;t.style&&(r=e.encode(t.style.style),a=e.encode(t.style.weight),l+=4+r.length+4+a.length);const c=new ArrayBuffer(l),u=new Uint8Array(c),h=new DataView(c);let d=0;h.setUint8(d++,t.guessFallback?1:0),h.setUint32(d,0),d+=4,n=0;for(const f of Gu.strings){const g=s[f],b=g.length;n+=4+b,h.setUint32(d,b),u.set(g,d+4),d+=4+b}return h.setUint32(d-n-4,n),t.style&&(h.setUint32(d,r.length),u.set(r,d+4),d+=4+r.length,h.setUint32(d,a.length),u.set(a,d+4),d+=4+a.length),St(d<=c.byteLength,"SubstitionInfo.write: Buffer overflow"),c.transferToFixedLength(d)}get guessFallback(){return o(this,tr).getUint8(0)!==0}get css(){return x(this,Yl,Af).call(this,0)}get loadedName(){return x(this,Yl,Af).call(this,1)}get baseFontName(){return x(this,Yl,Af).call(this,2)}get src(){return x(this,Yl,Af).call(this,3)}get style(){let t=1;t+=4+o(this,tr).getUint32(t);const e=o(this,tr).getUint32(t),s=o(this,Xl).decode(new Uint8Array(o(this,co),t+4,e));t+=4+e;const n=o(this,tr).getUint32(t),r=o(this,Xl).decode(new Uint8Array(o(this,co),t+4,n));return{style:s,weight:r}}};co=new WeakMap,tr=new WeakMap,Xl=new WeakMap,Yl=new WeakSet,Af=function(t){St(t<Gu.strings.length,"Invalid string index");let e=5;for(let n=0;n<t;n++)e+=o(this,tr).getUint32(e)+4;const s=o(this,tr).getUint32(e);return o(this,Xl).decode(new Uint8Array(o(this,co),e+4,s))},B(Gu,"strings",["css","loadedName","baseFontName","src"]);let K0=Gu;var Ch,Rh,Oh,kh,di,er,Qg,zt,Se,An,By,Sf;const ct=class ct{constructor({data:t,extra:e}){A(this,Se);A(this,er);A(this,Qg);A(this,zt);m(this,er,t),m(this,Qg,new TextDecoder),m(this,zt,new DataView(o(this,er))),e&&Object.assign(this,e)}get black(){return x(this,Se,An).call(this,0)}get bold(){return x(this,Se,An).call(this,1)}get disableFontFace(){return x(this,Se,An).call(this,2)}get fontExtraProperties(){return x(this,Se,An).call(this,3)}get isInvalidPDFjsFont(){return x(this,Se,An).call(this,4)}get isType3Font(){return x(this,Se,An).call(this,5)}get italic(){return x(this,Se,An).call(this,6)}get missingFile(){return x(this,Se,An).call(this,7)}get remeasure(){return x(this,Se,An).call(this,8)}get vertical(){return x(this,Se,An).call(this,9)}get ascent(){return x(this,Se,By).call(this,0)}get defaultWidth(){return x(this,Se,By).call(this,1)}get descent(){return x(this,Se,By).call(this,2)}get bbox(){let t=o(ct,Rh);if(o(this,zt).getUint8(t)===0)return;t+=1;const s=[];for(let n=0;n<4;n++)s.push(o(this,zt).getInt16(t,!0)),t+=2;return s}get fontMatrix(){let t=o(ct,Oh);if(o(this,zt).getUint8(t)===0)return;t+=1;const s=[];for(let n=0;n<6;n++)s.push(o(this,zt).getFloat64(t,!0)),t+=8;return s}get defaultVMetrics(){let t=o(ct,kh);if(o(this,zt).getUint8(t)===0)return;t+=1;const s=[];for(let n=0;n<3;n++)s.push(o(this,zt).getInt16(t,!0)),t+=2;return s}get fallbackName(){return x(this,Se,Sf).call(this,0)}get loadedName(){return x(this,Se,Sf).call(this,1)}get mimetype(){return x(this,Se,Sf).call(this,2)}get name(){return x(this,Se,Sf).call(this,3)}get data(){let t=o(ct,di);const e=o(this,zt).getUint32(t);t+=4+e;const s=o(this,zt).getUint32(t);t+=4+s;const n=o(this,zt).getUint32(t);t+=4+n;const r=o(this,zt).getUint32(t);if(r!==0)return new Uint8Array(o(this,er),t+4,r)}clearData(){let t=o(ct,di);const e=o(this,zt).getUint32(t);t+=4+e;const s=o(this,zt).getUint32(t);t+=4+s;const n=o(this,zt).getUint32(t);t+=4+n;const r=o(this,zt).getUint32(t);new Uint8Array(o(this,er),t+4,r).fill(0),o(this,zt).setUint32(t,0)}get cssFontInfo(){let t=o(ct,di);const e=o(this,zt).getUint32(t);t+=4+e;const s=o(this,zt).getUint32(t);t+=4+s;const n=o(this,zt).getUint32(t);if(n===0)return null;const r=new Uint8Array(n);return r.set(new Uint8Array(o(this,er),t+4,n)),new Y0(r.buffer)}get systemFontInfo(){let t=o(ct,di);const e=o(this,zt).getUint32(t);t+=4+e;const s=o(this,zt).getUint32(t);if(s===0)return null;const n=new Uint8Array(s);return n.set(new Uint8Array(o(this,er),t+4,s)),new K0(n.buffer)}static write(t){const e=t.systemFontInfo?K0.write(t.systemFontInfo):null,s=t.cssFontInfo?Y0.write(t.cssFontInfo):null,n=new TextEncoder,r={};let a=0;for(const v of ct.strings)r[v]=n.encode(t[v]),a+=4+r[v].length;const l=o(ct,di)+4+a+4+(e?e.byteLength:0)+4+(s?s.byteLength:0)+4+(t.data?t.data.length:0),c=new ArrayBuffer(l),u=new Uint8Array(c),h=new DataView(c);let d=0;const f=ct.bools.length;let g=0,b=0;for(let v=0;v<f;v++){const S=t[ct.bools[v]];g|=(S===void 0?0:S?2:1)<<b,b+=2,(b===8||v===f-1)&&(h.setUint8(d++,g),g=0,b=0)}St(d===o(ct,Ch),"FontInfo.write: Boolean properties offset mismatch");for(const v of ct.numbers)h.setFloat64(d,t[v]),d+=8;if(St(d===o(ct,Rh),"FontInfo.write: Number properties offset mismatch"),t.bbox){h.setUint8(d++,4);for(const v of t.bbox)h.setInt16(d,v,!0),d+=2}else h.setUint8(d++,0),d+=2*4;if(St(d===o(ct,Oh),"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){h.setUint8(d++,6);for(const v of t.fontMatrix)h.setFloat64(d,v,!0),d+=8}else h.setUint8(d++,0),d+=8*6;if(St(d===o(ct,kh),"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){h.setUint8(d++,1);for(const v of t.defaultVMetrics)h.setInt16(d,v,!0),d+=2}else h.setUint8(d++,0),d+=3*2;St(d===o(ct,di),"FontInfo.write: DefaultVMetrics properties offset mismatch"),h.setUint32(o(ct,di),0),d+=4;for(const v of ct.strings){const S=r[v],p=S.length;h.setUint32(d,p),u.set(S,d+4),d+=4+p}if(h.setUint32(o(ct,di),d-o(ct,di)-4),!e)h.setUint32(d,0),d+=4;else{const v=e.byteLength;h.setUint32(d,v),St(d+4+v<=c.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(e),d+4),d+=4+v}if(!s)h.setUint32(d,0),d+=4;else{const v=s.byteLength;h.setUint32(d,v),St(d+4+v<=c.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(s),d+4),d+=4+v}return t.data===void 0?(h.setUint32(d,0),d+=4):(h.setUint32(d,t.data.length),u.set(t.data,d+4),d+=4+t.data.length),St(d<=c.byteLength,"FontInfo.write: Buffer overflow"),c.transferToFixedLength(d)}};Ch=new WeakMap,Rh=new WeakMap,Oh=new WeakMap,kh=new WeakMap,di=new WeakMap,er=new WeakMap,Qg=new WeakMap,zt=new WeakMap,Se=new WeakSet,An=function(t){St(t<ct.bools.length,"Invalid boolean index");const e=Math.floor(t/4),s=t*2%8,n=o(this,zt).getUint8(e)>>s&3;return n===0?void 0:n===2},By=function(t){return St(t<ct.numbers.length,"Invalid number index"),o(this,zt).getFloat64(o(ct,Ch)+t*8)},Sf=function(t){St(t<ct.strings.length,"Invalid string index");let e=o(ct,di)+4;for(let r=0;r<t;r++)e+=o(this,zt).getUint32(e)+4;const s=o(this,zt).getUint32(e),n=new Uint8Array(s);return n.set(new Uint8Array(o(this,er),e+4,s)),o(this,Qg).decode(n)},B(ct,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),B(ct,"numbers",["ascent","defaultWidth","descent"]),B(ct,"strings",["fallbackName","loadedName","mimetype","name"]),A(ct,Ch,Math.ceil(ct.bools.length*2/8)),A(ct,Rh,o(ct,Ch)+ct.numbers.length*8),A(ct,Oh,o(ct,Rh)+1+2*4),A(ct,kh,o(ct,Oh)+1+8*6),A(ct,di,o(ct,kh)+1+2*3);let M_=ct;var Jg,Zg,tm,em,sm,im,nm,rm;const Zt=class Zt{constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,s=null,n=[],r=[],a=[],l=[],c=null,u=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,s=t[2],a=t[3],e===1?n.push(...t[4],...t[5]):n.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,c=t[1],n=t[2],r=t[3],l=t[4]||[],s=t[6],u=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const h=Math.floor(n.length/2),d=Math.floor(r.length/3),f=a.length,g=l.length;let b=0;for(const T of l)b+=1,b=Math.ceil(b/4)*4,b+=4+T.coords.length*4,b+=4+T.colors.length*4,T.verticesPerRow!==void 0&&(b+=4);const v=20+h*8+d*3+f*8+(s?16:0)+(u?3:0)+b,S=new ArrayBuffer(v),p=new DataView(S),w=new Uint8Array(S);p.setUint8(o(Zt,Jg),e),p.setUint8(o(Zt,Zg),s?1:0),p.setUint8(o(Zt,tm),u?1:0),p.setUint8(o(Zt,em),c),p.setUint32(o(Zt,sm),h,!0),p.setUint32(o(Zt,im),d,!0),p.setUint32(o(Zt,nm),f,!0),p.setUint32(o(Zt,rm),g,!0);let y=20;new Float32Array(S,y,h*2).set(n),y+=h*8,w.set(r,y),y+=d*3;for(const[T,C]of a)p.setFloat32(y,T,!0),y+=4,p.setUint32(y,parseInt(C.slice(1),16),!0),y+=4;if(s)for(const T of s)p.setFloat32(y,T,!0),y+=4;u&&(w.set(u,y),y+=3);for(let T=0;T<l.length;T++){const C=l[T];p.setUint8(y,C.type),y+=1,y=Math.ceil(y/4)*4,p.setUint32(y,C.coords.length,!0),y+=4,new Int32Array(S,y,C.coords.length).set(C.coords),y+=C.coords.length*4,p.setUint32(y,C.colors.length,!0),y+=4,new Int32Array(S,y,C.colors.length).set(C.colors),y+=C.colors.length*4,C.verticesPerRow!==void 0&&(p.setUint32(y,C.verticesPerRow,!0),y+=4)}return S}getIR(){const t=this.view,e=this.data[o(Zt,Jg)],s=!!this.data[o(Zt,Zg)],n=!!this.data[o(Zt,tm)],r=t.getUint32(o(Zt,sm),!0),a=t.getUint32(o(Zt,im),!0),l=t.getUint32(o(Zt,nm),!0),c=t.getUint32(o(Zt,rm),!0);let u=20;const h=new Float32Array(this.buffer,u,r*2);u+=r*8;const d=new Uint8Array(this.buffer,u,a*3);u+=a*3;const f=[];for(let S=0;S<l;++S){const p=t.getFloat32(u,!0);u+=4;const w=t.getUint32(u,!0);u+=4,f.push([p,`#${w.toString(16).padStart(6,"0")}`])}let g=null;if(s){g=[];for(let S=0;S<4;++S)g.push(t.getFloat32(u,!0)),u+=4}let b=null;n&&(b=new Uint8Array(this.buffer,u,3),u+=3);const v=[];for(let S=0;S<c;++S){const p=t.getUint8(u);u+=1,u=Math.ceil(u/4)*4;const w=t.getUint32(u,!0);u+=4;const y=new Int32Array(this.buffer,u,w);u+=w*4;const E=t.getUint32(u,!0);u+=4;const T=new Int32Array(this.buffer,u,E);u+=E*4;const C={type:p,coords:y,colors:T};p===u_.LATTICE&&(C.verticesPerRow=t.getUint32(u,!0),u+=4),v.push(C)}if(e===1)return["RadialAxial","axial",g,f,Array.from(h.slice(0,2)),Array.from(h.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",g,f,[h[0],h[1]],[h[3],h[4]],h[2],h[5]];if(e===3){const S=this.data[o(Zt,em)];let p=null;if(h.length>0){let w=h[0],y=h[0],E=h[1],T=h[1];for(let C=0;C<h.length;C+=2){const R=h[C],O=h[C+1];w=w>R?R:w,E=E>O?O:E,y=y<R?R:y,T=T<O?O:T}p=[w,E,y,T]}return["Mesh",S,h,d,v,p,g,b]}throw new Error(`Unsupported pattern kind: ${e}`)}};Jg=new WeakMap,Zg=new WeakMap,tm=new WeakMap,em=new WeakMap,sm=new WeakMap,im=new WeakMap,nm=new WeakMap,rm=new WeakMap,A(Zt,Jg,0),A(Zt,Zg,1),A(Zt,tm,2),A(Zt,em,3),A(Zt,sm,4),A(Zt,im,8),A(Zt,nm,12),A(Zt,rm,16);let D_=Zt;function c3(i){if(i instanceof URL)return i.href;if(typeof i=="string"){if(Bs)return i;const t=URL.parse(i,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function u3(i){if(Bs&&typeof Buffer<"u"&&i instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return xp(i);if(i instanceof ArrayBuffer||ArrayBuffer.isView(i)||typeof i=="object"&&!isNaN(i==null?void 0:i.length))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function ry(i){if(typeof i!="string")return null;if(i.endsWith("/"))return i;throw new Error(`Invalid factory url: "${i}" must include trailing slash.`)}const j_=i=>typeof i=="object"&&Number.isInteger(i==null?void 0:i.num)&&i.num>=0&&Number.isInteger(i==null?void 0:i.gen)&&i.gen>=0,h3=i=>typeof i=="object"&&typeof(i==null?void 0:i.name)=="string",d3=VB.bind(null,j_,h3);var Vr,ub;class f3{constructor(){A(this,Vr,new Map);A(this,ub,Promise.resolve())}postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};o(this,ub).then(()=>{for(const[n]of o(this,Vr))n.call(this,s)})}addEventListener(t,e,s=null){let n=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){nt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);n=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}o(this,Vr).set(e,n)}removeEventListener(t,e){const s=o(this,Vr).get(e);s==null||s(),o(this,Vr).delete(e)}terminate(){for(const[,t]of o(this,Vr))t==null||t();o(this,Vr).clear()}}Vr=new WeakMap,ub=new WeakMap;const ay={DATA:1,ERROR:2},Ne={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function EE(){}function Xs(i){if(i instanceof el||i instanceof h_||i instanceof yE||i instanceof q0||i instanceof Gv)return i;switch(i instanceof Error||typeof i=="object"&&i!==null||Wt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),i.name){case"AbortException":return new el(i.message);case"InvalidPDFException":return new h_(i.message);case"PasswordException":return new yE(i.message,i.code);case"ResponseException":return new q0(i.message,i.status,i.missing);case"UnknownErrorException":return new Gv(i.message,i.details)}return new Gv(i.message,i.toString())}var Nh,pn,$O,qO,GO,Iy;class xf{constructor(t,e,s){A(this,pn);A(this,Nh,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",x(this,pn,$O).bind(this),{signal:o(this,Nh).signal})}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const n=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[n]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(t,e,s,n){const r=this.streamId++,a=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:l,action:t,streamId:r,data:e,desiredSize:u.desiredSize},n),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,c.postMessage({sourceName:a,targetName:l,stream:Ne.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{St(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:l,stream:Ne.CANCEL,streamId:r,reason:Xs(u)}),h.promise}},s)}destroy(){var t;(t=o(this,Nh))==null||t.abort(),m(this,Nh,null)}}Nh=new WeakMap,pn=new WeakSet,$O=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){x(this,pn,GO).call(this,t);return}if(t.callback){const s=t.callbackId,n=this.callbackCapabilities[s];if(!n)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===ay.DATA)n.resolve(t.data);else if(t.callback===ay.ERROR)n.reject(Xs(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,n=t.sourceName,r=this.comObj;Promise.try(e,t.data).then(function(a){r.postMessage({sourceName:s,targetName:n,callback:ay.DATA,callbackId:t.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:n,callback:ay.ERROR,callbackId:t.callbackId,reason:Xs(a)})});return}if(t.streamId){x(this,pn,qO).call(this,t);return}e(t.data)},qO=function(t){const e=t.streamId,s=this.sourceName,n=t.sourceName,r=this.comObj,a=this,l=this.actionHandler[t.action],c={enqueue(u,h=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=h,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:n,stream:Ne.ENQUEUE,streamId:e,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:n,stream:Ne.CLOSE,streamId:e}),delete a.streamSinks[e])},error(u){St(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:n,stream:Ne.ERROR,streamId:e,reason:Xs(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[e]=c,Promise.try(l,t.data,c).then(function(){r.postMessage({sourceName:s,targetName:n,stream:Ne.START_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:s,targetName:n,stream:Ne.START_COMPLETE,streamId:e,reason:Xs(u)})})},GO=function(t){const e=t.streamId,s=this.sourceName,n=t.sourceName,r=this.comObj,a=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case Ne.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(Xs(t.reason));break;case Ne.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(Xs(t.reason));break;case Ne.PULL:if(!l){r.postMessage({sourceName:s,targetName:n,stream:Ne.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,Promise.try(l.onPull||EE).then(function(){r.postMessage({sourceName:s,targetName:n,stream:Ne.PULL_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:s,targetName:n,stream:Ne.PULL_COMPLETE,streamId:e,reason:Xs(u)})});break;case Ne.ENQUEUE:if(St(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case Ne.CLOSE:if(St(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),x(this,pn,Iy).call(this,a,e);break;case Ne.ERROR:St(a,"error should have stream controller"),a.controller.error(Xs(t.reason)),x(this,pn,Iy).call(this,a,e);break;case Ne.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(Xs(t.reason)),x(this,pn,Iy).call(this,a,e);break;case Ne.CANCEL:if(!l)break;const c=Xs(t.reason);Promise.try(l.onCancel||EE,c).then(function(){r.postMessage({sourceName:s,targetName:n,stream:Ne.CANCEL_COMPLETE,streamId:e,success:!0})},function(u){r.postMessage({sourceName:s,targetName:n,stream:Ne.CANCEL_COMPLETE,streamId:e,reason:Xs(u)})}),l.sinkCapability.reject(c),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},Iy=async function(t,e){var s,n,r;await Promise.allSettled([(s=t.startCall)==null?void 0:s.promise,(n=t.pullCall)==null?void 0:n.promise,(r=t.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[e]};var am;class VO{constructor({enableHWA:t=!1}){A(this,am,!1);m(this,am,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!o(this,am)})}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Wt("Abstract method `_createCanvas` called.")}}am=new WeakMap;class g3 extends VO{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");return s.width=t,s.height=e,s}}class XO{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Wt("Abstract method `_fetch` called.")}}class TE extends XO{async _fetch(t){const e=await Ep(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):xp(e)}}class YO{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,s,n,r){return"none"}destroy(t=!1){}}var Kl,Mh,Xr,Yr,Cs,Wl,Ql,F,As,Ef,Su,Uy,xu,KO,L_,Eu,Tf,Cf,P_,Rf;class m3 extends YO{constructor({docId:e,ownerDocument:s=globalThis.document}){super();A(this,F);A(this,Kl);A(this,Mh);A(this,Xr);A(this,Yr);A(this,Cs);A(this,Wl);A(this,Ql,0);m(this,Yr,e),m(this,Cs,s)}addFilter(e){if(!e)return"none";let s=o(this,F,As).get(e);if(s)return s;const[n,r,a]=x(this,F,Uy).call(this,e),l=e.length===1?n:`${n}${r}${a}`;if(s=o(this,F,As).get(l),s)return o(this,F,As).set(e,s),s;const c=`g_${o(this,Yr)}_transfer_map_${Fe(this,Ql)._++}`,u=x(this,F,xu).call(this,c);o(this,F,As).set(e,u),o(this,F,As).set(l,u);const h=x(this,F,Eu).call(this,c);return x(this,F,Cf).call(this,n,r,a,h),u}addHCMFilter(e,s){var b;const n=`${e}-${s}`,r="base";let a=o(this,F,Ef).get(r);if((a==null?void 0:a.key)===n||(a?((b=a.filter)==null||b.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},o(this,F,Ef).set(r,a)),!e||!s))return a.url;const l=x(this,F,Rf).call(this,e);e=$.makeHexColor(...l);const c=x(this,F,Rf).call(this,s);if(s=$.makeHexColor(...c),o(this,F,Su).style.color="",e==="#000000"&&s==="#ffffff"||e===s)return a.url;const u=new Array(256);for(let v=0;v<=255;v++){const S=v/255;u[v]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const h=u.join(","),d=`g_${o(this,Yr)}_hcm_filter`,f=a.filter=x(this,F,Eu).call(this,d);x(this,F,Cf).call(this,h,h,h,f),x(this,F,L_).call(this,f);const g=(v,S)=>{const p=l[v]/255,w=c[v]/255,y=new Array(S+1);for(let E=0;E<=S;E++)y[E]=p+E/S*(w-p);return y.join(",")};return x(this,F,Cf).call(this,g(0,5),g(1,5),g(2,5),f),a.url=x(this,F,xu).call(this,d),a.url}addAlphaFilter(e){let s=o(this,F,As).get(e);if(s)return s;const[n]=x(this,F,Uy).call(this,[e]),r=`alpha_${n}`;if(s=o(this,F,As).get(r),s)return o(this,F,As).set(e,s),s;const a=`g_${o(this,Yr)}_alpha_map_${Fe(this,Ql)._++}`,l=x(this,F,xu).call(this,a);o(this,F,As).set(e,l),o(this,F,As).set(r,l);const c=x(this,F,Eu).call(this,a);return x(this,F,P_).call(this,n,c),l}addLuminosityFilter(e){let s=o(this,F,As).get(e||"luminosity");if(s)return s;let n,r;if(e?([n]=x(this,F,Uy).call(this,[e]),r=`luminosity_${n}`):r="luminosity",s=o(this,F,As).get(r),s)return o(this,F,As).set(e,s),s;const a=`g_${o(this,Yr)}_luminosity_map_${Fe(this,Ql)._++}`,l=x(this,F,xu).call(this,a);o(this,F,As).set(e,l),o(this,F,As).set(r,l);const c=x(this,F,Eu).call(this,a);return x(this,F,KO).call(this,c),e&&x(this,F,P_).call(this,n,c),l}addHighlightHCMFilter(e,s,n,r,a){var w;const l=`${s}-${n}-${r}-${a}`;let c=o(this,F,Ef).get(e);if((c==null?void 0:c.key)===l||(c?((w=c.filter)==null||w.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},o(this,F,Ef).set(e,c)),!s||!n))return c.url;const[u,h]=[s,n].map(x(this,F,Rf).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,b]=[r,a].map(x(this,F,Rf).bind(this));f<d&&([d,f,g,b]=[f,d,b,g]),o(this,F,Su).style.color="";const v=(y,E,T)=>{const C=new Array(256),R=(f-d)/T,O=y/255,k=(E-y)/(255*T);let D=0;for(let P=0;P<=T;P++){const I=Math.round(d+P*R),Z=O+P*k;for(let K=D;K<=I;K++)C[K]=Z;D=I+1}for(let P=D;P<256;P++)C[P]=C[D-1];return C.join(",")},S=`g_${o(this,Yr)}_hcm_${e}_filter`,p=c.filter=x(this,F,Eu).call(this,S);return x(this,F,L_).call(this,p),x(this,F,Cf).call(this,v(g[0],b[0],5),v(g[1],b[1],5),v(g[2],b[2],5),p),c.url=x(this,F,xu).call(this,S),c.url}destroy(e=!1){var s,n,r,a;e&&((s=o(this,Wl))!=null&&s.size)||((n=o(this,Xr))==null||n.parentNode.parentNode.remove(),m(this,Xr,null),(r=o(this,Mh))==null||r.clear(),m(this,Mh,null),(a=o(this,Wl))==null||a.clear(),m(this,Wl,null),m(this,Ql,0))}}Kl=new WeakMap,Mh=new WeakMap,Xr=new WeakMap,Yr=new WeakMap,Cs=new WeakMap,Wl=new WeakMap,Ql=new WeakMap,F=new WeakSet,As=function(){return o(this,Mh)||m(this,Mh,new Map)},Ef=function(){return o(this,Wl)||m(this,Wl,new Map)},Su=function(){if(!o(this,Xr)){const e=o(this,Cs).createElement("div"),{style:s}=e;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const n=o(this,Cs).createElementNS(Rr,"svg");n.setAttribute("width",0),n.setAttribute("height",0),m(this,Xr,o(this,Cs).createElementNS(Rr,"defs")),e.append(n),n.append(o(this,Xr)),o(this,Cs).body.append(e)}return o(this,Xr)},Uy=function(e){if(e.length===1){const u=e[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=u[f]/255;const d=h.join(",");return[d,d,d]}const[s,n,r]=e,a=new Array(256),l=new Array(256),c=new Array(256);for(let u=0;u<256;u++)a[u]=s[u]/255,l[u]=n[u]/255,c[u]=r[u]/255;return[a.join(","),l.join(","),c.join(",")]},xu=function(e){if(o(this,Kl)===void 0){m(this,Kl,"");const s=o(this,Cs).URL;s!==o(this,Cs).baseURI&&(Xb(s)?nt('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,Kl,sO(s,"")))}return`url(${o(this,Kl)}#${e})`},KO=function(e){const s=o(this,Cs).createElementNS(Rr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(s)},L_=function(e){const s=o(this,Cs).createElementNS(Rr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(s)},Eu=function(e){const s=o(this,Cs).createElementNS(Rr,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",e),o(this,F,Su).append(s),s},Tf=function(e,s,n){const r=o(this,Cs).createElementNS(Rr,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",n),e.append(r)},Cf=function(e,s,n,r){const a=o(this,Cs).createElementNS(Rr,"feComponentTransfer");r.append(a),x(this,F,Tf).call(this,a,"feFuncR",e),x(this,F,Tf).call(this,a,"feFuncG",s),x(this,F,Tf).call(this,a,"feFuncB",n)},P_=function(e,s){const n=o(this,Cs).createElementNS(Rr,"feComponentTransfer");s.append(n),x(this,F,Tf).call(this,n,"feFuncA",e)},Rf=function(e){return o(this,F,Su).style.color=e,Cp(getComputedStyle(o(this,F,Su)).getPropertyValue("color"))};class WO{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Wt("Abstract method `_fetch` called.")}}class CE extends WO{async _fetch(t){const e=await Ep(t,"arraybuffer");return new Uint8Array(e)}}class QO{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Wt("Abstract method `_fetch` called.")}}class RE extends QO{async _fetch(t){const e=await Ep(t,"arraybuffer");return new Uint8Array(e)}}Bs&&nt("Please use the `legacy` build in Node.js environments.");async function JS(i){const e=await process.getBuiltinModule("fs").promises.readFile(i);return new Uint8Array(e)}class p3 extends YO{}class y3 extends VO{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class b3 extends XO{async _fetch(t){return JS(t)}}class v3 extends WO{async _fetch(t){return JS(t)}}class w3 extends QO{async _fetch(t){return JS(t)}}const mu="__forcedDependency",{floor:OE,ceil:kE}=Math;function oy(i,t,e,s,n,r){i[t*4+0]=Math.min(i[t*4+0],e),i[t*4+1]=Math.min(i[t*4+1],s),i[t*4+2]=Math.max(i[t*4+2],n),i[t*4+3]=Math.max(i[t*4+3],r)}const B_=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Dh,uo;class _3{constructor(t,e){A(this,Dh);A(this,uo);m(this,Dh,t),m(this,uo,e)}get length(){return o(this,Dh).length}isEmpty(t){return o(this,Dh)[t]===B_}minX(t){return o(this,uo)[t*4+0]/256}minY(t){return o(this,uo)[t*4+1]/256}maxX(t){return(o(this,uo)[t*4+2]+1)/256}maxY(t){return(o(this,uo)[t*4+3]+1)/256}}Dh=new WeakMap,uo=new WeakMap;const ly=(i,t)=>{if(!i)return;let e=i.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},i.set(t,e)),e};var Ws,Qs,Jl,Rn,Zl,Kr,jt,Ft,Wr,Js,om,jh,tc,ec,Qr,Rs,sr,lm,I_;class A3{constructor(t,e,s=!1){A(this,lm);A(this,Ws,{__proto__:null});A(this,Qs,{__proto__:null,transform:[],moveText:[],sameLineText:[],[mu]:[]});A(this,Jl,new Map);A(this,Rn,[]);A(this,Zl,[]);A(this,Kr,[[1,0,0,1,0,0]]);A(this,jt,[-1/0,-1/0,1/0,1/0]);A(this,Ft,new Float64Array([1/0,1/0,-1/0,-1/0]));A(this,Wr,-1);A(this,Js,new Set);A(this,om,new Map);A(this,jh,new Map);A(this,tc);A(this,ec);A(this,Qr);A(this,Rs);A(this,sr);m(this,tc,t.width),m(this,ec,t.height),x(this,lm,I_).call(this,e),s&&m(this,sr,new Map)}growOperationsCount(t){t>=o(this,Rs).length&&x(this,lm,I_).call(this,t,o(this,Rs))}save(t){return m(this,Ws,{__proto__:o(this,Ws)}),m(this,Qs,{__proto__:o(this,Qs),transform:{__proto__:o(this,Qs).transform},moveText:{__proto__:o(this,Qs).moveText},sameLineText:{__proto__:o(this,Qs).sameLineText},[mu]:{__proto__:o(this,Qs)[mu]}}),m(this,jt,{__proto__:o(this,jt)}),o(this,Rn).push(t),this}restore(t){var n;const e=Object.getPrototypeOf(o(this,Ws));if(e===null)return this;m(this,Ws,e),m(this,Qs,Object.getPrototypeOf(o(this,Qs))),m(this,jt,Object.getPrototypeOf(o(this,jt)));const s=o(this,Rn).pop();return s!==void 0&&((n=ly(o(this,sr),t))==null||n.dependencies.add(s),o(this,Rs)[t]=o(this,Rs)[s]),this}recordOpenMarker(t){return o(this,Rn).push(t),this}getOpenMarker(){return o(this,Rn).length===0?null:o(this,Rn).at(-1)}recordCloseMarker(t){var s;const e=o(this,Rn).pop();return e!==void 0&&((s=ly(o(this,sr),t))==null||s.dependencies.add(e),o(this,Rs)[t]=o(this,Rs)[e]),this}beginMarkedContent(t){return o(this,Zl).push(t),this}endMarkedContent(t){var s;const e=o(this,Zl).pop();return e!==void 0&&((s=ly(o(this,sr),t))==null||s.dependencies.add(e),o(this,Rs)[t]=o(this,Rs)[e]),this}pushBaseTransform(t){return o(this,Kr).push($.multiplyByDOMMatrix(o(this,Kr).at(-1),t.getTransform())),this}popBaseTransform(){return o(this,Kr).length>1&&o(this,Kr).pop(),this}recordSimpleData(t,e){return o(this,Ws)[t]=e,this}recordIncrementalData(t,e){return o(this,Qs)[t].push(e),this}resetIncrementalData(t,e){return o(this,Qs)[t].length=0,this}recordNamedData(t,e){return o(this,Jl).set(t,e),this}recordSimpleDataFromNamed(t,e,s){o(this,Ws)[t]=o(this,Jl).get(e)??s}recordFutureForcedDependency(t,e){return this.recordIncrementalData(mu,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in o(this,Ws)&&this.recordFutureForcedDependency(e,o(this,Ws)[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of o(this,Js))this.recordFutureForcedDependency(mu,t);return this}resetBBox(t){return o(this,Wr)!==t&&(m(this,Wr,t),o(this,Ft)[0]=1/0,o(this,Ft)[1]=1/0,o(this,Ft)[2]=-1/0,o(this,Ft)[3]=-1/0),this}recordClipBox(t,e,s,n,r,a){const l=$.multiplyByDOMMatrix(o(this,Kr).at(-1),e.getTransform()),c=[1/0,1/0,-1/0,-1/0];$.axialAlignedBoundingBox([s,r,n,a],l,c);const u=$.intersect(o(this,jt),c);return u?(o(this,jt)[0]=u[0],o(this,jt)[1]=u[1],o(this,jt)[2]=u[2],o(this,jt)[3]=u[3]):(o(this,jt)[0]=o(this,jt)[1]=1/0,o(this,jt)[2]=o(this,jt)[3]=-1/0),this}recordBBox(t,e,s,n,r,a){const l=o(this,jt);if(l[0]===1/0)return this;const c=$.multiplyByDOMMatrix(o(this,Kr).at(-1),e.getTransform());if(l[0]===-1/0)return $.axialAlignedBoundingBox([s,r,n,a],c,o(this,Ft)),this;const u=[1/0,1/0,-1/0,-1/0];return $.axialAlignedBoundingBox([s,r,n,a],c,u),o(this,Ft)[0]=Math.min(o(this,Ft)[0],Math.max(u[0],l[0])),o(this,Ft)[1]=Math.min(o(this,Ft)[1],Math.max(u[1],l[1])),o(this,Ft)[2]=Math.max(o(this,Ft)[2],Math.min(u[2],l[2])),o(this,Ft)[3]=Math.max(o(this,Ft)[3],Math.min(u[3],l[3])),this}recordCharacterBBox(t,e,s,n=1,r=0,a=0,l){const c=s.bbox;let u,h;if(c&&(u=c[2]!==c[0]&&c[3]!==c[1]&&o(this,jh).get(s),u!==!1&&(h=[0,0,0,0],$.axialAlignedBoundingBox(c,s.fontMatrix,h),(n!==1||r!==0||a!==0)&&$.scaleMinMax([n,0,0,-n,r,a],h),u)))return this.recordBBox(t,e,h[0],h[2],h[1],h[3]);if(!l)return this.recordFullPageBBox(t);const d=l();return c&&h&&u===void 0&&(u=h[0]<=r-d.actualBoundingBoxLeft&&h[2]>=r+d.actualBoundingBoxRight&&h[1]<=a-d.actualBoundingBoxAscent&&h[3]>=a+d.actualBoundingBoxDescent,o(this,jh).set(s,u),u)?this.recordBBox(t,e,h[0],h[2],h[1],h[3]):this.recordBBox(t,e,r-d.actualBoundingBoxLeft,r+d.actualBoundingBoxRight,a-d.actualBoundingBoxAscent,a+d.actualBoundingBoxDescent)}recordFullPageBBox(t){return o(this,Ft)[0]=Math.max(0,o(this,jt)[0]),o(this,Ft)[1]=Math.max(0,o(this,jt)[1]),o(this,Ft)[2]=Math.min(o(this,tc),o(this,jt)[2]),o(this,Ft)[3]=Math.min(o(this,ec),o(this,jt)[3]),this}getSimpleIndex(t){return o(this,Ws)[t]}recordDependencies(t,e){const s=o(this,Js),n=o(this,Ws),r=o(this,Qs);for(const a of e)a in o(this,Ws)?s.add(n[a]):a in r&&r[a].forEach(s.add,s);return this}recordNamedDependency(t,e){return o(this,Jl).has(e)&&o(this,Js).add(o(this,Jl).get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[mu]),o(this,sr)){const s=ly(o(this,sr),t),{dependencies:n}=s;o(this,Js).forEach(n.add,n),o(this,Rn).forEach(n.add,n),o(this,Zl).forEach(n.add,n),n.delete(t),s.isRenderingOperation=!0}if(o(this,Wr)===t){const s=OE(o(this,Ft)[0]*256/o(this,tc)),n=OE(o(this,Ft)[1]*256/o(this,ec)),r=kE(o(this,Ft)[2]*256/o(this,tc)),a=kE(o(this,Ft)[3]*256/o(this,ec));oy(o(this,Qr),t,s,n,r,a);for(const l of o(this,Js))l!==t&&oy(o(this,Qr),l,s,n,r,a);for(const l of o(this,Rn))l!==t&&oy(o(this,Qr),l,s,n,r,a);for(const l of o(this,Zl))l!==t&&oy(o(this,Qr),l,s,n,r,a);e||(o(this,Js).clear(),m(this,Wr,-1))}return this}recordShowTextOperation(t,e=!1){const s=Array.from(o(this,Js));this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const n of s)this.recordIncrementalData("sameLineText",n);return this}bboxToClipBoxDropOperation(t,e=!1){return o(this,Wr)===t&&(m(this,Wr,-1),o(this,jt)[0]=Math.max(o(this,jt)[0],o(this,Ft)[0]),o(this,jt)[1]=Math.max(o(this,jt)[1],o(this,Ft)[1]),o(this,jt)[2]=Math.min(o(this,jt)[2],o(this,Ft)[2]),o(this,jt)[3]=Math.min(o(this,jt)[3],o(this,Ft)[3]),e||o(this,Js).clear()),this}_takePendingDependencies(){const t=o(this,Js);return m(this,Js,new Set),t}_extractOperation(t){const e=o(this,om).get(t);return o(this,om).delete(t),e}_pushPendingDependencies(t){for(const e of t)o(this,Js).add(e)}take(){return o(this,jh).clear(),new _3(o(this,Rs),o(this,Qr))}takeDebugMetadata(){return o(this,sr)}}Ws=new WeakMap,Qs=new WeakMap,Jl=new WeakMap,Rn=new WeakMap,Zl=new WeakMap,Kr=new WeakMap,jt=new WeakMap,Ft=new WeakMap,Wr=new WeakMap,Js=new WeakMap,om=new WeakMap,jh=new WeakMap,tc=new WeakMap,ec=new WeakMap,Qr=new WeakMap,Rs=new WeakMap,sr=new WeakMap,lm=new WeakSet,I_=function(t,e){const s=new ArrayBuffer(t*4);m(this,Qr,new Uint8ClampedArray(s)),m(this,Rs,new Uint32Array(s)),e&&e.length>0?(o(this,Rs).set(e),o(this,Rs).fill(B_,e.length)):o(this,Rs).fill(B_)};var Yt,we,On,Lh,Ph;const ax=class ax{constructor(t,e,s){A(this,Yt);A(this,we);A(this,On);A(this,Lh,0);A(this,Ph,0);if(t instanceof ax&&o(t,On)===!!s)return t;m(this,Yt,t),m(this,we,e),m(this,On,!!s)}growOperationsCount(){throw new Error("Unreachable")}save(t){return Fe(this,Ph)._++,o(this,Yt).save(o(this,we)),this}restore(t){return o(this,Ph)>0&&(o(this,Yt).restore(o(this,we)),Fe(this,Ph)._--),this}recordOpenMarker(t){return Fe(this,Lh)._++,this}getOpenMarker(){return o(this,Lh)>0?o(this,we):o(this,Yt).getOpenMarker()}recordCloseMarker(t){return Fe(this,Lh)._--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return o(this,Yt).pushBaseTransform(t),this}popBaseTransform(){return o(this,Yt).popBaseTransform(),this}recordSimpleData(t,e){return o(this,Yt).recordSimpleData(t,o(this,we)),this}recordIncrementalData(t,e){return o(this,Yt).recordIncrementalData(t,o(this,we)),this}resetIncrementalData(t,e){return o(this,Yt).resetIncrementalData(t,o(this,we)),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,s){return o(this,Yt).recordSimpleDataFromNamed(t,e,o(this,we)),this}recordFutureForcedDependency(t,e){return o(this,Yt).recordFutureForcedDependency(t,o(this,we)),this}inheritSimpleDataAsFutureForcedDependencies(t){return o(this,Yt).inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return o(this,Yt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return o(this,On)||o(this,Yt).resetBBox(o(this,we)),this}recordClipBox(t,e,s,n,r,a){return o(this,On)||o(this,Yt).recordClipBox(o(this,we),e,s,n,r,a),this}recordBBox(t,e,s,n,r,a){return o(this,On)||o(this,Yt).recordBBox(o(this,we),e,s,n,r,a),this}recordCharacterBBox(t,e,s,n,r,a,l){return o(this,On)||o(this,Yt).recordCharacterBBox(o(this,we),e,s,n,r,a,l),this}recordFullPageBBox(t){return o(this,On)||o(this,Yt).recordFullPageBBox(o(this,we)),this}getSimpleIndex(t){return o(this,Yt).getSimpleIndex(t)}recordDependencies(t,e){return o(this,Yt).recordDependencies(o(this,we),e),this}recordNamedDependency(t,e){return o(this,Yt).recordNamedDependency(o(this,we),e),this}recordOperation(t){return o(this,Yt).recordOperation(o(this,we),!0),this}recordShowTextOperation(t){return o(this,Yt).recordShowTextOperation(o(this,we),!0),this}bboxToClipBoxDropOperation(t){return o(this,On)||o(this,Yt).bboxToClipBoxDropOperation(o(this,we),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Yt=new WeakMap,we=new WeakMap,On=new WeakMap,Lh=new WeakMap,Ph=new WeakMap;let W0=ax;const Vi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},gs={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function U_(i,t){if(!t)return;const e=t[2]-t[0],s=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],e,s),i.clip(n)}class ZS{isModifyingCurrentTransform(){return!1}getPattern(){Wt("Abstract method `getPattern` called.")}}class S3 extends ZS{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)e.addColorStop(s[0],s[1]);return e}getPattern(t,e,s,n){let r;if(n===gs.STROKE||n===gs.FILL){const a=e.current.getClippedPathBoundingBox(n,me(t))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,u=e.cachedCanvases.getCanvas("pattern",l,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=$.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...e.baseTransform),this.matrix&&h.transform(...this.matrix),U_(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=t.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(s);r.setTransform(d)}else U_(t,this._bbox),r=this._createGradient(t);return r}}function Yv(i,t,e,s,n,r,a,l){const c=t.coords,u=t.colors,h=i.data,d=i.width*4;let f;c[e+1]>c[s+1]&&(f=e,e=s,s=f,f=r,r=a,a=f),c[s+1]>c[n+1]&&(f=s,s=n,n=f,f=a,a=l,l=f),c[e+1]>c[s+1]&&(f=e,e=s,s=f,f=r,r=a,a=f);const g=(c[e]+t.offsetX)*t.scaleX,b=(c[e+1]+t.offsetY)*t.scaleY,v=(c[s]+t.offsetX)*t.scaleX,S=(c[s+1]+t.offsetY)*t.scaleY,p=(c[n]+t.offsetX)*t.scaleX,w=(c[n+1]+t.offsetY)*t.scaleY;if(b>=w)return;const y=u[r],E=u[r+1],T=u[r+2],C=u[a],R=u[a+1],O=u[a+2],k=u[l],D=u[l+1],P=u[l+2],I=Math.round(b),Z=Math.round(w);let K,W,N,L,z,tt,bt,ze;for(let gt=I;gt<=Z;gt++){if(gt<S){const Ct=gt<b?0:(b-gt)/(b-S);K=g-(g-v)*Ct,W=y-(y-C)*Ct,N=E-(E-R)*Ct,L=T-(T-O)*Ct}else{let Ct;gt>w?Ct=1:S===w?Ct=0:Ct=(S-gt)/(S-w),K=v-(v-p)*Ct,W=C-(C-k)*Ct,N=R-(R-D)*Ct,L=O-(O-P)*Ct}let vt;gt<b?vt=0:gt>w?vt=1:vt=(b-gt)/(b-w),z=g-(g-p)*vt,tt=y-(y-k)*vt,bt=E-(E-D)*vt,ze=T-(T-P)*vt;const Nt=Math.round(Math.min(K,z)),de=Math.round(Math.max(K,z));let ks=d*gt+Nt*4;for(let Ct=Nt;Ct<=de;Ct++)vt=(K-Ct)/(K-z),vt<0?vt=0:vt>1&&(vt=1),h[ks++]=W-(W-tt)*vt|0,h[ks++]=N-(N-bt)*vt|0,h[ks++]=L-(L-ze)*vt|0,h[ks++]=255}}function x3(i,t,e){const s=t.coords,n=t.colors;let r,a;switch(t.type){case u_.LATTICE:const l=t.verticesPerRow,c=Math.floor(s.length/l)-1,u=l-1;for(r=0;r<c;r++){let h=r*l;for(let d=0;d<u;d++,h++)Yv(i,e,s[h],s[h+1],s[h+l],n[h],n[h+1],n[h+l]),Yv(i,e,s[h+l+1],s[h+1],s[h+l],n[h+l+1],n[h+1],n[h+l])}break;case u_.TRIANGLES:for(r=0,a=s.length;r<a;r+=3)Yv(i,e,s[r],s[r+1],s[r+2],n[r],n[r+1],n[r+2]);break;default:throw new Error("illegal figure")}}class E3 extends ZS{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,s){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-l,h=Math.ceil(this._bounds[3])-c,d=Math.min(Math.ceil(Math.abs(u*t[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(h*t[1]*1.1)),3e3),g=u/d,b=h/f,v={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/g,scaleY:1/b},S=d+2*2,p=f+2*2,w=s.getCanvas("mesh",S,p),y=w.context,E=y.createImageData(d,f);if(e){const C=E.data;for(let R=0,O=C.length;R<O;R+=4)C[R]=e[0],C[R+1]=e[1],C[R+2]=e[2],C[R+3]=255}for(const C of this._figures)x3(E,C,v);return y.putImageData(E,2,2),{canvas:w.canvas,offsetX:l-2*g,offsetY:c-2*b,scaleX:g,scaleY:b}}isModifyingCurrentTransform(){return!0}getPattern(t,e,s,n){U_(t,this._bbox);const r=new Float32Array(2);if(n===gs.SHADING)$.singularValueDecompose2dScale(me(t),r);else if(this.matrix){$.singularValueDecompose2dScale(this.matrix,r);const[l,c]=r;$.singularValueDecompose2dScale(e.baseTransform,r),r[0]*=l,r[1]*=c}else $.singularValueDecompose2dScale(e.baseTransform,r);const a=this._createMeshCanvas(r,n===gs.SHADING?null:this._background,e.cachedCanvases);return n!==gs.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class T3 extends ZS{getPattern(){return"hotpink"}}function C3(i){switch(i[0]){case"RadialAxial":return new S3(i);case"Mesh":return new E3(i);case"Dummy":return new T3}throw new Error(`Unknown IR type: ${i[0]}`)}const NE={COLORED:1,UNCOLORED:2},hb=class hb{constructor(t,e,s,n){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=s,this.baseTransform=n}createPatternCanvas(t,e){var tt,bt;const{bbox:s,operatorList:n,paintType:r,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:h}=this;u=Math.abs(u),h=Math.abs(h),Vb("TilingType: "+a);const d=s[0],f=s[1],g=s[2],b=s[3],v=g-d,S=b-f,p=new Float32Array(2);$.singularValueDecompose2dScale(this.matrix,p);const[w,y]=p;$.singularValueDecompose2dScale(this.baseTransform,p);const E=w*p[0],T=y*p[1];let C=v,R=S,O=!1,k=!1;const D=Math.ceil(u*E),P=Math.ceil(h*T),I=Math.ceil(v*E),Z=Math.ceil(S*T);D>=I?C=u:O=!0,P>=Z?R=h:k=!0;const K=this.getSizeAndScale(C,this.ctx.canvas.width,E),W=this.getSizeAndScale(R,this.ctx.canvas.height,T),N=t.cachedCanvases.getCanvas("pattern",K.size,W.size),L=N.context,z=c.createCanvasGraphics(L,e);if(z.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(z,r,l),L.translate(-K.scale*d,-W.scale*f),z.transform(0,K.scale,0,0,W.scale,0,0),L.save(),(tt=z.dependencyTracker)==null||tt.save(),this.clipBbox(z,d,f,g,b),z.baseTransform=me(z.ctx),z.executeOperatorList(n),z.endDrawing(),(bt=z.dependencyTracker)==null||bt.restore(),L.restore(),O||k){const ze=N.canvas;O&&(C=u),k&&(R=h);const gt=this.getSizeAndScale(C,this.ctx.canvas.width,E),vt=this.getSizeAndScale(R,this.ctx.canvas.height,T),Nt=gt.size,de=vt.size,ks=t.cachedCanvases.getCanvas("pattern-workaround",Nt,de),Ct=ks.context,$i=O?Math.floor(v/u):0,Q=k?Math.floor(S/h):0;for(let it=0;it<=$i;it++)for(let fe=0;fe<=Q;fe++)Ct.drawImage(ze,Nt*it,de*fe,Nt,de,0,0,Nt,de);return{canvas:ks.canvas,scaleX:gt.scale,scaleY:vt.scale,offsetX:d,offsetY:f}}return{canvas:N.canvas,scaleX:K.scale,scaleY:W.scale,offsetX:d,offsetY:f}}getSizeAndScale(t,e,s){const n=Math.max(hb.MAX_PATTERN_SIZE,e);let r=Math.ceil(t*s);return r>=n?r=n:s=r/t,{scale:s,size:r}}clipBbox(t,e,s,n,r){const a=n-e,l=r-s;t.ctx.rect(e,s,a,l),$.axialAlignedBoundingBox([e,s,n,r],me(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const n=t.ctx,r=t.current;switch(e){case NE.COLORED:const{fillStyle:a,strokeStyle:l}=this.ctx;n.fillStyle=r.fillColor=a,n.strokeStyle=r.strokeColor=l;break;case NE.UNCOLORED:n.fillStyle=n.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new zB(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,s,n,r){let a=s;n!==gs.SHADING&&(a=$.transform(a,e.baseTransform),this.matrix&&(a=$.transform(a,this.matrix)));const l=this.createPatternCanvas(e,r);let c=new DOMMatrix(a);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const u=t.createPattern(l.canvas,"repeat");return u.setTransform(c),u}};B(hb,"MAX_PATTERN_SIZE",3e3);let z_=hb;function R3({src:i,srcPos:t=0,dest:e,width:s,height:n,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const l=_s.isLittleEndian?4278190080:255,[c,u]=a?[r,l]:[l,r],h=s>>3,d=s&7,f=i.length;e=new Uint32Array(e.buffer);let g=0;for(let b=0;b<n;b++){for(const S=t+h;t<S;t++){const p=t<f?i[t]:255;e[g++]=p&128?u:c,e[g++]=p&64?u:c,e[g++]=p&32?u:c,e[g++]=p&16?u:c,e[g++]=p&8?u:c,e[g++]=p&4?u:c,e[g++]=p&2?u:c,e[g++]=p&1?u:c}if(d===0)continue;const v=t<f?i[t++]:255;for(let S=0;S<d;S++)e[g++]=v&1<<7-S?u:c}return{srcPos:t,destPos:g}}const ME=16,DE=100,O3=15,jE=10,ni=16,Kv=new DOMMatrix,Oi=new Float32Array(2),Hu=new Float32Array([1/0,1/0,-1/0,-1/0]);function k3(i,t){if(i._removeMirroring)throw new Error("Context is already forwarding operations.");i.__originalSave=i.save,i.__originalRestore=i.restore,i.__originalRotate=i.rotate,i.__originalScale=i.scale,i.__originalTranslate=i.translate,i.__originalTransform=i.transform,i.__originalSetTransform=i.setTransform,i.__originalResetTransform=i.resetTransform,i.__originalClip=i.clip,i.__originalMoveTo=i.moveTo,i.__originalLineTo=i.lineTo,i.__originalBezierCurveTo=i.bezierCurveTo,i.__originalRect=i.rect,i.__originalClosePath=i.closePath,i.__originalBeginPath=i.beginPath,i._removeMirroring=()=>{i.save=i.__originalSave,i.restore=i.__originalRestore,i.rotate=i.__originalRotate,i.scale=i.__originalScale,i.translate=i.__originalTranslate,i.transform=i.__originalTransform,i.setTransform=i.__originalSetTransform,i.resetTransform=i.__originalResetTransform,i.clip=i.__originalClip,i.moveTo=i.__originalMoveTo,i.lineTo=i.__originalLineTo,i.bezierCurveTo=i.__originalBezierCurveTo,i.rect=i.__originalRect,i.closePath=i.__originalClosePath,i.beginPath=i.__originalBeginPath,delete i._removeMirroring},i.save=function(){t.save(),this.__originalSave()},i.restore=function(){t.restore(),this.__originalRestore()},i.translate=function(e,s){t.translate(e,s),this.__originalTranslate(e,s)},i.scale=function(e,s){t.scale(e,s),this.__originalScale(e,s)},i.transform=function(e,s,n,r,a,l){t.transform(e,s,n,r,a,l),this.__originalTransform(e,s,n,r,a,l)},i.setTransform=function(e,s,n,r,a,l){t.setTransform(e,s,n,r,a,l),this.__originalSetTransform(e,s,n,r,a,l)},i.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},i.rotate=function(e){t.rotate(e),this.__originalRotate(e)},i.clip=function(e){t.clip(e),this.__originalClip(e)},i.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},i.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},i.bezierCurveTo=function(e,s,n,r,a,l){t.bezierCurveTo(e,s,n,r,a,l),this.__originalBezierCurveTo(e,s,n,r,a,l)},i.rect=function(e,s,n,r){t.rect(e,s,n,r),this.__originalRect(e,s,n,r)},i.closePath=function(){t.closePath(),this.__originalClosePath()},i.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class N3{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,s){let n;return this.cache[t]!==void 0?(n=this.cache[t],this.canvasFactory.reset(n,e,s)):(n=this.canvasFactory.create(e,s),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function cy(i,t,e,s,n,r,a,l,c,u){const[h,d,f,g,b,v]=me(i);if(d===0&&f===0){const w=a*h+b,y=Math.round(w),E=l*g+v,T=Math.round(E),C=(a+c)*h+b,R=Math.abs(Math.round(C)-y)||1,O=(l+u)*g+v,k=Math.abs(Math.round(O)-T)||1;return i.setTransform(Math.sign(h),0,0,Math.sign(g),y,T),i.drawImage(t,e,s,n,r,0,0,R,k),i.setTransform(h,d,f,g,b,v),[R,k]}if(h===0&&g===0){const w=l*f+b,y=Math.round(w),E=a*d+v,T=Math.round(E),C=(l+u)*f+b,R=Math.abs(Math.round(C)-y)||1,O=(a+c)*d+v,k=Math.abs(Math.round(O)-T)||1;return i.setTransform(0,Math.sign(d),Math.sign(f),0,y,T),i.drawImage(t,e,s,n,r,0,0,k,R),i.setTransform(h,d,f,g,b,v),[k,R]}i.drawImage(t,e,s,n,r,a,l,c,u);const S=Math.hypot(h,d),p=Math.hypot(f,g);return[S*c,p*u]}class LE{constructor(t,e,s){B(this,"alphaIsShape",!1);B(this,"fontSize",0);B(this,"fontSizeScale",1);B(this,"textMatrix",null);B(this,"textMatrixScale",1);B(this,"fontMatrix",c_);B(this,"leading",0);B(this,"x",0);B(this,"y",0);B(this,"lineX",0);B(this,"lineY",0);B(this,"charSpacing",0);B(this,"wordSpacing",0);B(this,"textHScale",1);B(this,"textRenderingMode",os.FILL);B(this,"textRise",0);B(this,"fillColor","#000000");B(this,"strokeColor","#000000");B(this,"patternFill",!1);B(this,"patternStroke",!1);B(this,"fillAlpha",1);B(this,"strokeAlpha",1);B(this,"lineWidth",1);B(this,"activeSMask",null);B(this,"transferMaps","none");s==null||s(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Hu.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=gs.FILL,e=null){const s=this.minMax.slice();if(t===gs.STROKE){e||Wt("Stroke bounding box must include transform."),$.singularValueDecompose2dScale(e,Oi);const n=Oi[0]*this.lineWidth/2,r=Oi[1]*this.lineWidth/2;s[0]-=n,s[1]-=r,s[2]+=n,s[3]+=r}return s}updateClipFromPath(){const t=$.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Hu,0)}getClippedPathBoundingBox(t=gs.FILL,e=null){return $.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function PE(i,t){if(t instanceof ImageData){i.putImageData(t,0,0);return}const e=t.height,s=t.width,n=e%ni,r=(e-n)/ni,a=n===0?r:r+1,l=i.createImageData(s,ni);let c=0,u;const h=t.data,d=l.data;let f,g,b,v;if(t.kind===Oy.GRAYSCALE_1BPP){const S=h.byteLength,p=new Uint32Array(d.buffer,0,d.byteLength>>2),w=p.length,y=s+7>>3,E=4294967295,T=_s.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(b=f<r?ni:n,u=0,g=0;g<b;g++){const C=S-c;let R=0;const O=C>y?s:C*8-7,k=O&-8;let D=0,P=0;for(;R<k;R+=8)P=h[c++],p[u++]=P&128?E:T,p[u++]=P&64?E:T,p[u++]=P&32?E:T,p[u++]=P&16?E:T,p[u++]=P&8?E:T,p[u++]=P&4?E:T,p[u++]=P&2?E:T,p[u++]=P&1?E:T;for(;R<O;R++)D===0&&(P=h[c++],D=128),p[u++]=P&D?E:T,D>>=1}for(;u<w;)p[u++]=0;i.putImageData(l,0,f*ni)}}else if(t.kind===Oy.RGBA_32BPP){for(g=0,v=s*ni*4,f=0;f<r;f++)d.set(h.subarray(c,c+v)),c+=v,i.putImageData(l,0,g),g+=ni;f<a&&(v=s*n*4,d.set(h.subarray(c,c+v)),i.putImageData(l,0,g))}else if(t.kind===Oy.RGB_24BPP)for(b=ni,v=s*b,f=0;f<a;f++){for(f>=r&&(b=n,v=s*b),u=0,g=v;g--;)d[u++]=h[c++],d[u++]=h[c++],d[u++]=h[c++],d[u++]=255;i.putImageData(l,0,f*ni)}else throw new Error(`bad image kind: ${t.kind}`)}function BE(i,t){if(t.bitmap){i.drawImage(t.bitmap,0,0);return}const e=t.height,s=t.width,n=e%ni,r=(e-n)/ni,a=n===0?r:r+1,l=i.createImageData(s,ni);let c=0;const u=t.data,h=l.data;for(let d=0;d<a;d++){const f=d<r?ni:n;({srcPos:c}=R3({src:u,srcPos:c,dest:h,width:s,height:f,nonBlackColor:0})),i.putImageData(l,0,d*ni)}}function af(i,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of e)i[s]!==void 0&&(t[s]=i[s]);i.setLineDash!==void 0&&(t.setLineDash(i.getLineDash()),t.lineDashOffset=i.lineDashOffset)}function uy(i){i.strokeStyle=i.fillStyle="#000000",i.fillRule="nonzero",i.globalAlpha=1,i.lineWidth=1,i.lineCap="butt",i.lineJoin="miter",i.miterLimit=10,i.globalCompositeOperation="source-over",i.font="10px sans-serif",i.setLineDash!==void 0&&(i.setLineDash([]),i.lineDashOffset=0);const{filter:t}=i;t!=="none"&&t!==""&&(i.filter="none")}function IE(i,t){if(t)return!0;$.singularValueDecompose2dScale(i,Oi);const e=Math.fround(vr.pixelRatio*sl.PDF_TO_CSS_UNITS);return Oi[0]<=e&&Oi[1]<=e}const M3=["butt","round","square"],D3=["miter","round","bevel"],j3={},UE={};var zn,F_,H_,$_;const ox=class ox{constructor(t,e,s,n,r,{optionalContentConfig:a,markedContentStack:l=null},c,u,h){A(this,zn);this.ctx=t,this.current=new LE(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=s,this.canvasFactory=n,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new N3(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=h??null}getObject(t,e,s=null){var n;return typeof e=="string"?((n=this.dependencyTracker)==null||n.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):s}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:n=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=l,s){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...me(this.compositeCtx))}this.ctx.save(),uy(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=me(this.ctx)}executeOperatorList(t,e,s,n,r){var p;const a=t.argsArray,l=t.fnArray;let c=e||0;const u=a.length;if(u===c)return c;const h=u-c>jE&&typeof s=="function",d=h?Date.now()+O3:0;let f=0;const g=this.commonObjs,b=this.objs;let v,S;for(;;){if(n!==void 0&&c===n.nextBreakPoint)return n.breakIt(c,s),c;if(!r||r(c))if(v=l[c],S=a[c]??null,v!==bg.dependency)S===null?this[v](c):this[v](c,...S);else for(const w of S){(p=this.dependencyTracker)==null||p.recordNamedData(w,c);const y=w.startsWith("g_")?g:b;if(!y.has(w))return y.get(w,s),c}if(c++,c===u)return c;if(h&&++f>jE){if(Date.now()>d)return s(),c;f=0}}}endDrawing(){x(this,zn,F_).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),x(this,zn,H_).call(this)}_scaleImage(t,e){const s=t.width??t.displayWidth,n=t.height??t.displayHeight;let r=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),l=s,c=n,u="prescale1",h,d;for(;r>2&&l>1||a>2&&c>1;){let f=l,g=c;r>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),r/=l/f),a>2&&c>1&&(g=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/g),h=this.cachedCanvases.getCanvas(u,f,g),d=h.context,d.clearRect(0,0,f,g),d.drawImage(t,0,0,l,c,0,0,f,g),t=h.canvas,l=f,c=g,u=u==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:c}}_createMaskCanvas(t,e){var D,P;const s=this.ctx,{width:n,height:r}=e,a=this.current.fillColor,l=this.current.patternFill,c=me(s);let u,h,d,f;if((e.bitmap||e.data)&&e.count>1){const I=e.bitmap||e.data.buffer;h=JSON.stringify(l?c:[c.slice(0,4),a]),u=this._cachedBitmapsMap.get(I),u||(u=new Map,this._cachedBitmapsMap.set(I,u));const Z=u.get(h);if(Z&&!l){const K=Math.round(Math.min(c[0],c[2])+c[4]),W=Math.round(Math.min(c[1],c[3])+c[5]);return(D=this.dependencyTracker)==null||D.recordDependencies(t,Vi.transformAndFill),{canvas:Z,offsetX:K,offsetY:W}}d=Z}d||(f=this.cachedCanvases.getCanvas("maskCanvas",n,r),BE(f.context,e));let g=$.transform(c,[1/n,0,0,-1/r,0,0]);g=$.transform(g,[1,0,0,1,0,-r]);const b=Hu.slice();$.axialAlignedBoundingBox([0,0,n,r],g,b);const[v,S,p,w]=b,y=Math.round(p-v)||1,E=Math.round(w-S)||1,T=this.cachedCanvases.getCanvas("fillCanvas",y,E),C=T.context,R=v,O=S;C.translate(-R,-O),C.transform(...g),d||(d=this._scaleImage(f.canvas,Hn(C)),d=d.img,u&&l&&u.set(h,d)),C.imageSmoothingEnabled=IE(me(C),e.interpolate),cy(C,d,0,0,d.width,d.height,0,0,n,r),C.globalCompositeOperation="source-in";const k=$.transform(Hn(C),[1,0,0,1,-R,-O]);return C.fillStyle=l?a.getPattern(s,this,k,gs.FILL,t):a,C.fillRect(0,0,n,r),u&&!l&&(this.cachedCanvases.delete("fillCanvas"),u.set(h,T.canvas)),(P=this.dependencyTracker)==null||P.recordDependencies(t,Vi.transformAndFill),{canvas:T.canvas,offsetX:Math.round(R),offsetY:Math.round(O)}}setLineWidth(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineCap",t),this.ctx.lineCap=M3[e]}setLineJoin(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineJoin",t),this.ctx.lineJoin=D3[e]}setMiterLimit(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,s){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("dash",t);const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=s)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){var s,n,r,a,l;for(const[c,u]of e)switch(c){case"LW":this.setLineWidth(t,u);break;case"LC":this.setLineCap(t,u);break;case"LJ":this.setLineJoin(t,u);break;case"ML":this.setMiterLimit(t,u);break;case"D":this.setDash(t,u[0],u[1]);break;case"RI":this.setRenderingIntent(t,u);break;case"FL":this.setFlatness(t,u);break;case"Font":this.setFont(t,u[0],u[1]);break;case"CA":(s=this.dependencyTracker)==null||s.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=u;break;case"ca":(n=this.dependencyTracker)==null||n.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(r=this.dependencyTracker)==null||r.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=u;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",t),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(l=this.dependencyTracker)==null||l.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,s=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,s);this.suspendedCtx=this.ctx;const a=this.ctx=r.context;a.setTransform(this.suspendedCtx.getTransform()),af(this.suspendedCtx,a),k3(a,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),af(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,s,n){const r=n[0],a=n[1],l=n[2]-r,c=n[3]-a;l===0||c===0||(this.genericComposeSMask(e.context,s,l,c,e.subtype,e.backdrop,e.transferMap,r,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,e,s,n,r,a,l,c,u,h,d){let f=t.canvas,g=c-h,b=u-d;if(a)if(g<0||b<0||g+s>f.width||b+n>f.height){const S=this.cachedCanvases.getCanvas("maskExtension",s,n),p=S.context;p.drawImage(f,-g,-b),p.globalCompositeOperation="destination-atop",p.fillStyle=a,p.fillRect(0,0,s,n),p.globalCompositeOperation="source-over",f=S.canvas,g=b=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(g,b,s,n),t.clip(S),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(g,b,s,n),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),r==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):r==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const v=new Path2D;v.rect(c,u,s,n),e.clip(v),e.globalCompositeOperation="destination-in",e.drawImage(f,g,b,s,n,c,u,s,n),e.restore()}save(t){var s;this.inSMaskMode&&af(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),(s=this.dependencyTracker)==null||s.save(t)}restore(t){var e;if((e=this.dependencyTracker)==null||e.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&af(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,s,n,r,a,l){var c;(c=this.dependencyTracker)==null||c.recordIncrementalData("transform",t),this.ctx.transform(e,s,n,r,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,s,n){let[r]=s;if(!n){r||(r=s[0]=new Path2D),this[e](t,r);return}if(this.dependencyTracker!==null){const a=e===bg.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,n[0]-a,n[2]+a,n[1]-a,n[3]+a).recordDependencies(t,["transform"])}r instanceof Path2D||(r=s[0]=lO(r)),$.axialAlignedBoundingBox(n,me(this.ctx),this.current.minMax),this[e](t,r),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,s=!0){var a;const n=this.ctx,r=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const l=r.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=r.getPattern(n,this,Hn(n),gs.STROKE,t),l){const c=new Path2D;c.addPath(e,n.getTransform().invertSelf().multiplySelf(l)),e=c}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);(a=this.dependencyTracker)==null||a.recordDependencies(t,Vi.stroke),s&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(gs.STROKE,me(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,s=!0){var u,h,d;const n=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let l=!1;if(a){const f=r.isModifyingCurrentTransform()?n.getTransform():null;if((u=this.dependencyTracker)==null||u.save(t),n.save(),n.fillStyle=r.getPattern(n,this,Hn(n),gs.FILL,t),f){const g=new Path2D;g.addPath(e,n.getTransform().invertSelf().multiplySelf(f)),e=g}l=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),(h=this.dependencyTracker)==null||h.recordDependencies(t,Vi.fill),l&&(n.restore(),(d=this.dependencyTracker)==null||d.restore(t)),s&&this.consumePath(t,e,c)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){var s;this.ctx.fill(e),(s=this.dependencyTracker)==null||s.recordDependencies(t,Vi.rawFillPath).recordOperation(t)}clip(t){var e;(e=this.dependencyTracker)==null||e.recordFutureForcedDependency("clipMode",t),this.pendingClip=j3}eoClip(t){var e;(e=this.dependencyTracker)==null||e.recordFutureForcedDependency("clipMode",t),this.pendingClip=UE}beginText(t){var e;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(e=this.dependencyTracker)==null||e.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:n}=this;e!==void 0&&n.recordFutureForcedDependency("textClip",n.getOpenMarker()).recordFutureForcedDependency("textClip",t),n.recordCloseMarker(t)}if(e!==void 0){const n=new Path2D,r=s.getTransform().invertSelf();for(const{transform:a,x:l,y:c,fontSize:u,path:h}of e)h&&n.addPath(h,new DOMMatrix(a).preMultiplySelf(r).translate(l,c).scale(u,-u));s.clip(n)}delete this.pendingTextPaths}setCharSpacing(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,s){var d,f;(d=this.dependencyTracker)==null||d.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=n.fontMatrix||c_,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&nt("Invalid font matrix for font "+e),s<0?(s=-s,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=s,n.isType3Font)return;const a=n.loadedName||"sans-serif",l=((f=n.systemFontInfo)==null?void 0:f.css)||`"${a}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const u=n.italic?"italic":"normal";let h=s;s<ME?h=ME:s>DE&&(h=DE),this.current.fontSizeScale=s/h,this.ctx.font=`${u} ${c} ${h}px ${l}`}setTextRenderingMode(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,s){var n;(n=this.dependencyTracker)==null||n.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,e,s){this.setLeading(t,-s),this.moveText(t,e,s)}setTextMatrix(t,e){var n;(n=this.dependencyTracker)==null||n.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:s}=this;s.textMatrix=e,s.textMatrixScale=Math.hypot(e[0],e[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(t){var e;this.moveText(t,0,this.current.leading),(e=this.dependencyTracker)==null||e.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}paintChar(t,e,s,n,r,a){var p,w,y,E;const l=this.ctx,c=this.current,u=c.font,h=c.textRenderingMode,d=c.fontSize/c.fontSizeScale,f=h&os.FILL_STROKE_MASK,g=!!(h&os.ADD_TO_PATH_FLAG),b=c.patternFill&&!u.missingFile,v=c.patternStroke&&!u.missingFile;let S;if((u.disableFontFace||g||b||v)&&!u.missingFile&&(S=u.getPathGenerator(this.commonObjs,e)),S&&(u.disableFontFace||b||v)){l.save(),l.translate(s,n),l.scale(d,-d),(p=this.dependencyTracker)==null||p.recordCharacterBBox(t,l,u);let T;if(f===os.FILL||f===os.FILL_STROKE)if(r){T=l.getTransform(),l.setTransform(...r);const C=x(this,zn,$_).call(this,S,T,r);l.fill(C)}else l.fill(S);if(f===os.STROKE||f===os.FILL_STROKE)if(a){T||(T=l.getTransform()),l.setTransform(...a);const{a:C,b:R,c:O,d:k}=T,D=$.inverseTransform(a),P=$.transform([C,R,O,k,0,0],D);$.singularValueDecompose2dScale(P,Oi),l.lineWidth*=Math.max(Oi[0],Oi[1])/d,l.stroke(x(this,zn,$_).call(this,S,T,a))}else l.lineWidth/=d,l.stroke(S);l.restore()}else(f===os.FILL||f===os.FILL_STROKE)&&(l.fillText(e,s,n),(w=this.dependencyTracker)==null||w.recordCharacterBBox(t,l,u,d,s,n,()=>l.measureText(e))),(f===os.STROKE||f===os.FILL_STROKE)&&(this.dependencyTracker&&((y=this.dependencyTracker)==null||y.recordCharacterBBox(t,l,u,d,s,n,()=>l.measureText(e)).recordDependencies(t,Vi.stroke)),l.strokeText(e,s,n));g&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:me(l),x:s,y:n,fontSize:d,path:S}),(E=this.dependencyTracker)==null||E.recordCharacterBBox(t,l,u,d,s,n))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){s=!0;break}return ut(this,"isFontSubpixelAAEnabled",s)}showText(t,e){var O,k,D,P;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Vi.showText).resetBBox(t),this.current.textRenderingMode&os.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,n=s.font;if(n.isType3Font){this.showType3Text(t,e),(O=this.dependencyTracker)==null||O.recordShowTextOperation(t);return}const r=s.fontSize;if(r===0){(k=this.dependencyTracker)==null||k.recordOperation(t);return}const a=this.ctx,l=s.fontSizeScale,c=s.charSpacing,u=s.wordSpacing,h=s.fontDirection,d=s.textHScale*h,f=e.length,g=n.vertical,b=g?1:-1,v=n.defaultVMetrics,S=r*s.fontMatrix[0],p=s.textRenderingMode===os.FILL&&!n.disableFontFace&&!s.patternFill;a.save(),s.textMatrix&&a.transform(...s.textMatrix),a.translate(s.x,s.y+s.textRise),h>0?a.scale(d,-1):a.scale(d,1);let w,y;if(s.patternFill){a.save();const I=s.fillColor.getPattern(a,this,Hn(a),gs.FILL,t);w=me(a),a.restore(),a.fillStyle=I}if(s.patternStroke){a.save();const I=s.strokeColor.getPattern(a,this,Hn(a),gs.STROKE,t);y=me(a),a.restore(),a.strokeStyle=I}let E=s.lineWidth;const T=s.textMatrixScale;if(T===0||E===0){const I=s.textRenderingMode&os.FILL_STROKE_MASK;(I===os.STROKE||I===os.FILL_STROKE)&&(E=this.getSinglePixelWidth())}else E/=T;if(l!==1&&(a.scale(l,l),E/=l),a.lineWidth=E,n.isInvalidPDFjsFont){const I=[];let Z=0;for(const W of e)I.push(W.unicode),Z+=W.width;const K=I.join("");if(a.fillText(K,0,0),this.dependencyTracker!==null){const W=a.measureText(K);this.dependencyTracker.recordBBox(t,this.ctx,-W.actualBoundingBoxLeft,W.actualBoundingBoxRight,-W.actualBoundingBoxAscent,W.actualBoundingBoxDescent).recordShowTextOperation(t)}s.x+=Z*S*d,a.restore(),this.compose();return}let C=0,R;for(R=0;R<f;++R){const I=e[R];if(typeof I=="number"){C+=b*I*r/1e3;continue}let Z=!1;const K=(I.isSpace?u:0)+c,W=I.fontChar,N=I.accent;let L,z,tt=I.width;if(g){const gt=I.vmetric||v,vt=-(I.vmetric?gt[1]:tt*.5)*S,Nt=gt[2]*S;tt=gt?-gt[0]:tt,L=vt/l,z=(C+Nt)/l}else L=C/l,z=0;let bt;if(n.remeasure&&tt>0){bt=a.measureText(W);const gt=bt.width*1e3/r*l;if(tt<gt&&this.isFontSubpixelAAEnabled){const vt=tt/gt;Z=!0,a.save(),a.scale(vt,1),L/=vt}else tt!==gt&&(L+=(tt-gt)/2e3*r/l)}if(this.contentVisible&&(I.isInFont||n.missingFile)){if(p&&!N)a.fillText(W,L,z),(D=this.dependencyTracker)==null||D.recordCharacterBBox(t,a,bt?{bbox:null}:n,r/l,L,z,()=>bt??a.measureText(W));else if(this.paintChar(t,W,L,z,w,y),N){const gt=L+r*N.offset.x/l,vt=z-r*N.offset.y/l;this.paintChar(t,N.fontChar,gt,vt,w,y)}}const ze=g?tt*S-K*h:tt*S+K*h;C+=ze,Z&&a.restore()}g?s.y-=C:s.x+=C*d,a.restore(),this.compose(),(P=this.dependencyTracker)==null||P.recordShowTextOperation(t)}showType3Text(t,e){const s=this.ctx,n=this.current,r=n.font,a=n.fontSize,l=n.fontDirection,c=r.vertical?1:-1,u=n.charSpacing,h=n.wordSpacing,d=n.textHScale*l,f=n.fontMatrix||c_,g=e.length,b=n.textRenderingMode===os.INVISIBLE;let v,S,p,w;if(b||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),n.textMatrix&&s.transform(...n.textMatrix),s.translate(n.x,n.y+n.textRise),s.scale(d,l);const y=this.dependencyTracker;for(this.dependencyTracker=y?new W0(y,t):null,v=0;v<g;++v){if(S=e[v],typeof S=="number"){w=c*S*a/1e3,this.ctx.translate(w,0),n.x+=w*d;continue}const E=(S.isSpace?h:0)+u,T=r.charProcOperatorList[S.operatorListId];T?this.contentVisible&&(this.save(),s.scale(a,a),s.transform(...f),this.executeOperatorList(T),this.restore()):nt(`Type3 character "${S.operatorListId}" is not available.`);const C=[S.width,0];$.applyTransform(C,f),p=C[0]*a+E,s.translate(p,0),n.x+=p*d}s.restore(),y&&(this.dependencyTracker=y)}setCharWidth(t,e,s){}setCharWidthAndBounds(t,e,s,n,r,a,l){var u;const c=new Path2D;c.rect(n,r,a-n,l-r),this.ctx.clip(c),(u=this.dependencyTracker)==null||u.recordBBox(t,this.ctx,n,a,r,l).recordClipBox(t,this.ctx,n,a,r,l),this.endPath(t)}getColorN_Pattern(t,e){let s;if(e[0]==="TilingPattern"){const n=this.baseTransform||me(this.ctx),r={createCanvasGraphics:(a,l)=>new ox(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new W0(this.dependencyTracker,l,!0):null)};s=new z_(e,this.ctx,r,n)}else s=this._getPattern(t,e[1],e[2]);return s}setStrokeColorN(t,...e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){var e;(e=this.dependencyTracker)==null||e.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){var e;(e=this.dependencyTracker)==null||e.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,s=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=C3(this.getObject(t,e)),this.cachedPatterns.set(e,n)),s&&(n.matrix=s),n}shadingFill(t,e){var a;if(!this.contentVisible)return;const s=this.ctx;this.save(t);const n=this._getPattern(t,e);s.fillStyle=n.getPattern(s,this,Hn(s),gs.SHADING,t);const r=Hn(s);if(r){const{width:l,height:c}=s.canvas,u=Hu.slice();$.axialAlignedBoundingBox([0,0,l,c],r,u);const[h,d,f,g]=u;this.ctx.fillRect(h,d,f-h,g-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Vi.transform).recordDependencies(t,Vi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Wt("Should not call beginInlineImage")}beginImageData(){Wt("Should not call beginImageData")}paintFormXObjectBegin(t,e,s){var n;if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=me(this.ctx),s)){$.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,a,l,c]=s,u=new Path2D;u.rect(r,a,l-r,c-a),this.ctx.clip(u),(n=this.dependencyTracker)==null||n.recordClipBox(t,this.ctx,r,l,a,c),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){var y;if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;e.isolated||Vb("TODO: Support non-isolated groups."),e.knockout&&nt("Knockout groups not supported.");const n=me(s);if(e.matrix&&s.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=Hu.slice();$.axialAlignedBoundingBox(e.bbox,me(s),r);const a=[0,0,s.canvas.width,s.canvas.height];r=$.intersect(r,a)||[0,0,0,0];const l=Math.floor(r[0]),c=Math.floor(r[1]),u=Math.max(Math.ceil(r[2])-l,1),h=Math.max(Math.ceil(r[3])-c,1);this.current.startNewPathAndClipBox([0,0,u,h]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(d,u,h),g=f.context;g.translate(-l,-c),g.transform(...n);let b=new Path2D;const[v,S,p,w]=e.bbox;if(b.rect(v,S,p-v,w-S),e.matrix){const E=new Path2D;E.addPath(b,new DOMMatrix(e.matrix)),b=E}g.clip(b),e.smask&&this.smaskStack.push({canvas:f.canvas,context:g,offsetX:l,offsetY:c,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(l,c),s.save()),af(s,g),this.ctx=g,(y=this.dependencyTracker)==null||y.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t,e){var r;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,(r=this.dependencyTracker)==null||r.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=me(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const l=Hu.slice();$.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],a,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,e,s,n,r,a){if(x(this,zn,F_).call(this),uy(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const l=s[2]-s[0],c=s[3]-s[1];if(a&&this.annotationCanvasMap){n=n.slice(),n[4]-=s[0],n[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=l,s[3]=c,$.singularValueDecompose2dScale(me(this.ctx),Oi);const{viewportScale:u}=this,h=Math.ceil(l*this.outputScaleX*u),d=Math.ceil(c*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,d);const{canvas:f,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(e,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(Oi[0],0,0,-Oi[1],0,c*Oi[1]),uy(this.ctx)}else{uy(this.ctx),this.endPath(t);const u=new Path2D;u.rect(s[0],s[1],l,c),this.ctx.clip(u)}}this.current=new LE(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...n),this.transform(t,...r)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),x(this,zn,H_).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){var l;if(!this.contentVisible)return;const s=e.count;e=this.getObject(t,e.data,e),e.count=s;const n=this.ctx,r=this._createMaskCanvas(t,e),a=r.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(a,r.offsetX,r.offsetY),(l=this.dependencyTracker)==null||l.resetBBox(t).recordBBox(t,this.ctx,r.offsetX,r.offsetX+a.width,r.offsetY,r.offsetY+a.height).recordOperation(t),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,s,n=0,r=0,a,l){var d,f,g;if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const c=this.ctx;c.save();const u=me(c);c.transform(s,n,r,a,0,0);const h=this._createMaskCanvas(t,e);c.setTransform(1,0,0,1,h.offsetX-u[4],h.offsetY-u[5]),(d=this.dependencyTracker)==null||d.resetBBox(t);for(let b=0,v=l.length;b<v;b+=2){const S=$.transform(u,[s,n,r,a,l[b],l[b+1]]);c.drawImage(h.canvas,S[4],S[5]),(f=this.dependencyTracker)==null||f.recordBBox(t,this.ctx,S[4],S[4]+h.canvas.width,S[5],S[5]+h.canvas.height)}c.restore(),this.compose(),(g=this.dependencyTracker)==null||g.recordOperation(t)}paintImageMaskXObjectGroup(t,e){var a,l,c;if(!this.contentVisible)return;const s=this.ctx,n=this.current.fillColor,r=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(t).recordDependencies(t,Vi.transformAndFill);for(const u of e){const{data:h,width:d,height:f,transform:g}=u,b=this.cachedCanvases.getCanvas("maskCanvas",d,f),v=b.context;v.save();const S=this.getObject(t,h,u);BE(v,S),v.globalCompositeOperation="source-in",v.fillStyle=r?n.getPattern(v,this,Hn(s),gs.FILL,t):n,v.fillRect(0,0,d,f),v.restore(),s.save(),s.transform(...g),s.scale(1,-1),cy(s,b.canvas,0,0,d,f,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(t,s,0,d,0,f),s.restore()}this.compose(),(c=this.dependencyTracker)==null||c.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const s=this.getObject(t,e);if(!s){nt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,s)}paintImageXObjectRepeat(t,e,s,n,r){if(!this.contentVisible)return;const a=this.getObject(t,e);if(!a){nt("Dependent image isn't ready yet");return}const l=a.width,c=a.height,u=[];for(let h=0,d=r.length;h<d;h+=2)u.push({transform:[s,0,0,n,r[h],r[h+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(t,a,u)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:s,height:n}=t,r=this.cachedCanvases.getCanvas("inlineImage",s,n),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",r.canvas}paintInlineImageXObject(t,e){var u;if(!this.contentVisible)return;const s=e.width,n=e.height,r=this.ctx;this.save(t);const{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none"),r.scale(1/s,-1/n);let l;if(e.bitmap)l=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)l=e;else{const d=this.cachedCanvases.getCanvas("inlineImage",s,n).context;PE(d,e),l=this.applyTransferMapsToCanvas(d)}const c=this._scaleImage(l,Hn(r));r.imageSmoothingEnabled=IE(me(r),e.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(t).recordBBox(t,r,0,s,-n,0).recordDependencies(t,Vi.imageXObject).recordOperation(t),cy(r,c.img,0,0,c.paintWidth,c.paintHeight,0,-n,s,n),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,s){var a,l,c;if(!this.contentVisible)return;const n=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const u=e.width,h=e.height,f=this.cachedCanvases.getCanvas("inlineImage",u,h).context;PE(f,e),r=this.applyTransferMapsToCanvas(f)}(a=this.dependencyTracker)==null||a.resetBBox(t);for(const u of s)n.save(),n.transform(...u.transform),n.scale(1,-1),cy(n,r,u.x,u.y,u.w,u.h,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(t,n,0,1,-1,0),n.restore();(c=this.dependencyTracker)==null||c.recordOperation(t),this.compose()}paintSolidColorImageMask(t){var e;this.contentVisible&&((e=this.dependencyTracker)==null||e.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Vi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,s){}beginMarkedContent(t,e){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,s){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){var e;(e=this.dependencyTracker)==null||e.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,s){var a,l;const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const r=this.ctx;this.pendingClip?(n||(this.pendingClip===UE?r.clip(e,"evenodd"):r.clip(e)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):(l=this.dependencyTracker)==null||l.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=me(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:s,c:n,d:r}=this.ctx.getTransform();let a,l;if(s===0&&n===0){const c=Math.abs(e),u=Math.abs(r);if(c===u)if(t===0)a=l=1/c;else{const h=c*t;a=l=h<1?1/h:1}else if(t===0)a=1/c,l=1/u;else{const h=c*t,d=u*t;a=h<1?1/h:1,l=d<1?1/d:1}}else{const c=Math.abs(e*r-s*n),u=Math.hypot(e,s),h=Math.hypot(n,r);if(t===0)a=h/c,l=u/c;else{const d=t*c;a=h>d?h/d:1,l=u>d?u/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:s,current:{lineWidth:n}}=this,[r,a]=this.getScaleForStroking();if(r===a){s.lineWidth=(n||1)*r,s.stroke(t);return}const l=s.getLineDash();e&&s.save(),s.scale(r,a),Kv.a=1/r,Kv.d=1/a;const c=new Path2D;if(c.addPath(t,Kv),l.length>0){const u=Math.max(r,a);s.setLineDash(l.map(h=>h/u)),s.lineDashOffset/=u}s.lineWidth=n||1,s.stroke(c),e&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};zn=new WeakSet,F_=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},H_=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},$_=function(t,e,s){const n=new Path2D;return n.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(e)),n};let eh=ox;for(const i in bg)eh.prototype[i]!==void 0&&(eh.prototype[bg[i]]=eh.prototype[i]);var cm,um;class fr{static get workerPort(){return o(this,cm)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");m(this,cm,t)}static get workerSrc(){return o(this,um)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");m(this,um,t)}}cm=new WeakMap,um=new WeakMap,A(fr,cm,null),A(fr,um,"");var Bh,hm;class L3{constructor({parsedData:t,rawData:e}){A(this,Bh);A(this,hm);m(this,Bh,t),m(this,hm,e)}getRaw(){return o(this,hm)}get(t){return o(this,Bh).get(t)??null}[Symbol.iterator](){return o(this,Bh).entries()}}Bh=new WeakMap,hm=new WeakMap;const Tu=Symbol("INTERNAL");var dm,fm,gm,Ih;class P3{constructor(t,{name:e,intent:s,usage:n,rbGroups:r}){A(this,dm,!1);A(this,fm,!1);A(this,gm,!1);A(this,Ih,!0);m(this,dm,!!(t&Ci.DISPLAY)),m(this,fm,!!(t&Ci.PRINT)),this.name=e,this.intent=s,this.usage=n,this.rbGroups=r}get visible(){if(o(this,gm))return o(this,Ih);if(!o(this,Ih))return!1;const{print:t,view:e}=this.usage;return o(this,dm)?(e==null?void 0:e.viewState)!=="OFF":o(this,fm)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,s=!1){t!==Tu&&Wt("Internal method `_setVisible` called."),m(this,gm,s),m(this,Ih,e)}}dm=new WeakMap,fm=new WeakMap,gm=new WeakMap,Ih=new WeakMap;var ho,Ht,Uh,zh,mm,q_;class B3{constructor(t,e=Ci.DISPLAY){A(this,mm);A(this,ho,null);A(this,Ht,new Map);A(this,Uh,null);A(this,zh,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,m(this,zh,t.order);for(const s of t.groups)o(this,Ht).set(s.id,new P3(e,s));if(t.baseState==="OFF")for(const s of o(this,Ht).values())s._setVisible(Tu,!1);for(const s of t.on)o(this,Ht).get(s)._setVisible(Tu,!0);for(const s of t.off)o(this,Ht).get(s)._setVisible(Tu,!1);m(this,Uh,this.getHash())}}isVisible(t){if(o(this,Ht).size===0)return!0;if(!t)return Vb("Optional content group not defined."),!0;if(t.type==="OCG")return o(this,Ht).has(t.id)?o(this,Ht).get(t.id).visible:(nt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return x(this,mm,q_).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!o(this,Ht).has(e))return nt(`Optional content group not found: ${e}`),!0;if(o(this,Ht).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!o(this,Ht).has(e))return nt(`Optional content group not found: ${e}`),!0;if(!o(this,Ht).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!o(this,Ht).has(e))return nt(`Optional content group not found: ${e}`),!0;if(!o(this,Ht).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!o(this,Ht).has(e))return nt(`Optional content group not found: ${e}`),!0;if(o(this,Ht).get(e).visible)return!1}return!0}return nt(`Unknown optional content policy ${t.policy}.`),!0}return nt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,s=!0){var r;const n=o(this,Ht).get(t);if(!n){nt(`Optional content group not found: ${t}`);return}if(s&&e&&n.rbGroups.length)for(const a of n.rbGroups)for(const l of a)l!==t&&((r=o(this,Ht).get(l))==null||r._setVisible(Tu,!1,!0));n._setVisible(Tu,!!e,!0),m(this,ho,null)}setOCGState({state:t,preserveRB:e}){let s;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":s=n;continue}const r=o(this,Ht).get(n);if(r)switch(s){case"ON":this.setVisibility(n,!0,e);break;case"OFF":this.setVisibility(n,!1,e);break;case"Toggle":this.setVisibility(n,!r.visible,e);break}}m(this,ho,null)}get hasInitialVisibility(){return o(this,Uh)===null||this.getHash()===o(this,Uh)}getOrder(){return o(this,Ht).size?o(this,zh)?o(this,zh).slice():[...o(this,Ht).keys()]:null}getGroup(t){return o(this,Ht).get(t)||null}getHash(){if(o(this,ho)!==null)return o(this,ho);const t=new zO;for(const[e,s]of o(this,Ht))t.update(`${e}:${s.visible}`);return m(this,ho,t.hexdigest())}[Symbol.iterator](){return o(this,Ht).entries()}}ho=new WeakMap,Ht=new WeakMap,Uh=new WeakMap,zh=new WeakMap,mm=new WeakSet,q_=function(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let n=1;n<e;n++){const r=t[n];let a;if(Array.isArray(r))a=x(this,mm,q_).call(this,r);else if(o(this,Ht).has(r))a=o(this,Ht).get(r).visible;else return nt(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class I3{constructor(t,{disableRange:e=!1,disableStream:s=!1}){St(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:r,progressiveDone:a,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=l,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),t.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),t.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const s=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const n=this._rangeReaders.some(function(r){return r._begin!==t?!1:(r._enqueue(s),!0)});St(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,s,n,r;t.total===void 0?(s=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||s.call(e,{loaded:t.loaded}):(r=(n=this._fullRequestReader)==null?void 0:n.onProgress)==null||r.call(n,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){St(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new U3(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new z3(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeReaders.slice(0))s.cancel(t);this._pdfDataRangeTransport.abort()}}class U3{constructor(t,e,s=!1,n=null){this._stream=t,this._done=s||!1,this._filename=WS(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class z3{constructor(t,e,s){this._stream=t,this._begin=e,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function F3(i){let t=!0,e=s("filename\\*","i").exec(i);if(e){e=e[1];let h=l(e);return h=unescape(h),h=c(h),h=u(h),r(h)}if(e=a(i),e){const h=u(e);return r(h)}if(e=s("filename","i").exec(i),e){e=e[1];let h=l(e);return h=u(h),r(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function n(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),g=xp(d);d=f.decode(g),t=!1}catch{}}return d}function r(h){return t&&/[\x80-\xff]/.test(h)&&(h=n("utf-8",h),t&&(h=n("iso-8859-1",h))),h}function a(h){const d=[];let f;const g=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=g.exec(h))!==null;){let[,v,S,p]=f;if(v=parseInt(v,10),v in d){if(v===0)break;continue}d[v]=[S,p]}const b=[];for(let v=0;v<d.length&&v in d;++v){let[S,p]=d[v];p=l(p),S&&(p=unescape(p),v===0&&(p=c(p))),b.push(p)}return b.join("")}function l(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const g=d[f].indexOf('"');g!==-1&&(d[f]=d[f].slice(0,g),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function c(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),b=h.slice(d+1).replace(/^[^']*'/,"");return n(f,b)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,g,b){if(g==="q"||g==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,S){return String.fromCharCode(parseInt(S,16))}),n(f,b);try{b=atob(b)}catch{}return n(f,b)})}return""}function JO(i,t){const e=new Headers;if(!i||!t||typeof t!="object")return e;for(const s in t){const n=t[s];n!==void 0&&e.append(s,n)}return e}function Yb(i){var t;return((t=URL.parse(i))==null?void 0:t.origin)??null}function ZO({responseHeaders:i,isHttp:t,rangeChunkSize:e,disableRange:s}){const n={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(i.get("Content-Length"),10);return!Number.isInteger(r)||(n.suggestedLength=r,r<=2*e)||s||!t||i.get("Accept-Ranges")!=="bytes"||(i.get("Content-Encoding")||"identity")!=="identity"||(n.allowRangeRequests=!0),n}function tk(i){const t=i.get("Content-Disposition");if(t){let e=F3(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(WS(e))return e}return null}function Op(i,t){return new q0(`Unexpected server response (${i}) while retrieving PDF "${t}".`,i,i===404||i===0&&t.startsWith("file:"))}function ek(i){return i===200||i===206}function sk(i,t,e){return{method:"GET",headers:i,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function ik(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:(nt(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class H3{constructor(t){B(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=JO(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return St(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new $3(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new q3(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class $3{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const s=new Headers(t.headers),n=e.url;fetch(n,sk(s,this._withCredentials,this._abortController)).then(r=>{if(t._responseOrigin=Yb(r.url),!ek(r.status))throw Op(r.status,n);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:l,suggestedLength:c}=ZO({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=c||this._contentLength,this._filename=tk(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new el("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ik(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class q3{constructor(t,e,s){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const r=new Headers(t.headers);r.append("Range",`bytes=${e}-${s-1}`);const a=n.url;fetch(a,sk(r,this._withCredentials,this._abortController)).then(l=>{const c=Yb(l.url);if(c!==t._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${t._responseOrigin}".`);if(!ek(l.status))throw Op(l.status,a);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:ik(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const Wv=200,Qv=206;function G3(i){const t=i.response;return typeof t!="string"?t:xp(t).buffer}class V3{constructor({url:t,httpHeaders:e,withCredentials:s}){B(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=JO(this.isHttp,e),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[r,a]of this.headers)e.setRequestHeader(r,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=Qv):n.expectedStatus=Wv,e.responseType="arraybuffer",St(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,s),e.onprogress=this.onProgress.bind(this,s),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),s}onProgress(t,e){var n;const s=this.pendingRequests[t];s&&((n=s.onProgress)==null||n.call(s,e))}onStateChange(t,e){const s=this.pendingRequests[t];if(!s)return;const n=s.xhr;if(n.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),n.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],n.status===0&&this.isHttp){s.onError(n.status);return}const r=n.status||Wv;if(!(r===Wv&&s.expectedStatus===Qv)&&r!==s.expectedStatus){s.onError(n.status);return}const l=G3(n);if(r===Qv){const c=n.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:l}):(nt('Missing or invalid "Content-Range" header.'),s.onError(0))}else l?s.onDone({begin:0,chunk:l}):s.onError(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class X3{constructor(t){this._source=t,this._manager=new V3(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return St(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Y3(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const s=new K3(this._manager,t,e);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class Y3{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Yb(e.responseURL);const s=e.getAllResponseHeaders(),n=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[c,...u]=l.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=ZO({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=tk(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Op(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class K3{constructor(t,e,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=Yb((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=Op(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const W3=/^[a-z][a-z0-9\-+.]+:/i;function Q3(i){if(W3.test(i))return new URL(i);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(i))}class J3{constructor(t){this.source=t,this.url=Q3(t.url),St(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return St(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Z3(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new t4(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const s of this._rangeRequestReaders.slice(0))s.cancel(t)}}class Z3{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(n=>{this._contentLength=n.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},n=>{n.code==="ENOENT"&&(n=Op(0,this._url.href)),this._storedError=n,this._headersCapability.reject(n)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new el("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class t4{constructor(t,e,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=t.source;this._isStreamingSupported=!n.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:e,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const of=Symbol("INITIAL_DATA");var fi,pm,G_;class nk{constructor(){A(this,pm);A(this,fi,Object.create(null))}get(t,e=null){if(e){const n=x(this,pm,G_).call(this,t);return n.promise.then(()=>e(n.data)),null}const s=o(this,fi)[t];if(!s||s.data===of)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=o(this,fi)[t];return!!e&&e.data!==of}delete(t){const e=o(this,fi)[t];return!e||e.data===of?!1:(delete o(this,fi)[t],!0)}resolve(t,e=null){const s=x(this,pm,G_).call(this,t);s.data=e,s.resolve()}clear(){var t;for(const e in o(this,fi)){const{data:s}=o(this,fi)[e];(t=s==null?void 0:s.bitmap)==null||t.close()}m(this,fi,Object.create(null))}*[Symbol.iterator](){for(const t in o(this,fi)){const{data:e}=o(this,fi)[t];e!==of&&(yield[t,e])}}}fi=new WeakMap,pm=new WeakSet,G_=function(t){var e;return(e=o(this,fi))[t]||(e[t]={...Promise.withResolvers(),data:of})};const e4=1e5,zE=30;var qE,fo,Zs,ym,bm,sc,Jr,vm,wm,ic,Fh,Hh,go,$h,_m,qh,nc,Am,Sm,Gh,rc,xm,mo,Vh,Ma,rk,ak,V_,zi,zy,X_,ok,lk;const $e=class $e{constructor({textContentSource:t,container:e,viewport:s}){A(this,Ma);A(this,fo,Promise.withResolvers());A(this,Zs,null);A(this,ym,!1);A(this,bm,!!((qE=globalThis.FontInspector)!=null&&qE.enabled));A(this,sc,null);A(this,Jr,null);A(this,vm,0);A(this,wm,0);A(this,ic,null);A(this,Fh,null);A(this,Hh,0);A(this,go,0);A(this,$h,Object.create(null));A(this,_m,[]);A(this,qh,null);A(this,nc,[]);A(this,Am,new WeakMap);A(this,Sm,null);var c;if(t instanceof ReadableStream)m(this,qh,t);else if(typeof t=="object")m(this,qh,new ReadableStream({start(u){u.enqueue(t),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');m(this,Zs,m(this,Fh,e)),m(this,go,s.scale*vr.pixelRatio),m(this,Hh,s.rotation),m(this,Jr,{div:null,properties:null,ctx:null});const{pageWidth:n,pageHeight:r,pageX:a,pageY:l}=s.rawDims;m(this,Sm,[1,0,0,-1,-a,l+r]),m(this,wm,n),m(this,vm,r),x(c=$e,zi,ok).call(c),Wc(e,s),o(this,fo).promise.finally(()=>{o($e,Vh).delete(this),m(this,Jr,null),m(this,$h,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=_s.platform;return ut(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{o(this,ic).read().then(({value:e,done:s})=>{if(s){o(this,fo).resolve();return}o(this,sc)??m(this,sc,e.lang),Object.assign(o(this,$h),e.styles),x(this,Ma,rk).call(this,e.items),t()},o(this,fo).reject)};return m(this,ic,o(this,qh).getReader()),o($e,Vh).add(this),t(),o(this,fo).promise}update({viewport:t,onBefore:e=null}){var r;const s=t.scale*vr.pixelRatio,n=t.rotation;if(n!==o(this,Hh)&&(e==null||e(),m(this,Hh,n),Wc(o(this,Fh),{rotation:n})),s!==o(this,go)){e==null||e(),m(this,go,s);const a={div:null,properties:null,ctx:x(r=$e,zi,zy).call(r,o(this,sc))};for(const l of o(this,nc))a.properties=o(this,Am).get(l),a.div=l,x(this,Ma,V_).call(this,a)}}cancel(){var e;const t=new el("TextLayer task cancelled.");(e=o(this,ic))==null||e.cancel(t).catch(()=>{}),m(this,ic,null),o(this,fo).reject(t)}get textDivs(){return o(this,nc)}get textContentItemsStr(){return o(this,_m)}static cleanup(){if(!(o(this,Vh).size>0)){o(this,Gh).clear();for(const{canvas:t}of o(this,rc).values())t.remove();o(this,rc).clear()}}};fo=new WeakMap,Zs=new WeakMap,ym=new WeakMap,bm=new WeakMap,sc=new WeakMap,Jr=new WeakMap,vm=new WeakMap,wm=new WeakMap,ic=new WeakMap,Fh=new WeakMap,Hh=new WeakMap,go=new WeakMap,$h=new WeakMap,_m=new WeakMap,qh=new WeakMap,nc=new WeakMap,Am=new WeakMap,Sm=new WeakMap,Gh=new WeakMap,rc=new WeakMap,xm=new WeakMap,mo=new WeakMap,Vh=new WeakMap,Ma=new WeakSet,rk=function(t){var n,r;if(o(this,ym))return;(r=o(this,Jr)).ctx??(r.ctx=x(n=$e,zi,zy).call(n,o(this,sc)));const e=o(this,nc),s=o(this,_m);for(const a of t){if(e.length>e4){nt("Ignoring additional textDivs for performance reasons."),m(this,ym,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const l=o(this,Zs);m(this,Zs,document.createElement("span")),o(this,Zs).classList.add("markedContent"),a.id&&o(this,Zs).setAttribute("id",`${a.id}`),l.append(o(this,Zs))}else a.type==="endMarkedContent"&&m(this,Zs,o(this,Zs).parentNode);continue}s.push(a.str),x(this,Ma,ak).call(this,a)}},ak=function(t){var v;const e=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};o(this,nc).push(e);const n=$.transform(o(this,Sm),t.transform);let r=Math.atan2(n[1],n[0]);const a=o(this,$h)[t.fontName];a.vertical&&(r+=Math.PI/2);let l=o(this,bm)&&a.fontSubstitution||a.fontFamily;l=$e.fontFamilyMap.get(l)||l;const c=Math.hypot(n[2],n[3]),u=c*x(v=$e,zi,lk).call(v,l,a,o(this,sc));let h,d;r===0?(h=n[4],d=n[5]-u):(h=n[4]+u*Math.sin(r),d=n[5]-u*Math.cos(r));const f="calc(var(--total-scale-factor) *",g=e.style;o(this,Zs)===o(this,Fh)?(g.left=`${(100*h/o(this,wm)).toFixed(2)}%`,g.top=`${(100*d/o(this,vm)).toFixed(2)}%`):(g.left=`${f}${h.toFixed(2)}px)`,g.top=`${f}${d.toFixed(2)}px)`),g.fontSize=`${f}${(o($e,mo)*c).toFixed(2)}px)`,g.fontFamily=l,s.fontSize=c,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,o(this,bm)&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),r!==0&&(s.angle=r*(180/Math.PI));let b=!1;if(t.str.length>1)b=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),p=Math.abs(t.transform[3]);S!==p&&Math.max(S,p)/Math.min(S,p)>1.5&&(b=!0)}if(b&&(s.canvasWidth=a.vertical?t.height:t.width),o(this,Am).set(e,s),o(this,Jr).div=e,o(this,Jr).properties=s,x(this,Ma,V_).call(this,o(this,Jr)),s.hasText&&o(this,Zs).append(e),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),o(this,Zs).append(S)}},V_=function(t){var l;const{div:e,properties:s,ctx:n}=t,{style:r}=e;let a="";if(o($e,mo)>1&&(a=`scale(${1/o($e,mo)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:h}=s;x(l=$e,zi,X_).call(l,n,h*o(this,go),c);const{width:d}=n.measureText(e.textContent);d>0&&(a=`scaleX(${u*o(this,go)/d}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)},zi=new WeakSet,zy=function(t=null){let e=o(this,rc).get(t||(t=""));if(!e){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),e=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),o(this,rc).set(t,e),o(this,xm).set(e,{size:0,family:""})}return e},X_=function(t,e,s){const n=o(this,xm).get(t);e===n.size&&s===n.family||(t.font=`${e}px ${s}`,n.size=e,n.family=s)},ok=function(){if(o(this,mo)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),m(this,mo,t.getBoundingClientRect().height),t.remove()},lk=function(t,e,s){const n=o(this,Gh).get(t);if(n)return n;const r=x(this,zi,zy).call(this,s);r.canvas.width=r.canvas.height=zE,x(this,zi,X_).call(this,r,zE,t);const a=r.measureText(""),l=a.fontBoundingBoxAscent,c=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let u=.8;return l?u=l/(l+c):(_s.platform.isFirefox&&nt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?u=e.ascent:e.descent&&(u=1+e.descent)),o(this,Gh).set(t,u),u},A($e,zi),A($e,Gh,new Map),A($e,rc,new Map),A($e,xm,new WeakMap),A($e,mo,null),A($e,Vh,new Set);let wg=$e;const s4=100;function ck(i={}){typeof i=="string"||i instanceof URL?i={url:i}:(i instanceof ArrayBuffer||ArrayBuffer.isView(i))&&(i={data:i});const t=new Y_,{docId:e}=t,s=i.url?c3(i.url):null,n=i.data?u3(i.data):null,r=i.httpHeaders||null,a=i.withCredentials===!0,l=i.password??null,c=i.range instanceof uk?i.range:null,u=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:2**16;let h=i.worker instanceof _g?i.worker:null;const d=i.verbosity,f=typeof i.docBaseUrl=="string"&&!Xb(i.docBaseUrl)?i.docBaseUrl:null,g=ry(i.cMapUrl),b=i.cMapPacked!==!1,v=i.CMapReaderFactory||(Bs?b3:TE),S=ry(i.iccUrl),p=ry(i.standardFontDataUrl),w=i.StandardFontDataFactory||(Bs?v3:CE),y=ry(i.wasmUrl),E=i.WasmFactory||(Bs?w3:RE),T=i.stopAtErrors!==!0,C=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,R=i.isEvalSupported!==!1,O=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!Bs,k=typeof i.isImageDecoderSupported=="boolean"?i.isImageDecoderSupported:!Bs&&(_s.platform.isFirefox||!globalThis.chrome),D=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,P=typeof i.disableFontFace=="boolean"?i.disableFontFace:Bs,I=i.fontExtraProperties===!0,Z=i.enableXfa===!0,K=i.ownerDocument||globalThis.document,W=i.disableRange===!0,N=i.disableStream===!0,L=i.disableAutoFetch===!0,z=i.pdfBug===!0,tt=i.CanvasFactory||(Bs?y3:g3),bt=i.FilterFactory||(Bs?p3:m3),ze=i.enableHWA===!0,gt=i.useWasm!==!1,vt=c?c.length:i.length??NaN,Nt=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!Bs&&!P,de=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:!!(v===TE&&w===CE&&E===RE&&g&&p&&y&&pf(g,document.baseURI)&&pf(p,document.baseURI)&&pf(y,document.baseURI)),ks=null;BB(d);const Ct={canvasFactory:new tt({ownerDocument:K,enableHWA:ze}),filterFactory:new bt({docId:e,ownerDocument:K}),cMapReaderFactory:de?null:new v({baseUrl:g,isCompressed:b}),standardFontDataFactory:de?null:new w({baseUrl:p}),wasmFactory:de?null:new E({baseUrl:y})};h||(h=_g.create({verbosity:d,port:fr.workerPort}),t._worker=h);const $i={docId:e,apiVersion:"5.4.394",data:n,password:l,disableAutoFetch:L,rangeChunkSize:u,length:vt,docBaseUrl:f,enableXfa:Z,evaluatorOptions:{maxImageSize:C,disableFontFace:P,ignoreErrors:T,isEvalSupported:R,isOffscreenCanvasSupported:O,isImageDecoderSupported:k,canvasMaxAreaInBytes:D,fontExtraProperties:I,useSystemFonts:Nt,useWasm:gt,useWorkerFetch:de,cMapUrl:g,iccUrl:S,standardFontDataUrl:p,wasmUrl:y}},Q={ownerDocument:K,pdfBug:z,styleElement:ks,loadingParams:{disableAutoFetch:L,enableXfa:Z}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const it=h.messageHandler.sendWithPromise("GetDocRequest",$i,n?[n.buffer]:null);let fe;if(c)fe=new I3(c,{disableRange:W,disableStream:N});else if(!n){if(!s)throw new Error("getDocument - no `url` parameter provided.");const ol=pf(s)?H3:Bs?J3:X3;fe=new ol({url:s,length:vt,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:W,disableStream:N})}return it.then(ol=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Wd=new xf(e,ol,h.port),Np=new r4(Wd,t,fe,Q,Ct,ze);t._transport=Np,Wd.send("Ready",null)})}).catch(t._capability.reject),t}var db;const fb=class fb{constructor(){B(this,"_capability",Promise.withResolvers());B(this,"_transport",null);B(this,"_worker",null);B(this,"docId",`d${Fe(fb,db)._++}`);B(this,"destroyed",!1);B(this,"onPassword",null);B(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var t,e,s,n;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(n=this._worker)==null||n.destroy(),this._worker=null}async getData(){return this._transport.getData()}};db=new WeakMap,A(fb,db,0);let Y_=fb;var ac,Em,Tm,Cm,Rm;class uk{constructor(t,e,s=!1,n=null){A(this,ac,Promise.withResolvers());A(this,Em,[]);A(this,Tm,[]);A(this,Cm,[]);A(this,Rm,[]);this.length=t,this.initialData=e,this.progressiveDone=s,this.contentDispositionFilename=n}addRangeListener(t){o(this,Rm).push(t)}addProgressListener(t){o(this,Cm).push(t)}addProgressiveReadListener(t){o(this,Tm).push(t)}addProgressiveDoneListener(t){o(this,Em).push(t)}onDataRange(t,e){for(const s of o(this,Rm))s(t,e)}onDataProgress(t,e){o(this,ac).promise.then(()=>{for(const s of o(this,Cm))s(t,e)})}onDataProgressiveRead(t){o(this,ac).promise.then(()=>{for(const e of o(this,Tm))e(t)})}onDataProgressiveDone(){o(this,ac).promise.then(()=>{for(const t of o(this,Em))t()})}transportReady(){o(this,ac).resolve()}requestDataRange(t,e){Wt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}ac=new WeakMap,Em=new WeakMap,Tm=new WeakMap,Cm=new WeakMap,Rm=new WeakMap;class i4{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Zr,oc,Of;class n4{constructor(t,e,s,n=!1){A(this,oc);A(this,Zr,!1);this._pageIndex=t,this._pageInfo=e,this._transport=s,this._stats=n?new vE:null,this._pdfBug=n,this.commonObjs=s.commonObjs,this.objs=new nk,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:r=!1}={}){return new Tp({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:n,dontFlip:r})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ut(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,canvas:e=t.canvas,viewport:s,intent:n="display",annotationMode:r=qa.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:h=null,printAnnotationStorage:d=null,isEditing:f=!1,recordOperations:g=!1,operationsFilter:b=null}){var k,D,P;(k=this._stats)==null||k.time("Overall");const v=this._transport.getRenderingIntent(n,r,d,f),{renderingIntent:S,cacheKey:p}=v;m(this,Zr,!1),c||(c=this._transport.getOptionalContentConfig(S));let w=this._intentStates.get(p);w||(w=Object.create(null),this._intentStates.set(p,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const y=!!(S&Ci.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(D=this._stats)==null||D.time("Page Request"),this._pumpOperatorList(v));const E=!!(this._pdfBug&&((P=globalThis.StepperManager)!=null&&P.enabled)),T=!this.recordedBBoxes&&(g||E),C=I=>{var Z,K;if(w.renderTasks.delete(R),T){const W=(Z=R.gfx)==null?void 0:Z.dependencyTracker.take();W&&(R.stepper&&R.stepper.setOperatorBBoxes(W,R.gfx.dependencyTracker.takeDebugMetadata()),g&&(this.recordedBBoxes=W))}y&&m(this,Zr,!0),x(this,oc,Of).call(this),I?(R.capability.reject(I),this._abortOperatorList({intentState:w,reason:I instanceof Error?I:new Error(I)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(K=globalThis.Stats)!=null&&K.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new K_({callback:C,params:{canvas:e,canvasContext:t,dependencyTracker:T?new A3(e,w.operatorList.length,E):null,viewport:s,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!y,pdfBug:this._pdfBug,pageColors:h,enableHWA:this._transport.enableHWA,operationsFilter:b});(w.renderTasks||(w.renderTasks=new Set)).add(R);const O=R.task;return Promise.all([w.displayReadyCapability.promise,c]).then(([I,Z])=>{var K;if(this.destroyed){C();return}if((K=this._stats)==null||K.time("Rendering"),!(Z.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:I,optionalContentConfig:Z}),R.operatorListChanged()}).catch(C),O}getOperatorList({intent:t="display",annotationMode:e=qa.ENABLE,printAnnotationStorage:s=null,isEditing:n=!1}={}){var u;function r(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(t,e,s,n,!0);let l=this._intentStates.get(a.cacheKey);l||(l=Object.create(null),this._intentStates.set(a.cacheKey,l));let c;return l.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(c),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(n){return n.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>vg.textContent(s));const e=this.streamTextContent(t);return new Promise(function(s,n){function r(){a.read().then(function({value:c,done:u}){if(u){s(l);return}l.lang??(l.lang=c.lang),Object.assign(l.styles,c.styles),l.items.push(...c.items),r()},n)}const a=e.getReader(),l={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const s of e.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),m(this,Zr,!1),Promise.all(t)}cleanup(t=!1){m(this,Zr,!0);const e=x(this,oc,Of).call(this);return t&&e&&this._stats&&(this._stats=new vE),e}_startRenderPage(t,e){var n,r;const s=this._intentStates.get(e);s&&((n=this._stats)==null||n.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(t))}_renderPageChunk(t,e){for(let s=0,n=t.length;s<n;s++)e.operatorList.fnArray.push(t.fnArray[s]),e.operatorList.argsArray.push(t.argsArray[s]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const s of e.renderTasks)s.operatorListChanged();t.lastChunk&&x(this,oc,Of).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s,modifiedIds:n}){const{map:r,transfer:a}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:r,modifiedIds:n},a).getReader(),u=this._intentStates.get(e);u.streamReader=c;const h=()=>{c.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),h())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();x(this,oc,Of).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(e instanceof KS){let n=s4;e.extraDelay>0&&e.extraDelay<1e3&&(n+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},n);return}}if(t.streamReader.cancel(new el(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[n,r]of this._intentStates)if(r===t){this._intentStates.delete(n);break}this.cleanup()}}}get stats(){return this._stats}}Zr=new WeakMap,oc=new WeakSet,Of=function(){if(!o(this,Zr)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,Zr,!1),!0};var po,kn,ta,lc,gb,cc,uc,Fs,Fy,hk,dk,kf,Xh,Hy;const le=class le{constructor({name:t=null,port:e=null,verbosity:s=IB()}={}){A(this,Fs);A(this,po,Promise.withResolvers());A(this,kn,null);A(this,ta,null);A(this,lc,null);if(this.name=t,this.destroyed=!1,this.verbosity=s,e){if(o(le,uc).has(e))throw new Error("Cannot use more than one PDFWorker per port.");o(le,uc).set(e,this),x(this,Fs,hk).call(this,e)}else x(this,Fs,dk).call(this)}get promise(){return o(this,po).promise}get port(){return o(this,ta)}get messageHandler(){return o(this,kn)}destroy(){var t,e;this.destroyed=!0,(t=o(this,lc))==null||t.terminate(),m(this,lc,null),o(le,uc).delete(o(this,ta)),m(this,ta,null),(e=o(this,kn))==null||e.destroy(),m(this,kn,null)}static create(t){const e=o(this,uc).get(t==null?void 0:t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new le(t)}static get workerSrc(){if(fr.workerSrc)return fr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ut(this,"_setupFakeWorkerGlobal",(async()=>o(this,Xh,Hy)?o(this,Xh,Hy):(await import(this.workerSrc)).WorkerMessageHandler)())}};po=new WeakMap,kn=new WeakMap,ta=new WeakMap,lc=new WeakMap,gb=new WeakMap,cc=new WeakMap,uc=new WeakMap,Fs=new WeakSet,Fy=function(){o(this,po).resolve(),o(this,kn).send("configure",{verbosity:this.verbosity})},hk=function(t){m(this,ta,t),m(this,kn,new xf("main","worker",t)),o(this,kn).on("ready",()=>{}),x(this,Fs,Fy).call(this)},dk=function(){if(o(le,cc)||o(le,Xh,Hy)){x(this,Fs,kf).call(this);return}let{workerSrc:t}=le;try{le._isSameOrigin(window.location,t)||(t=le._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),s=new xf("main","worker",e),n=()=>{r.abort(),s.destroy(),e.terminate(),this.destroyed?o(this,po).reject(new Error("Worker was destroyed")):x(this,Fs,kf).call(this)},r=new AbortController;e.addEventListener("error",()=>{o(this,lc)||n()},{signal:r.signal}),s.on("test",l=>{if(r.abort(),this.destroyed||!l){n();return}m(this,kn,s),m(this,ta,e),m(this,lc,e),x(this,Fs,Fy).call(this)}),s.on("ready",l=>{if(r.abort(),this.destroyed){n();return}try{a()}catch{x(this,Fs,kf).call(this)}});const a=()=>{const l=new Uint8Array;s.send("test",l,[l.buffer])};a();return}catch{Vb("The worker has been disabled.")}x(this,Fs,kf).call(this)},kf=function(){o(le,cc)||(nt("Setting up fake worker."),m(le,cc,!0)),le._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){o(this,po).reject(new Error("Worker was destroyed"));return}const e=new f3;m(this,ta,e);const s=`fake${Fe(le,gb)._++}`,n=new xf(s+"_worker",s,e);t.setup(n,e),m(this,kn,new xf(s,s+"_worker",e)),x(this,Fs,Fy).call(this)}).catch(t=>{o(this,po).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Xh=new WeakSet,Hy=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},A(le,Xh),A(le,gb,0),A(le,cc,!1),A(le,uc,new WeakMap),Bs&&(m(le,cc,!0),fr.workerSrc||(fr.workerSrc="./pdf.worker.mjs")),le._isSameOrigin=(t,e)=>{const s=URL.parse(t);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const n=new URL(e,s);return s.origin===n.origin},le._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},le.fromPort=t=>{if(WB("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return le.create(t)};let _g=le;var ea,ir,Yh,Kh,sa,hc,Nf;class r4{constructor(t,e,s,n,r,a){A(this,hc);A(this,ea,new Map);A(this,ir,new Map);A(this,Yh,new Map);A(this,Kh,new Map);A(this,sa,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new nk,this.fontLoader=new o3({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return ut(this,"annotationStorage",new QS)}getRenderingIntent(t,e=qa.ENABLE,s=null,n=!1,r=!1){let a=Ci.DISPLAY,l=N_;switch(t){case"any":a=Ci.ANY;break;case"display":break;case"print":a=Ci.PRINT;break;default:nt(`getRenderingIntent - invalid intent: ${t}`)}const c=a&Ci.PRINT&&s instanceof HO?s:this.annotationStorage;switch(e){case qa.DISABLE:a+=Ci.ANNOTATIONS_DISABLE;break;case qa.ENABLE:break;case qa.ENABLE_FORMS:a+=Ci.ANNOTATIONS_FORMS;break;case qa.ENABLE_STORAGE:a+=Ci.ANNOTATIONS_STORAGE,l=c.serializable;break;default:nt(`getRenderingIntent - invalid annotationMode: ${e}`)}n&&(a+=Ci.IS_EDITING),r&&(a+=Ci.OPLIST);const{ids:u,hash:h}=c.modifiedIds,d=[a,l.hash,h];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=o(this,sa))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of o(this,ir).values())t.push(n._destroy());o(this,ir).clear(),o(this,Yh).clear(),o(this,Kh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var n,r;this.commonObjs.clear(),this.fontLoader.clear(),o(this,ea).clear(),this.filterFactory.destroy(),wg.cleanup(),(n=this._networkStream)==null||n.cancelAllRequests(new el("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(s,n)=>{St(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},n.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){n.close();return}St(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{n.error(r)})},n.onCancel=r=>{this._fullReader.cancel(r),n.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async s=>{var l;await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:r,contentLength:a}=this._fullReader;return(!n||!r)&&(this._lastProgress&&((l=e.onProgress)==null||l.call(e,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=e.onProgress)==null||u.call(e,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:n,isRangeSupported:r,contentLength:a}}),t.on("GetRangeReader",(s,n)=>{St(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){n.close();return}n.onPull=()=>{r.read().then(function({value:a,done:l}){if(l){n.close();return}St(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),n.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{n.error(a)})},n.onCancel=a=>{r.cancel(a),n.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,e._capability.resolve(new i4(s,this))}),t.on("DocException",s=>{e._capability.reject(Xs(s))}),t.on("PasswordRequest",s=>{m(this,sa,Promise.withResolvers());try{if(!e.onPassword)throw Xs(s);const n=r=>{r instanceof Error?o(this,sa).reject(r):o(this,sa).resolve({password:r})};e.onPassword(n,s.code)}catch(n){o(this,sa).reject(n)}return o(this,sa).promise}),t.on("DataLoaded",s=>{var n;(n=e.onProgress)==null||n.call(e,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;o(this,ir).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,n,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(n){case"Font":if("error"in r){const f=r.error;nt(`Error during font loading: ${f}`),this.commonObjs.resolve(s,f);break}const l=new M_(r),c=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(f,g)=>globalThis.FontInspector.fontAdded(f,g):null,u=new l3(l,c,r.extra,r.charProcOperatorList);this.fontLoader.bind(u).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(s,u)});break;case"CopyLocalImage":const{imageRef:h}=r;St(h,"The imageRef must be defined.");for(const f of o(this,ir).values())for(const[,g]of f.objs)if((g==null?void 0:g.ref)===h)return g.dataLen?(this.commonObjs.resolve(s,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(s,r);break;case"Pattern":const d=new D_(r);this.commonObjs.resolve(s,d.getIR());break;default:throw new Error(`Got unknown common object type ${n}`)}return null}),t.on("obj",([s,n,r,a])=>{var c;if(this.destroyed)return;const l=o(this,ir).get(n);if(!l.objs.has(s)){if(l._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(r){case"Image":case"Pattern":l.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),t.on("DocProgress",s=>{var n;this.destroyed||(n=e.onProgress)==null||n.call(e,{loaded:s.loaded,total:s.total})}),t.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const n=this[s.type];if(!n)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return n.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&nt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((s=this._fullReader)==null?void 0:s.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=o(this,Yh).get(e);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&o(this,Kh).set(r.refStr,t);const a=new n4(e,r,this,this._params.pdfBug);return o(this,ir).set(e,a),a});return o(this,Yh).set(e,n),n}getPageIndex(t){return j_(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return x(this,hc,Nf).call(this,"GetFieldObjects")}hasJSActions(){return x(this,hc,Nf).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return x(this,hc,Nf).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return x(this,hc,Nf).call(this,"GetOptionalContentConfig").then(e=>new B3(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=o(this,ea).get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then(n=>{var r,a;return{info:n[0],metadata:n[1]?new L3(n[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return o(this,ea).set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of o(this,ir).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),o(this,ea).clear(),this.filterFactory.destroy(!0),wg.cleanup()}}cachedPageNumber(t){if(!j_(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return o(this,Kh).get(e)??null}}ea=new WeakMap,ir=new WeakMap,Yh=new WeakMap,Kh=new WeakMap,sa=new WeakMap,hc=new WeakSet,Nf=function(t,e=null){const s=o(this,ea).get(t);if(s)return s;const n=this.messageHandler.sendWithPromise(t,e);return o(this,ea).set(t,n),n};var yo;class a4{constructor(t){A(this,yo,null);B(this,"onContinue",null);B(this,"onError",null);m(this,yo,t)}get promise(){return o(this,yo).capability.promise}cancel(t=0){o(this,yo).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=o(this,yo).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=o(this,yo);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}yo=new WeakMap;var bo,dc;const Al=class Al{constructor({callback:t,params:e,objs:s,commonObjs:n,annotationCanvasMap:r,operatorList:a,pageIndex:l,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null,enableHWA:g=!1,operationsFilter:b=null}){A(this,bo,null);this.callback=t,this.params=e,this.objs=s,this.commonObjs=n,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new a4(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=g,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=b}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var c,u;if(this.cancelled)return;if(this._canvas){if(o(Al,dc).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");o(Al,dc).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:n,background:r,dependencyTracker:a}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new eh(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:n,viewport:s,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(t=null,e=0){var s,n,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),o(this,bo)&&(window.cancelAnimationFrame(o(this,bo)),m(this,bo,null)),o(Al,dc).delete(this._canvas),t||(t=new KS(`Rendering cancelled, page ${this._pageIndex+1}`,e)),this.callback(t),(r=(n=this.task).onError)==null||r.call(n,t)}operatorListChanged(){var t,e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.gfx.dependencyTracker)==null||t.growOperationsCount(this.operatorList.fnArray.length),(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,bo,window.requestAnimationFrame(()=>{m(this,bo,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),o(Al,dc).delete(this._canvas),this.callback())))}};bo=new WeakMap,dc=new WeakMap,A(Al,dc,new WeakSet);let K_=Al;const o4="5.4.394",l4="2cc809ade";var gi,fc,Wh,Ve,Om,Qh,ia,km,vo,Nn,Nm,Vt,W_,Q_,J_,pl,fk,Pa;const Ys=class Ys{constructor({editor:t=null,uiManager:e=null}){A(this,Vt);A(this,gi,null);A(this,fc,null);A(this,Wh);A(this,Ve,null);A(this,Om,!1);A(this,Qh,!1);A(this,ia,null);A(this,km);A(this,vo,null);A(this,Nn,null);var s,n;t?(m(this,Qh,!1),m(this,ia,t)):m(this,Qh,!0),m(this,Nn,(t==null?void 0:t._uiManager)||e),m(this,km,o(this,Nn)._eventBus),m(this,Wh,((s=t==null?void 0:t.color)==null?void 0:s.toUpperCase())||((n=o(this,Nn))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),o(Ys,Nm)||m(Ys,Nm,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ut(this,"_keyboardManager",new Rp([[["Escape","mac+Escape"],Ys.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ys.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ys.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ys.prototype._moveToPrevious],[["Home","mac+Home"],Ys.prototype._moveToBeginning],[["End","mac+End"],Ys.prototype._moveToEnd]]))}renderButton(){const t=m(this,gi,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",o(this,ia)&&(t.ariaControls=`${o(this,ia).id}_colorpicker_dropdown`);const e=o(this,Nn)._signal;t.addEventListener("click",x(this,Vt,pl).bind(this),{signal:e}),t.addEventListener("keydown",x(this,Vt,J_).bind(this),{signal:e});const s=m(this,fc,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=o(this,Wh),t.append(s),t}renderMainDropdown(){const t=m(this,Ve,x(this,Vt,W_).call(this));return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}_colorSelectFromKeyboard(t){if(t.target===o(this,gi)){x(this,Vt,pl).call(this,t);return}const e=t.target.getAttribute("data-color");e&&x(this,Vt,Q_).call(this,e,t)}_moveToNext(t){var e,s;if(!o(this,Vt,Pa)){x(this,Vt,pl).call(this,t);return}if(t.target===o(this,gi)){(e=o(this,Ve).firstChild)==null||e.focus();return}(s=t.target.nextSibling)==null||s.focus()}_moveToPrevious(t){var e,s;if(t.target===((e=o(this,Ve))==null?void 0:e.firstChild)||t.target===o(this,gi)){o(this,Vt,Pa)&&this._hideDropdownFromKeyboard();return}o(this,Vt,Pa)||x(this,Vt,pl).call(this,t),(s=t.target.previousSibling)==null||s.focus()}_moveToBeginning(t){var e;if(!o(this,Vt,Pa)){x(this,Vt,pl).call(this,t);return}(e=o(this,Ve).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!o(this,Vt,Pa)){x(this,Vt,pl).call(this,t);return}(e=o(this,Ve).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=o(this,Ve))==null||t.classList.add("hidden"),o(this,gi).ariaExpanded="false",(e=o(this,vo))==null||e.abort(),m(this,vo,null)}_hideDropdownFromKeyboard(){var t;if(!o(this,Qh)){if(!o(this,Vt,Pa)){(t=o(this,ia))==null||t.unselect();return}this.hideDropdown(),o(this,gi).focus({preventScroll:!0,focusVisible:o(this,Om)})}}updateColor(t){if(o(this,fc)&&(o(this,fc).style.backgroundColor=t),!o(this,Ve))return;const e=o(this,Nn).highlightColors.values();for(const s of o(this,Ve).children)s.ariaSelected=e.next().value===t.toUpperCase()}destroy(){var t,e;(t=o(this,gi))==null||t.remove(),m(this,gi,null),m(this,fc,null),(e=o(this,Ve))==null||e.remove(),m(this,Ve,null)}};gi=new WeakMap,fc=new WeakMap,Wh=new WeakMap,Ve=new WeakMap,Om=new WeakMap,Qh=new WeakMap,ia=new WeakMap,km=new WeakMap,vo=new WeakMap,Nn=new WeakMap,Nm=new WeakMap,Vt=new WeakSet,W_=function(){const t=document.createElement("div"),e=o(this,Nn)._signal;t.addEventListener("contextmenu",bn,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),o(this,ia)&&(t.id=`${o(this,ia).id}_colorpicker_dropdown`);for(const[s,n]of o(this,Nn).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",n),r.title=s,r.setAttribute("data-l10n-id",o(Ys,Nm)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=n,r.ariaSelected=n===o(this,Wh),r.addEventListener("click",x(this,Vt,Q_).bind(this,n),{signal:e}),t.append(r)}return t.addEventListener("keydown",x(this,Vt,J_).bind(this),{signal:e}),t},Q_=function(t,e){e.stopPropagation(),o(this,km).dispatch("switchannotationeditorparams",{source:this,type:At.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)},J_=function(t){Ys._keyboardManager.exec(this,t)},pl=function(t){if(o(this,Vt,Pa)){this.hideDropdown();return}if(m(this,Om,t.detail===0),o(this,vo)||(m(this,vo,new AbortController),window.addEventListener("pointerdown",x(this,Vt,fk).bind(this),{signal:o(this,Nn).combinedSignal(o(this,vo))})),o(this,gi).ariaExpanded="true",o(this,Ve)){o(this,Ve).classList.remove("hidden");return}const e=m(this,Ve,x(this,Vt,W_).call(this));o(this,gi).append(e)},fk=function(t){var e;(e=o(this,Ve))!=null&&e.contains(t.target)||this.hideDropdown()},Pa=function(){return o(this,Ve)&&!o(this,Ve).classList.contains("hidden")},A(Ys,Nm,null);let Q0=Ys;var nr,Mm,Jh,Dm;const Sl=class Sl{constructor(t){A(this,nr,null);A(this,Mm,null);A(this,Jh,null);m(this,Mm,t),m(this,Jh,t._uiManager),o(Sl,Dm)||m(Sl,Dm,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(o(this,nr))return o(this,nr);const{editorType:t,colorType:e,color:s}=o(this,Mm),n=m(this,nr,document.createElement("input"));return n.type="color",n.value=s||"#000000",n.className="basicColorPicker",n.tabIndex=0,n.setAttribute("data-l10n-id",o(Sl,Dm)[t]),n.addEventListener("input",()=>{o(this,Jh).updateParams(e,n.value)},{signal:o(this,Jh)._signal}),n}update(t){o(this,nr)&&(o(this,nr).value=t)}destroy(){var t;(t=o(this,nr))==null||t.remove(),m(this,nr,null)}hideDropdown(){}};nr=new WeakMap,Mm=new WeakMap,Jh=new WeakMap,Dm=new WeakMap,A(Sl,Dm,null);let J0=Sl;function FE(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}function lf(i){return Math.max(0,Math.min(255,255*i))}class HE{static CMYK_G([t,e,s,n]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=lf(t),[t,t,t]}static G_HTML([t]){const e=FE(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_rgb(t){return t.map(lf)}static RGB_HTML(t){return`#${t.map(FE).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,s,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,s+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,s,n]){return[lf(1-Math.min(1,t+n)),lf(1-Math.min(1,s+n)),lf(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const n=1-t,r=1-e,a=1-s,l=Math.min(n,r,a);return["CMYK",n,r,a,l]}}class c4{create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),s||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Wt("Abstract method `_createSVG` called.")}}class Z0 extends c4{_createSVG(t){return document.createElementNS(Rr,t)}}const u4=9,Jc=new WeakSet,h4=new Date().getTimezoneOffset()*60*1e3;class Jv{static create(t){switch(t.data.annotationType){case Me.LINK:return new tx(t);case Me.TEXT:return new f4(t);case Me.WIDGET:switch(t.data.fieldType){case"Tx":return new g4(t);case"Btn":return t.data.radioButton?new pk(t):t.data.checkBox?new p4(t):new y4(t);case"Ch":return new b4(t);case"Sig":return new m4(t)}return new au(t);case Me.POPUP:return new tA(t);case Me.FREETEXT:return new _k(t);case Me.LINE:return new w4(t);case Me.SQUARE:return new _4(t);case Me.CIRCLE:return new A4(t);case Me.POLYLINE:return new Ak(t);case Me.CARET:return new x4(t);case Me.INK:return new ex(t);case Me.POLYGON:return new S4(t);case Me.HIGHLIGHT:return new Sk(t);case Me.UNDERLINE:return new E4(t);case Me.SQUIGGLY:return new T4(t);case Me.STRIKEOUT:return new C4(t);case Me.STAMP:return new xk(t);case Me.FILEATTACHMENT:return new R4(t);default:return new ye(t)}}}var gc,Zh,sn,jm,Z_;const lx=class lx{constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}={}){A(this,jm);A(this,gc,null);A(this,Zh,!1);A(this,sn,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(s)),n&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t!=null&&t.str||e!=null&&e.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return lx._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var s;const{data:t}=this,e=(s=this.annotationStorage)==null?void 0:s.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var l;const t=(l=this.annotationStorage)==null?void 0:l.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:s,rect:n}=this.data;let r=-1/0,a=-1/0;if((e==null?void 0:e.length)>=8){for(let c=0;c<e.length;c+=8)e[c+1]>a?(a=e[c+1],r=e[c+2]):e[c+1]===a&&(r=Math.max(r,e[c+2]));return[r,a]}if((s==null?void 0:s.length)>=1){for(const c of s)for(let u=0,h=c.length;u<h;u+=2)c[u+1]>a?(a=c[u+1],r=c[u]):c[u+1]===a&&(r=Math.max(r,c[u]));if(r!==1/0)return[r,a]}return n?[n[2],n[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:s,pageHeight:n,pageX:r,pageY:a}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-r)/s,t[1]=100*(t[1]-a)/n,t}get commentText(){var e,s,n;const{data:t}=this;return((s=(e=this.annotationStorage.getRawValue(`${yg}${t.id}`))==null?void 0:e.popup)==null?void 0:s.contents)||((n=t.contentsObj)==null?void 0:n.str)||""}set commentText(t){const{data:e}=this,s={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:s})||this.annotationStorage.setValue(`${yg}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){var t,e;(e=((t=o(this,sn))==null?void 0:t.popup)||this.popup)==null||e.remove(),m(this,sn,this.popup=null)}updateEdited(t){var r;if(!this.container)return;t.rect&&(o(this,gc)||m(this,gc,{rect:this.data.rect.slice(0)}));const{rect:e,popup:s}=t;e&&x(this,jm,Z_).call(this,e);let n=((r=o(this,sn))==null?void 0:r.popup)||this.popup;!n&&(s!=null&&s.text)&&(this._createPopup(s),n=o(this,sn).popup),n&&(n.updateEdited(t),s!=null&&s.deleted&&(n.remove(),m(this,sn,null),this.popup=null))}resetEdited(){var t;o(this,gc)&&(x(this,jm,Z_).call(this,o(this,gc).rect),(t=o(this,sn))==null||t.popup.resetEdited(),m(this,gc,null))}_createContainer(t){const{data:e,parent:{page:s,viewport:n}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",e.id),!(this instanceof au)&&!(this instanceof tx)&&(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(r.title=e.alternativeText),e.noRotate&&r.classList.add("norotate"),!e.rect||this instanceof tA){const{rotation:v}=e;return!e.hasOwnCanvas&&v!==0&&this.setRotation(v,r),r}const{width:l,height:c}=this;if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const v=e.borderStyle.horizontalCornerRadius,S=e.borderStyle.verticalCornerRadius;if(v>0||S>0){const w=`calc(${v}px * var(--total-scale-factor)) / calc(${S}px * var(--total-scale-factor))`;a.borderRadius=w}else if(this instanceof pk){const w=`calc(${l}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;a.borderRadius=w}switch(e.borderStyle.style){case _u.SOLID:a.borderStyle="solid";break;case _u.DASHED:a.borderStyle="dashed";break;case _u.BEVELED:nt("Unimplemented border style: beveled");break;case _u.INSET:nt("Unimplemented border style: inset");break;case _u.UNDERLINE:a.borderBottomStyle="solid";break}const p=e.borderColor||null;p?(m(this,Zh,!0),a.borderColor=$.makeHexColor(p[0]|0,p[1]|0,p[2]|0)):a.borderWidth=0}const u=$.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:g}=n.rawDims;a.left=`${100*(u[0]-f)/h}%`,a.top=`${100*(u[1]-g)/d}%`;const{rotation:b}=e;return e.hasOwnCanvas||b===0?(a.width=`${100*l/h}%`,a.height=`${100*c/d}%`):this.setRotation(b,r),r}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims;let{width:r,height:a}=this;t%180!==0&&([r,a]=[a,r]),e.style.width=`${100*r/s}%`,e.style.height=`${100*a/n}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,s,n)=>{const r=n.detail[e],a=r[0],l=r.slice(1);n.target.style[s]=HE[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[s]:HE[`${a}_rgb`](l)})};return ut(this,"_commonActions",{display:e=>{const{display:s}=e.detail,n=s%2===1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:s===1||s===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:s}=e.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const s=e.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const n of Object.keys(e.detail)){const r=t[n]||s[n];r==null||r(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[n,r]of Object.entries(e)){const a=s[n];if(a){const l={detail:{[n]:r},target:t};a(l),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,s,n,r]=this.data.rect.map(v=>Math.fround(v));if(t.length===8){const[v,S,p,w]=t.subarray(2,6);if(n===v&&r===S&&e===p&&s===w)return}const{style:a}=this.container;let l;if(o(this,Zh)){const{borderColor:v,borderWidth:S}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${v}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const c=n-e,u=r-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0),d.role="none";const f=h.createElement("defs");d.append(f);const g=h.createElement("clipPath"),b=`clippath_${this.data.id}`;g.setAttribute("id",b),g.setAttribute("clipPathUnits","objectBoundingBox"),f.append(g);for(let v=2,S=t.length;v<S;v+=8){const p=t[v],w=t[v+1],y=t[v+2],E=t[v+3],T=h.createElement("rect"),C=(y-e)/c,R=(r-w)/u,O=(p-y)/c,k=(w-E)/u;T.setAttribute("x",C),T.setAttribute("y",R),T.setAttribute("width",O),T.setAttribute("height",k),g.append(T),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${C}" y="${R}" width="${O}" height="${k}"/>`)}o(this,Zh)&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(d),this.container.style.clipPath=`url(#${b})`}_createPopup(t=null){const{data:e}=this;let s,n;t?(s={str:t.text},n=t.date):(s=e.contentsObj,n=e.modificationDate),m(this,sn,new tA({data:{color:e.color,titleObj:e.titleObj,modificationDate:n,contentsObj:s,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(o(this,sn)||this.popup||this.data.popupRef)}get extraPopupElement(){return o(this,sn)}render(){Wt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:r,id:a,exportValues:l}of n){if(r===-1||a===e)continue;const c=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!Jc.has(u)){nt(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:c,domElement:u})}return s}for(const n of document.getElementsByName(t)){const{exportValue:r}=n,a=n.getAttribute("data-element-id");a!==e&&Jc.has(n)&&s.push({id:a,exportValue:r,domElement:n})}return s}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};gc=new WeakMap,Zh=new WeakMap,sn=new WeakMap,jm=new WeakSet,Z_=function(t){const{container:{style:e},data:{rect:s,rotation:n},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:l,pageY:c}}}}=this;s==null||s.splice(0,4,...t),e.left=`${100*(t[0]-l)/r}%`,e.top=`${100*(a-t[3]+c)/a}%`,n===0?(e.width=`${100*(t[2]-t[0])/r}%`,e.height=`${100*(t[3]-t[1])/a}%`):this.setRotation(n)};let ye=lx;class d4 extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var Ni,yl,gk,mk;class tx extends ye{constructor(e,s=null){super(e,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});A(this,Ni);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:s}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let r=!1;return e.url?(s.addLinkAttributes(n,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),r=!0):e.attachment?(x(this,Ni,gk).call(this,n,e.attachment,e.overlaidText,e.attachmentDest),r=!0):e.setOCGState?(x(this,Ni,mk).call(this,n,e.setOCGState,e.overlaidText),r=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),r=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=n,this.container.append(n)),this.container}_bindLink(e,s,n=""){e.href=this.linkService.getDestinationHash(s),e.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&x(this,Ni,yl).call(this),n&&(e.title=n)}_bindNamedAction(e,s,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(s),!1),n&&(e.title=n),x(this,Ni,yl).call(this)}_bindJSAction(e,s){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=n.get(r);a&&(e[a]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}s.overlaidText&&(e.title=s.overlaidText),e.onclick||(e.onclick=()=>!1),x(this,Ni,yl).call(this)}_bindResetFormAction(e,s){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),x(this,Ni,yl).call(this),!this._fieldObjects){nt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{var d;n==null||n();const{fields:r,refs:a,include:l}=s,c=[];if(r.length!==0||a.length!==0){const f=new Set(a);for(const g of r){const b=this._fieldObjects[g]||[];for(const{id:v}of b)f.add(v)}for(const g of Object.values(this._fieldObjects))for(const b of g)f.has(b.id)===l&&c.push(b)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,h=[];for(const f of c){const{id:g}=f;switch(h.push(g),f.type){case"text":{const v=f.defaultValue||"";u.setValue(g,{value:v});break}case"checkbox":case"radiobutton":{const v=f.defaultValue===f.exportValues;u.setValue(g,{value:v});break}case"combobox":case"listbox":{const v=f.defaultValue||"";u.setValue(g,{value:v});break}default:continue}const b=document.querySelector(`[data-element-id="${g}"]`);if(b){if(!Jc.has(b)){nt(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Ni=new WeakSet,yl=function(){this.container.setAttribute("data-internal-link","")},gk=function(e,s,n="",r=null){e.href=this.linkService.getAnchorUrl(""),s.description?e.title=s.description:n&&(e.title=n),e.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(s.content,s.filename,r),!1},x(this,Ni,yl).call(this)},mk=function(e,s,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(s),!1),n&&(e.title=n),x(this,Ni,yl).call(this)};class f4 extends ye{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class au extends ye{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return _s.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,s,n,r){s.includes("mouse")?t.addEventListener(s,a=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(s,a=>{var l;if(s==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(s==="focus"){if(e.focused)return;e.focused=!0}r&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:r(a)}}))})}_setEventListeners(t,e,s,n){var r,a,l;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,c,u,n),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(t,e,"blur","Blur",null):u==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":$.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||u4,r=t.style;let a;const l=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),h=Math.round(u/(qv*n))||1,d=u/h;a=Math.min(n,c(d/qv))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(n,c(u/qv))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=$.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class g4 extends au{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,s,n){const r=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=s),r.setValue(a.id,{[n]:s})}render(){var n,r;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let l=a.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=a.formattedValue||((n=this.data.textContent)==null?void 0:n.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Jc.add(s),this.contentElement=s,s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:d,datetimeType:f,timeStep:g}=this.data,b=!!f&&this.enableScripting;d&&(s.title=d),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",S=>{t.setValue(e,{value:S.target.value}),this.setPropertyOnSiblings(s,"value",S.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",S=>{const p=this.data.defaultFieldValue??"";s.value=h.userValue=p,h.formattedValue=null});let v=S=>{const{formattedValue:p}=h;p!=null&&(S.target.value=p),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",p=>{var y;if(h.focused)return;const{target:w}=p;if(b&&(w.type=f,g&&(w.step=g)),h.userValue){const E=h.userValue;if(b)if(f==="time"){const T=new Date(E),C=[T.getHours(),T.getMinutes(),T.getSeconds()];w.value=C.map(R=>R.toString().padStart(2,"0")).join(":")}else w.value=new Date(E-h4).toISOString().split(f==="date"?"T":".",1)[0];else w.value=E}h.lastCommittedValue=w.value,h.commitKey=1,(y=this.data.actions)!=null&&y.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const w={value(y){h.userValue=y.detail.value??"",b||t.setValue(e,{value:h.userValue.toString()}),y.target.value=h.userValue},formattedValue(y){const{formattedValue:E}=y.detail;h.formattedValue=E,E!=null&&y.target!==document.activeElement&&(y.target.value=E);const T={formattedValue:E};b&&(T.value=E),t.setValue(e,T)},selRange(y){y.target.setSelectionRange(...y.detail.selRange)},charLimit:y=>{var R;const{charLimit:E}=y.detail,{target:T}=y;if(E===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",E);let C=h.userValue;!C||C.length<=E||(C=C.slice(0,E),T.value=h.userValue=C,t.setValue(e,{value:C}),(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(w,p)}),s.addEventListener("keydown",p=>{var E;h.commitKey=1;let w=-1;if(p.key==="Escape"?w=0:p.key==="Enter"&&!this.data.multiLine?w=2:p.key==="Tab"&&(h.commitKey=3),w===-1)return;const{value:y}=p.target;h.lastCommittedValue!==y&&(h.lastCommittedValue=y,h.userValue=y,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,willCommit:!0,commitKey:w,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const S=v;v=null,s.addEventListener("blur",p=>{var E,T;if(!h.focused||!p.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(h.focused=!1);const{target:w}=p;let{value:y}=w;if(b){if(y&&f==="time"){const C=y.split(":").map(R=>parseInt(R,10));y=new Date(2e3,0,1,C[0],C[1],C[2]||0).valueOf(),w.step=""}else y.includes("T")||(y=`${y}T00:00`),y=new Date(y).valueOf();w.type="text"}h.userValue=y,h.lastCommittedValue!==y&&((T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,willCommit:!0,commitKey:h.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),S(p)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",p=>{var k;h.lastCommittedValue=null;const{data:w,target:y}=p,{value:E,selectionStart:T,selectionEnd:C}=y;let R=T,O=C;switch(p.inputType){case"deleteWordBackward":{const D=E.substring(0,T).match(/\w*[^\w]*$/);D&&(R-=D[0].length);break}case"deleteWordForward":{const D=E.substring(T).match(/^[^\w]*\w*/);D&&(O+=D[0].length);break}case"deleteContentBackward":T===C&&(R-=1);break;case"deleteContentForward":T===C&&(O+=1);break}p.preventDefault(),(k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,change:w||"",willCommit:!1,selStart:R,selEnd:O}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(v&&s.addEventListener("blur",v),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class m4 extends au{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class p4 extends au{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let n=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;typeof n=="string"&&(n=n!=="Off",t.setValue(s,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return Jc.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.setAttribute("exportValue",e.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const u of this._getElementsByName(l,s)){const h=c&&u.exportValue===e.exportValue;u.domElement&&(u.domElement.checked=h),t.setValue(u.id,{value:h})}t.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const l=e.defaultFieldValue||"Off";a.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const l={value(c){c.target.checked=c.detail.value!=="Off",t.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class pk extends au{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let n=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if(typeof n=="string"&&(n=n!==e.buttonValue,t.setValue(s,{value:n})),n)for(const a of this._getElementsByName(e.fieldName,s))t.setValue(a.id,{value:!1});const r=document.createElement("input");if(Jc.add(r),r.setAttribute("data-element-id",s),r.disabled=e.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=e.fieldName,n&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:l,checked:c}=a.target;for(const u of this._getElementsByName(l,s))t.setValue(u.id,{value:!1});t.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const l=e.defaultFieldValue;a.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;r.addEventListener("updatefromsandbox",l=>{const c={value:u=>{const h=a===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===s;d.domElement&&(d.domElement.checked=f),t.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class y4 extends tx{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class b4 extends au{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");Jc.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of n.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),r=!1),n.append(d)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),n.prepend(h),a=()=>{h.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const l=h=>{const d=h?"value":"textContent",{options:f,multiple:g}=n;return g?Array.prototype.filter.call(f,b=>b.selected).map(b=>b[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=l(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",h=>{const d={value(f){a==null||a();const g=f.detail.value,b=new Set(Array.isArray(g)?g:[g]);for(const v of n.options)v.selected=b.has(v.value);t.setValue(e,{value:l(!0)}),c=l(!1)},multipleSelection(f){n.multiple=!0},remove(f){const g=n.options,b=f.detail.remove;g[b].selected=!1,n.remove(b),g.length>0&&Array.prototype.findIndex.call(g,S=>S.selected)===-1&&(g[0].selected=!0),t.setValue(e,{value:l(!0),items:u(f)}),c=l(!1)},clear(f){for(;n.length!==0;)n.remove(0);t.setValue(e,{value:null,items:[]}),c=l(!1)},insert(f){const{index:g,displayValue:b,exportValue:v}=f.detail.insert,S=n.children[g],p=document.createElement("option");p.textContent=b,p.value=v,S?S.before(p):n.append(p),t.setValue(e,{value:l(!0),items:u(f)}),c=l(!1)},items(f){const{items:g}=f.detail;for(;n.length!==0;)n.remove(0);for(const b of g){const{displayValue:v,exportValue:S}=b,p=document.createElement("option");p.textContent=v,p.value=S,n.append(p)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:l(!0),items:u(f)}),c=l(!1)},indices(f){const g=new Set(f.detail.indices);for(const b of f.target.options)b.selected=g.has(b.index);t.setValue(e,{value:l(!0)}),c=l(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),n.addEventListener("input",h=>{var g;const d=l(!0),f=l(!1);t.setValue(e,{value:d}),h.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:c,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):n.addEventListener("input",function(h){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}var Lm,eA;class tA extends ye{constructor(e){const{data:s,elements:n,parent:r}=e,a=!!r._commentManager;super(e,{isRenderable:!a&&ye._hasPopupData(s)});A(this,Lm);if(this.elements=n,a&&ye._hasPopupData(s)){const l=this.popup=x(this,Lm,eA).call(this);for(const c of n)c.popup=l}else this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const s=this.popup=x(this,Lm,eA).call(this),n=[];for(const r of this.elements)r.popup=s,r.container.ariaHasPopup="dialog",n.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(r=>`${Fu}${r}`).join(",")),this.container}}Lm=new WeakSet,eA=function(){return new v4({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var mi,wo,mb,pb,td,ed,_e,rr,_o,mc,sd,id,ar,pi,na,ra,Ae,aa,Ao,Pm,oa,nd,pc,So,Je,xo,ft,$y,sA,iA,nA,qy,rA,yk,bk,vk,wk,Gy,Vy,aA;class v4{constructor({container:t,color:e,elements:s,titleObj:n,modificationDate:r,contentsObj:a,richText:l,parent:c,rect:u,parentRect:h,open:d,commentManager:f=null}){A(this,ft);A(this,mi,null);A(this,wo,x(this,ft,vk).bind(this));A(this,mb,x(this,ft,aA).bind(this));A(this,pb,x(this,ft,Vy).bind(this));A(this,td,x(this,ft,Gy).bind(this));A(this,ed,null);A(this,_e,null);A(this,rr,null);A(this,_o,null);A(this,mc,null);A(this,sd,null);A(this,id,null);A(this,ar,!1);A(this,pi,null);A(this,na,null);A(this,ra,null);A(this,Ae,null);A(this,aa,null);A(this,Ao,null);A(this,Pm,null);A(this,oa,null);A(this,nd,null);A(this,pc,null);A(this,So,!1);A(this,Je,null);A(this,xo,null);m(this,_e,t),m(this,nd,n),m(this,rr,a),m(this,oa,l),m(this,sd,c),m(this,ed,e),m(this,Pm,u),m(this,id,h),m(this,mc,s),m(this,mi,f),m(this,Je,s[0]),m(this,_o,G0.toDateObject(r)),this.trigger=s.flatMap(g=>g.getElementsToTriggerPopup()),f||(x(this,ft,$y).call(this),o(this,_e).hidden=!0,d&&x(this,ft,Gy).call(this))}renderCommentButton(){if(o(this,Ae)){o(this,Ae).parentNode||o(this,Je).container.after(o(this,Ae));return}if(o(this,aa)||x(this,ft,sA).call(this),!o(this,aa))return;const{signal:t}=m(this,na,new AbortController),e=o(this,Je).hasOwnCommentButton,s=()=>{o(this,mi).toggleCommentPopup(this,!0,void 0,!e)},n=()=>{o(this,mi).toggleCommentPopup(this,!1,!0,!e)},r=()=>{o(this,mi).toggleCommentPopup(this,!1,!1)};if(e){m(this,Ae,o(this,Je).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",o(this,wo),{signal:t}),a.addEventListener("click",s,{signal:t}),a.addEventListener("pointerenter",n,{signal:t}),a.addEventListener("pointerleave",r,{signal:t}),a.classList.add("popupTriggerArea")}else{const a=m(this,Ae,document.createElement("button"));a.className="annotationCommentButton";const l=o(this,Je).container;a.style.zIndex=l.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),x(this,ft,nA).call(this),x(this,ft,iA).call(this),a.addEventListener("keydown",o(this,wo),{signal:t}),a.addEventListener("click",s,{signal:t}),a.addEventListener("pointerenter",n,{signal:t}),a.addEventListener("pointerleave",r,{signal:t}),l.after(a)}}get commentButtonColor(){const{color:t,opacity:e}=o(this,Je).commentData;return t?o(this,sd)._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{var t;(t=o(this,Ae))==null||t.focus()},0)}getData(){const{richText:t,color:e,opacity:s,creationDate:n,modificationDate:r}=o(this,Je).commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:s,creationDate:n,modificationDate:r}}get elementBeforePopup(){return o(this,Ae)}get comment(){return o(this,xo)||m(this,xo,o(this,Je).commentText),o(this,xo)}set comment(t){t!==this.comment&&(o(this,Je).commentText=m(this,xo,t))}focus(){var t;(t=o(this,Je).container)==null||t.focus()}get parentBoundingClientRect(){return o(this,Je).layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){o(this,Ae)&&(o(this,Ae).classList.toggle("selected",t),o(this,Ae).ariaExpanded=e)}setSelectedCommentButton(t){o(this,Ae).classList.toggle("selected",t)}get commentPopupPosition(){if(o(this,Ao))return o(this,Ao);const{x:t,y:e,height:s}=o(this,Ae).getBoundingClientRect(),{x:n,y:r,width:a,height:l}=o(this,Je).layer.getBoundingClientRect();return[(t-n)/a,(e+s-r)/l]}set commentPopupPosition(t){m(this,Ao,t)}hasDefaultPopupPosition(){return o(this,Ao)===null}get commentButtonPosition(){return o(this,aa)}get commentButtonWidth(){return o(this,Ae).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,s]=o(this,Ao)||this.commentButtonPosition.map(u=>u/100),n=this.parentBoundingClientRect,{x:r,y:a,width:l,height:c}=n;o(this,mi).showDialog(null,this,r+e*l,a+s*c,{...t,parentDimensions:n})}render(){var s,n;if(o(this,pi))return;const t=m(this,pi,document.createElement("div"));if(t.className="popup",o(this,ed)){const r=t.style.outlineColor=$.makeHexColor(...o(this,ed));t.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const e=document.createElement("span");if(e.className="header",(s=o(this,nd))!=null&&s.str){const r=document.createElement("span");r.className="title",e.append(r),{dir:r.dir,str:r.textContent}=o(this,nd)}if(t.append(e),o(this,_o)){const r=document.createElement("time");r.className="popupDate",r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:o(this,_o).valueOf()})),r.dateTime=o(this,_o).toISOString(),e.append(r)}oO({html:o(this,ft,qy)||o(this,rr).str,dir:(n=o(this,rr))==null?void 0:n.dir,className:"popupContent"},t),o(this,_e).append(t)}updateEdited({rect:t,popup:e,deleted:s}){var n;if(o(this,mi)){s?(this.remove(),m(this,xo,null)):e&&(e.deleted?this.remove():(x(this,ft,nA).call(this),m(this,xo,e.text))),t&&(m(this,aa,null),x(this,ft,sA).call(this),x(this,ft,iA).call(this));return}if(s||e!=null&&e.deleted){this.remove();return}x(this,ft,$y).call(this),o(this,pc)||m(this,pc,{contentsObj:o(this,rr),richText:o(this,oa)}),t&&m(this,ra,null),e&&e.text&&(m(this,oa,x(this,ft,bk).call(this,e.text)),m(this,_o,G0.toDateObject(e.date)),m(this,rr,null)),(n=o(this,pi))==null||n.remove(),m(this,pi,null)}resetEdited(){var t;o(this,pc)&&({contentsObj:Fe(this,rr)._,richText:Fe(this,oa)._}=o(this,pc),m(this,pc,null),(t=o(this,pi))==null||t.remove(),m(this,pi,null),m(this,ra,null))}remove(){var t,e,s;if((t=o(this,na))==null||t.abort(),m(this,na,null),(e=o(this,pi))==null||e.remove(),m(this,pi,null),m(this,So,!1),m(this,ar,!1),(s=o(this,Ae))==null||s.remove(),m(this,Ae,null),this.trigger)for(const n of this.trigger)n.classList.remove("popupTriggerArea")}forceHide(){m(this,So,this.isVisible),o(this,So)&&(o(this,_e).hidden=!0)}maybeShow(){o(this,mi)||(x(this,ft,$y).call(this),o(this,So)&&(o(this,pi)||x(this,ft,Vy).call(this),m(this,So,!1),o(this,_e).hidden=!1))}get isVisible(){return o(this,mi)?!1:o(this,_e).hidden===!1}}mi=new WeakMap,wo=new WeakMap,mb=new WeakMap,pb=new WeakMap,td=new WeakMap,ed=new WeakMap,_e=new WeakMap,rr=new WeakMap,_o=new WeakMap,mc=new WeakMap,sd=new WeakMap,id=new WeakMap,ar=new WeakMap,pi=new WeakMap,na=new WeakMap,ra=new WeakMap,Ae=new WeakMap,aa=new WeakMap,Ao=new WeakMap,Pm=new WeakMap,oa=new WeakMap,nd=new WeakMap,pc=new WeakMap,So=new WeakMap,Je=new WeakMap,xo=new WeakMap,ft=new WeakSet,$y=function(){var e;if(o(this,na))return;m(this,na,new AbortController);const{signal:t}=o(this,na);for(const s of this.trigger)s.addEventListener("click",o(this,td),{signal:t}),s.addEventListener("pointerenter",o(this,pb),{signal:t}),s.addEventListener("pointerleave",o(this,mb),{signal:t}),s.classList.add("popupTriggerArea");for(const s of o(this,mc))(e=s.container)==null||e.addEventListener("keydown",o(this,wo),{signal:t})},sA=function(){const t=o(this,mc).find(e=>e.hasCommentButton);t&&m(this,aa,t._normalizePoint(t.commentButtonPosition))},iA=function(){if(o(this,Je).extraPopupElement&&!o(this,Je).editor)return;o(this,Ae)||this.renderCommentButton();const[t,e]=o(this,aa),{style:s}=o(this,Ae);s.left=`calc(${t}%)`,s.top=`calc(${e}% - var(--comment-button-dim))`},nA=function(){o(this,Je).extraPopupElement||(o(this,Ae)||this.renderCommentButton(),o(this,Ae).style.backgroundColor=this.commentButtonColor||"")},qy=function(){const t=o(this,oa),e=o(this,rr);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&o(this,oa).html||null},rA=function(){var t,e,s;return((s=(e=(t=o(this,ft,qy))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:s.fontSize)||0},yk=function(){var t,e,s;return((s=(e=(t=o(this,ft,qy))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:s.color)||null},bk=function(t){const e=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:o(this,ft,yk),fontSize:o(this,ft,rA)?`calc(${o(this,ft,rA)}px * var(--total-scale-factor))`:""}};for(const r of t.split(`
`))e.push({name:"span",value:r,attributes:n});return s},vk=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&o(this,ar))&&x(this,ft,Gy).call(this)},wk=function(){if(o(this,ra)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:n,pageY:r}}}=o(this,sd);let a=!!o(this,id),l=a?o(this,id):o(this,Pm);for(const b of o(this,mc))if(!l||$.intersect(b.data.rect,l)!==null){l=b.data.rect,a=!0;break}const c=$.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),h=a?l[2]-l[0]+5:0,d=c[0]+h,f=c[1];m(this,ra,[100*(d-n)/e,100*(f-r)/s]);const{style:g}=o(this,_e);g.left=`${o(this,ra)[0]}%`,g.top=`${o(this,ra)[1]}%`},Gy=function(){if(o(this,mi)){o(this,mi).toggleCommentPopup(this,!1);return}m(this,ar,!o(this,ar)),o(this,ar)?(x(this,ft,Vy).call(this),o(this,_e).addEventListener("click",o(this,td)),o(this,_e).addEventListener("keydown",o(this,wo))):(x(this,ft,aA).call(this),o(this,_e).removeEventListener("click",o(this,td)),o(this,_e).removeEventListener("keydown",o(this,wo)))},Vy=function(){o(this,pi)||this.render(),this.isVisible?o(this,ar)&&o(this,_e).classList.add("focused"):(x(this,ft,wk).call(this),o(this,_e).hidden=!1,o(this,_e).style.zIndex=parseInt(o(this,_e).style.zIndex)+1e3)},aA=function(){o(this,_e).classList.remove("focused"),!(o(this,ar)||!this.isVisible)&&(o(this,_e).hidden=!0,o(this,_e).style.zIndex=parseInt(o(this,_e).style.zIndex)-1e3)};class _k extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=ot.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Bm;class w4 extends ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});A(this,Bm,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:s,height:n}=this,r=this.svgFactory.create(s,n,!0),a=m(this,Bm,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,Bm)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bm=new WeakMap;var Im;class _4 extends ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});A(this,Im,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:s,height:n}=this,r=this.svgFactory.create(s,n,!0),a=e.borderStyle.width,l=m(this,Im,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",s-a),l.setAttribute("height",n-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,Im)}addHighlightArea(){this.container.classList.add("highlightArea")}}Im=new WeakMap;var Um;class A4 extends ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});A(this,Um,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:s,height:n}=this,r=this.svgFactory.create(s,n,!0),a=e.borderStyle.width,l=m(this,Um,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",s/2),l.setAttribute("cy",n/2),l.setAttribute("rx",s/2-a/2),l.setAttribute("ry",n/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,Um)}addHighlightArea(){this.container.classList.add("highlightArea")}}Um=new WeakMap;var zm;class Ak extends ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});A(this,zm,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:s,borderStyle:n,popupRef:r},width:a,height:l}=this;if(!s)return this.container;const c=this.svgFactory.create(a,l,!0);let u=[];for(let d=0,f=s.length;d<f;d+=2){const g=s[d]-e[0],b=e[3]-s[d+1];u.push(`${g},${b}`)}u=u.join(" ");const h=m(this,zm,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,zm)}addHighlightArea(){this.container.classList.add("highlightArea")}}zm=new WeakMap;class S4 extends Ak{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class x4 extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var Fm,yc,Hm,oA;class ex extends ye{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});A(this,Hm);A(this,Fm,null);A(this,yc,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ot.HIGHLIGHT:ot.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:s,inkLists:n,borderStyle:r,popupRef:a}}=this,{transform:l,width:c,height:u}=x(this,Hm,oA).call(this,s,e),h=this.svgFactory.create(c,u,!0),d=m(this,Fm,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",l);for(let f=0,g=n.length;f<g;f++){const b=this.svgFactory.createElement(this.svgElementName);o(this,yc).push(b),b.setAttribute("points",n[f].join(",")),d.append(b)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:s,points:n,rect:r}=e,a=o(this,Fm);if(s>=0&&a.setAttribute("stroke-width",s||1),n)for(let l=0,c=o(this,yc).length;l<c;l++)o(this,yc)[l].setAttribute("points",n[l].join(","));if(r){const{transform:l,width:c,height:u}=x(this,Hm,oA).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),a.setAttribute("transform",l)}}getElementsToTriggerPopup(){return o(this,yc)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fm=new WeakMap,yc=new WeakMap,Hm=new WeakSet,oA=function(e,s){switch(e){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class Sk extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ot.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class E4 extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class T4 extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class C4 extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=t,this.container.append(s)}return this.container}}class xk extends ye{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ot.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var $m,qm,lA;class R4 extends ye{constructor(e){var n;super(e,{isRenderable:!0});A(this,qm);A(this,$m,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(n=this.linkService.eventBus)==null||n.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:s}=this;let n;s.hasAppearance||s.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),n.addEventListener("dblclick",x(this,qm,lA).bind(this)),m(this,$m,n);const{isMac:r}=_s.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&x(this,qm,lA).call(this)}),!s.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return o(this,$m)}addHighlightArea(){this.container.classList.add("highlightArea")}}$m=new WeakMap,qm=new WeakSet,lA=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var bc,vc,rd,Eo,Gm,wc,yi,Vm,xa,Xy,uA;const cx=class cx{constructor({div:t,accessibilityManager:e,annotationCanvasMap:s,annotationEditorUIManager:n,page:r,viewport:a,structTreeLayer:l,commentManager:c,linkService:u,annotationStorage:h}){A(this,xa);A(this,bc,null);A(this,vc,null);A(this,rd,null);A(this,Eo,new Map);A(this,Gm,null);A(this,wc,null);A(this,yi,[]);A(this,Vm,!1);this.div=t,m(this,bc,e),m(this,vc,s),m(this,Gm,l||null),m(this,wc,u||null),m(this,rd,h||new QS),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n,this._commentManager=c||null}hasEditableAnnotations(){return o(this,Eo).size>0}async render(t){var l;const{annotations:e}=t,s=this.div;Wc(s,this.viewport);const n=new Map,r=[],a={data:null,layer:s,linkService:o(this,wc),downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Z0,annotationStorage:o(this,rd),enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const c of e){if(c.noHTML)continue;const u=c.annotationType===Me.POPUP;if(u){const f=n.get(c.id);if(!f)continue;if(!this._commentManager){r.push(c);continue}a.elements=f}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;a.data=c;const h=Jv.create(a);if(!h.isRenderable)continue;if(!u&&(o(this,yi).push(h),c.popupRef)){const f=n.get(c.popupRef);f?f.push(h):n.set(c.popupRef,[h])}const d=h.render();c.hidden&&(d.style.visibility="hidden"),h._isEditable&&(o(this,Eo).set(h.data.id,h),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(h))}await x(this,xa,Xy).call(this);for(const c of r){const u=a.elements=n.get(c.id);a.data=c;const h=Jv.create(a);if(!h.isRenderable)continue;const d=h.render();h.contentElement.id=`${Fu}${c.id}`,c.hidden&&(d.style.visibility="hidden"),u.at(-1).container.after(d)}x(this,xa,uA).call(this)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:o(this,wc),svgFactory:new Z0,parent:this};for(const s of t){s.borderStyle||(s.borderStyle=cx._defaultBorderStyle),e.data=s;const n=Jv.create(e);n.isRenderable&&(n.render(),n.contentElement.id=`${Fu}${s.id}`,o(this,yi).push(n))}await x(this,xa,Xy).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,Wc(e,{rotation:t.rotation}),x(this,xa,uA).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(o(this,Eo).values())}getEditableAnnotation(t){return o(this,Eo).get(t)}addFakeAnnotation(t){const{div:e}=this,{id:s,rotation:n}=t,r=new d4({data:{id:s,rect:t.getPDFRect(),rotation:n},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:o(this,wc),annotationStorage:o(this,rd)});return r.render(),r.contentElement.id=`${Fu}${s}`,r.createOrUpdatePopup(),o(this,yi).push(r),r}removeAnnotation(t){var n;const e=o(this,yi).findIndex(r=>r.data.id===t);if(e<0)return;const[s]=o(this,yi).splice(e,1);(n=o(this,bc))==null||n.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);x(this,xa,Xy).call(this)}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return ut(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:_u.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};bc=new WeakMap,vc=new WeakMap,rd=new WeakMap,Eo=new WeakMap,Gm=new WeakMap,wc=new WeakMap,yi=new WeakMap,Vm=new WeakMap,xa=new WeakSet,Xy=async function(){var s,n,r;if(o(this,yi).length===0)return;this.div.replaceChildren();const t=[];if(!o(this,Vm)){m(this,Vm,!0);for(const{contentElement:a,data:{id:l}}of o(this,yi)){const c=a.id=`${Fu}${l}`;t.push((s=o(this,Gm))==null?void 0:s.getAriaAttributes(c).then(u=>{if(u)for(const[h,d]of u)a.setAttribute(h,d)}))}}o(this,yi).sort(({data:{rect:[a,l,c,u]}},{data:{rect:[h,d,f,g]}})=>{if(a===c&&l===u)return 1;if(h===f&&d===g)return-1;const b=u,v=l,S=(l+u)/2,p=g,w=d,y=(d+g)/2;if(S>=p&&y<=v)return-1;if(y>=b&&S<=w)return 1;const E=(a+c)/2,T=(h+f)/2;return E-T});const e=document.createDocumentFragment();for(const a of o(this,yi))e.append(a.container),this._commentManager?(r=((n=a.extraPopupElement)==null?void 0:n.popup)||a.popup)==null||r.renderCommentButton():a.extraPopupElement&&e.append(a.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),o(this,bc))for(const a of o(this,yi))o(this,bc).addPointerInTextLayer(a.contentElement,!1)},uA=function(){var e;if(!o(this,vc))return;const t=this.div;for(const[s,n]of o(this,vc)){const r=t.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;n.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):r.append(n);const l=o(this,Eo).get(s);l&&(l._hasNoCanvas?((e=this._annotationEditorUIManager)==null||e.setMissingCanvas(s,r.id,n),l._hasNoCanvas=!1):l.canvas=n)}o(this,vc).clear()};let cA=cx;const hy=/\r\n?|\n/g;var bi,Xm,_c,vi,Ue,Ek,Tk,Ck,Yy,Ea,Ky,Wy,Rk,dA,Ok;const ne=class ne extends ee{constructor(e){super({...e,name:"freeTextEditor"});A(this,Ue);A(this,bi,"");A(this,Xm,`${this.id}-editor`);A(this,_c,null);A(this,vi);B(this,"_colorPicker",null);this.color=e.color||ne._defaultColor||ee._defaultLineColor,m(this,vi,e.fontSize||ne._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const e=ne.prototype,s=a=>a.isEmpty(),n=Qc.TRANSLATE_SMALL,r=Qc.TRANSLATE_BIG;return ut(this,"_keyboardManager",new Rp([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(e,s){ee.initialize(e,s);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,s){switch(e){case At.FREETEXT_SIZE:ne._defaultFontSize=s;break;case At.FREETEXT_COLOR:ne._defaultColor=s;break}}updateParams(e,s){switch(e){case At.FREETEXT_SIZE:x(this,Ue,Ek).call(this,s);break;case At.FREETEXT_COLOR:x(this,Ue,Tk).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[At.FREETEXT_SIZE,ne._defaultFontSize],[At.FREETEXT_COLOR,ne._defaultColor||ee._defaultLineColor]]}get propertiesToUpdate(){return[[At.FREETEXT_SIZE,o(this,vi)],[At.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new J0(this)),[["colorPicker",this._colorPicker]]}get colorType(){return At.FREETEXT_COLOR}onUpdatedColor(){var e;this.editorDiv.style.color=this.color,(e=this._colorPicker)==null||e.update(this.color),super.onUpdatedColor()}_translateEmpty(e,s){this._uiManager.translateSelectedEditors(e,s,!0)}getInitialTranslation(){const e=this.parentScale;return[-ne._internalPadding*e,-(ne._internalPadding+o(this,vi))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,_c,new AbortController);const e=this._uiManager.combinedSignal(o(this,_c));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",o(this,Xm)),this._isDraggable=!0,(e=o(this,_c))==null||e.abort(),m(this,_c,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var s;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=o(this,bi),s=m(this,bi,x(this,Ue,Ck).call(this).trimEnd());if(e===s)return;const n=r=>{if(m(this,bi,r),!r){this.remove();return}x(this,Ue,Wy).call(this),this._uiManager.rebuild(this),x(this,Ue,Yy).call(this)};this.addCommands({cmd:()=>{n(s)},undo:()=>{n(e)},mustExec:!1}),x(this,Ue,Yy).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){ne._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,s;(this._isCopy||this.annotationElementId)&&(e=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",o(this,Xm)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${o(this,vi)}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,d]=this.pageDimensions,[f,g]=this.pageTranslation;let b,v;switch(this.rotation){case 0:b=e+(l[0]-f)/h,v=s+this.height-(l[1]-g)/d;break;case 90:b=e+(l[0]-f)/h,v=s-(l[1]-g)/d,[c,u]=[u,-c];break;case 180:b=e-this.width+(l[0]-f)/h,v=s-(l[1]-g)/d,[c,u]=[-c,-u];break;case 270:b=e+(l[0]-f-this.height*d)/h,v=s+(l[1]-g-this.width*h)/d,[c,u]=[-u,c];break}this.setAt(b*r,v*a,c,u)}else this._moveAfterPaste(e,s);x(this,Ue,Wy).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var b,v,S;const s=e.clipboardData||window.clipboardData,{types:n}=s;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const r=x(b=ne,Ea,dA).call(b,s.getData("text")||"").replaceAll(hy,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!r.includes(`
`)){l.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:u}=l,h=[],d=[];if(c.nodeType===Node.TEXT_NODE){const p=c.parentElement;if(d.push(c.nodeValue.slice(u).replaceAll(hy,"")),p!==this.editorDiv){let w=h;for(const y of this.editorDiv.childNodes){if(y===p){w=d;continue}w.push(x(v=ne,Ea,Ky).call(v,y))}}h.push(c.nodeValue.slice(0,u).replaceAll(hy,""))}else if(c===this.editorDiv){let p=h,w=0;for(const y of this.editorDiv.childNodes)w++===u&&(p=d),p.push(x(S=ne,Ea,Ky).call(S,y))}m(this,bi,`${h.join(`
`)}${r}${d.join(`
`)}`),x(this,Ue,Wy).call(this);const f=new Range;let g=Math.sumPrecise(h.map(p=>p.length));for(const{firstChild:p}of this.editorDiv.childNodes)if(p.nodeType===Node.TEXT_NODE){const w=p.nodeValue.length;if(g<=w){f.setStart(p,g),f.setEnd(p,g);break}g-=w}a.removeAllRanges(),a.addRange(f)}get contentDiv(){return this.editorDiv}getPDFRect(){const e=ne._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,s,n){var l;let r=null;if(e instanceof _k){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:d,id:f,popupRef:g,richText:b,contentsObj:v,creationDate:S,modificationDate:p},textContent:w,textPosition:y,parent:{page:{pageNumber:E}}}=e;if(!w||w.length===0)return null;r=e={annotationType:ot.FREETEXT,color:Array.from(u),fontSize:c,value:w.join(`
`),position:y,pageIndex:E-1,rect:h.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:g,comment:(v==null?void 0:v.str)||null,richText:b,creationDate:S,modificationDate:p}}const a=await super.deserialize(e,s,n);return m(a,vi,e.fontSize),a.color=$.makeHexColor(...e.color),m(a,bi,x(l=ne,Ea,dA).call(l,e.value)),a._initialData=r,e.comment&&a.setCommentData(e),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=ee._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:s,fontSize:o(this,vi),value:x(this,Ue,Rk).call(this)});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!x(this,Ue,Ok).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){const s=super.renderAnnotationElement(e);if(!s)return null;const{style:n}=s;n.fontSize=`calc(${o(this,vi)}px * var(--total-scale-factor))`,n.color=this.color,s.replaceChildren();for(const r of o(this,bi).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),s.append(a)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:o(this,bi)}}),s}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};bi=new WeakMap,Xm=new WeakMap,_c=new WeakMap,vi=new WeakMap,Ue=new WeakSet,Ek=function(e){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-o(this,vi))*this.parentScale),m(this,vi,r),x(this,Ue,Yy).call(this)},n=o(this,vi);this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:At.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Tk=function(e){const s=r=>{this.color=r,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:At.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ck=function(){var n;const e=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(e.push(x(n=ne,Ea,Ky).call(n,r)),s=r);return e.join(`
`)},Yy=function(){const[e,s]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,l=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/s):(this.width=n.height/e,this.height=n.width/s),this.fixAndSetPosition()},Ea=new WeakSet,Ky=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(hy,"")},Wy=function(){if(this.editorDiv.replaceChildren(),!!o(this,bi))for(const e of o(this,bi).split(`
`)){const s=document.createElement("div");s.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(s)}},Rk=function(){return o(this,bi).replaceAll(""," ")},dA=function(e){return e.replaceAll(" ","")},Ok=function(e){const{value:s,fontSize:n,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==s||e.fontSize!==n||e.color.some((l,c)=>l!==r[c])||e.pageIndex!==a},A(ne,Ea),B(ne,"_freeTextDefaultContent",""),B(ne,"_internalPadding",0),B(ne,"_defaultColor",null),B(ne,"_defaultFontSize",10),B(ne,"_type","freetext"),B(ne,"_editorType",ot.FREETEXT);let hA=ne;class H{toSVGPath(){Wt("Abstract method `toSVGPath` must be implemented.")}get box(){Wt("Abstract getter `box` must be implemented.")}serialize(t,e){Wt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,s,n,r,a){a||(a=new Float32Array(t.length));for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l]*n,a[l+1]=s+t[l+1]*r;return a}static _rescaleAndSwap(t,e,s,n,r,a){a||(a=new Float32Array(t.length));for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l+1]*n,a[l+1]=s+t[l]*r;return a}static _translate(t,e,s,n){n||(n=new Float32Array(t.length));for(let r=0,a=t.length;r<a;r+=2)n[r]=e+t[r],n[r+1]=s+t[r+1];return n}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,s,n,r){switch(r){case 90:return[1-e/s,t/n];case 180:return[1-t/s,1-e/n];case 270:return[e/s,1-t/n];default:return[t/s,e/n]}}static _normalizePagePoint(t,e,s){switch(s){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,s,n,r,a){return[(t+5*s)/6,(e+5*n)/6,(5*s+r)/6,(5*n+a)/6,(s+r)/2,(n+a)/2]}}B(H,"PRECISION",1e-4);var wi,Mn,ad,od,or,mt,Ac,Sc,Ym,Km,ld,cd,To,Wm,yb,bb,Ye,Mf,kk,Nk,Mk,Dk,jk,Lk;const Dr=class Dr{constructor({x:t,y:e},s,n,r,a,l=0){A(this,Ye);A(this,wi);A(this,Mn,[]);A(this,ad);A(this,od);A(this,or,[]);A(this,mt,new Float32Array(18));A(this,Ac);A(this,Sc);A(this,Ym);A(this,Km);A(this,ld);A(this,cd);A(this,To,[]);m(this,wi,s),m(this,cd,r*n),m(this,od,a),o(this,mt).set([NaN,NaN,NaN,NaN,t,e],6),m(this,ad,l),m(this,Km,o(Dr,Wm)*n),m(this,Ym,o(Dr,bb)*n),m(this,ld,n),o(this,To).push(t,e)}isEmpty(){return isNaN(o(this,mt)[8])}add({x:t,y:e}){var k;m(this,Ac,t),m(this,Sc,e);const[s,n,r,a]=o(this,wi);let[l,c,u,h]=o(this,mt).subarray(8,12);const d=t-u,f=e-h,g=Math.hypot(d,f);if(g<o(this,Ym))return!1;const b=g-o(this,Km),v=b/g,S=v*d,p=v*f;let w=l,y=c;l=u,c=h,u+=S,h+=p,(k=o(this,To))==null||k.push(t,e);const E=-p/b,T=S/b,C=E*o(this,cd),R=T*o(this,cd);return o(this,mt).set(o(this,mt).subarray(2,8),0),o(this,mt).set([u+C,h+R],4),o(this,mt).set(o(this,mt).subarray(14,18),12),o(this,mt).set([u-C,h-R],16),isNaN(o(this,mt)[6])?(o(this,or).length===0&&(o(this,mt).set([l+C,c+R],2),o(this,or).push(NaN,NaN,NaN,NaN,(l+C-s)/r,(c+R-n)/a),o(this,mt).set([l-C,c-R],14),o(this,Mn).push(NaN,NaN,NaN,NaN,(l-C-s)/r,(c-R-n)/a)),o(this,mt).set([w,y,l,c,u,h],6),!this.isEmpty()):(o(this,mt).set([w,y,l,c,u,h],6),Math.abs(Math.atan2(y-c,w-l)-Math.atan2(p,S))<Math.PI/2?([l,c,u,h]=o(this,mt).subarray(2,6),o(this,or).push(NaN,NaN,NaN,NaN,((l+u)/2-s)/r,((c+h)/2-n)/a),[l,c,w,y]=o(this,mt).subarray(14,18),o(this,Mn).push(NaN,NaN,NaN,NaN,((w+l)/2-s)/r,((y+c)/2-n)/a),!0):([w,y,l,c,u,h]=o(this,mt).subarray(0,6),o(this,or).push(((w+5*l)/6-s)/r,((y+5*c)/6-n)/a,((5*l+u)/6-s)/r,((5*c+h)/6-n)/a,((l+u)/2-s)/r,((c+h)/2-n)/a),[u,h,l,c,w,y]=o(this,mt).subarray(12,18),o(this,Mn).push(((w+5*l)/6-s)/r,((y+5*c)/6-n)/a,((5*l+u)/6-s)/r,((5*c+h)/6-n)/a,((l+u)/2-s)/r,((c+h)/2-n)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=o(this,or),e=o(this,Mn);if(isNaN(o(this,mt)[6])&&!this.isEmpty())return x(this,Ye,kk).call(this);const s=[];s.push(`M${t[4]} ${t[5]}`);for(let n=6;n<t.length;n+=6)isNaN(t[n])?s.push(`L${t[n+4]} ${t[n+5]}`):s.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);x(this,Ye,Mk).call(this,s);for(let n=e.length-6;n>=6;n-=6)isNaN(e[n])?s.push(`L${e[n+4]} ${e[n+5]}`):s.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);return x(this,Ye,Nk).call(this,s),s.join(" ")}newFreeDrawOutline(t,e,s,n,r,a){return new Pk(t,e,s,n,r,a)}getOutlines(){var d;const t=o(this,or),e=o(this,Mn),s=o(this,mt),[n,r,a,l]=o(this,wi),c=new Float32Array((((d=o(this,To))==null?void 0:d.length)??0)+2);for(let f=0,g=c.length-2;f<g;f+=2)c[f]=(o(this,To)[f]-n)/a,c[f+1]=(o(this,To)[f+1]-r)/l;if(c[c.length-2]=(o(this,Ac)-n)/a,c[c.length-1]=(o(this,Sc)-r)/l,isNaN(s[6])&&!this.isEmpty())return x(this,Ye,Dk).call(this,c);const u=new Float32Array(o(this,or).length+24+o(this,Mn).length);let h=t.length;for(let f=0;f<h;f+=2){if(isNaN(t[f])){u[f]=u[f+1]=NaN;continue}u[f]=t[f],u[f+1]=t[f+1]}h=x(this,Ye,Lk).call(this,u,h);for(let f=e.length-6;f>=6;f-=6)for(let g=0;g<6;g+=2){if(isNaN(e[f+g])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=e[f+g],u[h+1]=e[f+g+1],h+=2}return x(this,Ye,jk).call(this,u,h),this.newFreeDrawOutline(u,c,o(this,wi),o(this,ld),o(this,ad),o(this,od))}};wi=new WeakMap,Mn=new WeakMap,ad=new WeakMap,od=new WeakMap,or=new WeakMap,mt=new WeakMap,Ac=new WeakMap,Sc=new WeakMap,Ym=new WeakMap,Km=new WeakMap,ld=new WeakMap,cd=new WeakMap,To=new WeakMap,Wm=new WeakMap,yb=new WeakMap,bb=new WeakMap,Ye=new WeakSet,Mf=function(){const t=o(this,mt).subarray(4,6),e=o(this,mt).subarray(16,18),[s,n,r,a]=o(this,wi);return[(o(this,Ac)+(t[0]-e[0])/2-s)/r,(o(this,Sc)+(t[1]-e[1])/2-n)/a,(o(this,Ac)+(e[0]-t[0])/2-s)/r,(o(this,Sc)+(e[1]-t[1])/2-n)/a]},kk=function(){const[t,e,s,n]=o(this,wi),[r,a,l,c]=x(this,Ye,Mf).call(this);return`M${(o(this,mt)[2]-t)/s} ${(o(this,mt)[3]-e)/n} L${(o(this,mt)[4]-t)/s} ${(o(this,mt)[5]-e)/n} L${r} ${a} L${l} ${c} L${(o(this,mt)[16]-t)/s} ${(o(this,mt)[17]-e)/n} L${(o(this,mt)[14]-t)/s} ${(o(this,mt)[15]-e)/n} Z`},Nk=function(t){const e=o(this,Mn);t.push(`L${e[4]} ${e[5]} Z`)},Mk=function(t){const[e,s,n,r]=o(this,wi),a=o(this,mt).subarray(4,6),l=o(this,mt).subarray(16,18),[c,u,h,d]=x(this,Ye,Mf).call(this);t.push(`L${(a[0]-e)/n} ${(a[1]-s)/r} L${c} ${u} L${h} ${d} L${(l[0]-e)/n} ${(l[1]-s)/r}`)},Dk=function(t){const e=o(this,mt),[s,n,r,a]=o(this,wi),[l,c,u,h]=x(this,Ye,Mf).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(e[2]-s)/r,(e[3]-n)/a,NaN,NaN,NaN,NaN,(e[4]-s)/r,(e[5]-n)/a,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(e[16]-s)/r,(e[17]-n)/a,NaN,NaN,NaN,NaN,(e[14]-s)/r,(e[15]-n)/a],0),this.newFreeDrawOutline(d,t,o(this,wi),o(this,ld),o(this,ad),o(this,od))},jk=function(t,e){const s=o(this,Mn);return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],e),e+=6},Lk=function(t,e){const s=o(this,mt).subarray(4,6),n=o(this,mt).subarray(16,18),[r,a,l,c]=o(this,wi),[u,h,d,f]=x(this,Ye,Mf).call(this);return t.set([NaN,NaN,NaN,NaN,(s[0]-r)/l,(s[1]-a)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(n[0]-r)/l,(n[1]-a)/c],e),e+=24},A(Dr,Wm,8),A(Dr,yb,2),A(Dr,bb,o(Dr,Wm)+o(Dr,yb));let tb=Dr;var ud,xc,la,Qm,_i,Jm,Ce,vb,Bk;class Pk extends H{constructor(e,s,n,r,a,l){super();A(this,vb);A(this,ud);A(this,xc,new Float32Array(4));A(this,la);A(this,Qm);A(this,_i);A(this,Jm);A(this,Ce);m(this,Ce,e),m(this,_i,s),m(this,ud,n),m(this,Jm,r),m(this,la,a),m(this,Qm,l),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],x(this,vb,Bk).call(this,l);const[c,u,h,d]=o(this,xc);for(let f=0,g=e.length;f<g;f+=2)e[f]=(e[f]-c)/h,e[f+1]=(e[f+1]-u)/d;for(let f=0,g=s.length;f<g;f+=2)s[f]=(s[f]-c)/h,s[f+1]=(s[f+1]-u)/d}toSVGPath(){const e=[`M${o(this,Ce)[4]} ${o(this,Ce)[5]}`];for(let s=6,n=o(this,Ce).length;s<n;s+=6){if(isNaN(o(this,Ce)[s])){e.push(`L${o(this,Ce)[s+4]} ${o(this,Ce)[s+5]}`);continue}e.push(`C${o(this,Ce)[s]} ${o(this,Ce)[s+1]} ${o(this,Ce)[s+2]} ${o(this,Ce)[s+3]} ${o(this,Ce)[s+4]} ${o(this,Ce)[s+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,s,n,r],a){const l=n-e,c=r-s;let u,h;switch(a){case 0:u=H._rescale(o(this,Ce),e,r,l,-c),h=H._rescale(o(this,_i),e,r,l,-c);break;case 90:u=H._rescaleAndSwap(o(this,Ce),e,s,l,c),h=H._rescaleAndSwap(o(this,_i),e,s,l,c);break;case 180:u=H._rescale(o(this,Ce),n,s,-l,c),h=H._rescale(o(this,_i),n,s,-l,c);break;case 270:u=H._rescaleAndSwap(o(this,Ce),n,r,-l,-c),h=H._rescaleAndSwap(o(this,_i),n,r,-l,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return o(this,xc)}newOutliner(e,s,n,r,a,l=0){return new tb(e,s,n,r,a,l)}getNewOutline(e,s){const[n,r,a,l]=o(this,xc),[c,u,h,d]=o(this,ud),f=a*h,g=l*d,b=n*h+c,v=r*d+u,S=this.newOutliner({x:o(this,_i)[0]*f+b,y:o(this,_i)[1]*g+v},o(this,ud),o(this,Jm),e,o(this,Qm),s??o(this,la));for(let p=2;p<o(this,_i).length;p+=2)S.add({x:o(this,_i)[p]*f+b,y:o(this,_i)[p+1]*g+v});return S.getOutlines()}}ud=new WeakMap,xc=new WeakMap,la=new WeakMap,Qm=new WeakMap,_i=new WeakMap,Jm=new WeakMap,Ce=new WeakMap,vb=new WeakSet,Bk=function(e){const s=o(this,Ce);let n=s[4],r=s[5];const a=[n,r,n,r];let l=n,c=r,u=n,h=r;const d=e?Math.max:Math.min,f=new Float32Array(4);for(let b=6,v=s.length;b<v;b+=6){const S=s[b+4],p=s[b+5];isNaN(s[b])?($.pointBoundingBox(S,p,a),c>p?(l=S,c=p):c===p&&(l=d(l,S)),h<p?(u=S,h=p):h===p&&(u=d(u,S))):(f[0]=f[1]=1/0,f[2]=f[3]=-1/0,$.bezierBoundingBox(n,r,...s.slice(b,b+6),f),$.rectBoundingBox(f[0],f[1],f[2],f[3],a),c>f[1]?(l=f[0],c=f[1]):c===f[1]&&(l=d(l,f[0])),h<f[3]?(u=f[2],h=f[3]):h===f[3]&&(u=d(u,f[2]))),n=S,r=p}const g=o(this,xc);g[0]=a[0]-o(this,la),g[1]=a[1]-o(this,la),g[2]=a[2]-a[0]+2*o(this,la),g[3]=a[3]-a[1]+2*o(this,la),this.firstPoint=[l,c],this.lastPoint=[u,h]};var Zm,tp,ep,Co,Dn,Hs,Ik,Qy,Uk,zk,gA;class fA{constructor(t,e=0,s=0,n=!0){A(this,Hs);A(this,Zm);A(this,tp);A(this,ep);A(this,Co,[]);A(this,Dn,[]);const r=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:v,y:S,width:p,height:w}of t){const y=Math.floor((v-e)/a)*a,E=Math.ceil((v+p+e)/a)*a,T=Math.floor((S-e)/a)*a,C=Math.ceil((S+w+e)/a)*a,R=[y,T,C,!0],O=[E,T,C,!1];o(this,Co).push(R,O),$.rectBoundingBox(y,T,E,C,r)}const l=r[2]-r[0]+2*s,c=r[3]-r[1]+2*s,u=r[0]-s,h=r[1]-s;let d=n?-1/0:1/0,f=1/0;const g=o(this,Co).at(n?-1:-2),b=[g[0],g[2]];for(const v of o(this,Co)){const[S,p,w,y]=v;!y&&n?p<f?(f=p,d=S):p===f&&(d=Math.max(d,S)):y&&!n&&(p<f?(f=p,d=S):p===f&&(d=Math.min(d,S))),v[0]=(S-u)/l,v[1]=(p-h)/c,v[2]=(w-h)/c}m(this,Zm,new Float32Array([u,h,l,c])),m(this,tp,[d,f]),m(this,ep,b)}getOutlines(){o(this,Co).sort((e,s)=>e[0]-s[0]||e[1]-s[1]||e[2]-s[2]);const t=[];for(const e of o(this,Co))e[3]?(t.push(...x(this,Hs,gA).call(this,e)),x(this,Hs,Uk).call(this,e)):(x(this,Hs,zk).call(this,e),t.push(...x(this,Hs,gA).call(this,e)));return x(this,Hs,Ik).call(this,t)}}Zm=new WeakMap,tp=new WeakMap,ep=new WeakMap,Co=new WeakMap,Dn=new WeakMap,Hs=new WeakSet,Ik=function(t){const e=[],s=new Set;for(const a of t){const[l,c,u]=a;e.push([l,c,a],[l,u,a])}e.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=e.length;a<l;a+=2){const c=e[a][2],u=e[a+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const n=[];let r;for(;s.size>0;){const a=s.values().next().value;let[l,c,u,h,d]=a;s.delete(a);let f=l,g=c;for(r=[l,u],n.push(r);;){let b;if(s.has(h))b=h;else if(s.has(d))b=d;else break;s.delete(b),[l,c,u,h,d]=b,f!==l&&(r.push(f,g,l,g===c?c:u),f=l),g=g===c?u:c}r.push(f,g)}return new O4(n,o(this,Zm),o(this,tp),o(this,ep))},Qy=function(t){const e=o(this,Dn);let s=0,n=e.length-1;for(;s<=n;){const r=s+n>>1,a=e[r][0];if(a===t)return r;a<t?s=r+1:n=r-1}return n+1},Uk=function([,t,e]){const s=x(this,Hs,Qy).call(this,t);o(this,Dn).splice(s,0,[t,e])},zk=function([,t,e]){const s=x(this,Hs,Qy).call(this,t);for(let n=s;n<o(this,Dn).length;n++){const[r,a]=o(this,Dn)[n];if(r!==t)break;if(r===t&&a===e){o(this,Dn).splice(n,1);return}}for(let n=s-1;n>=0;n--){const[r,a]=o(this,Dn)[n];if(r!==t)break;if(r===t&&a===e){o(this,Dn).splice(n,1);return}}},gA=function(t){const[e,s,n]=t,r=[[e,s,n]],a=x(this,Hs,Qy).call(this,n);for(let l=0;l<a;l++){const[c,u]=o(this,Dn)[l];for(let h=0,d=r.length;h<d;h++){const[,f,g]=r[h];if(!(u<=f||g<=c)){if(f>=c){if(g>u)r[h][1]=u;else{if(d===1)return[];r.splice(h,1),h--,d--}continue}r[h][2]=c,g>u&&r.push([e,u,g])}}}return r};var sp,hd;class O4 extends H{constructor(e,s,n,r){super();A(this,sp);A(this,hd);m(this,hd,e),m(this,sp,s),this.firstPoint=n,this.lastPoint=r}toSVGPath(){const e=[];for(const s of o(this,hd)){let[n,r]=s;e.push(`M${n} ${r}`);for(let a=2;a<s.length;a+=2){const l=s[a],c=s[a+1];l===n?(e.push(`V${c}`),r=c):c===r&&(e.push(`H${l}`),n=l)}e.push("Z")}return e.join(" ")}serialize([e,s,n,r],a){const l=[],c=n-e,u=r-s;for(const h of o(this,hd)){const d=new Array(h.length);for(let f=0;f<h.length;f+=2)d[f]=e+h[f]*c,d[f+1]=r-h[f+1]*u;l.push(d)}return l}get box(){return o(this,sp)}get classNamesForOutlining(){return["highlightOutline"]}}sp=new WeakMap,hd=new WeakMap;class mA extends tb{newFreeDrawOutline(t,e,s,n,r,a){return new k4(t,e,s,n,r,a)}}class k4 extends Pk{newOutliner(t,e,s,n,r,a=0){return new mA(t,e,s,n,r,a)}}var dd,ip,ca,Ec,np,ti,rp,ap,Tc,Ai,Si,hs,fd,gd,Os,md,nn,op,dt,pA,Jy,Fk,Hk,$k,yA,bl,fn,Cu,qk,Zy,t0,Gk,Vk,Xk,Yk,Kk;const Rt=class Rt extends ee{constructor(e){super({...e,name:"highlightEditor"});A(this,dt);A(this,dd,null);A(this,ip,0);A(this,ca);A(this,Ec,null);A(this,np,null);A(this,ti,null);A(this,rp,null);A(this,ap,0);A(this,Tc,null);A(this,Ai,null);A(this,Si,null);A(this,hs,!1);A(this,fd,null);A(this,gd,null);A(this,Os,null);A(this,md,"");A(this,nn);A(this,op,"");this.color=e.color||Rt._defaultColor,m(this,nn,e.thickness||Rt._defaultThickness),this.opacity=e.opacity||Rt._defaultOpacity,m(this,ca,e.boxes||null),m(this,op,e.methodOfCreation||""),m(this,md,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(m(this,hs,!0),x(this,dt,Jy).call(this,e),x(this,dt,bl).call(this)):o(this,ca)&&(m(this,dd,e.anchorNode),m(this,ip,e.anchorOffset),m(this,rp,e.focusNode),m(this,ap,e.focusOffset),x(this,dt,pA).call(this),x(this,dt,bl).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const e=Rt.prototype;return ut(this,"_keyboardManager",new Rp([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:o(this,hs)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:o(this,nn),methodOfCreation:o(this,op)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,s){var n;ee.initialize(e,s),Rt._defaultColor||(Rt._defaultColor=((n=s.highlightColors)==null?void 0:n.values().next().value)||"#fff066")}static updateDefaultParams(e,s){switch(e){case At.HIGHLIGHT_COLOR:Rt._defaultColor=s;break;case At.HIGHLIGHT_THICKNESS:Rt._defaultThickness=s;break}}translateInPage(e,s){}get toolbarPosition(){return o(this,gd)}get commentButtonPosition(){return o(this,fd)}updateParams(e,s){switch(e){case At.HIGHLIGHT_COLOR:x(this,dt,Fk).call(this,s);break;case At.HIGHLIGHT_THICKNESS:x(this,dt,Hk).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[At.HIGHLIGHT_COLOR,Rt._defaultColor],[At.HIGHLIGHT_THICKNESS,Rt._defaultThickness]]}get propertiesToUpdate(){return[[At.HIGHLIGHT_COLOR,this.color||Rt._defaultColor],[At.HIGHLIGHT_THICKNESS,o(this,nn)||Rt._defaultThickness],[At.HIGHLIGHT_FREE,o(this,hs)]]}onUpdatedColor(){var e,s;(e=this.parent)==null||e.drawLayer.updateProperties(o(this,Si),{root:{fill:this.color,"fill-opacity":this.opacity}}),(s=o(this,np))==null||s.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",m(this,np,new Q0({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(x(this,dt,t0).call(this))}getBaseTranslation(){return[0,0]}getRect(e,s){return super.getRect(e,s,x(this,dt,t0).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){x(this,dt,yA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,dt,bl).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var n;let s=!1;this.parent&&!e?x(this,dt,yA).call(this):e&&(x(this,dt,bl).call(this,e),s=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),s&&this.select()}rotate(e){var r,a,l;const{drawLayer:s}=this.parent;let n;o(this,hs)?(e=(e-this.rotation+360)%360,n=x(r=Rt,fn,Cu).call(r,o(this,Ai).box,e)):n=x(a=Rt,fn,Cu).call(a,[this.x,this.y,this.width,this.height],e),s.updateProperties(o(this,Si),{bbox:n,root:{"data-main-rotation":e}}),s.updateProperties(o(this,Os),{bbox:x(l=Rt,fn,Cu).call(l,o(this,ti).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();o(this,md)&&(e.setAttribute("aria-label",o(this,md)),e.setAttribute("role","mark")),o(this,hs)?e.classList.add("free"):this.div.addEventListener("keydown",x(this,dt,qk).bind(this),{signal:this._uiManager._signal});const s=m(this,Tc,document.createElement("div"));return e.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=o(this,Ec),this.setDims(),gO(this,o(this,Tc),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(o(this,Os),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(o(this,Os),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:x(this,dt,Zy).call(this,!0);break;case 1:case 3:x(this,dt,Zy).call(this,!1);break}}select(){var e;super.select(),o(this,Os)&&((e=this.parent)==null||e.drawLayer.updateProperties(o(this,Os),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),o(this,Os)&&((e=this.parent)==null||e.drawLayer.updateProperties(o(this,Os),{rootClass:{selected:!1}}),o(this,hs)||x(this,dt,Zy).call(this,!1))}get _mustFixPosition(){return!o(this,hs)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(o(this,Si),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(o(this,Os),{rootClass:{hidden:!e}}))}static startHighlighting(e,s,{target:n,x:r,y:a}){const{x:l,y:c,width:u,height:h}=n.getBoundingClientRect(),d=new AbortController,f=e.combinedSignal(d),g=b=>{d.abort(),x(this,fn,Yk).call(this,e,b)};window.addEventListener("blur",g,{signal:f}),window.addEventListener("pointerup",g,{signal:f}),window.addEventListener("pointerdown",xe,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",bn,{signal:f}),n.addEventListener("pointermove",x(this,fn,Xk).bind(this,e),{signal:f}),this._freeHighlight=new mA({x:r,y:a},[l,c,u,h],e.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,s,n){var v,S,p,w;let r=null;if(e instanceof Sk){const{data:{quadPoints:y,rect:E,rotation:T,id:C,color:R,opacity:O,popupRef:k,richText:D,contentsObj:P,creationDate:I,modificationDate:Z},parent:{page:{pageNumber:K}}}=e;r=e={annotationType:ot.HIGHLIGHT,color:Array.from(R),opacity:O,quadPoints:y,boxes:null,pageIndex:K-1,rect:E.slice(0),rotation:T,annotationElementId:C,id:C,deleted:!1,popupRef:k,richText:D,comment:(P==null?void 0:P.str)||null,creationDate:I,modificationDate:Z}}else if(e instanceof ex){const{data:{inkLists:y,rect:E,rotation:T,id:C,color:R,borderStyle:{rawWidth:O},popupRef:k,richText:D,contentsObj:P,creationDate:I,modificationDate:Z},parent:{page:{pageNumber:K}}}=e;r=e={annotationType:ot.HIGHLIGHT,color:Array.from(R),thickness:O,inkLists:y,boxes:null,pageIndex:K-1,rect:E.slice(0),rotation:T,annotationElementId:C,id:C,deleted:!1,popupRef:k,richText:D,comment:(P==null?void 0:P.str)||null,creationDate:I,modificationDate:Z}}const{color:a,quadPoints:l,inkLists:c,opacity:u}=e,h=await super.deserialize(e,s,n);h.color=$.makeHexColor(...a),h.opacity=u||1,c&&m(h,nn,e.thickness),h._initialData=r,e.comment&&h.setCommentData(e);const[d,f]=h.pageDimensions,[g,b]=h.pageTranslation;if(l){const y=m(h,ca,[]);for(let E=0;E<l.length;E+=8)y.push({x:(l[E]-g)/d,y:1-(l[E+1]-b)/f,width:(l[E+2]-l[E])/d,height:(l[E+1]-l[E+5])/f});x(v=h,dt,pA).call(v),x(S=h,dt,bl).call(S),h.rotate(h.rotation)}else if(c){m(h,hs,!0);const y=c[0],E={x:y[0]-g,y:f-(y[1]-b)},T=new mA(E,[0,0,d,f],1,o(h,nn)/2,!0,.001);for(let O=0,k=y.length;O<k;O+=2)E.x=y[O]-g,E.y=f-(y[O+1]-b),T.add(E);const{id:C,clipPathId:R}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:T.toSVGPath()}},!0,!0);x(p=h,dt,Jy).call(p,{highlightOutlines:T.getOutlines(),highlightId:C,clipPathId:R}),x(w=h,dt,bl).call(w),h.rotate(h.parentRotation)}return h}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const s=ee._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:s,opacity:this.opacity,thickness:o(this,nn),quadPoints:x(this,dt,Gk).call(this),outlines:x(this,dt,Vk).call(this,n.rect)}),this.addComment(n),this.annotationElementId&&!x(this,dt,Kk).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};dd=new WeakMap,ip=new WeakMap,ca=new WeakMap,Ec=new WeakMap,np=new WeakMap,ti=new WeakMap,rp=new WeakMap,ap=new WeakMap,Tc=new WeakMap,Ai=new WeakMap,Si=new WeakMap,hs=new WeakMap,fd=new WeakMap,gd=new WeakMap,Os=new WeakMap,md=new WeakMap,nn=new WeakMap,op=new WeakMap,dt=new WeakSet,pA=function(){const e=new fA(o(this,ca),.001);m(this,Ai,e.getOutlines()),[this.x,this.y,this.width,this.height]=o(this,Ai).box;const s=new fA(o(this,ca),.0025,.001,this._uiManager.direction==="ltr");m(this,ti,s.getOutlines());const{firstPoint:n}=o(this,Ai);m(this,fd,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]);const{lastPoint:r}=o(this,ti);m(this,gd,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},Jy=function({highlightOutlines:e,highlightId:s,clipPathId:n}){var f,g;if(m(this,Ai,e),m(this,ti,e.getNewOutline(o(this,nn)/2+1.5,.0025)),s>=0)m(this,Si,s),m(this,Ec,n),this.parent.drawLayer.finalizeDraw(s,{bbox:e.box,path:{d:e.toSVGPath()}}),m(this,Os,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:o(this,ti).box,path:{d:o(this,ti).toSVGPath()}},!0));else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(o(this,Si),{bbox:x(f=Rt,fn,Cu).call(f,o(this,Ai).box,(b-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(o(this,Os),{bbox:x(g=Rt,fn,Cu).call(g,o(this,ti).box,b),path:{d:o(this,ti).toSVGPath()}})}const[a,l,c,u]=e.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=c,this.height=u;break;case 90:{const[b,v]=this.parentDimensions;this.x=l,this.y=1-a,this.width=c*v/b,this.height=u*b/v;break}case 180:this.x=1-a,this.y=1-l,this.width=c,this.height=u;break;case 270:{const[b,v]=this.parentDimensions;this.x=1-l,this.y=a,this.width=c*v/b,this.height=u*b/v;break}}const{firstPoint:h}=e;m(this,fd,[(h[0]-a)/c,(h[1]-l)/u]);const{lastPoint:d}=o(this,ti);m(this,gd,[(d[0]-a)/c,(d[1]-l)/u])},Fk=function(e){const s=(a,l)=>{this.color=a,this.opacity=l,this.onUpdatedColor()},n=this.color,r=this.opacity;this.addCommands({cmd:s.bind(this,e,Rt._defaultOpacity),undo:s.bind(this,n,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:At.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)},Hk=function(e){const s=o(this,nn),n=r=>{m(this,nn,r),x(this,dt,$k).call(this,r)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:At.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},$k=function(e){o(this,hs)&&(x(this,dt,Jy).call(this,{highlightOutlines:o(this,Ai).getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())},yA=function(){o(this,Si)===null||!this.parent||(this.parent.drawLayer.remove(o(this,Si)),m(this,Si,null),this.parent.drawLayer.remove(o(this,Os)),m(this,Os,null))},bl=function(e=this.parent){o(this,Si)===null&&({id:Fe(this,Si)._,clipPathId:Fe(this,Ec)._}=e.drawLayer.draw({bbox:o(this,Ai).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:o(this,hs)},path:{d:o(this,Ai).toSVGPath()}},!1,!0),m(this,Os,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:o(this,hs)},bbox:o(this,ti).box,path:{d:o(this,ti).toSVGPath()}},o(this,hs))),o(this,Tc)&&(o(this,Tc).style.clipPath=o(this,Ec)))},fn=new WeakSet,Cu=function([e,s,n,r],a){switch(a){case 90:return[1-s-r,e,r,n];case 180:return[1-e-n,1-s-r,n,r];case 270:return[s,1-e-n,r,n]}return[e,s,n,r]},qk=function(e){Rt._keyboardManager.exec(this,e)},Zy=function(e){if(!o(this,dd))return;const s=window.getSelection();e?s.setPosition(o(this,dd),o(this,ip)):s.setPosition(o(this,rp),o(this,ap))},t0=function(){return o(this,hs)?this.rotation:0},Gk=function(){if(o(this,hs))return null;const[e,s]=this.pageDimensions,[n,r]=this.pageTranslation,a=o(this,ca),l=new Float32Array(a.length*8);let c=0;for(const{x:u,y:h,width:d,height:f}of a){const g=u*e+n,b=(1-h)*s+r;l[c]=l[c+4]=g,l[c+1]=l[c+3]=b,l[c+2]=l[c+6]=g+d*e,l[c+5]=l[c+7]=b-f*s,c+=8}return l},Vk=function(e){return o(this,Ai).serialize(e,x(this,dt,t0).call(this))},Xk=function(e,s){this._freeHighlight.add(s)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},Yk=function(e,s){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Kk=function(e){const{color:s}=this._initialData;return this.hasEditedComment||e.color.some((n,r)=>n!==s[r])},A(Rt,fn),B(Rt,"_defaultColor",null),B(Rt,"_defaultOpacity",1),B(Rt,"_defaultThickness",12),B(Rt,"_type","highlight"),B(Rt,"_editorType",ot.HIGHLIGHT),B(Rt,"_freeHighlightId",-1),B(Rt,"_freeHighlight",null),B(Rt,"_freeHighlightClipId","");let eb=Rt;var Cc;class Wk{constructor(){A(this,Cc,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,s]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,s)}updateSVGProperty(t,e){o(this,Cc)[t]=e}toSVGProperties(){const t=o(this,Cc);return m(this,Cc,Object.create(null)),{root:t}}reset(){m(this,Cc,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){Wt("Not implemented")}}Cc=new WeakMap;var xi,pd,Ze,Rc,Oc,Et,bA,vA,wA,Df,Qk,e0,jf,Ru;const wt=class wt extends ee{constructor(e){super(e);A(this,Et);A(this,xi,null);A(this,pd);B(this,"_colorPicker",null);B(this,"_drawId",null);m(this,pd,e.mustBeCommitted||!1),this._addOutlines(e)}onUpdatedColor(){var e;(e=this._colorPicker)==null||e.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(x(this,Et,bA).call(this,e),x(this,Et,Df).call(this))}static _mergeSVGProperties(e,s){const n=new Set(Object.keys(e));for(const[r,a]of Object.entries(s))n.has(r)?Object.assign(e[r],a):e[r]=a;return e}static getDefaultDrawingOptions(e){Wt("Not implemented")}static get typesMap(){Wt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,s){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,s),this._currentParent&&(o(wt,Ze).updateProperty(n,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,s){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,s)}static get defaultPropertiesToUpdate(){const e=[],s=this._defaultDrawingOptions;for(const[n,r]of this.typesMap)e.push([n,s[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:s}=this;for(const[n,r]of this.constructor.typesMap)e.push([n,s[r]]);return e}_updateProperty(e,s,n){const r=this._drawingOptions,a=r[s],l=c=>{var h;r.updateProperty(s,c);const u=o(this,xi).updateProperty(s,c);u&&x(this,Et,jf).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(o(this,xi).getPathResizingSVGProperties(x(this,Et,e0).call(this)),{bbox:x(this,Et,Ru).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(o(this,xi).getPathResizedSVGProperties(x(this,Et,e0).call(this)),{bbox:x(this,Et,Ru).call(this)}))}_onTranslating(e,s){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,{bbox:x(this,Et,Ru).call(this)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(o(this,xi).getPathTranslatedSVGProperties(x(this,Et,e0).call(this),this.parentDimensions),{bbox:x(this,Et,Ru).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,o(this,pd)&&(m(this,pd,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){x(this,Et,wA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,Et,Df).call(this),x(this,Et,jf).call(this,o(this,xi).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var n;let s=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),x(this,Et,wA).call(this)):e&&(this._uiManager.addShouldRescale(this),x(this,Et,Df).call(this,e),s=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(e),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties({bbox:x(this,Et,Ru).call(this)},o(this,xi).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&x(this,Et,jf).call(this,o(this,xi).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,s;this._isCopy&&(e=this.x,s=this.y);const n=super.render();n.classList.add("draw");const r=document.createElement("div");return n.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,s),n}static createDrawerInstance(e,s,n,r,a){Wt("Not implemented")}static startDrawing(e,s,n,r){var S;const{target:a,offsetX:l,offsetY:c,pointerId:u,pointerType:h}=r;if(xs.isInitializedAndDifferentPointerType(h))return;const{viewport:{rotation:d}}=e,{width:f,height:g}=a.getBoundingClientRect(),b=m(wt,Rc,new AbortController),v=e.combinedSignal(b);if(xs.setPointer(h,u),window.addEventListener("pointerup",p=>{xs.isSamePointerIdOrRemove(p.pointerId)&&this._endDraw(p)},{signal:v}),window.addEventListener("pointercancel",p=>{xs.isSamePointerIdOrRemove(p.pointerId)&&this._currentParent.endDrawingSession()},{signal:v}),window.addEventListener("pointerdown",p=>{xs.isSamePointerType(p.pointerType)&&(xs.initializeAndAddPointerId(p.pointerId),o(wt,Ze).isCancellable()&&(o(wt,Ze).removeLastElement(),o(wt,Ze).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",bn,{signal:v}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:v}),a.addEventListener("touchmove",p=>{xs.isSameTimeStamp(p.timeStamp)&&xe(p)},{signal:v}),e.toggleDrawing(),(S=s._editorUndoBar)==null||S.hide(),o(wt,Ze)){e.drawLayer.updateProperties(this._currentDrawId,o(wt,Ze).startNew(l,c,f,g,d));return}s.updateUIForDefaultProperties(this),m(wt,Ze,this.createDrawerInstance(l,c,f,g,d)),m(wt,Oc,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(o(wt,Oc).toSVGProperties(),o(wt,Ze).defaultSVGProperties),!0,!1)}static _drawMove(e){if(xs.isSameTimeStamp(e.timeStamp),!o(wt,Ze))return;const{offsetX:s,offsetY:n,pointerId:r}=e;if(xs.isSamePointerId(r)){if(xs.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,o(wt,Ze).add(s,n)),xs.setTimeStamp(e.timeStamp),xe(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,m(wt,Ze,null),m(wt,Oc,null),xs.clearPointerType(),xs.clearTimeStamp()),o(wt,Rc)&&(o(wt,Rc).abort(),m(wt,Rc,null),xs.clearPointerIds())}static _endDraw(e){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(e==null?void 0:e.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,o(wt,Ze).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=o(wt,Ze),r=this._currentDrawId,a=n.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,n.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,n.removeLastElement())},mustExec:!1,type:At.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(At.DRAW_STEP),!o(wt,Ze).isEmpty()){const{pageDimensions:[n,r],scale:a}=s,l=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:o(wt,Ze).getOutlines(n*a,r*a,a,this._INNER_MARGIN),drawingOptions:o(wt,Oc),mustBeCommitted:!e});return this._cleanup(!0),l}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,s,n,r,a,l){Wt("Not implemented")}static async deserialize(e,s,n){var d,f;const{rawDims:{pageWidth:r,pageHeight:a,pageX:l,pageY:c}}=s.viewport,u=this.deserializeDraw(l,c,r,a,this._INNER_MARGIN,e),h=await super.deserialize(e,s,n);return h.createDrawingOptions(e),x(d=h,Et,bA).call(d,{drawOutlines:u}),x(f=h,Et,Df).call(f),h.onScaleChanging(),h.rotate(),h}serializeDraw(e){const[s,n]=this.pageTranslation,[r,a]=this.pageDimensions;return o(this,xi).serialize([s,n,r,a],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};xi=new WeakMap,pd=new WeakMap,Ze=new WeakMap,Rc=new WeakMap,Oc=new WeakMap,Et=new WeakSet,bA=function({drawOutlines:e,drawId:s,drawingOptions:n}){m(this,xi,e),this._drawingOptions||(this._drawingOptions=n),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,e.defaultProperties)):this._drawId=x(this,Et,vA).call(this,e,this.parent),x(this,Et,jf).call(this,e.box)},vA=function(e,s){const{id:n}=s.drawLayer.draw(wt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n},wA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Df=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=x(this,Et,vA).call(this,o(this,xi),e)}},Qk=function([e,s,n,r]){const{parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[s,1-e,n*(l/a),r*(a/l)];case 180:return[1-e,1-s,n,r];case 270:return[1-s,e,n*(l/a),r*(a/l)];default:return[e,s,n,r]}},e0=function(){const{x:e,y:s,width:n,height:r,parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[1-s,e,n*(a/l),r*(l/a)];case 180:return[1-e,1-s,n,r];case 270:return[s,1-e,n*(a/l),r*(l/a)];default:return[e,s,n,r]}},jf=function(e){[this.x,this.y,this.width,this.height]=x(this,Et,Qk).call(this,e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Ru=function(){const{x:e,y:s,width:n,height:r,rotation:a,parentRotation:l,parentDimensions:[c,u]}=this;switch((a*4+l)/90){case 1:return[1-s-r,e,r,n];case 2:return[1-e-n,1-s-r,n,r];case 3:return[s,1-e-n,r,n];case 4:return[e,s-n*(c/u),r*(u/c),n*(c/u)];case 5:return[1-s,e,n*(c/u),r*(u/c)];case 6:return[1-e-r*(u/c),1-s,r*(u/c),n*(c/u)];case 7:return[s-n*(c/u),1-e-r*(u/c),n*(c/u),r*(u/c)];case 8:return[e-n,s-r,n,r];case 9:return[1-s,e-n,r,n];case 10:return[1-e,1-s,n,r];case 11:return[s-r,1-e,r,n];case 12:return[e-r*(u/c),s,r*(u/c),n*(c/u)];case 13:return[1-s-n*(c/u),e-r*(u/c),n*(c/u),r*(u/c)];case 14:return[1-e,1-s-n*(c/u),r*(u/c),n*(c/u)];case 15:return[s,1-e,n*(c/u),r*(u/c)];default:return[e,s,n,r]}},B(wt,"_currentDrawId",-1),B(wt,"_currentParent",null),A(wt,Ze,null),A(wt,Rc,null),A(wt,Oc,null),B(wt,"_INNER_MARGIN",3);let sb=wt;var lr,ts,es,kc,yd,Ds,ds,rn,Nc,Mc,Dc,bd,s0;class N4{constructor(t,e,s,n,r,a){A(this,bd);A(this,lr,new Float64Array(6));A(this,ts);A(this,es);A(this,kc);A(this,yd);A(this,Ds);A(this,ds,"");A(this,rn,0);A(this,Nc,new kp);A(this,Mc);A(this,Dc);m(this,Mc,s),m(this,Dc,n),m(this,kc,r),m(this,yd,a),[t,e]=x(this,bd,s0).call(this,t,e);const l=m(this,ts,[NaN,NaN,NaN,NaN,t,e]);m(this,Ds,[t,e]),m(this,es,[{line:l,points:o(this,Ds)}]),o(this,lr).set(l,0)}updateProperty(t,e){t==="stroke-width"&&m(this,yd,e)}isEmpty(){return!o(this,es)||o(this,es).length===0}isCancellable(){return o(this,Ds).length<=10}add(t,e){[t,e]=x(this,bd,s0).call(this,t,e);const[s,n,r,a]=o(this,lr).subarray(2,6),l=t-r,c=e-a;return Math.hypot(o(this,Mc)*l,o(this,Dc)*c)<=2?null:(o(this,Ds).push(t,e),isNaN(s)?(o(this,lr).set([r,a,t,e],2),o(this,ts).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(o(this,lr)[0])&&o(this,ts).splice(6,6),o(this,lr).set([s,n,r,a,t,e],0),o(this,ts).push(...H.createBezierPoints(s,n,r,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const s=this.add(t,e);return s||(o(this,Ds).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,s,n,r){m(this,Mc,s),m(this,Dc,n),m(this,kc,r),[t,e]=x(this,bd,s0).call(this,t,e);const a=m(this,ts,[NaN,NaN,NaN,NaN,t,e]);m(this,Ds,[t,e]);const l=o(this,es).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),o(this,es).push({line:a,points:o(this,Ds)}),o(this,lr).set(a,0),m(this,rn,0),this.toSVGPath(),null}getLastElement(){return o(this,es).at(-1)}setLastElement(t){return o(this,es)?(o(this,es).push(t),m(this,ts,t.line),m(this,Ds,t.points),m(this,rn,0),{path:{d:this.toSVGPath()}}):o(this,Nc).setLastElement(t)}removeLastElement(){if(!o(this,es))return o(this,Nc).removeLastElement();o(this,es).pop(),m(this,ds,"");for(let t=0,e=o(this,es).length;t<e;t++){const{line:s,points:n}=o(this,es)[t];m(this,ts,s),m(this,Ds,n),m(this,rn,0),this.toSVGPath()}return{path:{d:o(this,ds)}}}toSVGPath(){const t=H.svgRound(o(this,ts)[4]),e=H.svgRound(o(this,ts)[5]);if(o(this,Ds).length===2)return m(this,ds,`${o(this,ds)} M ${t} ${e} Z`),o(this,ds);if(o(this,Ds).length<=6){const n=o(this,ds).lastIndexOf("M");m(this,ds,`${o(this,ds).slice(0,n)} M ${t} ${e}`),m(this,rn,6)}if(o(this,Ds).length===4){const n=H.svgRound(o(this,ts)[10]),r=H.svgRound(o(this,ts)[11]);return m(this,ds,`${o(this,ds)} L ${n} ${r}`),m(this,rn,12),o(this,ds)}const s=[];o(this,rn)===0&&(s.push(`M ${t} ${e}`),m(this,rn,6));for(let n=o(this,rn),r=o(this,ts).length;n<r;n+=6){const[a,l,c,u,h,d]=o(this,ts).slice(n,n+6).map(H.svgRound);s.push(`C${a} ${l} ${c} ${u} ${h} ${d}`)}return m(this,ds,o(this,ds)+s.join(" ")),m(this,rn,o(this,ts).length),o(this,ds)}getOutlines(t,e,s,n){const r=o(this,es).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),o(this,Nc).build(o(this,es),t,e,s,o(this,kc),o(this,yd),n),m(this,lr,null),m(this,ts,null),m(this,es,null),m(this,ds,null),o(this,Nc)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}lr=new WeakMap,ts=new WeakMap,es=new WeakMap,kc=new WeakMap,yd=new WeakMap,Ds=new WeakMap,ds=new WeakMap,rn=new WeakMap,Nc=new WeakMap,Mc=new WeakMap,Dc=new WeakMap,bd=new WeakSet,s0=function(t,e){return H._normalizePoint(t,e,o(this,Mc),o(this,Dc),o(this,kc))};var js,lp,cp,Ei,cr,ur,vd,wd,jc,ms,kr,Jk,Zk,tN;class kp extends H{constructor(){super(...arguments);A(this,ms);A(this,js);A(this,lp,0);A(this,cp);A(this,Ei);A(this,cr);A(this,ur);A(this,vd);A(this,wd);A(this,jc)}build(e,s,n,r,a,l,c){m(this,cr,s),m(this,ur,n),m(this,vd,r),m(this,wd,a),m(this,jc,l),m(this,cp,c??0),m(this,Ei,e),x(this,ms,Zk).call(this)}get thickness(){return o(this,jc)}setLastElement(e){return o(this,Ei).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return o(this,Ei).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:s}of o(this,Ei)){if(e.push(`M${H.svgRound(s[4])} ${H.svgRound(s[5])}`),s.length===6){e.push("Z");continue}if(s.length===12&&isNaN(s[6])){e.push(`L${H.svgRound(s[10])} ${H.svgRound(s[11])}`);continue}for(let n=6,r=s.length;n<r;n+=6){const[a,l,c,u,h,d]=s.subarray(n,n+6).map(H.svgRound);e.push(`C${a} ${l} ${c} ${u} ${h} ${d}`)}}return e.join("")}serialize([e,s,n,r],a){const l=[],c=[],[u,h,d,f]=x(this,ms,Jk).call(this);let g,b,v,S,p,w,y,E,T;switch(o(this,wd)){case 0:T=H._rescale,g=e,b=s+r,v=n,S=-r,p=e+u*n,w=s+(1-h-f)*r,y=e+(u+d)*n,E=s+(1-h)*r;break;case 90:T=H._rescaleAndSwap,g=e,b=s,v=n,S=r,p=e+h*n,w=s+u*r,y=e+(h+f)*n,E=s+(u+d)*r;break;case 180:T=H._rescale,g=e+n,b=s,v=-n,S=r,p=e+(1-u-d)*n,w=s+h*r,y=e+(1-u)*n,E=s+(h+f)*r;break;case 270:T=H._rescaleAndSwap,g=e+n,b=s+r,v=-n,S=-r,p=e+(1-h-f)*n,w=s+(1-u-d)*r,y=e+(1-h)*n,E=s+(1-u)*r;break}for(const{line:C,points:R}of o(this,Ei))l.push(T(C,g,b,v,S,a?new Array(C.length):null)),c.push(T(R,g,b,v,S,a?new Array(R.length):null));return{lines:l,points:c,rect:[p,w,y,E]}}static deserialize(e,s,n,r,a,{paths:{lines:l,points:c},rotation:u,thickness:h}){const d=[];let f,g,b,v,S;switch(u){case 0:S=H._rescale,f=-e/n,g=s/r+1,b=1/n,v=-1/r;break;case 90:S=H._rescaleAndSwap,f=-s/r,g=-e/n,b=1/r,v=1/n;break;case 180:S=H._rescale,f=e/n+1,g=-s/r,b=-1/n,v=1/r;break;case 270:S=H._rescaleAndSwap,f=s/r+1,g=e/n+1,b=-1/r,v=-1/n;break}if(!l){l=[];for(const w of c){const y=w.length;if(y===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(y===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const E=new Float32Array(3*(y-2));l.push(E);let[T,C,R,O]=w.subarray(0,4);E.set([NaN,NaN,NaN,NaN,T,C],0);for(let k=4;k<y;k+=2){const D=w[k],P=w[k+1];E.set(H.createBezierPoints(T,C,R,O,D,P),(k-2)*3),[T,C,R,O]=[R,O,D,P]}}}for(let w=0,y=l.length;w<y;w++)d.push({line:S(l[w].map(E=>E??NaN),f,g,b,v),points:S(c[w].map(E=>E??NaN),f,g,b,v)});const p=new this.prototype.constructor;return p.build(d,n,r,1,u,h,a),p}get box(){return o(this,js)}updateProperty(e,s){return e==="stroke-width"?x(this,ms,tN).call(this,s):null}updateParentDimensions([e,s],n){const[r,a]=x(this,ms,kr).call(this);m(this,cr,e),m(this,ur,s),m(this,vd,n);const[l,c]=x(this,ms,kr).call(this),u=l-r,h=c-a,d=o(this,js);return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(e){return m(this,lp,e),{path:{transform:this.rotationTransform}}}get viewBox(){return o(this,js).map(H.svgRound).join(" ")}get defaultProperties(){const[e,s]=o(this,js);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(e)} ${H.svgRound(s)}`}}}get rotationTransform(){const[,,e,s]=o(this,js);let n=0,r=0,a=0,l=0,c=0,u=0;switch(o(this,lp)){case 90:r=s/e,a=-e/s,c=e;break;case 180:n=-1,l=-1,c=e,u=s;break;case 270:r=-s/e,a=e/s,u=s;break;default:return""}return`matrix(${n} ${r} ${a} ${l} ${H.svgRound(c)} ${H.svgRound(u)})`}getPathResizingSVGProperties([e,s,n,r]){const[a,l]=x(this,ms,kr).call(this),[c,u,h,d]=o(this,js);if(Math.abs(h-a)<=H.PRECISION||Math.abs(d-l)<=H.PRECISION){const S=e+n/2-(c+h/2),p=s+r/2-(u+d/2);return{path:{"transform-origin":`${H.svgRound(e)} ${H.svgRound(s)}`,transform:`${this.rotationTransform} translate(${S} ${p})`}}}const f=(n-2*a)/(h-2*a),g=(r-2*l)/(d-2*l),b=h/n,v=d/r;return{path:{"transform-origin":`${H.svgRound(c)} ${H.svgRound(u)}`,transform:`${this.rotationTransform} scale(${b} ${v}) translate(${H.svgRound(a)} ${H.svgRound(l)}) scale(${f} ${g}) translate(${H.svgRound(-a)} ${H.svgRound(-l)})`}}}getPathResizedSVGProperties([e,s,n,r]){const[a,l]=x(this,ms,kr).call(this),c=o(this,js),[u,h,d,f]=c;if(c[0]=e,c[1]=s,c[2]=n,c[3]=r,Math.abs(d-a)<=H.PRECISION||Math.abs(f-l)<=H.PRECISION){const p=e+n/2-(u+d/2),w=s+r/2-(h+f/2);for(const{line:y,points:E}of o(this,Ei))H._translate(y,p,w,y),H._translate(E,p,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(e)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(n-2*a)/(d-2*a),b=(r-2*l)/(f-2*l),v=-g*(u+a)+e+a,S=-b*(h+l)+s+l;if(g!==1||b!==1||v!==0||S!==0)for(const{line:p,points:w}of o(this,Ei))H._rescale(p,v,S,g,b,p),H._rescale(w,v,S,g,b,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(e)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,s],n){const[r,a]=n,l=o(this,js),c=e-l[0],u=s-l[1];if(o(this,cr)===r&&o(this,ur)===a)for(const{line:h,points:d}of o(this,Ei))H._translate(h,c,u,h),H._translate(d,c,u,d);else{const h=o(this,cr)/r,d=o(this,ur)/a;m(this,cr,r),m(this,ur,a);for(const{line:f,points:g}of o(this,Ei))H._rescale(f,c,u,h,d,f),H._rescale(g,c,u,h,d,g);l[2]*=h,l[3]*=d}return l[0]=e,l[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(e)} ${H.svgRound(s)}`}}}get defaultSVGProperties(){const e=o(this,js);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(e[0])} ${H.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}js=new WeakMap,lp=new WeakMap,cp=new WeakMap,Ei=new WeakMap,cr=new WeakMap,ur=new WeakMap,vd=new WeakMap,wd=new WeakMap,jc=new WeakMap,ms=new WeakSet,kr=function(e=o(this,jc)){const s=o(this,cp)+e/2*o(this,vd);return o(this,wd)%180===0?[s/o(this,cr),s/o(this,ur)]:[s/o(this,ur),s/o(this,cr)]},Jk=function(){const[e,s,n,r]=o(this,js),[a,l]=x(this,ms,kr).call(this,0);return[e+a,s+l,n-2*a,r-2*l]},Zk=function(){const e=m(this,js,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of o(this,Ei)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6)$.pointBoundingBox(r[c],r[c+1],e);continue}let a=r[4],l=r[5];for(let c=6,u=r.length;c<u;c+=6){const[h,d,f,g,b,v]=r.subarray(c,c+6);$.bezierBoundingBox(a,l,h,d,f,g,b,v,e),a=b,l=v}}const[s,n]=x(this,ms,kr).call(this);e[0]=Is(e[0]-s,0,1),e[1]=Is(e[1]-n,0,1),e[2]=Is(e[2]+s,0,1),e[3]=Is(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]},tN=function(e){const[s,n]=x(this,ms,kr).call(this);m(this,jc,e);const[r,a]=x(this,ms,kr).call(this),[l,c]=[r-s,a-n],u=o(this,js);return u[0]-=l,u[1]-=c,u[2]+=2*l,u[3]+=2*c,u};class Kb extends Wk{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:ee._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Kb(this._viewParameters);return t.updateAll(this),t}}var wb,eN;const Vu=class Vu extends sb{constructor(e){super({...e,name:"inkEditor"});A(this,wb);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,s){ee.initialize(e,s),this._defaultDrawingOptions=new Kb(s.viewParameters)}static getDefaultDrawingOptions(e){const s=this._defaultDrawingOptions.clone();return s.updateProperties(e),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return ut(this,"typesMap",new Map([[At.INK_THICKNESS,"stroke-width"],[At.INK_COLOR,"stroke"],[At.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,s,n,r,a){return new N4(e,s,n,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,s,n,r,a,l){return kp.deserialize(e,s,n,r,a,l)}static async deserialize(e,s,n){let r=null;if(e instanceof ex){const{data:{inkLists:l,rect:c,rotation:u,id:h,color:d,opacity:f,borderStyle:{rawWidth:g},popupRef:b,richText:v,contentsObj:S,creationDate:p,modificationDate:w},parent:{page:{pageNumber:y}}}=e;r=e={annotationType:ot.INK,color:Array.from(d),thickness:g,opacity:f,paths:{points:l},boxes:null,pageIndex:y-1,rect:c.slice(0),rotation:u,annotationElementId:h,id:h,deleted:!1,popupRef:b,richText:v,comment:(S==null?void 0:S.str)||null,creationDate:p,modificationDate:w}}const a=await super.deserialize(e,s,n);return a._initialData=r,e.comment&&a.setCommentData(e),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new J0(this)),[["colorPicker",this._colorPicker]]}get colorType(){return At.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:s,parent:n}=this;s.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:s,opacity:n}){this._drawingOptions=Vu.getDefaultDrawingOptions({stroke:$.makeHexColor(...e),"stroke-width":s,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":l}}=this,c=Object.assign(super.serialize(e),{color:ee._colorManager.convert(r),opacity:a,thickness:l,paths:{lines:s,points:n}});return this.addComment(c),e?(c.isCopy=!0,c):this.annotationElementId&&!x(this,wb,eN).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:s,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:s,popup:this.comment}),null}};wb=new WeakSet,eN=function(e){const{color:s,thickness:n,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((l,c)=>l!==s[c])||e.thickness!==n||e.opacity!==r||e.pageIndex!==a},B(Vu,"_type","ink"),B(Vu,"_editorType",ot.INK),B(Vu,"_defaultDrawingOptions",null);let _A=Vu;class AA extends kp{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const dy=8,cf=3;var Lc,Mt,SA,jn,sN,iN,xA,i0,nN,rN,aN,EA,TA,oN;class pa{static extractContoursFromText(t,{fontFamily:e,fontStyle:s,fontWeight:n},r,a,l,c){let u=new OffscreenCanvas(1,1),h=u.getContext("2d",{alpha:!1});const d=200,f=h.font=`${s} ${n} ${d}px ${e}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:b,actualBoundingBoxAscent:v,actualBoundingBoxDescent:S,fontBoundingBoxAscent:p,fontBoundingBoxDescent:w,width:y}=h.measureText(t),E=1.5,T=Math.ceil(Math.max(Math.abs(g)+Math.abs(b)||0,y)*E),C=Math.ceil(Math.max(Math.abs(v)+Math.abs(S)||d,Math.abs(p)+Math.abs(w)||d)*E);u=new OffscreenCanvas(T,C),h=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=f,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,T,C),h.fillStyle="black",h.fillText(t,T*(E-1)/2,C*(3-E)/2);const R=x(this,Mt,EA).call(this,h.getImageData(0,0,T,C).data),O=x(this,Mt,aN).call(this,R),k=x(this,Mt,TA).call(this,O),D=x(this,Mt,xA).call(this,R,T,C,k);return this.processDrawnLines({lines:{curves:D,width:T,height:C},pageWidth:r,pageHeight:a,rotation:l,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(t,e,s,n,r){const[a,l,c]=x(this,Mt,oN).call(this,t),[u,h]=x(this,Mt,rN).call(this,a,l,c,Math.hypot(l,c)*o(this,Lc).sigmaSFactor,o(this,Lc).sigmaR,o(this,Lc).kernelSize),d=x(this,Mt,TA).call(this,h),f=x(this,Mt,xA).call(this,u,l,c,d);return this.processDrawnLines({lines:{curves:f,width:l,height:c},pageWidth:e,pageHeight:s,rotation:n,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:s,rotation:n,innerMargin:r,mustSmooth:a,areContours:l}){n%180!==0&&([e,s]=[s,e]);const{curves:c,width:u,height:h}=t,d=t.thickness??0,f=[],g=Math.min(e/u,s/h),b=g/e,v=g/s,S=[];for(const{points:w}of c){const y=a?x(this,Mt,nN).call(this,w):w;if(!y)continue;S.push(y);const E=y.length,T=new Float32Array(E),C=new Float32Array(3*(E===2?2:E-2));if(f.push({line:C,points:T}),E===2){T[0]=y[0]*b,T[1]=y[1]*v,C.set([NaN,NaN,NaN,NaN,T[0],T[1]],0);continue}let[R,O,k,D]=y;R*=b,O*=v,k*=b,D*=v,T.set([R,O,k,D],0),C.set([NaN,NaN,NaN,NaN,R,O],0);for(let P=4;P<E;P+=2){const I=T[P]=y[P]*b,Z=T[P+1]=y[P+1]*v;C.set(H.createBezierPoints(R,O,k,D,I,Z),(P-2)*3),[R,O,k,D]=[k,D,I,Z]}}if(f.length===0)return null;const p=l?new AA:new kp;return p.build(f,e,s,1,n,l?0:d,r),{outline:p,newCurves:S,areContours:l,thickness:d,width:u,height:h}}static async compressSignature({outlines:t,areContours:e,thickness:s,width:n,height:r}){let a=1/0,l=-1/0,c=0;for(const y of t){c+=y.length;for(let E=2,T=y.length;E<T;E++){const C=y[E]-y[E-2];a=Math.min(a,C),l=Math.max(l,C)}}let u;a>=-128&&l<=127?u=Int8Array:a>=-32768&&l<=32767?u=Int16Array:u=Int32Array;const h=t.length,d=dy+cf*h,f=new Uint32Array(d);let g=0;f[g++]=d*Uint32Array.BYTES_PER_ELEMENT+(c-2*h)*u.BYTES_PER_ELEMENT,f[g++]=0,f[g++]=n,f[g++]=r,f[g++]=e?0:1,f[g++]=Math.max(0,Math.floor(s??0)),f[g++]=h,f[g++]=u.BYTES_PER_ELEMENT;for(const y of t)f[g++]=y.length-2,f[g++]=y[0],f[g++]=y[1];const b=new CompressionStream("deflate-raw"),v=b.writable.getWriter();await v.ready,v.write(f);const S=u.prototype.constructor;for(const y of t){const E=new S(y.length-2);for(let T=2,C=y.length;T<C;T++)E[T-2]=y[T]-y[T-2];v.write(E)}v.close();const p=await new Response(b.readable).arrayBuffer(),w=new Uint8Array(p);return rO(w)}static async decompressSignature(t){try{const e=XB(t),{readable:s,writable:n}=new DecompressionStream("deflate-raw"),r=n.getWriter();await r.ready,r.write(e).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,l=0;for await(const y of s)a||(a=new Uint8Array(new Uint32Array(y.buffer,0,4)[0])),a.set(y,l),l+=y.length;const c=new Uint32Array(a.buffer,0,a.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const h=c[2],d=c[3],f=c[4]===0,g=c[5],b=c[6],v=c[7],S=[],p=(dy+cf*b)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(v){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(a.buffer,p);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(a.buffer,p);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(a.buffer,p);break}l=0;for(let y=0;y<b;y++){const E=c[cf*y+dy],T=new Float32Array(E+2);S.push(T);for(let C=0;C<cf-1;C++)T[C]=c[cf*y+dy+C+1];for(let C=0;C<E;C++)T[C+2]=T[C]+w[l++]}return{areContours:f,thickness:g,outlines:S,width:h,height:d}}catch(e){return nt(`decompressSignature: ${e}`),null}}}Lc=new WeakMap,Mt=new WeakSet,SA=function(t,e,s,n){return s-=t,n-=e,s===0?n>0?0:4:s===1?n+6:2-n},jn=new WeakMap,sN=function(t,e,s,n,r,a,l){const c=x(this,Mt,SA).call(this,s,n,r,a);for(let u=0;u<8;u++){const h=(-u+c-l+16)%8,d=o(this,jn)[2*h],f=o(this,jn)[2*h+1];if(t[(s+d)*e+(n+f)]!==0)return h}return-1},iN=function(t,e,s,n,r,a,l){const c=x(this,Mt,SA).call(this,s,n,r,a);for(let u=0;u<8;u++){const h=(u+c+l+16)%8,d=o(this,jn)[2*h],f=o(this,jn)[2*h+1];if(t[(s+d)*e+(n+f)]!==0)return h}return-1},xA=function(t,e,s,n){const r=t.length,a=new Int32Array(r);for(let h=0;h<r;h++)a[h]=t[h]<=n?1:0;for(let h=1;h<s-1;h++)a[h*e]=a[h*e+e-1]=0;for(let h=0;h<e;h++)a[h]=a[e*s-1-h]=0;let l=1,c;const u=[];for(let h=1;h<s-1;h++){c=1;for(let d=1;d<e-1;d++){const f=h*e+d,g=a[f];if(g===0)continue;let b=h,v=d;if(g===1&&a[f-1]===0)l+=1,v-=1;else if(g>=1&&a[f+1]===0)l+=1,v+=1,g>1&&(c=g);else{g!==1&&(c=Math.abs(g));continue}const S=[d,h],p=v===d+1,w={isHole:p,points:S,id:l,parent:0};u.push(w);let y;for(const P of u)if(P.id===c){y=P;break}y?y.isHole?w.parent=p?y.parent:c:w.parent=p?c:y.parent:w.parent=p?c:0;const E=x(this,Mt,sN).call(this,a,e,h,d,b,v,0);if(E===-1){a[f]=-l,a[f]!==1&&(c=Math.abs(a[f]));continue}let T=o(this,jn)[2*E],C=o(this,jn)[2*E+1];const R=h+T,O=d+C;b=R,v=O;let k=h,D=d;for(;;){const P=x(this,Mt,iN).call(this,a,e,k,D,b,v,1);T=o(this,jn)[2*P],C=o(this,jn)[2*P+1];const I=k+T,Z=D+C;S.push(Z,I);const K=k*e+D;if(a[K+1]===0?a[K]=-l:a[K]===1&&(a[K]=l),I===h&&Z===d&&k===R&&D===O){a[f]!==1&&(c=Math.abs(a[f]));break}else b=k,v=D,k=I,D=Z}}}return u},i0=function(t,e,s,n){if(s-e<=4){for(let R=e;R<s-2;R+=2)n.push(t[R],t[R+1]);return}const r=t[e],a=t[e+1],l=t[s-4]-r,c=t[s-3]-a,u=Math.hypot(l,c),h=l/u,d=c/u,f=h*a-d*r,g=c/l,b=1/u,v=Math.atan(g),S=Math.cos(v),p=Math.sin(v),w=b*(Math.abs(S)+Math.abs(p)),y=b*(1-w+w**2),E=Math.max(Math.atan(Math.abs(p+S)*y),Math.atan(Math.abs(p-S)*y));let T=0,C=e;for(let R=e+2;R<s-2;R+=2){const O=Math.abs(f-h*t[R+1]+d*t[R]);O>T&&(C=R,T=O)}T>(u*E)**2?(x(this,Mt,i0).call(this,t,e,C+2,n),x(this,Mt,i0).call(this,t,C,s,n)):n.push(r,a)},nN=function(t){const e=[],s=t.length;return x(this,Mt,i0).call(this,t,0,s,e),e.push(t[s-2],t[s-1]),e.length<=4?null:e},rN=function(t,e,s,n,r,a){const l=new Float32Array(a**2),c=-2*n**2,u=a>>1;for(let v=0;v<a;v++){const S=(v-u)**2;for(let p=0;p<a;p++)l[v*a+p]=Math.exp((S+(p-u)**2)/c)}const h=new Float32Array(256),d=-2*r**2;for(let v=0;v<256;v++)h[v]=Math.exp(v**2/d);const f=t.length,g=new Uint8Array(f),b=new Uint32Array(256);for(let v=0;v<s;v++)for(let S=0;S<e;S++){const p=v*e+S,w=t[p];let y=0,E=0;for(let C=0;C<a;C++){const R=v+C-u;if(!(R<0||R>=s))for(let O=0;O<a;O++){const k=S+O-u;if(k<0||k>=e)continue;const D=t[R*e+k],P=l[C*a+O]*h[Math.abs(D-w)];y+=D*P,E+=P}}const T=g[p]=Math.round(y/E);b[T]++}return[g,b]},aN=function(t){const e=new Uint32Array(256);for(const s of t)e[s]++;return e},EA=function(t){const e=t.length,s=new Uint8ClampedArray(e>>2);let n=-1/0,r=1/0;for(let l=0,c=s.length;l<c;l++){const u=s[l]=t[l<<2];n=Math.max(n,u),r=Math.min(r,u)}const a=255/(n-r);for(let l=0,c=s.length;l<c;l++)s[l]=(s[l]-r)*a;return s},TA=function(t){let e,s=-1/0,n=-1/0;const r=t.findIndex(c=>c!==0);let a=r,l=r;for(e=r;e<256;e++){const c=t[e];c>s&&(e-a>n&&(n=e-a,l=e-1),s=c,a=e)}for(e=l-1;e>=0&&!(t[e]>t[e+1]);e--);return e},oN=function(t){const e=t,{width:s,height:n}=t,{maxDim:r}=o(this,Lc);let a=s,l=n;if(s>r||n>r){let f=s,g=n,b=Math.log2(Math.max(s,n)/r);const v=Math.floor(b);b=b===v?v-1:v;for(let p=0;p<b;p++){a=Math.ceil(f/2),l=Math.ceil(g/2);const w=new OffscreenCanvas(a,l);w.getContext("2d").drawImage(t,0,0,f,g,0,0,a,l),f=a,g=l,t!==e&&t.close(),t=w.transferToImageBitmap()}const S=Math.min(r/a,r/l);a=Math.round(a*S),l=Math.round(l*S)}const u=new OffscreenCanvas(a,l).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,a,l),u.filter="grayscale(1)",u.drawImage(t,0,0,t.width,t.height,0,0,a,l);const h=u.getImageData(0,0,a,l).data;return[x(this,Mt,EA).call(this,h),a,l]},A(pa,Mt),A(pa,Lc,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),A(pa,jn,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class sx extends Wk{constructor(){super(),super.updateProperties({fill:ee._defaultLineColor,"stroke-width":0})}clone(){const t=new sx;return t.updateAll(this),t}}class ix extends Kb{constructor(t){super(t),super.updateProperties({stroke:ee._defaultLineColor,"stroke-width":1})}clone(){const t=new ix(this._viewParameters);return t.updateAll(this),t}}var Ro,hr,Oo,Pc;const li=class li extends sb{constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"});A(this,Ro,!1);A(this,hr,null);A(this,Oo,null);A(this,Pc,null);this._willKeepAspectRatio=!0,m(this,Oo,e.signatureData||null),m(this,hr,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,s){ee.initialize(e,s),this._defaultDrawingOptions=new sx,this._defaultDrawnSignatureOptions=new ix(s.viewParameters)}static getDefaultDrawingOptions(e){const s=this._defaultDrawingOptions.clone();return s.updateProperties(e),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return ut(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!o(this,hr)}}static computeTelemetryFinalData(e){const s=e.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,s;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,s=this.y),super.render(),this._drawId===null)if(o(this,Oo)){const{lines:r,mustSmooth:a,areContours:l,description:c,uuid:u,heightInPage:h}=o(this,Oo),{rawDims:{pageWidth:d,pageHeight:f},rotation:g}=this.parent.viewport,b=pa.processDrawnLines({lines:r,pageWidth:d,pageHeight:f,rotation:g,innerMargin:li._INNER_MARGIN,mustSmooth:a,areContours:l});this.addSignature(b,h,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:o(this,hr)||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,s)),this.div}setUuid(e){m(this,Pc,e),this.addEditToolbar()}getUuid(){return o(this,Pc)}get description(){return o(this,hr)}set description(e){m(this,hr,e),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:s,thickness:n,width:r,height:a}=o(this,Oo),l=Math.max(r,a),c=pa.processDrawnLines({lines:{curves:e.map(u=>({points:u})),thickness:n,width:r,height:a},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,s,n,r){const{x:a,y:l}=this,{outline:c}=m(this,Oo,e);m(this,Ro,c instanceof AA),this.description=n;let u;o(this,Ro)?u=li.getDefaultDrawingOptions():(u=li._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[,h]=this.pageDimensions;let d=s/h;d=d>=1?.5:d,this.width*=d/this.height,this.width>=1&&(d*=.9/this.width,this.width=.9),this.height=d,this.setDims(),this.x=a,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:s,pageHeight:n},rotation:r}=this.parent.viewport;return pa.process(e,s,n,r,li._INNER_MARGIN)}getFromText(e,s){const{rawDims:{pageWidth:n,pageHeight:r},rotation:a}=this.parent.viewport;return pa.extractContoursFromText(e,s,n,r,a,li._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:s,pageHeight:n},rotation:r}=this.parent.viewport;return pa.processDrawnLines({lines:e,pageWidth:s,pageHeight:n,rotation:r,innerMargin:li._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:s}){e?this._drawingOptions=li.getDefaultDrawingOptions():(this._drawingOptions=li._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:s,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":r}}=this,a=Object.assign(super.serialize(e),{isSignature:!0,areContours:o(this,Ro),color:[0,0,0],thickness:o(this,Ro)?0:r});return this.addComment(a),e?(a.paths={lines:s,points:n},a.uuid=o(this,Pc),a.isCopy=!0):a.lines=s,o(this,hr)&&(a.accessibilityData={type:"Figure",alt:o(this,hr)}),a}static deserializeDraw(e,s,n,r,a,l){return l.areContours?AA.deserialize(e,s,n,r,a,l):kp.deserialize(e,s,n,r,a,l)}static async deserialize(e,s,n){var a;const r=await super.deserialize(e,s,n);return m(r,Ro,e.areContours),r.description=((a=e.accessibilityData)==null?void 0:a.alt)||"",m(r,Pc,e.uuid),r}};Ro=new WeakMap,hr=new WeakMap,Oo=new WeakMap,Pc=new WeakMap,B(li,"_type","signature"),B(li,"_editorType",ot.SIGNATURE),B(li,"_defaultDrawingOptions",null);let CA=li;var ue,ss,ko,ua,No,_d,ha,Bc,dr,Ti,Ad,Tt,Lf,Pf,n0,r0,a0,OA,o0,lN;class RA extends ee{constructor(e){super({...e,name:"stampEditor"});A(this,Tt);A(this,ue,null);A(this,ss,null);A(this,ko,null);A(this,ua,null);A(this,No,null);A(this,_d,"");A(this,ha,null);A(this,Bc,!1);A(this,dr,null);A(this,Ti,!1);A(this,Ad,!1);m(this,ua,e.bitmapUrl),m(this,No,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,s){ee.initialize(e,s)}static isHandlingMimeForPasting(e){return f_.includes(e)}static paste(e,s){s.pasteEditor({mode:ot.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const s=e.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(e=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:l}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:r,width:a,height:l,channels:r.length/(a*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var e;o(this,ss)&&(m(this,ue,null),this._uiManager.imageManager.deleteId(o(this,ss)),(e=o(this,ha))==null||e.remove(),m(this,ha,null),o(this,dr)&&(clearTimeout(o(this,dr)),m(this,dr,null))),super.remove()}rebuild(){if(!this.parent){o(this,ss)&&x(this,Tt,n0).call(this);return}super.rebuild(),this.div!==null&&(o(this,ss)&&o(this,ha)===null&&x(this,Tt,n0).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(o(this,ko)||o(this,ue)||o(this,ua)||o(this,No)||o(this,ss)||o(this,Bc))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,s;return this._isCopy&&(e=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),o(this,Bc)||(o(this,ue)?x(this,Tt,r0).call(this):x(this,Tt,n0).call(this)),this._isCopy&&this._moveAfterPaste(e,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,s){const{id:n,bitmap:r}=this._uiManager.imageManager.getFromCanvas(e,s);s.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(m(this,ss,n),r&&m(this,ue,r),m(this,Bc,!1),x(this,Tt,r0).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;o(this,dr)!==null&&clearTimeout(o(this,dr)),m(this,dr,setTimeout(()=>{m(this,dr,null),x(this,Tt,OA).call(this)},200))}copyCanvas(e,s,n=!1){e||(e=224);const{width:r,height:a}=o(this,ue),l=new vr;let c=o(this,ue),u=r,h=a,d=null;if(s){if(r>s||a>s){const R=Math.min(s/r,s/a);u=Math.floor(r*R),h=Math.floor(a*R)}d=document.createElement("canvas");const g=d.width=Math.ceil(u*l.sx),b=d.height=Math.ceil(h*l.sy);o(this,Ti)||(c=x(this,Tt,a0).call(this,g,b));const v=d.getContext("2d");v.filter=this._uiManager.hcmFilter;let S="white",p="#cfcfd8";this._uiManager.hcmFilter!=="none"?p="black":ZB.isDarkMode&&(S="#8f8f9d",p="#42414d");const w=15,y=w*l.sx,E=w*l.sy,T=new OffscreenCanvas(y*2,E*2),C=T.getContext("2d");C.fillStyle=S,C.fillRect(0,0,y*2,E*2),C.fillStyle=p,C.fillRect(0,0,y,E),C.fillRect(y,E,y,E),v.fillStyle=v.createPattern(T,"repeat"),v.fillRect(0,0,g,b),v.drawImage(c,0,0,c.width,c.height,0,0,g,b)}let f=null;if(n){let g,b;if(l.symmetric&&c.width<e&&c.height<e)g=c.width,b=c.height;else if(c=o(this,ue),r>e||a>e){const p=Math.min(e/r,e/a);g=Math.floor(r*p),b=Math.floor(a*p),o(this,Ti)||(c=x(this,Tt,a0).call(this,g,b))}const S=new OffscreenCanvas(g,b).getContext("2d",{willReadFrequently:!0});S.drawImage(c,0,0,c.width,c.height,0,0,g,b),f={width:g,height:b,data:S.getImageData(0,0,g,b).data}}return{canvas:d,width:u,height:h,imageData:f}}static async deserialize(e,s,n){var S;let r=null,a=!1;if(e instanceof xk){const{data:{rect:p,rotation:w,id:y,structParent:E,popupRef:T,richText:C,contentsObj:R,creationDate:O,modificationDate:k},container:D,parent:{page:{pageNumber:P}},canvas:I}=e;let Z,K;I?(delete e.canvas,{id:Z,bitmap:K}=n.imageManager.getFromCanvas(D.id,I),I.remove()):(a=!0,e._hasNoCanvas=!0);const W=((S=await s._structTree.getAriaAttributes(`${Fu}${y}`))==null?void 0:S.get("aria-label"))||"";r=e={annotationType:ot.STAMP,bitmapId:Z,bitmap:K,pageIndex:P-1,rect:p.slice(0),rotation:w,annotationElementId:y,id:y,deleted:!1,accessibilityData:{decorative:!1,altText:W},isSvg:!1,structParent:E,popupRef:T,richText:C,comment:(R==null?void 0:R.str)||null,creationDate:O,modificationDate:k}}const l=await super.deserialize(e,s,n),{rect:c,bitmap:u,bitmapUrl:h,bitmapId:d,isSvg:f,accessibilityData:g}=e;a?(n.addMissingCanvas(e.id,l),m(l,Bc,!0)):d&&n.imageManager.isValidId(d)?(m(l,ss,d),u&&m(l,ue,u)):m(l,ua,h),m(l,Ti,f);const[b,v]=l.pageDimensions;return l.width=(c[2]-c[0])/b,l.height=(c[3]-c[1])/v,g&&(l.altTextData=g),l._initialData=r,e.comment&&l.setCommentData(e),m(l,Ad,!!r),l}serialize(e=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:o(this,ss),isSvg:o(this,Ti)});if(this.addComment(n),e)return n.bitmapUrl=x(this,Tt,o0).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=x(this,Tt,lN).call(this,n);return c.isSame?null:(c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(s===null)return n;s.stamps||(s.stamps=new Map);const l=o(this,Ti)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!s.stamps.has(o(this,ss)))s.stamps.set(o(this,ss),{area:l,serialized:n}),n.bitmap=x(this,Tt,o0).call(this,!1);else if(o(this,Ti)){const c=s.stamps.get(o(this,ss));l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=x(this,Tt,o0).call(this,!1))}return n}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}ue=new WeakMap,ss=new WeakMap,ko=new WeakMap,ua=new WeakMap,No=new WeakMap,_d=new WeakMap,ha=new WeakMap,Bc=new WeakMap,dr=new WeakMap,Ti=new WeakMap,Ad=new WeakMap,Tt=new WeakSet,Lf=function(e,s=!1){if(!e){this.remove();return}m(this,ue,e.bitmap),s||(m(this,ss,e.id),m(this,Ti,e.isSvg)),e.file&&m(this,_d,e.file.name),x(this,Tt,r0).call(this)},Pf=function(){if(m(this,ko,null),this._uiManager.enableWaiting(!1),!!o(this,ha)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,ue)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,ue)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},n0=function(){if(o(this,ss)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(o(this,ss)).then(n=>x(this,Tt,Lf).call(this,n,!0)).finally(()=>x(this,Tt,Pf).call(this));return}if(o(this,ua)){const n=o(this,ua);m(this,ua,null),this._uiManager.enableWaiting(!0),m(this,ko,this._uiManager.imageManager.getFromUrl(n).then(r=>x(this,Tt,Lf).call(this,r)).finally(()=>x(this,Tt,Pf).call(this)));return}if(o(this,No)){const n=o(this,No);m(this,No,null),this._uiManager.enableWaiting(!0),m(this,ko,this._uiManager.imageManager.getFromFile(n).then(r=>x(this,Tt,Lf).call(this,r)).finally(()=>x(this,Tt,Pf).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=f_.join(",");const s=this._uiManager._signal;m(this,ko,new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),x(this,Tt,Lf).call(this,r)}n()},{signal:s}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:s})}).finally(()=>x(this,Tt,Pf).call(this))),e.click()},r0=function(){var u;const{div:e}=this;let{width:s,height:n}=o(this,ue);const[r,a]=this.pageDimensions,l=.75;if(this.width)s=this.width*r,n=this.height*a;else if(s>l*r||n>l*a){const h=Math.min(l*r/s,l*a/n);s*=h,n*=h}this._uiManager.enableWaiting(!1);const c=m(this,ha,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this.width=s/r,this.height=n/a,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),x(this,Tt,OA).call(this),o(this,Ad)||(this.parent.addUndoableEditor(this),m(this,Ad,!0)),this._reportTelemetry({action:"inserted_image"}),o(this,_d)&&this.div.setAttribute("aria-description",o(this,_d)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},a0=function(e,s){const{width:n,height:r}=o(this,ue);let a=n,l=r,c=o(this,ue);for(;a>2*e||l>2*s;){const u=a,h=l;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*s&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const d=new OffscreenCanvas(a,l);d.getContext("2d").drawImage(c,0,0,u,h,0,0,a,l),c=d.transferToImageBitmap()}return c},OA=function(){const[e,s]=this.parentDimensions,{width:n,height:r}=this,a=new vr,l=Math.ceil(n*e*a.sx),c=Math.ceil(r*s*a.sy),u=o(this,ha);if(!u||u.width===l&&u.height===c)return;u.width=l,u.height=c;const h=o(this,Ti)?o(this,ue):x(this,Tt,a0).call(this,l,c),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,l,c)},o0=function(e){if(e){if(o(this,Ti)){const r=this._uiManager.imageManager.getSvgUrl(o(this,ss));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=o(this,ue),s.getContext("2d").drawImage(o(this,ue),0,0),s.toDataURL()}if(o(this,Ti)){const[s,n]=this.pageDimensions,r=Math.round(this.width*s*sl.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*sl.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(r,a);return l.getContext("2d").drawImage(o(this,ue),0,0,o(this,ue).width,o(this,ue).height,0,0,r,a),l.transferToImageBitmap()}return structuredClone(o(this,ue))},lN=function(e){var l;const{pageIndex:s,accessibilityData:{altText:n}}=this._initialData,r=e.pageIndex===s,a=(((l=e.accessibilityData)==null?void 0:l.alt)||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},B(RA,"_type","stamp"),B(RA,"_editorType",ot.STAMP);var Ic,Sd,Mo,Do,da,ei,jo,xd,Ed,Ln,fa,is,ga,Lo,Td,V,Po,Kt,NA,cN,qn,MA,DA,l0;const Sn=class Sn{constructor({uiManager:t,pageIndex:e,div:s,structTreeLayer:n,accessibilityManager:r,annotationLayer:a,drawLayer:l,textLayer:c,viewport:u,l10n:h}){A(this,Kt);A(this,Ic);A(this,Sd,!1);A(this,Mo,null);A(this,Do,null);A(this,da,null);A(this,ei,new Map);A(this,jo,!1);A(this,xd,!1);A(this,Ed,!1);A(this,Ln,null);A(this,fa,null);A(this,is,null);A(this,ga,null);A(this,Lo,null);A(this,Td,-1);A(this,V);const d=[...o(Sn,Po).values()];if(!Sn._initialized){Sn._initialized=!0;for(const f of d)f.initialize(h,t)}t.registerEditorTypes(d),m(this,V,t),this.pageIndex=e,this.div=s,m(this,Ic,r),m(this,Mo,a),this.viewport=u,m(this,is,c),this.drawLayer=l,this._structTree=n,o(this,V).addLayer(this)}get isEmpty(){return o(this,ei).size===0}get isInvisible(){return this.isEmpty&&o(this,V).getMode()===ot.NONE}updateToolbar(t){o(this,V).updateToolbar(t)}updateMode(t=o(this,V).getMode()){switch(x(this,Kt,l0).call(this),t){case ot.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ot.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ot.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===ot.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const s of o(Sn,Po).values())e.toggle(`${s._type}Editing`,t===s._editorType)}this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=o(this,is))==null?void 0:e.div)}setEditingState(t){o(this,V).setEditingState(t)}addCommands(t){o(this,V).addCommands(t)}cleanUndoStack(t){o(this,V).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=o(this,Mo))==null||e.togglePointerEvents(t)}async enable(){var s;m(this,Ed,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(s=o(this,Lo))==null||s.abort(),m(this,Lo,null);const t=new Set;for(const n of o(this,Kt,NA))n.enableEditing(),n.show(!0),n.annotationElementId&&(o(this,V).removeChangedExistingAnnotation(n),t.add(n.annotationElementId));const e=o(this,Mo);if(e)for(const n of e.getEditableAnnotations()){if(n.hide(),o(this,V).isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const r=await this.deserialize(n);r&&(this.addOrRebuild(r),r.enableEditing())}m(this,Ed,!1),o(this,V)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var n;if(m(this,xd,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),o(this,is)&&!o(this,Lo)){m(this,Lo,new AbortController);const r=o(this,V).combinedSignal(o(this,Lo));o(this,is).div.addEventListener("pointerdown",a=>{const{clientX:c,clientY:u,timeStamp:h}=a,d=o(this,Td);if(h-d>500){m(this,Td,h);return}m(this,Td,-1);const{classList:f}=this.div;f.toggle("getElements",!0);const g=document.elementsFromPoint(c,u);if(f.toggle("getElements",!1),!this.div.contains(g[0]))return;let b;const v=new RegExp(`^${yg}[0-9]+$`);for(const p of g)if(v.test(p.id)){b=p.id;break}if(!b)return;const S=o(this,ei).get(b);(S==null?void 0:S.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),S.dblclick(a))},{signal:r,capture:!0})}const t=o(this,Mo),e=[];if(t){const r=new Map,a=new Map;for(const c of o(this,Kt,NA)){if(c.disableEditing(),!c.annotationElementId){e.push(c);continue}if(c.serialize()!==null){r.set(c.annotationElementId,c);continue}else a.set(c.annotationElementId,c);(n=this.getEditableAnnotation(c.annotationElementId))==null||n.show(),c.remove()}const l=t.getEditableAnnotations();for(const c of l){const{id:u}=c.data;if(o(this,V).isDeletedAnnotationElement(u)){c.updateEdited({deleted:!0});continue}let h=a.get(u);if(h){h.resetAnnotationElement(c),h.show(!1),c.show();continue}h=r.get(u),h&&(o(this,V).addChangedExistingAnnotation(h),h.renderAnnotationElement(c)&&h.show(!1)),c.show()}}x(this,Kt,l0).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of o(Sn,Po).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t==null||t.updateFakeAnnotations(e),m(this,xd,!1)}getEditableAnnotation(t){var e;return((e=o(this,Mo))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){o(this,V).getActive()!==t&&o(this,V).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=o(this,is))!=null&&t.div&&!o(this,ga)){m(this,ga,new AbortController);const e=o(this,V).combinedSignal(o(this,ga));o(this,is).div.addEventListener("pointerdown",x(this,Kt,cN).bind(this),{signal:e}),o(this,is).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=o(this,is))!=null&&t.div&&o(this,ga)&&(o(this,ga).abort(),m(this,ga,null),o(this,is).div.classList.remove("highlighting"))}enableClick(){if(o(this,Do))return;m(this,Do,new AbortController);const t=o(this,V).combinedSignal(o(this,Do));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=o(this,Do))==null||t.abort(),m(this,Do,null)}attach(t){o(this,ei).set(t.id,t);const{annotationElementId:e}=t;e&&o(this,V).isDeletedAnnotationElement(e)&&o(this,V).removeDeletedAnnotationElement(t)}detach(t){var e;o(this,ei).delete(t.id),(e=o(this,Ic))==null||e.removePointerInTextLayer(t.contentDiv),!o(this,xd)&&t.annotationElementId&&o(this,V).addDeletedAnnotationElement(t)}remove(t){this.detach(t),o(this,V).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(o(this,V).addDeletedAnnotationElement(t.annotationElementId),ee.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),o(this,V).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!o(this,Ed)),o(this,V).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var s;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!o(this,da)&&(t._focusEventsAllowed=!1,m(this,da,setTimeout(()=>{m(this,da,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:o(this,V)._signal}),e.focus())},0))),t._structTreeParentId=(s=o(this,Ic))==null?void 0:s.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:e,undo:s,mustExec:!1})}getEditorByUID(t){for(const e of o(this,ei).values())if(e.uid===t)return e;return null}getNextId(){return o(this,V).getId()}combinedSignal(t){return o(this,V).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=o(this,Kt,qn))==null?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await o(this,V).updateMode(t.mode);const{offsetX:s,offsetY:n}=x(this,Kt,DA).call(this),r=this.getNextId(),a=x(this,Kt,MA).call(this,{parent:this,id:r,x:s,y:n,uiManager:o(this,V),isCentered:!0,...e});a&&this.add(a)}async deserialize(t){var e;return await((e=o(Sn,Po).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,o(this,V)))||null}createAndAddNewEditor(t,e,s={}){const n=this.getNextId(),r=x(this,Kt,MA).call(this,{parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:o(this,V),isCentered:e,...s});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(t={}){this.createAndAddNewEditor(x(this,Kt,DA).call(this),!0,t)}setSelected(t){o(this,V).setSelected(t)}toggleSelected(t){o(this,V).toggleSelected(t)}unselect(t){o(this,V).unselect(t)}pointerup(t){var n;const{isMac:e}=_s.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!o(this,jo)||(m(this,jo,!1),(n=o(this,Kt,qn))!=null&&n.isDrawer&&o(this,Kt,qn).supportMultipleDrawings))return;if(!o(this,Sd)){m(this,Sd,!0);return}const s=o(this,V).getMode();if(s===ot.STAMP||s===ot.SIGNATURE){o(this,V).unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){var n;if(o(this,V).getMode()===ot.HIGHLIGHT&&this.enableTextSelection(),o(this,jo)){m(this,jo,!1);return}const{isMac:e}=_s.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(m(this,jo,!0),(n=o(this,Kt,qn))!=null&&n.isDrawer){this.startDrawingSession(t);return}const s=o(this,V).getActive();m(this,Sd,!s||s.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),o(this,Ln)){o(this,Kt,qn).startDrawing(this,o(this,V),!1,t);return}o(this,V).setCurrentDrawingSession(this),m(this,Ln,new AbortController);const e=o(this,V).combinedSignal(o(this,Ln));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(m(this,fa,null),this.commitOrRemove())},{signal:e}),o(this,Kt,qn).startDrawing(this,o(this,V),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&m(this,fa,e);return}o(this,fa)&&setTimeout(()=>{var e;(e=o(this,fa))==null||e.focus(),m(this,fa,null)},0)}endDrawingSession(t=!1){return o(this,Ln)?(o(this,V).setCurrentDrawingSession(null),o(this,Ln).abort(),m(this,Ln,null),m(this,fa,null),o(this,Kt,qn).endDrawing(t)):null}findNewParent(t,e,s){const n=o(this,V).findParent(e,s);return n===null||n===this?!1:(n.changeParent(t),!0)}commitOrRemove(){return o(this,Ln)?(this.endDrawingSession(),!0):!1}onScaleChanging(){o(this,Ln)&&o(this,Kt,qn).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=o(this,V).getActive())==null?void 0:t.parent)===this&&(o(this,V).commitOrRemove(),o(this,V).setActiveEditor(null)),o(this,da)&&(clearTimeout(o(this,da)),m(this,da,null));for(const s of o(this,ei).values())(e=o(this,Ic))==null||e.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,o(this,ei).clear(),o(this,V).removeLayer(this)}render({viewport:t}){this.viewport=t,Wc(this.div,t);for(const e of o(this,V).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){o(this,V).commitOrRemove(),x(this,Kt,l0).call(this);const e=this.viewport.rotation,s=t.rotation;if(this.viewport=t,Wc(this.div,{rotation:s}),e!==s)for(const n of o(this,ei).values())n.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return o(this,V).viewParameters.realScale}};Ic=new WeakMap,Sd=new WeakMap,Mo=new WeakMap,Do=new WeakMap,da=new WeakMap,ei=new WeakMap,jo=new WeakMap,xd=new WeakMap,Ed=new WeakMap,Ln=new WeakMap,fa=new WeakMap,is=new WeakMap,ga=new WeakMap,Lo=new WeakMap,Td=new WeakMap,V=new WeakMap,Po=new WeakMap,Kt=new WeakSet,NA=function(){return o(this,ei).size!==0?o(this,ei).values():o(this,V).getEditors(this.pageIndex)},cN=function(t){o(this,V).unselectAll();const{target:e}=t;if(e===o(this,is).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&o(this,is).div.contains(e)){const{isMac:s}=_s.platform;if(t.button!==0||t.ctrlKey&&s)return;o(this,V).showAllEditors("highlight",!0,!0),o(this,is).div.classList.add("free"),this.toggleDrawing(),eb.startHighlighting(this,o(this,V).direction==="ltr",{target:o(this,is).div,x:t.x,y:t.y}),o(this,is).div.addEventListener("pointerup",()=>{o(this,is).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:o(this,V)._signal}),t.preventDefault()}},qn=function(){return o(Sn,Po).get(o(this,V).getMode())},MA=function(t){const e=o(this,Kt,qn);return e?new e.prototype.constructor(t):null},DA=function(){const{x:t,y:e,width:s,height:n}=this.boundingClientRect,r=Math.max(0,t),a=Math.max(0,e),l=Math.min(window.innerWidth,t+s),c=Math.min(window.innerHeight,e+n),u=(r+l)/2-t,h=(a+c)/2-e,[d,f]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:d,offsetY:f}},l0=function(){for(const t of o(this,ei).values())t.isEmpty()&&t.remove()},B(Sn,"_initialized",!1),A(Sn,Po,new Map([hA,_A,RA,eb,CA].map(t=>[t._editorType,t])));let kA=Sn;var Pn,Ls,Uc,up,_b,uN,wr,LA,hN,PA;const qe=class qe{constructor({pageIndex:t}){A(this,wr);A(this,Pn,null);A(this,Ls,new Map);A(this,Uc,new Map);this.pageIndex=t}setParent(t){if(!o(this,Pn)){m(this,Pn,t);return}if(o(this,Pn)!==t){if(o(this,Ls).size>0)for(const e of o(this,Ls).values())e.remove(),t.append(e);m(this,Pn,t)}}static get _svgFactory(){return ut(this,"_svgFactory",new Z0)}draw(t,e=!1,s=!1){const n=Fe(qe,up)._++,r=x(this,wr,LA).call(this),a=qe._svgFactory.createElement("defs");r.append(a);const l=qe._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),e&&o(this,Uc).set(n,l);const u=s?x(this,wr,hN).call(this,a,c):null,h=qe._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(r,t),o(this,Ls).set(n,r),{id:n,clipPathId:`url(#${u})`}}drawOutline(t,e){const s=Fe(qe,up)._++,n=x(this,wr,LA).call(this),r=qe._svgFactory.createElement("defs");n.append(r);const a=qe._svgFactory.createElement("path");r.append(a);const l=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(e){const d=qe._svgFactory.createElement("mask");r.append(d),c=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=qe._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const g=qe._svgFactory.createElement("use");d.append(g),g.setAttribute("href",`#${l}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const u=qe._svgFactory.createElement("use");n.append(u),u.setAttribute("href",`#${l}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return n.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(n,t),o(this,Ls).set(s,n),s}finalizeDraw(t,e){o(this,Uc).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var c;if(!e)return;const{root:s,bbox:n,rootClass:r,path:a}=e,l=typeof t=="number"?o(this,Ls).get(t):t;if(l){if(s&&x(this,wr,PA).call(this,l,s),n&&x(c=qe,_b,uN).call(c,l,n),r){const{classList:u}=l;for(const[h,d]of Object.entries(r))u.toggle(h,d)}if(a){const h=l.firstChild.firstChild;x(this,wr,PA).call(this,h,a)}}}updateParent(t,e){if(e===this)return;const s=o(this,Ls).get(t);s&&(o(e,Pn).append(s),o(this,Ls).delete(t),o(e,Ls).set(t,s))}remove(t){o(this,Uc).delete(t),o(this,Pn)!==null&&(o(this,Ls).get(t).remove(),o(this,Ls).delete(t))}destroy(){m(this,Pn,null);for(const t of o(this,Ls).values())t.remove();o(this,Ls).clear(),o(this,Uc).clear()}};Pn=new WeakMap,Ls=new WeakMap,Uc=new WeakMap,up=new WeakMap,_b=new WeakSet,uN=function(t,[e,s,n,r]){const{style:a}=t;a.top=`${100*s}%`,a.left=`${100*e}%`,a.width=`${100*n}%`,a.height=`${100*r}%`},wr=new WeakSet,LA=function(){const t=qe._svgFactory.create(1,1,!0);return o(this,Pn).append(t),t.setAttribute("aria-hidden",!0),t},hN=function(t,e){const s=qe._svgFactory.createElement("clipPath");t.append(s);const n=`clip_${e}`;s.setAttribute("id",n),s.setAttribute("clipPathUnits","objectBoundingBox");const r=qe._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${e}`),r.classList.add("clip"),n},PA=function(t,e){for(const[s,n]of Object.entries(e))n===null?t.removeAttribute(s):t.setAttribute(s,n)},A(qe,_b),A(qe,up,0);let jA=qe;globalThis._pdfjsTestingUtils={HighlightOutliner:fA};globalThis.pdfjsLib={AbortException:el,AnnotationEditorLayer:kA,AnnotationEditorParamsType:At,AnnotationEditorType:ot,AnnotationEditorUIManager:Qc,AnnotationLayer:cA,AnnotationMode:qa,AnnotationType:Me,applyOpacity:e3,build:l4,ColorPicker:Q0,createValidAbsoluteUrl:eO,CSSConstants:t3,DOMSVGFactory:Z0,DrawLayer:jA,FeatureTest:_s,fetchData:Ep,findContrastColor:s3,getDocument:ck,getFilenameFromUrl:YB,getPdfFilenameFromUrl:KB,getRGB:Cp,getUuid:nO,getXfaPageViewport:QB,GlobalWorkerOptions:fr,ImageKind:Oy,InvalidPDFException:h_,isDataScheme:Xb,isPdfFile:WS,isValidExplicitDest:d3,MathClamp:Is,noContextMenu:bn,normalizeUnicode:GB,OPS:bg,OutputScale:vr,PasswordResponses:PB,PDFDataRangeTransport:uk,PDFDateString:G0,PDFWorker:_g,PermissionFlag:LB,PixelsPerInch:sl,RenderingCancelledException:KS,renderRichText:oO,ResponseException:q0,setLayerDimensions:Wc,shadow:ut,SignatureExtractor:pa,stopEvent:xe,SupportedImageMimeTypes:f_,TextLayer:wg,TouchManager:X0,updateUrlHash:sO,Util:$,VerbosityLevel:qb,version:o4,XfaLayer:aO};const M4="/assets/pdf.worker-zxMdjS_u.mjs";fr.workerSrc=M4;function $E(){const{user:i}=nu(),[t,e]=q.useState([]),[s,n]=q.useState(!0),[r,a]=q.useState(!1),[l,c]=q.useState(""),[u,h]=q.useState(null);q.useEffect(()=>{d()},[]);const d=async()=>{try{const{data:y,error:E}=await $t.from("documents").select("*").order("created_at",{ascending:!1});if(E)throw E;e(y||[])}catch(y){console.error("Error fetching documents:",y),f("error","Failed to load documents")}finally{n(!1)}},f=(y,E)=>{h({type:y,text:E}),setTimeout(()=>h(null),5e3)},g=async y=>{try{c("Reading PDF file...");const E=await y.arrayBuffer();c("Loading PDF document...");const T=await ck({data:E}).promise;let C="";const R=T.numPages;c(`Extracting text from ${R} pages...`);for(let k=1;k<=R;k++){c(`Processing page ${k} of ${R}...`);const I=(await(await T.getPage(k)).getTextContent()).items.map(Z=>Z.str).join(" ");C+=I+`

`}const O=C.trim();if(console.log(` Extracted ${O.length} characters from PDF`),O.length<100)throw new Error("PDF appears to be empty or contains very little text");return O}catch(E){throw console.error("PDF extraction error:",E),new Error(`Failed to extract text from PDF: ${E.message}`)}},b=async y=>{var T;const E=(T=y.target.files)==null?void 0:T[0];if(!(!E||!i)){a(!0),c("Starting upload...");try{let C="";if(E.type==="application/pdf")C=await g(E);else if(E.type.includes("text/"))c("Reading text file..."),C=await E.text();else throw new Error("Unsupported file type. Please upload PDF or TXT files.");console.log(`Text content length: ${C.length} characters`),c("Uploading file to storage...");const R=E.name.split(".").pop(),k=`documents/${`${Date.now()}.${R}`}`,{error:D}=await $t.storage.from("documents").upload(k,E);if(D)throw D;c("Processing document and generating embeddings..."),console.log(" Sending to edge function:",{name:E.name,contentLength:C.length,contentPreview:C.substring(0,100),file_path:k,file_size:E.size,mime_type:E.type});const{data:P,error:I}=await $t.functions.invoke("process-document",{body:{name:E.name,content:C,file_path:k,file_size:E.size,mime_type:E.type}});if(console.log(" Response from edge function:",P),I)throw I;f("success",` Document processed! Extracted ${C.length} characters.`),d()}catch(C){console.error("Error uploading document:",C),f("error",C.message||"Failed to upload document")}finally{a(!1),c(""),y.target.value=""}}},v=async y=>{try{const{data:E,error:T}=await $t.storage.from("documents").download(y.file_path);if(T)throw T;const C=URL.createObjectURL(E),R=window.document.createElement("a");R.href=C,R.download=y.name,window.document.body.appendChild(R),R.click(),window.document.body.removeChild(R),URL.revokeObjectURL(C)}catch(E){console.error("Error downloading document:",E),f("error","Failed to download document")}},S=async y=>{if(confirm(`Are you sure you want to delete "${y.name}"?`))try{const{error:E}=await $t.storage.from("documents").remove([y.file_path]);if(E)throw E;const{error:T}=await $t.from("documents").delete().eq("id",y.id);if(T)throw T;f("success","Document deleted successfully!"),d()}catch(E){console.error("Error deleting document:",E),f("error","Failed to delete document")}},p=y=>{if(y===0)return"0 Bytes";const E=1024,T=["Bytes","KB","MB","GB"],C=Math.floor(Math.log(y)/Math.log(E));return parseFloat((y/Math.pow(E,C)).toFixed(2))+" "+T[C]},w=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return s?_.jsx("div",{className:"flex items-center justify-center h-64",children:_.jsx(br,{className:"w-8 h-8 animate-spin text-primary-600"})}):_.jsxs("div",{className:"space-y-6 px-4",children:[_.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:_.jsxs("div",{children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Training Documents"}),_.jsx("p",{className:"text-gray-600 mt-1",children:"Upload Formula Student rulebooks, guides, and reference materials"})]})}),u&&_.jsxs("div",{className:`p-4 rounded-lg flex items-center space-x-2 ${u.type==="success"?"bg-success-50 border border-success-200":"bg-danger-50 border border-danger-200"}`,children:[u.type==="success"?_.jsx(YS,{className:"w-5 h-5 text-success-600"}):_.jsx(XS,{className:"w-5 h-5 text-danger-600"}),_.jsx("span",{className:u.type==="success"?"text-success-700":"text-danger-700",children:u.text})]}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 sm:p-8 text-center hover:border-primary-400 transition-colors",children:[_.jsx(RB,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),_.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Training Documents"}),_.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-4",children:"Supported formats: PDF, TXT (Max 10MB)"}),r&&l&&_.jsx("p",{className:"text-xs sm:text-sm text-primary-600 mb-3 font-medium",children:l}),_.jsxs("label",{className:"btn-primary cursor-pointer inline-block",children:[r?_.jsxs("span",{className:"flex items-center space-x-2",children:[_.jsx(br,{className:"w-4 h-4 animate-spin"}),_.jsx("span",{children:"Processing..."})]}):"Choose File",_.jsx("input",{type:"file",className:"hidden",accept:".pdf,.txt",onChange:b,disabled:r})]})]})}),_.jsxs("div",{className:"card",children:[_.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Uploaded Documents (",t.length,")"]}),t.length===0?_.jsxs("div",{className:"text-center py-8",children:[_.jsx($0,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600",children:"No documents uploaded yet"}),_.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload your first training document to get started"})]}):_.jsx("div",{className:"space-y-3",children:t.map(y=>_.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 sm:p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors space-y-3 sm:space-y-0",children:[_.jsxs("div",{className:"flex items-start sm:items-center space-x-3 flex-1",children:[_.jsx($0,{className:"w-8 h-8 text-primary-600 flex-shrink-0"}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("h3",{className:"font-medium text-gray-900 text-sm sm:text-base truncate",children:y.name}),_.jsxs("p",{className:"text-sm text-gray-500",children:[p(y.file_size),"  Uploaded ",w(y.created_at)]}),y.content&&!y.content.startsWith("[PDF Document:")&&_.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[" Text extracted (",y.content.length," chars)"]}),y.content&&y.content.startsWith("[PDF Document:")&&_.jsx("p",{className:"text-xs text-orange-600 mt-1",children:" No text extracted - please re-upload"})]})]}),_.jsxs("div",{className:"flex items-center space-x-2 self-end sm:self-center",children:[_.jsx("button",{onClick:()=>v(y),className:"p-2 text-gray-600 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Download",children:_.jsx(ZP,{className:"w-4 h-4"})}),_.jsx("button",{onClick:()=>S(y),className:"p-2 text-gray-600 hover:text-danger-600 hover:bg-danger-50 rounded-lg transition-colors",title:"Delete",children:_.jsx(EB,{className:"w-4 h-4"})})]})]},y.id))})]})]})}function D4(){const{user:i}=nu(),[t,e]=q.useState([]),[s,n]=q.useState(""),[r,a]=q.useState(!1),l=q.useRef(null);q.useEffect(()=>{e([{id:"1",content:"Hello! I'm your Formula Student training assistant. I can help you with questions about the rulebook, regulations, and technical requirements. What would you like to know?",is_user:!1,timestamp:new Date().toISOString()}])},[]),q.useEffect(()=>{c()},[t]);const c=()=>{var h;(h=l.current)==null||h.scrollIntoView({behavior:"smooth"})},u=async h=>{if(h.preventDefault(),!s.trim()||r)return;const d={id:Date.now().toString(),content:s.trim(),is_user:!0,timestamp:new Date().toISOString()};e(f=>[...f,d]),n(""),a(!0);try{const{data:f,error:g}=await $t.functions.invoke("chat-rag",{body:{query:d.content}});if(g)throw g;const b={id:(Date.now()+1).toString(),content:f.response,is_user:!1,timestamp:new Date().toISOString(),sources:f.sources||[]};e(v=>[...v,b])}catch(f){console.error("Error sending message:",f);const g={id:(Date.now()+1).toString(),content:"I'm sorry, I encountered an error while processing your question. Please try again.",is_user:!1,timestamp:new Date().toISOString()};e(b=>[...b,g])}finally{a(!1)}};return _.jsxs("div",{className:"h-[calc(100vh-8rem)] flex flex-col px-4",children:[_.jsxs("div",{className:"mb-6",children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Q&A Chat"}),_.jsx("p",{className:"text-gray-600 mt-1",children:"Ask questions about Formula Student rules and regulations"})]}),_.jsxs("div",{className:"flex-1 card overflow-hidden flex flex-col",children:[_.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 sm:p-4 space-y-4",children:[t.map(h=>_.jsxs("div",{className:`flex items-start space-x-2 sm:space-x-3 ${h.is_user?"flex-row-reverse space-x-reverse":""}`,children:[_.jsx("div",{className:`flex-shrink-0 w-6 h-6 sm:w-8 sm:h-8 rounded-full flex items-center justify-center ${h.is_user?"bg-primary-600 text-white":"bg-gray-200 text-gray-600"}`,children:h.is_user?_.jsx(NB,{className:"w-3 h-3 sm:w-4 sm:h-4"}):_.jsx(fE,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),_.jsxs("div",{className:`flex-1 max-w-full sm:max-w-3xl ${h.is_user?"text-right":"text-left"}`,children:[_.jsx("div",{className:`inline-block p-2 sm:p-3 rounded-lg max-w-full ${h.is_user?"bg-primary-600 text-white":"bg-gray-100 text-gray-900"}`,children:_.jsx("p",{className:"whitespace-pre-wrap text-sm sm:text-base break-words",children:h.content})}),h.sources&&h.sources.length>0&&_.jsxs("div",{className:"mt-2 text-xs sm:text-sm text-gray-500",children:[_.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[_.jsx($0,{className:"w-3 h-3"}),_.jsx("span",{children:"Sources:"})]}),_.jsx("ul",{className:"list-disc list-inside space-y-1 break-words",children:h.sources.map((d,f)=>_.jsx("li",{children:d},f))})]}),_.jsx("div",{className:"text-xs text-gray-500 mt-1 break-words",children:new Date(h.timestamp).toLocaleTimeString()})]})]},h.id)),r&&_.jsxs("div",{className:"flex items-start space-x-3",children:[_.jsx("div",{className:"flex-shrink-0 w-6 h-6 sm:w-8 sm:h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center",children:_.jsx(fE,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),_.jsx("div",{className:"flex-1",children:_.jsx("div",{className:"inline-block p-2 sm:p-3 rounded-lg bg-gray-100",children:_.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsx(br,{className:"w-4 h-4 animate-spin"}),_.jsx("span",{className:"text-gray-600 text-sm sm:text-base",children:"Thinking..."})]})})})]}),_.jsx("div",{ref:l})]}),_.jsx("div",{className:"border-t border-gray-200 p-2 sm:p-4",children:_.jsxs("form",{onSubmit:u,className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:[_.jsx("input",{type:"text",value:s,onChange:h=>n(h.target.value),placeholder:"Ask a question about Formula Student...",className:"flex-1 input-field text-sm sm:text-base",disabled:r}),_.jsx("button",{type:"submit",disabled:r||!s.trim(),className:"btn-primary px-4 sm:px-6 w-full sm:w-auto",children:_.jsx(ZR,{className:"w-4 h-4"})})]})})]})]})}function j4(){const{user:i}=nu(),[t,e]=q.useState([]),[s,n]=q.useState(0),[r,a]=q.useState(null),[l,c]=q.useState(!1),[u,h]=q.useState(0),[d,f]=q.useState([]),[g,b]=q.useState(!1),[v,S]=q.useState(!1),[p,w]=q.useState(!0),[y,E]=q.useState({questionCount:5,timeLimit:10}),[T,C]=q.useState(0),[R,O]=q.useState(!1),[k,D]=q.useState(!1),[P,I]=q.useState(""),[Z,K]=q.useState(!1),W=t[s],N=s===t.length-1;q.useEffect(()=>{let Q;return R&&!k&&T>0&&(Q=setInterval(()=>{C(it=>it<=1?(L(),0):it-1)},1e3)),()=>clearInterval(Q)},[R,k,T]);const L=()=>{O(!1),c(!0),Nt()},z=async()=>{var Q;S(!0);try{const{data:it,error:fe}=await $t.functions.invoke("generate-quiz",{body:{count:y.questionCount}});if(fe)throw fe;e(it.questions||[]),f(new Array(((Q=it.questions)==null?void 0:Q.length)||0).fill(null)),tt(),w(!1)}catch(it){console.error("Error generating quiz:",it);const fe=[{id:"1",type:"multiple_choice",question:"What is the maximum engine displacement allowed in Formula Student?",options:["610cc","650cc","710cc","750cc"],correct_answer:0,explanation:"The maximum engine displacement is 610cc according to Formula Student rules.",difficulty:"medium"},{id:"2",type:"true_false",question:"Formula Student cars must have a functioning brake system on all four wheels.",correct_answer:!0,explanation:"All Formula Student cars must have brakes on all four wheels for safety.",difficulty:"easy"}];e(fe),f(new Array(fe.length).fill(null)),tt(),w(!1)}finally{S(!1)}},tt=()=>{n(0),a(null),c(!1),h(0),O(!1),D(!1),C(0),I(""),f(new Array(t.length).fill(null))},bt=()=>{O(!0),C(y.timeLimit*60)},ze=()=>{D(!k)},gt=Q=>{a(Q)},vt=()=>{if(r===null)return;const Q=[...d];Q[s]=r,f(Q),r===W.correct_answer&&h(u+1),N?(O(!1),c(!0),Nt()):(n(s+1),a(null))},Nt=async()=>{K(!0);try{const{data:Q,error:it}=await $t.functions.invoke("generate-feedback",{body:{questions:t,answers:d,score:u,totalQuestions:t.length}});if(it)throw it;I(Q.feedback||"")}catch(Q){console.error("Error generating feedback:",Q);const it=Q instanceof Error?Q.message:"Unknown error occurred";it.includes("Failed to fetch")||it.includes("fetch")?I("Unable to connect to the feedback service. Please check your internet connection and try again."):I(`Unable to generate personalized feedback: ${it}`)}finally{K(!1)}},de=()=>{w(!0),tt()},ks=Q=>{const it=Math.floor(Q/60),fe=Q%60;return`${it}:${fe.toString().padStart(2,"0")}`},Ct=()=>{const Q=u/t.length*100;return Q>=80?"text-success-600":Q>=60?"text-yellow-600":"text-danger-600"},$i=()=>{const Q=u/t.length*100;return Q>=80?"Excellent work! You're well prepared.":Q>=60?"Good job! Keep studying to improve.":"Keep practicing! Review the materials and try again."};return p?_.jsxs("div",{className:"max-w-2xl mx-auto",children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quiz Settings"}),_.jsx("p",{className:"text-gray-600 mt-1",children:"Configure your Formula Student quiz"})]}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Questions"}),_.jsxs("select",{value:y.questionCount,onChange:Q=>E(it=>({...it,questionCount:parseInt(Q.target.value)})),className:"input-field",children:[_.jsx("option",{value:5,children:"5 Questions"}),_.jsx("option",{value:10,children:"10 Questions"}),_.jsx("option",{value:15,children:"15 Questions"}),_.jsx("option",{value:20,children:"20 Questions"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Limit (Total Quiz Duration)"}),_.jsxs("select",{value:y.timeLimit,onChange:Q=>E(it=>({...it,timeLimit:parseInt(Q.target.value)})),className:"input-field",children:[_.jsx("option",{value:5,children:"5 Minutes"}),_.jsx("option",{value:10,children:"10 Minutes"}),_.jsx("option",{value:15,children:"15 Minutes"}),_.jsx("option",{value:20,children:"20 Minutes"}),_.jsx("option",{value:30,children:"30 Minutes"}),_.jsx("option",{value:0,children:"No Time Limit"})]})]}),_.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[_.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Quiz Preview"}),_.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[_.jsxs("li",{children:[" ",y.questionCount," AI-generated questions"]}),_.jsxs("li",{children:[" ",y.timeLimit>0?`${y.timeLimit} minutes total`:"No time limit"]}),_.jsx("li",{children:" Mix of multiple choice and true/false questions"}),_.jsx("li",{children:" Personalized AI feedback based on your performance"})]})]}),_.jsx("button",{onClick:z,disabled:v,className:"btn-primary w-full",children:v?_.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[_.jsx(br,{className:"w-4 h-4 animate-spin"}),_.jsx("span",{children:"Generating Quiz..."})]}):_.jsxs("span",{className:"flex items-center justify-center space-x-2",children:[_.jsx(Ry,{className:"w-4 h-4"}),_.jsx("span",{children:"Generate Quiz"})]})})]})})]}):v?_.jsx("div",{className:"flex items-center justify-center h-64",children:_.jsxs("div",{className:"text-center",children:[_.jsx(br,{className:"w-8 h-8 animate-spin text-primary-600 mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600",children:"Generating quiz questions with AI..."})]})}):t.length===0?_.jsxs("div",{className:"text-center py-12",children:[_.jsx(XS,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),_.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Questions Available"}),_.jsx("p",{className:"text-gray-600 mb-4",children:"Please upload some training documents first to generate quiz questions."}),_.jsx("button",{onClick:()=>w(!0),className:"btn-primary",children:"Configure Quiz"})]}):l?_.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[_.jsx("div",{className:"text-center mb-8",children:_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quiz Results"})}),_.jsxs("div",{className:"card text-center",children:[_.jsxs("div",{className:"mb-6",children:[_.jsx($b,{className:`w-16 h-16 mx-auto mb-4 ${Ct()}`}),_.jsxs("h2",{className:`text-3xl font-bold mb-2 ${Ct()}`,children:[u," / ",t.length]}),_.jsxs("p",{className:"text-xl text-gray-600 mb-4",children:[Math.round(u/t.length*100),"% Correct"]}),_.jsx("p",{className:"text-gray-600",children:$i()})]}),_.jsxs("div",{className:"mb-8 text-left",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 text-center",children:"AI Performance Analysis"}),_.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:Z?_.jsxs("div",{className:"flex items-center justify-center py-4",children:[_.jsx(br,{className:"w-5 h-5 animate-spin text-primary-600 mr-2"}),_.jsx("span",{className:"text-gray-600",children:"Analyzing your performance..."})]}):_.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:P})})]}),_.jsx("div",{className:"space-y-4 mb-8",children:t.map((Q,it)=>{const fe=d[it],ol=fe===Q.correct_answer;return _.jsx("div",{className:"text-left p-3 sm:p-4 border border-gray-200 rounded-lg",children:_.jsxs("div",{className:"flex items-start space-x-3",children:[ol?_.jsx(YS,{className:"w-5 h-5 text-success-600 mt-0.5"}):_.jsx(YP,{className:"w-5 h-5 text-danger-600 mt-0.5"}),_.jsxs("div",{className:"flex-1",children:[_.jsxs("p",{className:"font-medium text-gray-900 mb-2 text-sm sm:text-base",children:[it+1,". ",Q.question]}),Q.type==="multiple_choice"&&Q.options&&_.jsxs("div",{className:"space-y-1 text-sm",children:[_.jsxs("p",{className:"text-gray-600",children:["Your answer: ",Q.options[fe]||"No answer"]}),_.jsxs("p",{className:"text-gray-600",children:["Correct answer: ",Q.options[Q.correct_answer]]})]}),Q.type==="true_false"&&_.jsxs("div",{className:"space-y-1 text-sm",children:[_.jsxs("p",{className:"text-gray-600",children:["Your answer: ",(fe==null?void 0:fe.toString())||"No answer"]}),_.jsxs("p",{className:"text-gray-600",children:["Correct answer: ",Q.correct_answer.toString()]})]}),_.jsx("p",{className:"text-sm text-gray-500 mt-2",children:Q.explanation})]})]})},Q.id)})}),_.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4 justify-center",children:[_.jsxs("button",{onClick:de,className:"btn-secondary",children:[_.jsx(mE,{className:"w-4 h-4 mr-2"}),"New Quiz"]}),_.jsxs("button",{onClick:()=>w(!0),className:"btn-primary",children:[_.jsx(Ry,{className:"w-4 h-4 mr-2"}),"Configure Quiz"]})]})]})]}):R?_.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[_.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-8 space-y-4 sm:space-y-0",children:[_.jsxs("div",{children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Self Quiz"}),_.jsx("p",{className:"text-gray-600 mt-1",children:"Test your Formula Student knowledge"})]}),_.jsx("div",{className:"text-right",children:_.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[y.timeLimit>0&&_.jsxs("div",{className:"flex items-center space-x-2 justify-end sm:justify-start",children:[_.jsx(WP,{className:`w-5 h-5 ${T<60?"text-danger-600":"text-gray-600"}`}),_.jsx("span",{className:`font-mono text-base sm:text-lg ${T<60?"text-danger-600":"text-gray-900"}`,children:ks(T)}),_.jsx("button",{onClick:ze,className:"p-1 text-gray-600 hover:text-primary-600 rounded",children:_.jsx(gE,{className:"w-4 h-4"})})]}),_.jsxs("div",{children:[_.jsxs("p",{className:"text-sm text-gray-500",children:["Question ",s+1," of ",t.length]}),_.jsx("div",{className:"w-24 sm:w-32 bg-gray-200 rounded-full h-2 mt-1",children:_.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${(s+1)/t.length*100}%`}})})]})]})})]}),k&&_.jsx("div",{className:"card mb-6 text-center",children:_.jsxs("div",{className:"py-4",children:[_.jsx(gE,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),_.jsx("p",{className:"text-gray-600",children:"Quiz Paused"}),_.jsx("button",{onClick:ze,className:"btn-primary mt-2",children:"Resume Quiz"})]})}),_.jsxs("div",{className:`card ${k?"opacity-50":""}`,children:[_.jsxs("div",{className:"mb-6",children:[_.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[_.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${W.difficulty==="easy"?"bg-success-100 text-success-700":W.difficulty==="medium"?"bg-yellow-100 text-yellow-700":"bg-danger-100 text-danger-700"}`,children:W.difficulty.toUpperCase()}),_.jsx("span",{className:"text-sm text-gray-500 capitalize",children:W.type.replace("_"," ")})]}),_.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900 mb-6",children:W.question})]}),_.jsxs("div",{className:"space-y-3 mb-8",children:[W.type==="multiple_choice"&&W.options&&W.options.map((Q,it)=>_.jsx("button",{onClick:()=>gt(it),disabled:k,className:`w-full text-left p-4 border-2 rounded-lg transition-all duration-200 ${r===it?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"} ${k?"cursor-not-allowed":""}`,children:_.jsxs("div",{className:"flex items-start space-x-3",children:[_.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${r===it?"border-primary-500 bg-primary-500":"border-gray-300"}`,children:r===it&&_.jsx("div",{className:"w-2 h-2 bg-white rounded-full mx-auto mt-0.5"})}),_.jsxs("span",{className:"font-medium text-sm sm:text-base",children:[String.fromCharCode(65+it),". ",Q]})]})},it)),W.type==="true_false"&&_.jsxs(_.Fragment,{children:[_.jsx("button",{onClick:()=>gt(!0),disabled:k,className:`w-full text-left p-4 border-2 rounded-lg transition-all duration-200 ${r===!0?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"} ${k?"cursor-not-allowed":""}`,children:_.jsxs("div",{className:"flex items-start space-x-3",children:[_.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${r===!0?"border-primary-500 bg-primary-500":"border-gray-300"}`,children:r===!0&&_.jsx("div",{className:"w-2 h-2 bg-white rounded-full mx-auto mt-0.5"})}),_.jsx("span",{className:"font-medium text-sm sm:text-base",children:"True"})]})}),_.jsx("button",{onClick:()=>gt(!1),disabled:k,className:`w-full text-left p-4 border-2 rounded-lg transition-all duration-200 ${r===!1?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"} ${k?"cursor-not-allowed":""}`,children:_.jsxs("div",{className:"flex items-start space-x-3",children:[_.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${r===!1?"border-primary-500 bg-primary-500":"border-gray-300"}`,children:r===!1&&_.jsx("div",{className:"w-2 h-2 bg-white rounded-full mx-auto mt-0.5"})}),_.jsx("span",{className:"font-medium text-sm sm:text-base",children:"False"})]})})]})]}),_.jsxs("div",{className:"flex flex-col sm:flex-row justify-between space-y-2 sm:space-y-0 sm:space-x-4",children:[_.jsxs("button",{onClick:de,className:"btn-secondary w-full sm:w-auto",disabled:k,children:[_.jsx(yB,{className:"w-4 h-4 mr-2"}),"New Quiz"]}),_.jsx("button",{onClick:vt,disabled:r===null||r===""||k,className:"btn-primary w-full sm:w-auto",children:N?"Finish Quiz":"Next Question"})]})]})]}):_.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ready to Start Quiz"}),_.jsxs("p",{className:"text-gray-600 mt-1",children:[t.length," questions  ",y.timeLimit>0?`${y.timeLimit} minutes`:"No time limit"]})]}),_.jsxs("div",{className:"card text-center",children:[_.jsxs("div",{className:"mb-6",children:[_.jsx(Ry,{className:"w-16 h-16 text-primary-600 mx-auto mb-4"}),_.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Formula Student Quiz"}),_.jsx("p",{className:"text-gray-600",children:"Test your knowledge with AI-generated questions based on your uploaded documents."})]}),_.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4 justify-center",children:[_.jsxs("button",{onClick:()=>w(!0),className:"btn-secondary",children:[_.jsx(mE,{className:"w-4 h-4 mr-2"}),"Settings"]}),_.jsxs("button",{onClick:bt,className:"btn-primary",children:[_.jsx(l_,{className:"w-4 h-4 mr-2"}),"Start Quiz"]})]})]})]})}function L4(){var Np;const{user:i}=nu(),[t,e]=q.useState([]),[s,n]=q.useState(null),[r,a]=q.useState([]),[l,c]=q.useState(!1),[u,h]=q.useState(!1),[d,f]=q.useState(""),[g,b]=q.useState(""),[v,S]=q.useState(!1),[p,w]=q.useState(null),[y,E]=q.useState(1),[T,C]=q.useState(0),[R,O]=q.useState(!1),[k,D]=q.useState({numTeams:2,questionsPerTeam:10,timePerQuestion:60});q.useEffect(()=>{P()},[]),q.useEffect(()=>{s&&(I(),Z())},[s]),q.useEffect(()=>{let j;return R&&T>0&&(j=setInterval(()=>{C(G=>G<=1?(ze(),0):G-1)},1e3)),()=>clearInterval(j)},[R,T]);const P=async()=>{try{const{data:j,error:G}=await $t.from("team_rooms").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(G)throw G;e(j||[])}catch(j){console.error("Error fetching rooms:",j)}},I=async()=>{if(s)try{const{data:j,error:G}=await $t.from("room_participants").select("*").eq("room_id",s.id);if(G)throw G;a(j||[])}catch(j){console.error("Error fetching participants:",j)}},Z=()=>{if(!s)return;const j=$t.channel(`room-${s.id}`).on("postgres_changes",{event:"*",schema:"public",table:"team_rooms",filter:`id=eq.${s.id}`},G=>{if(G.new){const rt=G.new;n(rt),rt.room_status==="in_progress"&&rt.current_question&&(C(rt.time_per_question),O(!0))}}).on("postgres_changes",{event:"*",schema:"public",table:"room_participants",filter:`room_id=eq.${s.id}`},()=>{I()}).subscribe();return()=>{j.unsubscribe()}},K=async()=>{if(!(!d.trim()||!i)){S(!0);try{const j=Math.random().toString(36).substring(2,8).toUpperCase(),{data:G,error:rt}=await $t.from("team_rooms").insert({name:d.trim(),code:j,created_by:i.id,is_active:!0,num_teams:k.numTeams,questions_per_team:k.questionsPerTeam,time_per_question:k.timePerQuestion,current_turn_team_id:1,current_question_index:0,team_questions:{},team_scores:{},room_status:"lobby",current_question:null,current_answers:{}}).select().single();if(rt)throw rt;await $t.from("room_participants").insert({room_id:G.id,user_id:i.id,user_email:i.email||"",team_number:1}),n(G),c(!1),f(""),P()}catch(j){console.error("Error creating room:",j)}finally{S(!1)}}},W=async()=>{if(!(!g.trim()||!i)){S(!0);try{const{data:j,error:G}=await $t.from("team_rooms").select("*").eq("code",g.trim().toUpperCase()).eq("is_active",!0).single();if(G)throw new Error("Room not found");const{data:rt}=await $t.from("room_participants").select("*").eq("room_id",j.id).eq("user_id",i.id).single();rt||await $t.from("room_participants").insert({room_id:j.id,user_id:i.id,user_email:i.email||"",team_number:y}),n(j),h(!1),b("")}catch(j){console.error("Error joining room:",j),alert("Failed to join room. Please check the room code.")}finally{S(!1)}}},N=async()=>{if(!(!s||!i))try{await $t.from("room_participants").delete().eq("room_id",s.id).eq("user_id",i.id),n(null),a([]),w(null),O(!1),C(0)}catch(j){console.error("Error leaving room:",j)}},L=async()=>{if(!(!s||s.created_by!==(i==null?void 0:i.id))){S(!0);try{const j=s.num_teams*s.questions_per_team,{data:G,error:rt}=await $t.functions.invoke("generate-quiz",{body:{count:j}});if(rt)throw rt;const We={},ke={};for(let qs=1;qs<=s.num_teams;qs++)We[qs.toString()]=G.questions.slice((qs-1)*s.questions_per_team,qs*s.questions_per_team),ke[qs.toString()]=0;await $t.from("team_rooms").update({room_status:"in_progress",team_questions:We,team_scores:ke,current_turn_team_id:1,current_question_index:0,current_question:We[1][0],current_answers:{}}).eq("id",s.id),w(null)}catch(j){console.error("Error starting game:",j)}finally{S(!1)}}},z=async()=>{var j;if(!(!s||!i||p===null))try{const G=s.current_answers||{};G[i.id]={answer:p,user_email:i.email,team_number:(j=r.find(rt=>rt.user_id===i.id))==null?void 0:j.team_number},await $t.from("team_rooms").update({current_answers:G}).eq("id",s.id),tt()}catch(G){console.error("Error submitting answer:",G)}},tt=async()=>{var We;if(!s||!i)return;const j=r.filter(ke=>ke.team_number===s.current_turn_team_id),G=s.current_answers||{},rt=j.map(ke=>G[ke.user_id]).filter(ke=>ke!==void 0);if(rt.length===j.length){const ke=(We=rt[0])==null?void 0:We.answer;rt.every(qi=>qi.answer===ke)&&await bt(ke)}},bt=async j=>{if(s)try{const G=s.current_turn_team_id,rt=s.current_question,We=j===rt.correct_answer,ke={...s.team_scores};We&&(ke[G.toString()]=(ke[G.toString()]||0)+1);let qs=G,qi=s.current_question_index,ou=null,dN=s.room_status;qs=G%s.num_teams+1,qs===1&&qi++;const fN=Math.max(...Object.values(s.team_questions).map(Mp=>Mp.length));if(qi>=fN)dN="finished",await $t.from("team_rooms").update({room_status:"finished",is_active:!1,team_scores:ke,current_answers:{}}).eq("id",s.id);else{const Mp=s.team_questions[qs.toString()]||[];qi<Mp.length&&(ou=Mp[qi]),await $t.from("team_rooms").update({current_turn_team_id:qs,current_question_index:qi,current_question:ou,current_answers:{},team_scores:ke}).eq("id",s.id)}w(null),O(!1),C(0)}catch(G){console.error("Error advancing question:",G)}},ze=async()=>{s&&(O(!1),await bt("PASS"))},gt=j=>{const G=Math.floor(j/60),rt=j%60;return`${G}:${rt.toString().padStart(2,"0")}`},vt=(s==null?void 0:s.created_by)===(i==null?void 0:i.id),Nt=s==null?void 0:s.current_question,de=(s==null?void 0:s.current_answers)||{},ks=r.find(j=>j.user_id===(i==null?void 0:i.id)),Ct=(ks==null?void 0:ks.team_number)===(s==null?void 0:s.current_turn_team_id),$i=(i==null?void 0:i.id)&&de[i.id],Q=r.filter(j=>j.team_number===(s==null?void 0:s.current_turn_team_id)),it=Q.map(j=>de[j.user_id]).filter(j=>j!==void 0),fe=it.length===Q.length,ol=(Np=it[0])==null?void 0:Np.answer,Wd=fe&&it.every(j=>j.answer===ol);if((s==null?void 0:s.room_status)==="finished"){const j=s.team_scores||{},G=Object.entries(j).sort(([,rt],[,We])=>We-rt);return _.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 px-4",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Game Finished!"}),_.jsx("p",{className:"text-gray-600",children:s.name})]}),_.jsxs("div",{className:"card",children:[_.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6 text-center",children:"Final Results"}),_.jsx("div",{className:"space-y-4",children:G.map(([rt,We],ke)=>{const qs=r.filter(ou=>ou.team_number===parseInt(rt)),qi=ke===0;return _.jsxs("div",{className:`p-4 rounded-lg border-2 ${qi?"border-yellow-400 bg-yellow-50":"border-gray-200 bg-gray-50"}`,children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsxs("div",{className:"flex items-center space-x-2",children:[qi&&_.jsx($v,{className:"w-5 h-5 text-yellow-500"}),_.jsxs("h3",{className:"font-semibold text-gray-900",children:["Team ",rt," ",qi&&""]})]}),_.jsxs("div",{className:"text-2xl font-bold text-primary-600",children:[We,"/",s.questions_per_team]})]}),_.jsxs("div",{className:"text-sm text-gray-600",children:["Members: ",qs.map(ou=>ou.user_email).join(", ")]}),_.jsx("div",{className:"mt-2",children:_.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:_.jsx("div",{className:`h-2 rounded-full ${qi?"bg-yellow-500":"bg-primary-500"}`,style:{width:`${We/s.questions_per_team*100}%`}})})})]},rt)})}),_.jsx("div",{className:"mt-8 text-center",children:_.jsx("button",{onClick:N,className:"btn-primary",children:"Leave Room"})})]})]})}return s&&s.room_status==="in_progress"?_.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 px-4",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.name}),_.jsxs("p",{className:"text-gray-600",children:["Room Code: ",_.jsx("span",{className:"font-mono font-bold",children:s.code})]})]}),_.jsx("button",{onClick:N,className:"btn-secondary",children:"Leave Room"})]}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:[_.jsxs("div",{className:"flex items-center space-x-4",children:[_.jsxs("div",{className:"text-center",children:[_.jsxs("div",{className:"text-2xl font-bold text-primary-600",children:["Team ",s.current_turn_team_id]}),_.jsx("div",{className:"text-sm text-gray-600",children:"Current Turn"})]}),_.jsxs("div",{className:"text-center",children:[_.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[s.current_question_index+1,"/",s.questions_per_team]}),_.jsx("div",{className:"text-sm text-gray-600",children:"Question"})]})]}),R&&_.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsx(SB,{className:`w-5 h-5 ${T<10?"text-danger-600":"text-primary-600"}`}),_.jsx("span",{className:`text-2xl font-mono font-bold ${T<10?"text-danger-600":"text-primary-600"}`,children:gt(T)})]})]})}),_.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[_.jsx("div",{className:"lg:col-span-2",children:_.jsx("div",{className:"card",children:Nt?_.jsxs("div",{children:[_.jsxs("div",{className:"mb-4",children:[_.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[_.jsx(_B,{className:"w-5 h-5 text-primary-600"}),_.jsxs("span",{className:"font-medium text-primary-600",children:["Team ",s.current_turn_team_id,"'s Question"]})]}),!Ct&&_.jsx("div",{className:"p-3 bg-gray-100 rounded-lg mb-4",children:_.jsxs("p",{className:"text-gray-600 text-center",children:["Waiting for Team ",s.current_turn_team_id," to answer..."]})})]}),_.jsxs("div",{className:"mb-6",children:[_.jsx("p",{className:"text-lg text-gray-900 mb-4",children:Nt.question}),Nt.type==="multiple_choice"&&Nt.options&&_.jsx("div",{className:"space-y-3",children:Nt.options.map((j,G)=>_.jsx("button",{onClick:()=>w(G),disabled:!Ct||$i,className:`w-full text-left p-3 border-2 rounded-lg transition-all duration-200 ${p===G?"border-primary-500 bg-primary-50":!Ct||$i?"border-gray-200 bg-gray-50 cursor-not-allowed":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("span",{children:[String.fromCharCode(65+G),". ",j]}),_.jsx("div",{className:"flex items-center space-x-1",children:it.filter(rt=>rt.answer===G).map((rt,We)=>_.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full"},We))})]})},G))}),Nt.type==="true_false"&&_.jsx("div",{className:"space-y-3",children:[!0,!1].map(j=>_.jsx("button",{onClick:()=>w(j),disabled:!Ct||$i,className:`w-full text-left p-3 border-2 rounded-lg transition-all duration-200 ${p===j?"border-primary-500 bg-primary-50":!Ct||$i?"border-gray-200 bg-gray-50 cursor-not-allowed":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx("span",{children:j?"True":"False"}),_.jsx("div",{className:"flex items-center space-x-1",children:it.filter(G=>G.answer===j).map((G,rt)=>_.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full"},rt))})]})},j.toString()))})]}),Ct&&_.jsx("div",{className:"mb-4",children:_.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx("span",{className:"text-blue-700 font-medium",children:"Team Consensus"}),_.jsxs("span",{className:"text-blue-600",children:[it.length,"/",Q.length," answered"]})]}),it.length>0&&!Wd&&_.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"Team members have different answers. Coordinate to reach consensus!"}),Wd&&_.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[_.jsx(YS,{className:"w-4 h-4 text-success-600"}),_.jsx("span",{className:"text-success-700 text-sm",children:"Consensus reached!"})]})]})}),Ct&&!$i&&p!==null&&_.jsxs("button",{onClick:z,className:"btn-primary",children:[_.jsx(ZR,{className:"w-4 h-4 mr-2"}),"Submit Answer"]}),$i&&_.jsx("div",{className:"p-3 bg-success-50 border border-success-200 rounded-lg",children:_.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsx(pE,{className:"w-5 h-5 text-success-600"}),_.jsx("span",{className:"text-success-700",children:"Answer submitted! Waiting for team consensus..."})]})})]}):_.jsxs("div",{className:"text-center py-12",children:[_.jsx($b,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),_.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Active Question"}),_.jsx("p",{className:"text-gray-600",children:"Loading next question..."})]})})}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"card",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Team Scores"}),_.jsx("div",{className:"space-y-3",children:Array.from({length:s.num_teams},(j,G)=>G+1).map(j=>{const G=r.filter(ke=>ke.team_number===j),rt=s.team_scores[j.toString()]||0,We=j===s.current_turn_team_id;return _.jsxs("div",{className:`p-3 rounded-lg border-2 ${We?"border-primary-500 bg-primary-50":"border-gray-200 bg-gray-50"}`,children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsxs("div",{className:"flex items-center space-x-2",children:[We&&_.jsx(l_,{className:"w-4 h-4 text-primary-600"}),_.jsxs("span",{className:"font-medium text-gray-900",children:["Team ",j]})]}),_.jsxs("div",{className:"text-lg font-bold text-primary-600",children:[rt,"/",s.questions_per_team]})]}),_.jsxs("div",{className:"text-xs text-gray-600",children:[G.length," members"]})]},j)})})]}),_.jsxs("div",{className:"card",children:[_.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["All Participants (",r.length,")"]}),_.jsx("div",{className:"space-y-2",children:r.map(j=>{const G=j.user_id===s.created_by,rt=de[j.user_id];return _.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[_.jsxs("div",{className:"flex items-center space-x-2",children:[G&&_.jsx($v,{className:"w-4 h-4 text-yellow-500"}),_.jsx("span",{className:"text-sm font-medium text-gray-900",children:j.user_email}),_.jsxs("span",{className:"text-xs bg-primary-100 text-primary-700 px-2 py-1 rounded",children:["Team ",j.team_number]})]}),Nt&&j.team_number===s.current_turn_team_id&&_.jsx("div",{className:"flex items-center space-x-2",children:rt?_.jsx(pE,{className:"w-4 h-4 text-success-600"}):_.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"})})]},j.id)})})]})]})]})]}):s&&s.room_status==="lobby"?_.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 px-4",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.name}),_.jsxs("p",{className:"text-gray-600",children:["Room Code: ",_.jsx("span",{className:"font-mono font-bold",children:s.code})]})]}),_.jsx("button",{onClick:N,className:"btn-secondary",children:"Leave Room"})]}),_.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[_.jsxs("div",{className:"card",children:[_.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Game Settings"}),_.jsxs("div",{className:"space-y-3 text-sm",children:[_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{className:"text-gray-600",children:"Number of Teams:"}),_.jsx("span",{className:"font-medium",children:s.num_teams})]}),_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{className:"text-gray-600",children:"Questions per Team:"}),_.jsx("span",{className:"font-medium",children:s.questions_per_team})]}),_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{className:"text-gray-600",children:"Time per Question:"}),_.jsxs("span",{className:"font-medium",children:[s.time_per_question,"s"]})]})]}),vt&&_.jsxs("div",{className:"mt-6",children:[_.jsxs("button",{onClick:L,disabled:v||r.length<2,className:"btn-primary w-full",children:[v?_.jsx(br,{className:"w-4 h-4 mr-2 animate-spin"}):_.jsx(l_,{className:"w-4 h-4 mr-2"}),"Start Game"]}),r.length<2&&_.jsx("p",{className:"text-sm text-gray-500 mt-2 text-center",children:"Need at least 2 participants to start"})]})]}),_.jsxs("div",{className:"card",children:[_.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teams"}),_.jsx("div",{className:"space-y-4",children:Array.from({length:s.num_teams},(j,G)=>G+1).map(j=>{const G=r.filter(rt=>rt.team_number===j);return _.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsxs("h3",{className:"font-medium text-gray-900",children:["Team ",j]}),_.jsxs("span",{className:"text-sm text-gray-500",children:[G.length," members"]})]}),_.jsxs("div",{className:"space-y-1",children:[G.map(rt=>_.jsxs("div",{className:"flex items-center space-x-2",children:[rt.user_id===s.created_by&&_.jsx($v,{className:"w-4 h-4 text-yellow-500"}),_.jsx("span",{className:"text-sm text-gray-700",children:rt.user_email})]},rt.id)),G.length===0&&_.jsx("p",{className:"text-sm text-gray-500 italic",children:"No members yet"})]})]},j)})})]})]})]}):_.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 px-4",children:[_.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-4 sm:space-y-0",children:_.jsxs("div",{children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Team Challenge"}),_.jsx("p",{className:"text-gray-600",children:"Collaborate with your team to answer Formula Student questions"})]})}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[_.jsx("div",{className:"card",children:_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:_.jsx(mB,{className:"w-6 h-6 text-primary-600"})}),_.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Create Room"}),_.jsx("p",{className:"text-gray-600 mb-4",children:"Start a new team challenge session"}),l?_.jsxs("div",{className:"space-y-4",children:[_.jsx("input",{type:"text",value:d,onChange:j=>f(j.target.value),placeholder:"Enter room name",className:"input-field"}),_.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Teams"}),_.jsx("select",{value:k.numTeams,onChange:j=>D(G=>({...G,numTeams:parseInt(j.target.value)})),className:"input-field text-sm",children:[2,3,4,5,6,7,8].map(j=>_.jsx("option",{value:j,children:j},j))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Questions"}),_.jsx("select",{value:k.questionsPerTeam,onChange:j=>D(G=>({...G,questionsPerTeam:parseInt(j.target.value)})),className:"input-field text-sm",children:[5,10,15,20].map(j=>_.jsx("option",{value:j,children:j},j))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Time (s)"}),_.jsx("select",{value:k.timePerQuestion,onChange:j=>D(G=>({...G,timePerQuestion:parseInt(j.target.value)})),className:"input-field text-sm",children:[30,60,90,120].map(j=>_.jsx("option",{value:j,children:j},j))})]})]}),_.jsxs("div",{className:"flex space-x-2",children:[_.jsx("button",{onClick:K,disabled:v||!d.trim(),className:"btn-primary flex-1",children:v?_.jsx(br,{className:"w-4 h-4 animate-spin"}):"Create"}),_.jsx("button",{onClick:()=>c(!1),className:"btn-secondary",children:"Cancel"})]})]}):_.jsx("button",{onClick:()=>c(!0),className:"btn-primary",children:"Create Room"})]})}),_.jsx("div",{className:"card",children:_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"w-12 h-12 bg-success-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:_.jsx(rB,{className:"w-6 h-6 text-success-600"})}),_.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Join Room"}),_.jsx("p",{className:"text-gray-600 mb-4",children:"Enter a room code to join an existing session"}),u?_.jsxs("div",{className:"space-y-4",children:[_.jsx("input",{type:"text",value:g,onChange:j=>b(j.target.value.toUpperCase()),placeholder:"Enter room code",className:"input-field font-mono text-center",maxLength:6}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:"Select Team"}),_.jsx("div",{className:"flex space-x-2",children:[1,2,3,4].map(j=>_.jsxs("button",{onClick:()=>E(j),className:`flex-1 py-2 px-3 rounded-lg border-2 transition-colors ${y===j?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300"}`,children:["Team ",j]},j))})]}),_.jsxs("div",{className:"flex space-x-2",children:[_.jsx("button",{onClick:W,disabled:v||!g.trim(),className:"btn-primary flex-1",children:v?_.jsx(br,{className:"w-4 h-4 animate-spin"}):"Join"}),_.jsx("button",{onClick:()=>h(!1),className:"btn-secondary",children:"Cancel"})]})]}):_.jsx("button",{onClick:()=>h(!0),className:"btn-primary",children:"Join Room"})]})})]}),t.length>0&&_.jsxs("div",{className:"card",children:[_.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Active Rooms"}),_.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(j=>_.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsx("h3",{className:"font-medium text-gray-900",children:j.name}),_.jsxs("div",{className:"flex items-center space-x-1",children:[_.jsx(tO,{className:"w-4 h-4 text-gray-400"}),_.jsx("span",{className:"text-sm text-gray-500",children:j.num_teams})]})]}),_.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Code: ",_.jsx("span",{className:"font-mono font-bold",children:j.code})]}),_.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:[j.questions_per_team," questions  ",j.time_per_question,"s per question"]}),_.jsx("button",{onClick:()=>{b(j.code),h(!0)},className:"btn-secondary w-full text-sm",children:"Join Room"})]},j.id))})]})]})}function P4(){const{user:i,loading:t}=nu(),[e,s]=q.useState("documents");if(t)return _.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:_.jsxs("div",{className:"text-center",children:[_.jsx(br,{className:"w-8 h-8 animate-spin text-primary-600 mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});if(!i)return _.jsx(jB,{});const n=()=>{switch(e){case"documents":return _.jsx($E,{});case"chat":return _.jsx(D4,{});case"quiz":return _.jsx(j4,{});case"team":return _.jsx(L4,{});default:return _.jsx($E,{})}};return _.jsx(DB,{currentPage:e,onPageChange:s,children:n()})}function B4(){return _.jsx(BP,{children:_.jsx(P4,{})})}pj.createRoot(document.getElementById("root")).render(_.jsx(PN.StrictMode,{children:_.jsx(B4,{})}));
